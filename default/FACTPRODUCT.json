{
  "externalControllerServices" : { },
  "flow" : {
    "createdTimestamp" : 1767794465110,
    "description" : "",
    "identifier" : "FACTPRODUCT",
    "lastModifiedTimestamp" : 1767794465110,
    "name" : "FACT_PRODUCT",
    "versionCount" : 0
  },
  "flowContents" : {
    "comments" : "",
    "componentType" : "PROCESS_GROUP",
    "connections" : [ {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "2c1f88b7-a870-329b-9710-16d7c0ef6b35",
        "name" : "KiemTraLaBcCuoiCung",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "e59070de-b9b7-3b56-8d58-33e71c9565ae",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
        "id" : "baffeed0-28c5-33f4-addb-2aebd65fd084",
        "name" : "stateBcOut",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 26
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "id" : "a9d9caaa-313d-3197-bad9-d377112f7fdf",
        "name" : "stateStatus",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "02fd7142-f205-33e6-be08-32c49d711cdd",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "b6706b10-3c15-352e-898d-dabd3112924a",
        "id" : "add339f6-8d10-38fd-b4f5-8702ed779a97",
        "name" : "stateOut",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 6
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
        "id" : "0e8881ae-6778-343c-a439-0ea19c8b1f47",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "9f13b9b3-7df0-3d9d-86a6-3508be3719d1",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "failure" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "483fbf05-05ed-3daf-8b9f-2d2cc72d5a01",
        "name" : "DuyetTungBC",
        "type" : "PROCESSOR"
      },
      "zIndex" : 11
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "3c787563-45b6-3ab6-8173-03029e8fa19d",
        "name" : "CapNhatTrangThaiBcHienTaiLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "d6a1d46a-3631-3968-9642-5792d2b23087",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
        "id" : "4828f287-46ce-3813-a778-625818bcafe5",
        "name" : "Output",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 24
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
        "id" : "4d384010-b603-3237-ab47-e54869976a8e",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "bf38aa48-1204-313d-8f59-470bc0b19a1d",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "3c787563-45b6-3ab6-8173-03029e8fa19d",
        "name" : "CapNhatTrangThaiBcHienTaiLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "zIndex" : 25
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "id" : "68ccbe35-520c-3b45-bc1f-07907ab33cb5",
        "name" : "stateAdAccounts",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "3b5e8b33-eeba-340a-a15f-4227d57483e0",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "id" : "d1e693d3-7e6e-31c1-bff8-9b16617a8f29",
        "name" : "stateAdAccount",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 22
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "27cbdf39-7cef-3636-8933-7d1432d20eae",
        "name" : "LayDanhSachBC",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "a9760506-8775-3165-b061-ff26bfd2b69b",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "id" : "14a94c7b-5181-3fa1-8121-8f751311b371",
        "name" : "stateStore",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 7
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
        "id" : "1f024838-4692-38aa-a66e-2150644fac99",
        "name" : "input",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "27d144e1-1d68-3eed-8ecb-7d76db486e33",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "61adbd51-67d9-3d52-84d6-23a1a641c4d8",
        "name" : "KhoiTao",
        "type" : "PROCESSOR"
      },
      "zIndex" : 1
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "8e7dcdc3-0278-3846-972a-bd4f37bafec9",
        "name" : "KiemTraETLDangXuLy",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "a4fbd3b9-274e-3c75-b5d0-b6ad25c1c288",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
        "id" : "1d51748c-cb5d-3f17-b570-d02049b2a48a",
        "name" : "ouput",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 2
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "483fbf05-05ed-3daf-8b9f-2d2cc72d5a01",
        "name" : "DuyetTungBC",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "5a91061e-d5c2-3308-99be-3deb1f11ce87",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "d619de88-2c2b-3b99-824e-f04f4f69f7d3",
        "name" : "DataToJSON",
        "type" : "PROCESSOR"
      },
      "zIndex" : 10
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "b6706b10-3c15-352e-898d-dabd3112924a",
        "id" : "87ef39a4-9be3-31ca-bcb0-fd878c9dbc4f",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "349be93f-8ef6-366e-9795-a8b36f37d8d4",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "58621464-e384-349f-aa27-0adcb0d488d8",
        "name" : "CapNhatETLLaDangXuLy",
        "type" : "PROCESSOR"
      },
      "zIndex" : 5
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "d619de88-2c2b-3b99-824e-f04f4f69f7d3",
        "name" : "DataToJSON",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "ac132256-bca8-31f4-a496-0eb74bba3a22",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "27cbdf39-7cef-3636-8933-7d1432d20eae",
        "name" : "LayDanhSachBC",
        "type" : "PROCESSOR"
      },
      "zIndex" : 9
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "b853ae00-798e-328a-94e5-ea8573b9145e",
        "name" : "CapNhatBcHienTaiLaDangXuLy",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "effdac95-e0c0-3e6f-996b-33e8948164cc",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "unmatched" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "e5cfb2f3-8f0f-3e16-af54-5114cbf73a95",
        "name" : "KiemTraBcDaETLChua",
        "type" : "PROCESSOR"
      },
      "zIndex" : 19
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
        "id" : "d60fa9ec-18f5-316a-8b75-58a4cbb697c6",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "5059f844-10e8-3fa6-8d25-9867e7dc0492",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "b853ae00-798e-328a-94e5-ea8573b9145e",
        "name" : "CapNhatBcHienTaiLaDangXuLy",
        "type" : "PROCESSOR"
      },
      "zIndex" : 20
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
        "id" : "1a632db3-5e0a-3171-a2d6-70b126d62f39",
        "name" : "Input",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "c1241a55-e95a-300b-b6e9-7067afe77a1b",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "id" : "80573ecd-9d95-3907-ab77-59fd2796370a",
        "name" : "stateCams",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 23
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
        "id" : "f3f2a256-33ed-389b-ad4c-912a5d3b6b6f",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "54fef04e-00c4-39f9-849d-0abe9bdb341f",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "7dca28f1-f4cf-341a-85df-c3285c4f539f",
        "name" : "CapNhatETLLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "zIndex" : 16
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "c0e34305-e902-372e-8f04-61d91f3e741a",
        "id" : "9de022c3-2d10-3fa4-a7e3-3425c75612c4",
        "name" : "input",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "9f347de8-2eda-3a32-aa3c-5187a2e8a76d",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
        "id" : "0d8152a5-c84f-32ee-aa29-3f46e15c016e",
        "name" : "stateOut",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 30
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "7dca28f1-f4cf-341a-85df-c3285c4f539f",
        "name" : "CapNhatETLLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "85d24243-4bd3-372a-8757-fbd6eda9a681",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "isEmptyJsonArray " ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "74eae803-28d2-32fd-99f0-4a6f45184a5a",
        "name" : "KiemTraDanhSachBcTrong",
        "type" : "PROCESSOR"
      },
      "zIndex" : 15
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
        "id" : "055ac462-66e1-38b6-9f35-4c87245fccaf",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "316cee6c-0b22-376f-ab86-7a3149c34f9c",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "f6935d0d-06f0-3954-a1f0-322e9bb2ede4",
        "name" : "CapNhatTrangThaiETLLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "zIndex" : 29
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "e5cfb2f3-8f0f-3e16-af54-5114cbf73a95",
        "name" : "KiemTraBcDaETLChua",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "af23bd1f-46f2-33ce-9b19-35171a2b5459",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
        "id" : "b08fdcf9-a15c-3efa-b739-9b709b91a431",
        "name" : "stateBcOut",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 17
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "id" : "f4fbf07e-71ef-3afd-8362-81c93c937378",
        "name" : "stateBc",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "691f552d-b62a-31cb-b3c8-26e85eca5876",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
        "id" : "65bcb24e-8e54-3675-a6b5-0ae09b42b758",
        "name" : "stateBcOut",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 21
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "74eae803-28d2-32fd-99f0-4a6f45184a5a",
        "name" : "KiemTraDanhSachBcTrong",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "be837af3-879c-3ccf-83b2-0b0811271154",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "original" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "483fbf05-05ed-3daf-8b9f-2d2cc72d5a01",
        "name" : "DuyetTungBC",
        "type" : "PROCESSOR"
      },
      "zIndex" : 12
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "85f7c2f9-0155-3de9-9d10-177640448caa",
        "name" : "LogMessage",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "eb056a71-795f-3381-b18b-d0308632a943",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "HoanThanhETLRoi" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "e5cfb2f3-8f0f-3e16-af54-5114cbf73a95",
        "name" : "KiemTraBcDaETLChua",
        "type" : "PROCESSOR"
      },
      "zIndex" : 18
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "7d64d08a-b2d5-3f72-bd8c-d5c999e73fff",
        "name" : "LogMessage",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "1cb4bb1e-38b4-33a8-8316-29e3e159a8a8",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "unmatched" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "2c1f88b7-a870-329b-9710-16d7c0ef6b35",
        "name" : "KiemTraLaBcCuoiCung",
        "type" : "PROCESSOR"
      },
      "zIndex" : 28
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "f6935d0d-06f0-3954-a1f0-322e9bb2ede4",
        "name" : "CapNhatTrangThaiETLLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "12527700-6f53-3877-b09f-a280e56796ba",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "bcCuoiCung" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "2c1f88b7-a870-329b-9710-16d7c0ef6b35",
        "name" : "KiemTraLaBcCuoiCung",
        "type" : "PROCESSOR"
      },
      "zIndex" : 27
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "38823f81-1250-33b7-94e0-7c4e89e40cd8",
        "name" : "ChuyenContentBcLenAttribute",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "ad60d882-aefd-38f7-90b5-8cd1d13a12ec",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "split" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "483fbf05-05ed-3daf-8b9f-2d2cc72d5a01",
        "name" : "DuyetTungBC",
        "type" : "PROCESSOR"
      },
      "zIndex" : 13
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
        "id" : "3aa4cbad-b604-366e-a9f7-e3512cadb3c7",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "73d87994-8356-3678-a78b-0fee5c9ebd30",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "failure" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "27cbdf39-7cef-3636-8933-7d1432d20eae",
        "name" : "LayDanhSachBC",
        "type" : "PROCESSOR"
      },
      "zIndex" : 8
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
        "id" : "4895f878-2fb6-37fb-bc5e-a296ef29e377",
        "name" : "BcId",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "575efac7-d312-359c-a797-6ff18a664b3c",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "matched" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "38823f81-1250-33b7-94e0-7c4e89e40cd8",
        "name" : "ChuyenContentBcLenAttribute",
        "type" : "PROCESSOR"
      },
      "zIndex" : 14
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "58621464-e384-349f-aa27-0adcb0d488d8",
        "name" : "CapNhatETLLaDangXuLy",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "d297456d-a9b3-3c51-b474-615bde94c3eb",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "unmatched" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "8e7dcdc3-0278-3846-972a-bd4f37bafec9",
        "name" : "KiemTraETLDangXuLy",
        "type" : "PROCESSOR"
      },
      "zIndex" : 3
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "0625d3f3-bdcc-3723-8b2e-0bd52a18095a",
        "name" : "LogMessage",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "8d532c6a-3878-3416-98d9-5448c4b695c8",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "isProcessing" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "8e7dcdc3-0278-3846-972a-bd4f37bafec9",
        "name" : "KiemTraETLDangXuLy",
        "type" : "PROCESSOR"
      },
      "zIndex" : 4
    } ],
    "controllerServices" : [ {
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-record-serialization-services-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "CONTROLLER_SERVICE",
      "controllerServiceApis" : [ {
        "bundle" : {
          "artifact" : "nifi-standard-services-api-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "type" : "org.apache.nifi.serialization.RecordSetWriterFactory"
      } ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "877d4cf8-3ef9-3d3c-965f-0f85798a2a2f",
      "name" : "JsonRecordSetWriter",
      "properties" : {
        "Allow Scientific Notation" : "false",
        "compression-level" : "1",
        "Pretty Print JSON" : "false",
        "compression-format" : "none",
        "Schema Write Strategy" : "no-schema",
        "suppress-nulls" : "never-suppress",
        "output-grouping" : "output-array",
        "schema-name" : "${schema.name}",
        "schema-access-strategy" : "inherit-record-schema",
        "schema-text" : "${avro.schema}"
      },
      "propertyDescriptors" : {
        "schema-reference-reader" : {
          "displayName" : "Schema Reference Reader",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "schema-reference-reader",
          "sensitive" : false
        },
        "schema-branch" : {
          "displayName" : "Schema Branch",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-branch",
          "sensitive" : false
        },
        "Allow Scientific Notation" : {
          "displayName" : "Allow Scientific Notation",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Allow Scientific Notation",
          "sensitive" : false
        },
        "compression-level" : {
          "displayName" : "Compression Level",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "compression-level",
          "sensitive" : false
        },
        "schema-cache" : {
          "displayName" : "Schema Cache",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "schema-cache",
          "sensitive" : false
        },
        "Timestamp Format" : {
          "displayName" : "Timestamp Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Timestamp Format",
          "sensitive" : false
        },
        "Date Format" : {
          "displayName" : "Date Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Date Format",
          "sensitive" : false
        },
        "Pretty Print JSON" : {
          "displayName" : "Pretty Print JSON",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Pretty Print JSON",
          "sensitive" : false
        },
        "compression-format" : {
          "displayName" : "Compression Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "compression-format",
          "sensitive" : false
        },
        "Schema Write Strategy" : {
          "displayName" : "Schema Write Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Schema Write Strategy",
          "sensitive" : false
        },
        "suppress-nulls" : {
          "displayName" : "Suppress Null Values",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "suppress-nulls",
          "sensitive" : false
        },
        "output-grouping" : {
          "displayName" : "Output Grouping",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "output-grouping",
          "sensitive" : false
        },
        "schema-name" : {
          "displayName" : "Schema Name",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-name",
          "sensitive" : false
        },
        "schema-registry" : {
          "displayName" : "Schema Registry",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "schema-registry",
          "sensitive" : false
        },
        "Time Format" : {
          "displayName" : "Time Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Time Format",
          "sensitive" : false
        },
        "schema-access-strategy" : {
          "displayName" : "Schema Access Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-access-strategy",
          "sensitive" : false
        },
        "schema-version" : {
          "displayName" : "Schema Version",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-version",
          "sensitive" : false
        },
        "schema-text" : {
          "displayName" : "Schema Text",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-text",
          "sensitive" : false
        },
        "Schema Reference Writer" : {
          "displayName" : "Schema Reference Writer",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "Schema Reference Writer",
          "sensitive" : false
        }
      },
      "scheduledState" : "DISABLED",
      "type" : "org.apache.nifi.json.JsonRecordSetWriter"
    }, {
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-record-serialization-services-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "CONTROLLER_SERVICE",
      "controllerServiceApis" : [ {
        "bundle" : {
          "artifact" : "nifi-standard-services-api-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "type" : "org.apache.nifi.serialization.RecordReaderFactory"
      } ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "40a44711-6955-3e69-b463-371590dfa3ed",
      "name" : "AvroReader",
      "properties" : {
        "schema-name" : "${schema.name}",
        "cache-size" : "1000",
        "schema-access-strategy" : "embedded-avro-schema",
        "schema-text" : "${avro.schema}"
      },
      "propertyDescriptors" : {
        "schema-reference-reader" : {
          "displayName" : "Schema Reference Reader",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "schema-reference-reader",
          "sensitive" : false
        },
        "schema-branch" : {
          "displayName" : "Schema Branch",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-branch",
          "sensitive" : false
        },
        "schema-name" : {
          "displayName" : "Schema Name",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-name",
          "sensitive" : false
        },
        "cache-size" : {
          "displayName" : "Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "cache-size",
          "sensitive" : false
        },
        "schema-registry" : {
          "displayName" : "Schema Registry",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "schema-registry",
          "sensitive" : false
        },
        "schema-access-strategy" : {
          "displayName" : "Schema Access Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-access-strategy",
          "sensitive" : false
        },
        "schema-version" : {
          "displayName" : "Schema Version",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-version",
          "sensitive" : false
        },
        "schema-text" : {
          "displayName" : "Schema Text",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-text",
          "sensitive" : false
        }
      },
      "scheduledState" : "DISABLED",
      "type" : "org.apache.nifi.avro.AvroReader"
    }, {
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-dbcp-service-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "CONTROLLER_SERVICE",
      "controllerServiceApis" : [ {
        "bundle" : {
          "artifact" : "nifi-standard-services-api-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "type" : "org.apache.nifi.dbcp.DBCPService"
      } ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "6fce9190-8f74-3a75-9e56-36c3f8fc6d63",
      "name" : "DBCPConnectionPool",
      "properties" : {
        "dbcp-min-idle-conns" : "0",
        "Max Wait Time" : "500 millis",
        "Database Driver Class Name" : "#{DbDriverClassName}",
        "dbcp-min-evictable-idle-time" : "30 mins",
        "Max Total Connections" : "8",
        "dbcp-max-conn-lifetime" : "-1",
        "Database Connection URL" : "#{DbConnectString}",
        "dbcp-time-between-eviction-runs" : "-1",
        "Database User" : "#{DbAccount}",
        "dbcp-soft-min-evictable-idle-time" : "-1",
        "database-driver-locations" : "#{DbDriverLocation}",
        "dbcp-max-idle-conns" : "8"
      },
      "propertyDescriptors" : {
        "dbcp-min-idle-conns" : {
          "displayName" : "Minimum Idle Connections",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-min-idle-conns",
          "sensitive" : false
        },
        "Max Wait Time" : {
          "displayName" : "Max Wait Time",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Max Wait Time",
          "sensitive" : false
        },
        "Database Driver Class Name" : {
          "displayName" : "Database Driver Class Name",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Database Driver Class Name",
          "sensitive" : false
        },
        "dbcp-min-evictable-idle-time" : {
          "displayName" : "Minimum Evictable Idle Time",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-min-evictable-idle-time",
          "sensitive" : false
        },
        "Max Total Connections" : {
          "displayName" : "Max Total Connections",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Max Total Connections",
          "sensitive" : false
        },
        "dbcp-max-conn-lifetime" : {
          "displayName" : "Max Connection Lifetime",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-max-conn-lifetime",
          "sensitive" : false
        },
        "Validation-query" : {
          "displayName" : "Validation query",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Validation-query",
          "sensitive" : false
        },
        "Database Connection URL" : {
          "displayName" : "Database Connection URL",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Database Connection URL",
          "sensitive" : false
        },
        "dbcp-time-between-eviction-runs" : {
          "displayName" : "Time Between Eviction Runs",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-time-between-eviction-runs",
          "sensitive" : false
        },
        "Database User" : {
          "displayName" : "Database User",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Database User",
          "sensitive" : false
        },
        "kerberos-user-service" : {
          "displayName" : "Kerberos User Service",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "kerberos-user-service",
          "sensitive" : false
        },
        "dbcp-soft-min-evictable-idle-time" : {
          "displayName" : "Soft Minimum Evictable Idle Time",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-soft-min-evictable-idle-time",
          "sensitive" : false
        },
        "database-driver-locations" : {
          "displayName" : "Database Driver Location(s)",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "database-driver-locations",
          "resourceDefinition" : {
            "cardinality" : "MULTIPLE",
            "resourceTypes" : [ "FILE", "URL", "DIRECTORY" ]
          },
          "sensitive" : false
        },
        "dbcp-max-idle-conns" : {
          "displayName" : "Max Idle Connections",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-max-idle-conns",
          "sensitive" : false
        },
        "Password" : {
          "displayName" : "Password",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Password",
          "sensitive" : true
        }
      },
      "scheduledState" : "DISABLED",
      "type" : "org.apache.nifi.dbcp.DBCPConnectionPool"
    } ],
    "defaultBackPressureDataSizeThreshold" : "1 GB",
    "defaultBackPressureObjectThreshold" : 10000,
    "defaultFlowFileExpiration" : "0 sec",
    "executionEngine" : "INHERITED",
    "externalControllerServiceReferences" : { },
    "flowFileConcurrency" : "UNBOUNDED",
    "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
    "funnels" : [ ],
    "identifier" : "flow-contents-group",
    "inputPorts" : [ ],
    "labels" : [ ],
    "maxConcurrentTasks" : 1,
    "name" : "FACT_PRODUCT",
    "outputPorts" : [ ],
    "parameterContextName" : "ETL",
    "position" : {
      "x" : 0.0,
      "y" : 0.0
    },
    "processGroups" : [ {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
          "id" : "e942fcb9-db63-3773-8592-1d62b60b7530",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
        "identifier" : "47b498e2-f23c-3f4f-9bec-ff354b03a917",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
          "id" : "055ac462-66e1-38b6-9f35-4c87245fccaf",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
          "id" : "f89d3070-615d-3f03-bf34-fe4b77bdabd5",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
        "identifier" : "84dd8b9e-344b-30bc-94b7-01addb75cdee",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
          "id" : "299bd568-c78f-396e-9073-9d88e21c5f93",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
          "id" : "fa3af728-0d55-32e6-85d6-0d73fd1c1f96",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
        "identifier" : "6f68c9c7-abaa-3729-abaf-6b9849bda608",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
          "id" : "299bd568-c78f-396e-9073-9d88e21c5f93",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
          "id" : "f89d3070-615d-3f03-bf34-fe4b77bdabd5",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
        "identifier" : "46f49305-5cda-33c5-b6d4-89c682a89a1e",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
          "id" : "fa3af728-0d55-32e6-85d6-0d73fd1c1f96",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
          "id" : "0d8152a5-c84f-32ee-aa29-3f46e15c016e",
          "name" : "stateOut",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
        "identifier" : "5400816a-16c1-3e4c-a685-53b2d65f9bf2",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
          "id" : "fa3af728-0d55-32e6-85d6-0d73fd1c1f96",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
          "id" : "299bd568-c78f-396e-9073-9d88e21c5f93",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
        "identifier" : "60a1ba6a-54ee-3560-b63e-ff91246cb5ea",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
          "id" : "e942fcb9-db63-3773-8592-1d62b60b7530",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
        "identifier" : "055ac462-66e1-38b6-9f35-4c87245fccaf",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LuuTrangThaiETL",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
        "identifier" : "0d8152a5-c84f-32ee-aa29-3f46e15c016e",
        "name" : "stateOut",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 1464.0,
          "y" : -200.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -200.0,
        "y" : 4928.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
        "identifier" : "299bd568-c78f-396e-9073-9d88e21c5f93",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${state.name}\",\n  \"isActive\": ${state.isActive},\n  \"lastExecutionTime\": \"${state.lastExecutionTime}\",\n  \"startTime\": \"${state.startTime}\",\n  \"endTime\": \"${state.endTime}\",\n  \"status\": \"${state.status}\",\n  \"sequenceNumber\": \"${state.sequenceNumber}\",\n  \"message\": \"${state.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
        "identifier" : "fa3af728-0d55-32e6-85d6-0d73fd1c1f96",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${state.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
        "identifier" : "f89d3070-615d-3f03-bf34-fe4b77bdabd5",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "f30d37a1-b6ea-34fb-a05b-0c81c0c48a27",
        "identifier" : "e942fcb9-db63-3773-8592-1d62b60b7530",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "filename" : "${state.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.lastExecutionTime" : {
            "displayName" : "state.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.lastExecutionTime",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
          "id" : "c7825240-44e3-3788-a682-8498af60bbf5",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
        "identifier" : "d7ba6ea1-eafb-3dc7-acdf-9ca4bd30bff8",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
          "id" : "f3f2a256-33ed-389b-ad4c-912a5d3b6b6f",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
          "id" : "23880d88-9745-35fb-8c48-92e20e994901",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
        "identifier" : "998f77de-4188-3028-93cb-1f65ef0aa1f8",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
          "id" : "8e5af2e6-b7db-3914-b990-370da74943cb",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
          "id" : "4d12f451-6565-3152-8836-6ee6a4e4abfa",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
        "identifier" : "dcb9a847-d2b7-3926-93c3-68ad7791c33e",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
          "id" : "8e5af2e6-b7db-3914-b990-370da74943cb",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
          "id" : "4d12f451-6565-3152-8836-6ee6a4e4abfa",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
        "identifier" : "7070b8e0-1a28-3168-9bf0-d6918d5fe546",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
          "id" : "23880d88-9745-35fb-8c48-92e20e994901",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
          "id" : "8e5af2e6-b7db-3914-b990-370da74943cb",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
        "identifier" : "f9328e3d-aa75-3be5-bc67-b19eb04ebf2b",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
          "id" : "c7825240-44e3-3788-a682-8498af60bbf5",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
        "identifier" : "f3f2a256-33ed-389b-ad4c-912a5d3b6b6f",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LuuTrangThaiETL",
      "outputPorts" : [ ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : 280.0,
        "y" : 2160.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
        "identifier" : "23880d88-9745-35fb-8c48-92e20e994901",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${state.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
        "identifier" : "8e5af2e6-b7db-3914-b990-370da74943cb",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${state.name}\",\n  \"isActive\": ${state.isActive},\n  \"lastExecutionTime\": \"${state.lastExecutionTime}\",\n  \"startTime\": \"${state.startTime}\",\n  \"endTime\": \"${state.endTime}\",\n  \"status\": \"${state.status}\",\n  \"sequenceNumber\": \"${state.sequenceNumber}\",\n  \"message\": \"${state.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
        "identifier" : "c7825240-44e3-3788-a682-8498af60bbf5",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "filename" : "${state.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.lastExecutionTime" : {
            "displayName" : "state.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.lastExecutionTime",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "19606677-bbb0-3ce0-b6c3-bc868af89c97",
        "identifier" : "4d12f451-6565-3152-8836-6ee6a4e4abfa",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
          "id" : "ce8bfb56-647d-3a55-bb99-d7d6f0907dd2",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
        "identifier" : "c3e7d955-6522-3c96-9f09-4a065c19e46d",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
          "id" : "4d384010-b603-3237-ab47-e54869976a8e",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
          "id" : "baffeed0-28c5-33f4-addb-2aebd65fd084",
          "name" : "stateBcOut",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
        "identifier" : "6014f7f8-e8e2-3d69-94e5-6c4e69b70b6c",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
          "id" : "0fb895a6-fb5e-3ca5-b85b-2cfabef6dba2",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
          "id" : "078e7fac-261f-333f-81e5-033965fb92b5",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
        "identifier" : "765ee927-1a96-32f9-b2a8-07acd3b325a3",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
          "id" : "8bfd675e-f626-3793-add5-f1ed71cd8ec2",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
          "id" : "0fb895a6-fb5e-3ca5-b85b-2cfabef6dba2",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
        "identifier" : "5e649163-2e20-3aae-be3e-014f62c6fb88",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
          "id" : "8bfd675e-f626-3793-add5-f1ed71cd8ec2",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
          "id" : "078e7fac-261f-333f-81e5-033965fb92b5",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
        "identifier" : "3537cf3f-2120-3ac0-a65e-d9a29f408e43",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
          "id" : "0fb895a6-fb5e-3ca5-b85b-2cfabef6dba2",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
          "id" : "8bfd675e-f626-3793-add5-f1ed71cd8ec2",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
        "identifier" : "8ba0782b-2e62-390b-bdbf-499c233c85eb",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
          "id" : "ce8bfb56-647d-3a55-bb99-d7d6f0907dd2",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
        "identifier" : "4d384010-b603-3237-ab47-e54869976a8e",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LuuTrangThaiBCHienTai",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
        "identifier" : "baffeed0-28c5-33f4-addb-2aebd65fd084",
        "name" : "stateBcOut",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 1552.0,
          "y" : -154.5
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -200.0,
        "y" : 4224.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
        "identifier" : "8bfd675e-f626-3793-add5-f1ed71cd8ec2",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${stateBc.name}\",\n  \"isActive\": ${stateBc.isActive},\n  \"lastExecutionTime\": \"${stateBc.lastExecutionTime}\",\n  \"startTime\": \"${stateBc.startTime}\",\n  \"endTime\": \"${stateBc.endTime}\",\n  \"status\": \"${stateBc.status}\",\n  \"sequenceNumber\": \"${stateBc.sequenceNumber}\",\n  \"message\": \"${stateBc.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
        "identifier" : "ce8bfb56-647d-3a55-bb99-d7d6f0907dd2",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "filename" : "${stateBc.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateBc.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateBc.lastExecutionTime" : {
            "displayName" : "stateBc.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateBc.lastExecutionTime",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
        "identifier" : "078e7fac-261f-333f-81e5-033965fb92b5",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "fbd2ac52-3ebf-38d4-bff2-846e8802e2ed",
        "identifier" : "0fb895a6-fb5e-3ca5-b85b-2cfabef6dba2",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${stateBc.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
          "id" : "94566d1e-6dd9-31f0-bbec-9ecacddf3290",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
        "identifier" : "87dd361f-bb4e-3857-b0d2-96703b1182c9",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
          "id" : "28fc2551-3e68-31e6-964b-928bd9bfbc60",
          "name" : "KhoiTaoBc",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
          "id" : "28fc2551-3e68-31e6-964b-928bd9bfbc60",
          "name" : "KhoiTaoBc",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
        "identifier" : "ff3645ff-8804-3147-a627-86022db8fec0",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
          "id" : "4895f878-2fb6-37fb-bc5e-a296ef29e377",
          "name" : "BcId",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
          "id" : "23eb3d30-d3a9-3200-9d12-42e89551265a",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
        "identifier" : "d76dd772-8dce-37fa-b9a8-40a768905b11",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
          "id" : "94566d1e-6dd9-31f0-bbec-9ecacddf3290",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "zIndex" : 45
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
          "id" : "b08fdcf9-a15c-3efa-b739-9b709b91a431",
          "name" : "stateBcOut",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
        "identifier" : "7f89e367-6bc6-372f-9a42-bdac7b7a75ae",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
          "id" : "94566d1e-6dd9-31f0-bbec-9ecacddf3290",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
        "identifier" : "4895f878-2fb6-37fb-bc5e-a296ef29e377",
        "name" : "BcId",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LayTrangThaiBCHienTai",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
        "identifier" : "b08fdcf9-a15c-3efa-b739-9b709b91a431",
        "name" : "stateBcOut",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 1280.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -200.0,
        "y" : 2160.0
      },
      "processGroups" : [ {
        "comments" : "",
        "componentType" : "PROCESS_GROUP",
        "connections" : [ {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
            "id" : "6ceb0e0e-bc04-32bc-bfd5-f79f7c852f81",
            "name" : "CapNhatToContent",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
          "identifier" : "3606cdbc-3bc5-3b3b-9be0-d1363c72c242",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
            "id" : "1c62247e-ef09-3a94-84a6-d63477232249",
            "name" : "ChuanHoa",
            "type" : "PROCESSOR"
          },
          "zIndex" : 42
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "030716b5-3225-30fe-9862-6c28b2a103ed",
            "id" : "83b03de6-e2ae-3934-b04d-3391528d4b7c",
            "name" : "input",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
          "identifier" : "3973313e-d5d1-3de6-a1ad-ed1195fa6c6f",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
            "id" : "56e10efe-006a-37b1-b642-524fb371ae5f",
            "name" : "LuuFile",
            "type" : "PROCESSOR"
          },
          "zIndex" : 47
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
            "id" : "56e10efe-006a-37b1-b642-524fb371ae5f",
            "name" : "LuuFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
          "identifier" : "88971910-57e3-3866-ad6c-4371f6512447",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
            "id" : "6ceb0e0e-bc04-32bc-bfd5-f79f7c852f81",
            "name" : "CapNhatToContent",
            "type" : "PROCESSOR"
          },
          "zIndex" : 43
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
            "id" : "b66f0f8a-8e9a-3dde-9081-813a9f8e1de1",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
          "identifier" : "43f78998-9ccc-366d-8581-9a122203f391",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
            "id" : "6ceb0e0e-bc04-32bc-bfd5-f79f7c852f81",
            "name" : "CapNhatToContent",
            "type" : "PROCESSOR"
          },
          "zIndex" : 44
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
            "id" : "1c62247e-ef09-3a94-84a6-d63477232249",
            "name" : "ChuanHoa",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
          "identifier" : "83661a45-ccbc-36e9-bc6e-7142c533f5c9",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
            "id" : "23eb3d30-d3a9-3200-9d12-42e89551265a",
            "name" : "TrangThai",
            "type" : "INPUT_PORT"
          },
          "zIndex" : 41
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
            "id" : "b66f0f8a-8e9a-3dde-9081-813a9f8e1de1",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
          "identifier" : "6bfe5017-64bf-34a8-81b6-a81f65658ec2",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
            "id" : "56e10efe-006a-37b1-b642-524fb371ae5f",
            "name" : "LuuFile",
            "type" : "PROCESSOR"
          },
          "zIndex" : 46
        } ],
        "controllerServices" : [ ],
        "defaultBackPressureDataSizeThreshold" : "1 GB",
        "defaultBackPressureObjectThreshold" : 10000,
        "defaultFlowFileExpiration" : "0 sec",
        "executionEngine" : "INHERITED",
        "flowFileConcurrency" : "UNBOUNDED",
        "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
        "funnels" : [ ],
        "groupIdentifier" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
        "identifier" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
        "inputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "INPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
          "identifier" : "23eb3d30-d3a9-3200-9d12-42e89551265a",
          "name" : "TrangThai",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : -488.0,
            "y" : -176.0
          },
          "scheduledState" : "ENABLED",
          "type" : "INPUT_PORT"
        } ],
        "labels" : [ ],
        "maxConcurrentTasks" : 1,
        "name" : "LuuTrangThaiBCHienTaiVoiLoi",
        "outputPorts" : [ ],
        "parameterContextName" : "TikTokETL",
        "position" : {
          "x" : 600.0,
          "y" : 72.0
        },
        "processGroups" : [ {
          "comments" : "",
          "componentType" : "PROCESS_GROUP",
          "connections" : [ {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "030716b5-3225-30fe-9862-6c28b2a103ed",
              "id" : "414bc74f-3720-3b37-96cd-e3953e09e765",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "030716b5-3225-30fe-9862-6c28b2a103ed",
            "identifier" : "3eb7ff19-4f13-3ab6-834b-81349606d150",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "030716b5-3225-30fe-9862-6c28b2a103ed",
              "id" : "99daba2e-53d2-3747-8279-6ef247eaa7c2",
              "name" : "ReplaceText",
              "type" : "PROCESSOR"
            },
            "zIndex" : 9
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "030716b5-3225-30fe-9862-6c28b2a103ed",
              "id" : "e3792d80-4a01-35c4-b387-1268751461b4",
              "name" : "GuiTinNhanTelegram",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "030716b5-3225-30fe-9862-6c28b2a103ed",
            "identifier" : "bc0360ae-9675-3f18-bb7b-ff715f757d0e",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "030716b5-3225-30fe-9862-6c28b2a103ed",
              "id" : "99daba2e-53d2-3747-8279-6ef247eaa7c2",
              "name" : "ReplaceText",
              "type" : "PROCESSOR"
            },
            "zIndex" : 7
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "030716b5-3225-30fe-9862-6c28b2a103ed",
              "id" : "414bc74f-3720-3b37-96cd-e3953e09e765",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "030716b5-3225-30fe-9862-6c28b2a103ed",
            "identifier" : "5c606ae0-5233-3e56-9942-9631f9b58ba0",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "Response", "Failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "030716b5-3225-30fe-9862-6c28b2a103ed",
              "id" : "e3792d80-4a01-35c4-b387-1268751461b4",
              "name" : "GuiTinNhanTelegram",
              "type" : "PROCESSOR"
            },
            "zIndex" : 5
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "030716b5-3225-30fe-9862-6c28b2a103ed",
              "id" : "d0432176-c4df-3b4f-9b46-63871ec5def7",
              "name" : "LaythongtinTelegramCauHinh",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "030716b5-3225-30fe-9862-6c28b2a103ed",
            "identifier" : "c61f89a4-6e0a-3025-98cb-8758b0d27182",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "groupId" : "030716b5-3225-30fe-9862-6c28b2a103ed",
              "id" : "83b03de6-e2ae-3934-b04d-3391528d4b7c",
              "name" : "input",
              "type" : "INPUT_PORT"
            },
            "zIndex" : 1
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "030716b5-3225-30fe-9862-6c28b2a103ed",
              "id" : "99daba2e-53d2-3747-8279-6ef247eaa7c2",
              "name" : "ReplaceText",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "030716b5-3225-30fe-9862-6c28b2a103ed",
            "identifier" : "7f572009-0409-36bc-97e4-ef78716809e1",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "send" ],
            "source" : {
              "comments" : "",
              "groupId" : "030716b5-3225-30fe-9862-6c28b2a103ed",
              "id" : "d69b6ba2-0b35-3310-a95c-ced6c73ba9d6",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "zIndex" : 8
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "030716b5-3225-30fe-9862-6c28b2a103ed",
              "id" : "d69b6ba2-0b35-3310-a95c-ced6c73ba9d6",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "030716b5-3225-30fe-9862-6c28b2a103ed",
            "identifier" : "c7161ae8-fe4d-3842-b059-545af019237d",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "030716b5-3225-30fe-9862-6c28b2a103ed",
              "id" : "d0432176-c4df-3b4f-9b46-63871ec5def7",
              "name" : "LaythongtinTelegramCauHinh",
              "type" : "PROCESSOR"
            },
            "zIndex" : 6
          } ],
          "controllerServices" : [ ],
          "defaultBackPressureDataSizeThreshold" : "1 GB",
          "defaultBackPressureObjectThreshold" : 10000,
          "defaultFlowFileExpiration" : "0 sec",
          "executionEngine" : "INHERITED",
          "flowFileConcurrency" : "UNBOUNDED",
          "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
          "funnels" : [ ],
          "groupIdentifier" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
          "identifier" : "030716b5-3225-30fe-9862-6c28b2a103ed",
          "inputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "INPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "030716b5-3225-30fe-9862-6c28b2a103ed",
            "identifier" : "83b03de6-e2ae-3934-b04d-3391528d4b7c",
            "name" : "input",
            "portFunction" : "STANDARD",
            "position" : {
              "x" : -1056.0,
              "y" : -248.0
            },
            "scheduledState" : "ENABLED",
            "type" : "INPUT_PORT"
          } ],
          "labels" : [ ],
          "maxConcurrentTasks" : 1,
          "name" : "GuiThongBaoTelegram",
          "outputPorts" : [ ],
          "position" : {
            "x" : 1376.0,
            "y" : -256.0
          },
          "processGroups" : [ ],
          "processors" : [ {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "030716b5-3225-30fe-9862-6c28b2a103ed",
            "identifier" : "d0432176-c4df-3b4f-9b46-63871ec5def7",
            "maxBackoffPeriod" : "10 mins",
            "name" : "LaythongtinTelegramCauHinh",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : -656.0,
              "y" : -280.0
            },
            "properties" : {
              "telegram.botToken" : "#{BotToken}",
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100",
              "telegram.chatId" : "#{ChatId}",
              "telegram.enabled" : "#{Enabled}",
              "telegram.text" : " MESSAGE ALERT\n Application: NIFI\n Flow: ${state.name}\n Message: ${state.message}"
            },
            "propertyDescriptors" : {
              "telegram.botToken" : {
                "displayName" : "telegram.botToken",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "telegram.botToken",
                "sensitive" : false
              },
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "telegram.chatId" : {
                "displayName" : "telegram.chatId",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "telegram.chatId",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              },
              "telegram.enabled" : {
                "displayName" : "telegram.enabled",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "telegram.enabled",
                "sensitive" : false
              },
              "telegram.text" : {
                "displayName" : "telegram.text",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "telegram.text",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "success" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "030716b5-3225-30fe-9862-6c28b2a103ed",
            "identifier" : "414bc74f-3720-3b37-96cd-e3953e09e765",
            "maxBackoffPeriod" : "10 mins",
            "name" : "LogMessage",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 224.0,
              "y" : 32.0
            },
            "properties" : {
              "log-level" : "info"
            },
            "propertyDescriptors" : {
              "log-message" : {
                "displayName" : "Log message",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-message",
                "sensitive" : false
              },
              "log-level" : {
                "displayName" : "Log Level",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-level",
                "sensitive" : false
              },
              "log-prefix" : {
                "displayName" : "Log prefix",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-prefix",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.LogMessage",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "030716b5-3225-30fe-9862-6c28b2a103ed",
            "identifier" : "99daba2e-53d2-3747-8279-6ef247eaa7c2",
            "maxBackoffPeriod" : "10 mins",
            "name" : "ReplaceText",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 200.0,
              "y" : -288.0
            },
            "properties" : {
              "Regular Expression" : "(?s)^(.*)$",
              "Replacement Value" : "{\"chat_id\":\"#{ChatId}\",\"text\":\"${telegram.text}\"}",
              "Evaluation Mode" : "Entire text",
              "Line-by-Line Evaluation Mode" : "All",
              "Character Set" : "UTF-8",
              "Maximum Buffer Size" : "1 MB",
              "Replacement Strategy" : "Regex Replace"
            },
            "propertyDescriptors" : {
              "Regular Expression" : {
                "displayName" : "Search Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Regular Expression",
                "sensitive" : false
              },
              "Replacement Value" : {
                "displayName" : "Replacement Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Replacement Value",
                "sensitive" : false
              },
              "Evaluation Mode" : {
                "displayName" : "Evaluation Mode",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Evaluation Mode",
                "sensitive" : false
              },
              "Text to Prepend" : {
                "displayName" : "Text to Prepend",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Text to Prepend",
                "sensitive" : false
              },
              "Line-by-Line Evaluation Mode" : {
                "displayName" : "Line-by-Line Evaluation Mode",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Line-by-Line Evaluation Mode",
                "sensitive" : false
              },
              "Character Set" : {
                "displayName" : "Character Set",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Character Set",
                "sensitive" : false
              },
              "Maximum Buffer Size" : {
                "displayName" : "Maximum Buffer Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Maximum Buffer Size",
                "sensitive" : false
              },
              "Replacement Strategy" : {
                "displayName" : "Replacement Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Replacement Strategy",
                "sensitive" : false
              },
              "Text to Append" : {
                "displayName" : "Text to Append",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Text to Append",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.ReplaceText",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "No Retry", "Retry", "Original" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "030716b5-3225-30fe-9862-6c28b2a103ed",
            "identifier" : "e3792d80-4a01-35c4-b387-1268751461b4",
            "maxBackoffPeriod" : "10 mins",
            "name" : "GuiTinNhanTelegram",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 656.0,
              "y" : -296.0
            },
            "properties" : {
              "Request Content-Encoding" : "DISABLED",
              "Request Multipart Form-Data Filename Enabled" : "true",
              "Request Chunked Transfer-Encoding Enabled" : "false",
              "HTTP/2 Disabled" : "False",
              "Connection Timeout" : "30 secs",
              "Response Cookie Strategy" : "DISABLED",
              "Socket Read Timeout" : "15 secs",
              "Socket Idle Connections" : "5",
              "Request Body Enabled" : "true",
              "OAuth2 Access Token Refresh Strategy" : "ON_TOKEN_EXPIRATION",
              "HTTP URL" : "https://api.telegram.org/bot#{BotToken}/sendMessage",
              "Socket Idle Timeout" : "5 mins",
              "Response Redirects Enabled" : "True",
              "Socket Write Timeout" : "15 secs",
              "Response FlowFile Naming Strategy" : "RANDOM",
              "Response Cache Enabled" : "false",
              "Request Date Header Enabled" : "True",
              "Request Failure Penalization Enabled" : "false",
              "Response Body Attribute Size" : "256",
              "Response Generation Required" : "false",
              "Response Header Request Attributes Enabled" : "false",
              "HTTP Method" : "POST",
              "Request Content-Type" : "application/json",
              "Request Digest Authentication Enabled" : "false",
              "Response Cache Size" : "10MB",
              "Response Body Ignored" : "false"
            },
            "propertyDescriptors" : {
              "Request Content-Encoding" : {
                "displayName" : "Request Content-Encoding",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Content-Encoding",
                "sensitive" : false
              },
              "proxy-configuration-service" : {
                "displayName" : "Proxy Configuration Service",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "proxy-configuration-service",
                "sensitive" : false
              },
              "Request Multipart Form-Data Filename Enabled" : {
                "displayName" : "Request Multipart Form-Data Filename Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Multipart Form-Data Filename Enabled",
                "sensitive" : false
              },
              "Request Chunked Transfer-Encoding Enabled" : {
                "displayName" : "Request Chunked Transfer-Encoding Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Chunked Transfer-Encoding Enabled",
                "sensitive" : false
              },
              "Response Header Request Attributes Prefix" : {
                "displayName" : "Response Header Request Attributes Prefix",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Header Request Attributes Prefix",
                "sensitive" : false
              },
              "HTTP/2 Disabled" : {
                "displayName" : "HTTP/2 Disabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "HTTP/2 Disabled",
                "sensitive" : false
              },
              "Connection Timeout" : {
                "displayName" : "Connection Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Connection Timeout",
                "sensitive" : false
              },
              "Response Cookie Strategy" : {
                "displayName" : "Response Cookie Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Cookie Strategy",
                "sensitive" : false
              },
              "Request Password" : {
                "displayName" : "Request Password",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Password",
                "sensitive" : true
              },
              "Socket Read Timeout" : {
                "displayName" : "Socket Read Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Socket Read Timeout",
                "sensitive" : false
              },
              "Socket Idle Connections" : {
                "displayName" : "Socket Idle Connections",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Socket Idle Connections",
                "sensitive" : false
              },
              "Request Body Enabled" : {
                "displayName" : "Request Body Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Body Enabled",
                "sensitive" : false
              },
              "OAuth2 Access Token Refresh Strategy" : {
                "displayName" : "OAuth2 Access Token Refresh Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "OAuth2 Access Token Refresh Strategy",
                "sensitive" : false
              },
              "HTTP URL" : {
                "displayName" : "HTTP URL",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "HTTP URL",
                "sensitive" : false
              },
              "Request OAuth2 Access Token Provider" : {
                "displayName" : "Request OAuth2 Access Token Provider",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "Request OAuth2 Access Token Provider",
                "sensitive" : false
              },
              "Socket Idle Timeout" : {
                "displayName" : "Socket Idle Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Socket Idle Timeout",
                "sensitive" : false
              },
              "Response Redirects Enabled" : {
                "displayName" : "Response Redirects Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Redirects Enabled",
                "sensitive" : false
              },
              "Socket Write Timeout" : {
                "displayName" : "Socket Write Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Socket Write Timeout",
                "sensitive" : false
              },
              "Request Header Attributes Pattern" : {
                "displayName" : "Request Header Attributes Pattern",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Header Attributes Pattern",
                "sensitive" : false
              },
              "Response FlowFile Naming Strategy" : {
                "displayName" : "Response FlowFile Naming Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response FlowFile Naming Strategy",
                "sensitive" : false
              },
              "Response Cache Enabled" : {
                "displayName" : "Response Cache Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Cache Enabled",
                "sensitive" : false
              },
              "Request Date Header Enabled" : {
                "displayName" : "Request Date Header Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Date Header Enabled",
                "sensitive" : false
              },
              "Request Failure Penalization Enabled" : {
                "displayName" : "Request Failure Penalization Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Failure Penalization Enabled",
                "sensitive" : false
              },
              "Response Body Attribute Size" : {
                "displayName" : "Response Body Attribute Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Body Attribute Size",
                "sensitive" : false
              },
              "SSL Context Service" : {
                "displayName" : "SSL Context Service",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "SSL Context Service",
                "sensitive" : false
              },
              "Response Generation Required" : {
                "displayName" : "Response Generation Required",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Generation Required",
                "sensitive" : false
              },
              "Request User-Agent" : {
                "displayName" : "Request User-Agent",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request User-Agent",
                "sensitive" : false
              },
              "Response Header Request Attributes Enabled" : {
                "displayName" : "Response Header Request Attributes Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Header Request Attributes Enabled",
                "sensitive" : false
              },
              "HTTP Method" : {
                "displayName" : "HTTP Method",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "HTTP Method",
                "sensitive" : false
              },
              "Request Username" : {
                "displayName" : "Request Username",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Username",
                "sensitive" : false
              },
              "Request Content-Type" : {
                "displayName" : "Request Content-Type",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Content-Type",
                "sensitive" : false
              },
              "Response Body Attribute Name" : {
                "displayName" : "Response Body Attribute Name",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Body Attribute Name",
                "sensitive" : false
              },
              "Request Digest Authentication Enabled" : {
                "displayName" : "Request Digest Authentication Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Digest Authentication Enabled",
                "sensitive" : false
              },
              "Request Multipart Form-Data Name" : {
                "displayName" : "Request Multipart Form-Data Name",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Multipart Form-Data Name",
                "sensitive" : false
              },
              "Response Cache Size" : {
                "displayName" : "Response Cache Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Cache Size",
                "sensitive" : false
              },
              "Response Body Ignored" : {
                "displayName" : "Response Body Ignored",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Body Ignored",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "unmatched" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "030716b5-3225-30fe-9862-6c28b2a103ed",
            "identifier" : "d69b6ba2-0b35-3310-a95c-ced6c73ba9d6",
            "maxBackoffPeriod" : "10 mins",
            "name" : "RouteOnAttribute",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : -184.0,
              "y" : -288.0
            },
            "properties" : {
              "Routing Strategy" : "Route to Property name",
              "send" : "${telegram.enabled:equals('true')}"
            },
            "propertyDescriptors" : {
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              },
              "send" : {
                "displayName" : "send",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "send",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          } ],
          "remoteProcessGroups" : [ ],
          "scheduledState" : "ENABLED",
          "statelessFlowTimeout" : "1 min"
        } ],
        "processors" : [ {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
          "identifier" : "56e10efe-006a-37b1-b642-524fb371ae5f",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LuuFile",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 944.0,
            "y" : -232.0
          },
          "properties" : {
            "Create Missing Directories" : "true",
            "Directory" : "${stateBc.path}",
            "Conflict Resolution Strategy" : "replace"
          },
          "propertyDescriptors" : {
            "Group" : {
              "displayName" : "Group",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Group",
              "sensitive" : false
            },
            "Owner" : {
              "displayName" : "Owner",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Owner",
              "sensitive" : false
            },
            "Create Missing Directories" : {
              "displayName" : "Create Missing Directories",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Create Missing Directories",
              "sensitive" : false
            },
            "Permissions" : {
              "displayName" : "Permissions",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Permissions",
              "sensitive" : false
            },
            "Maximum File Count" : {
              "displayName" : "Maximum File Count",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum File Count",
              "sensitive" : false
            },
            "Last Modified Time" : {
              "displayName" : "Last Modified Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Last Modified Time",
              "sensitive" : false
            },
            "Directory" : {
              "displayName" : "Directory",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory",
              "sensitive" : false
            },
            "Conflict Resolution Strategy" : {
              "displayName" : "Conflict Resolution Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Conflict Resolution Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.PutFile",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "success" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
          "identifier" : "b66f0f8a-8e9a-3dde-9081-813a9f8e1de1",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LogMessage",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 616.0,
            "y" : 64.0
          },
          "properties" : {
            "log-level" : "info"
          },
          "propertyDescriptors" : {
            "log-message" : {
              "displayName" : "Log message",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-message",
              "sensitive" : false
            },
            "log-level" : {
              "displayName" : "Log Level",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-level",
              "sensitive" : false
            },
            "log-prefix" : {
              "displayName" : "Log prefix",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-prefix",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ "success" ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.LogMessage",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
          "identifier" : "6ceb0e0e-bc04-32bc-bfd5-f79f7c852f81",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CapNhatToContent",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 424.0,
            "y" : -232.0
          },
          "properties" : {
            "Regular Expression" : "(?s)(^.*$)",
            "Replacement Value" : "{\n  \"name\": \"${stateBc.name}\",\n  \"isActive\": ${stateBc.isActive},\n  \"lastExecutionTime\": \"${stateBc.lastExecutionTime}\",\n  \"startTime\": \"${stateBc.startTime}\",\n  \"endTime\": \"${stateBc.endTime}\",\n  \"status\": \"${stateBc.status}\",\n  \"sequenceNumber\": \"${stateBc.sequenceNumber}\",\n  \"message\": \"${stateBc.message}\"\n}",
            "Evaluation Mode" : "Entire text",
            "Line-by-Line Evaluation Mode" : "All",
            "Character Set" : "UTF-8",
            "Maximum Buffer Size" : "1 MB",
            "Replacement Strategy" : "Always Replace"
          },
          "propertyDescriptors" : {
            "Regular Expression" : {
              "displayName" : "Search Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Regular Expression",
              "sensitive" : false
            },
            "Replacement Value" : {
              "displayName" : "Replacement Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Value",
              "sensitive" : false
            },
            "Evaluation Mode" : {
              "displayName" : "Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Evaluation Mode",
              "sensitive" : false
            },
            "Text to Prepend" : {
              "displayName" : "Text to Prepend",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Prepend",
              "sensitive" : false
            },
            "Line-by-Line Evaluation Mode" : {
              "displayName" : "Line-by-Line Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Line-by-Line Evaluation Mode",
              "sensitive" : false
            },
            "Character Set" : {
              "displayName" : "Character Set",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Character Set",
              "sensitive" : false
            },
            "Maximum Buffer Size" : {
              "displayName" : "Maximum Buffer Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum Buffer Size",
              "sensitive" : false
            },
            "Replacement Strategy" : {
              "displayName" : "Replacement Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Strategy",
              "sensitive" : false
            },
            "Text to Append" : {
              "displayName" : "Text to Append",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Append",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ReplaceText",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4b5c8c4b-9247-37d9-8feb-c94eacbf6955",
          "identifier" : "1c62247e-ef09-3a94-84a6-d63477232249",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ChuanHoa",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 16.0,
            "y" : -224.0
          },
          "properties" : {
            "state.message" : "Ly trng thi Bc ${stateBc.name} li",
            "filename" : "${stateBc.filename}",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100",
            "stateBc.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}",
            "stateBc.isActive" : "false",
            "stateBc.message" : "Ly trng thi Bc ${stateBc.name} li",
            "stateBc.status" : "3"
          },
          "propertyDescriptors" : {
            "state.message" : {
              "displayName" : "state.message",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.message",
              "sensitive" : false
            },
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "filename" : {
              "displayName" : "filename",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "filename",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "stateBc.lastExecutionTime" : {
              "displayName" : "stateBc.lastExecutionTime",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateBc.lastExecutionTime",
              "sensitive" : false
            },
            "stateBc.isActive" : {
              "displayName" : "stateBc.isActive",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateBc.isActive",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            },
            "stateBc.message" : {
              "displayName" : "stateBc.message",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateBc.message",
              "sensitive" : false
            },
            "stateBc.status" : {
              "displayName" : "stateBc.status",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateBc.status",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        } ],
        "remoteProcessGroups" : [ ],
        "scheduledState" : "ENABLED",
        "statelessFlowTimeout" : "1 min"
      } ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
        "identifier" : "28fc2551-3e68-31e6-964b-928bd9bfbc60",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KhoiTaoBc",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : -98.10848017609499,
          "y" : -206.47323369608057
        },
        "properties" : {
          "stateBc.path" : "#{TempPath}${Path.Separator}${state.name}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateBc.name" : "${stateBc.id}",
          "stateBc.filename" : "state_${stateBc.id}.json"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "stateBc.path" : {
            "displayName" : "stateBc.path",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateBc.path",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateBc.name" : {
            "displayName" : "stateBc.name",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateBc.name",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "stateBc.filename" : {
            "displayName" : "stateBc.filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateBc.filename",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-scripting-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "83bee318-51dc-3b23-8839-4e3bcfd396b9",
        "identifier" : "94566d1e-6dd9-31f0-bbec-9ecacddf3290",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LayTrangThai",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : -208.0
        },
        "properties" : {
          "Script Engine" : "Groovy",
          "Script Body" : "// Ly trng thi ca BC hin ti\nimport groovy.json.JsonSlurper\nimport groovy.json.JsonBuilder\nimport java.nio.file.*\nimport java.time.Instant\nimport java.time.ZoneOffset\nimport java.time.format.DateTimeFormatter\nimport java.time.LocalDateTime\nimport java.time.LocalDate\nimport org.apache.nifi.processor.io.OutputStreamCallback\n\ndef flowFile = session.get()\nif (!flowFile) return\n\n// --- Helpers ---\nboolean isIntSafe(def v) {\n    if (v == null) return false\n    try { Integer.parseInt(v.toString()); return true } catch (ignored) { return false }\n}\n\n// Ly parameters t attributes (stateBc.*)\ndef etlName   = flowFile.getAttribute('stateBc.name')\ndef statePath = flowFile.getAttribute('stateBc.path')\ndef filename  = flowFile.getAttribute('stateBc.filename')\n\nif (!etlName || !statePath || !filename) {\n    log.error(\"Missing required attributes: stateBc.name, stateBc.path, or stateBc.filename\")\n    flowFile = session.putAttribute(flowFile, 'error.message', 'Missing stateBc.name, stateBc.path, or stateBc.filename attributes')\n    session.transfer(flowFile, REL_FAILURE)\n    return\n}\n\n// To ng dn y \ndef stateFilePath = Paths.get(statePath, filename).toString()\n\ntry {\n    def stateContent = \"\"\n    def stateExists = false\n\n    // Thi gian UTC & mc nh\n    def formatter = DateTimeFormatter.ofPattern(\"yyyy/MM/dd HH:mm:ss\")\n    def currentTimeUTC = Instant.now().atZone(ZoneOffset.UTC).format(formatter)\n    def defaultStartTime = \"2025/01/01 00:00:00\"\n\n    // State mc nh\n    def defaultState = [\n        name: etlName,\n        isActive: false,\n        lastExecutionTime: currentTimeUTC,\n        startTime: defaultStartTime,\n        endTime: currentTimeUTC,\n        sequenceNumber: 1, // ln chy u tin\n        status: 0,         // 0: khi to\n        message: \"\"        // trng\n    ]\n\n    // c file nu c\n    def path = Paths.get(stateFilePath)\n    if (Files.exists(path)) {\n        stateContent = new String(Files.readAllBytes(path), \"UTF-8\")\n        stateExists = true\n        log.info(\"stateBc file found for ETL '${etlName}' at '${stateFilePath}': ${stateContent}\")\n    } else {\n        stateContent = new JsonBuilder(defaultState).toString()\n        stateExists = false\n        log.info(\"stateBc file not found for ETL '${etlName}' at '${stateFilePath}', creating default content\")\n    }\n\n    // Parse JSON (fallback default nu li)\n    def jsonSlurper = new JsonSlurper()\n    Map state\n    try {\n        state = (Map) jsonSlurper.parseText(stateContent)\n    } catch (Throwable ex) {\n        log.warn(\"Invalid stateBc content, fallback to default. Error: ${ex.message}\")\n        state = new LinkedHashMap(defaultState)\n        stateExists = false\n    }\n\n    // Chun ho trng\n    state.name = etlName\n    state.isActive = (state.containsKey('isActive') && state.isActive != null) ? state.isActive as Boolean : false\n    state.lastExecutionTime = (state.lastExecutionTime ?: currentTimeUTC)\n    state.startTime = (state.startTime ?: defaultStartTime)\n    state.endTime = (state.endTime ?: currentTimeUTC)\n\n    // Gi tr hin hu  dng cho logic ca s mi\n    def oldEndTime = (state.endTime && state.endTime.toString().trim()) ? state.endTime.toString() : defaultStartTime\n\n    // sequenceNumber / status / message\n    Integer seq = 1\n    if (state.containsKey('sequenceNumber') && isIntSafe(state.sequenceNumber)) {\n        seq = (state.sequenceNumber as Integer)\n        if (seq <= 0) seq = 1\n    }\n    Integer prevStatus = 0\n    if (state.containsKey('status') && isIntSafe(state.status)) {\n        prevStatus = (state.status as Integer)\n    }\n    String msg = (state.containsKey('message') && state.message != null) ? (state.message as String) : \"\"\n\n    // --- LOGIC MI: to ca s ETL mi nu status = 0 hoc 2 ---\n    // Gii thch:\n    //  - 0 (khi to) hoc 2 (hon thnh) => ln ETL trc  kt thc bnh thng.\n    //  - startTime = endTime (c) vi gi pht giy 00:00:00 ; endTime = currentTimeUTC ; lastExecutionTime = endTime (c)\n    boolean shouldCreateNewWindow = stateExists && (prevStatus == 0 || prevStatus == 2)\n    if (shouldCreateNewWindow) {\n        // Parse oldEndTime v t li gi pht giy thnh 00:00:00\n        def newStartTime = oldEndTime\n        try {\n            def oldEndTimeParsed = LocalDateTime.parse(oldEndTime, formatter)\n            def dateOnly = oldEndTimeParsed.toLocalDate()\n            def startOfDay = dateOnly.atStartOfDay()\n            newStartTime = startOfDay.format(formatter)\n            log.info(\"stateBc: Parsed oldEndTime '${oldEndTime}' to start of day: '${newStartTime}'\")\n        } catch (Exception ex) {\n            log.warn(\"stateBc: Could not parse oldEndTime '${oldEndTime}', using as-is. Error: ${ex.message}\")\n            newStartTime = oldEndTime\n        }\n        \n        state.startTime = newStartTime\n        state.endTime = currentTimeUTC\n        log.info(\"stateBc: Create new ETL window: startTime=${state.startTime} (reset to 00:00:00), endTime=${state.endTime}, lastExecutionTime=${state.lastExecutionTime}\")\n    }\n\n    // Logic khi c t file c sn:\n    // - t status = 0\n    // - nu status c == 2 => tng sequenceNumber\n    // - message = \"\"\n    if (stateExists) {\n        if (prevStatus == 2) {\n            seq = seq + 1\n            log.info(\"stateBc: Previous status=2 (completed). Increase sequenceNumber to ${seq}\")\n        }\n        prevStatus = 0\n        msg = \"\"\n    } else {\n        // state mi\n        prevStatus = 0\n        msg = \"\"\n        seq = 1\n    }\n\n    // Gn li vo state\n    state.sequenceNumber = seq\n    state.status = prevStatus\n    state.message = msg\n\n    // Ghi attributes ra flowfile (prefix stateBc.*)\n    flowFile = session.putAttribute(flowFile, 'stateBc.exists', stateExists.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.name', state.name.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.isActive', state.isActive.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.lastExecutionTime', state.lastExecutionTime.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.startTime', state.startTime.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.endTime', state.endTime.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.sequenceNumber', state.sequenceNumber.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.status', state.status.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.message', state.message.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.fullPath', stateFilePath)\n\n    // JSON content chun ho\n    def stateContentForFlowFile = [\n        name: state.name,\n        isActive: state.isActive,\n        lastExecutionTime: state.lastExecutionTime,\n        startTime: state.startTime,\n        endTime: state.endTime,\n        sequenceNumber: state.sequenceNumber,\n        status: state.status,\n        message: state.message\n    ]\n\n    // Ghi JSON stateBc vo flowFile content\n    def contentJson = new JsonBuilder(stateContentForFlowFile).toString()\n    flowFile = session.write(flowFile, { outputStream ->\n        outputStream.write(contentJson.getBytes(\"UTF-8\"))\n    } as OutputStreamCallback)\n\n    // Lu li JSON vo attribute\n    flowFile = session.putAttribute(flowFile, 'stateBc.content', contentJson)\n\n    session.transfer(flowFile, REL_SUCCESS)\n\n} catch (Exception e) {\n    log.error(\"Error reading stateBc file for ETL '${etlName}' at '${stateFilePath}': ${e.message}\", e)\n    flowFile = session.putAttribute(flowFile, 'error.message', e.getMessage())\n    session.transfer(flowFile, REL_FAILURE)\n}"
        },
        "propertyDescriptors" : {
          "Script File" : {
            "displayName" : "Script File",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script File",
            "resourceDefinition" : {
              "cardinality" : "SINGLE",
              "resourceTypes" : [ "FILE" ]
            },
            "sensitive" : false
          },
          "Script Engine" : {
            "displayName" : "Script Engine",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script Engine",
            "sensitive" : false
          },
          "Script Body" : {
            "displayName" : "Script Body",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script Body",
            "sensitive" : false
          },
          "Module Directory" : {
            "displayName" : "Module Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Module Directory",
            "resourceDefinition" : {
              "cardinality" : "MULTIPLE",
              "resourceTypes" : [ "FILE", "DIRECTORY" ]
            },
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.script.ExecuteScript",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "21d040b8-f905-3679-8117-a0f8c6a005d2",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "d986801b-bf69-380b-b53a-2cf144690f63",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "749e8720-81cc-3024-8f59-52c95f571c61",
          "name" : "Data to JSON",
          "type" : "PROCESSOR"
        },
        "zIndex" : 6
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "21d040b8-f905-3679-8117-a0f8c6a005d2",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "8c1eb234-a08c-30b1-a6f5-a1ce881259de",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "unmatched" ],
        "source" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "7b07b9bd-a6c6-3fa1-ab0d-a534c990da37",
          "name" : "CheckHasData",
          "type" : "PROCESSOR"
        },
        "zIndex" : 16
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "21d040b8-f905-3679-8117-a0f8c6a005d2",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "dd129465-a0a7-37fd-a809-97ee6bfa3554",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "dc3d58b2-a65b-3828-9e50-848affbc76e9",
          "name" : "LayDsCam",
          "type" : "PROCESSOR"
        },
        "zIndex" : 4
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "21d040b8-f905-3679-8117-a0f8c6a005d2",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "048b6ec4-8642-3e25-a220-3187e73f8fa7",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "01047733-c45c-3884-bc1f-a35d53d136df",
          "name" : "PutFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 8
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "dc3d58b2-a65b-3828-9e50-848affbc76e9",
          "name" : "LayDsCam",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "5f80c97c-3a5c-3fc1-8afc-17eb3819cfca",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "8fcde0cc-be3f-34c5-b145-05adb7d5f810",
          "name" : "KhoiTaoLayDanhSach",
          "type" : "PROCESSOR"
        },
        "zIndex" : 2
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "749e8720-81cc-3024-8f59-52c95f571c61",
          "name" : "Data to JSON",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "be47f852-7439-364d-8930-2bdd5d77048c",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "dc3d58b2-a65b-3828-9e50-848affbc76e9",
          "name" : "LayDsCam",
          "type" : "PROCESSOR"
        },
        "zIndex" : 3
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "21d040b8-f905-3679-8117-a0f8c6a005d2",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "28b57806-d919-333a-bd17-f460c84e3b7a",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "15f38e0b-9309-3491-a998-a374cf7be9ac",
          "name" : "MapNoiDungLenAttribute",
          "type" : "PROCESSOR"
        },
        "zIndex" : 12
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "23b88d76-3d62-306b-84ef-b795a23ddc7d",
          "name" : "ChuanHoaIdsQuerySql",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "839cb7a9-280b-3875-a498-ef315ed9fafc",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "01047733-c45c-3884-bc1f-a35d53d136df",
          "name" : "PutFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 9
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "01047733-c45c-3884-bc1f-a35d53d136df",
          "name" : "PutFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "91d1b14b-c4e4-36cf-b17d-efecd1893ba2",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "hasCams" ],
        "source" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "7b07b9bd-a6c6-3fa1-ab0d-a534c990da37",
          "name" : "CheckHasData",
          "type" : "PROCESSOR"
        },
        "zIndex" : 17
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "15f38e0b-9309-3491-a998-a374cf7be9ac",
          "name" : "MapNoiDungLenAttribute",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "cab27304-97c3-34ed-b071-628aeebe2922",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "749e8720-81cc-3024-8f59-52c95f571c61",
          "name" : "Data to JSON",
          "type" : "PROCESSOR"
        },
        "zIndex" : 15
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "7b07b9bd-a6c6-3fa1-ab0d-a534c990da37",
          "name" : "CheckHasData",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "bfb5c695-02ac-3e69-9f91-d22d93c89ae5",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "matched", "unmatched" ],
        "source" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "15f38e0b-9309-3491-a998-a374cf7be9ac",
          "name" : "MapNoiDungLenAttribute",
          "type" : "PROCESSOR"
        },
        "zIndex" : 14
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "8fcde0cc-be3f-34c5-b145-05adb7d5f810",
          "name" : "KhoiTaoLayDanhSach",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "6c12f5c3-aa33-3280-bcf8-27df0c094588",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "68ccbe35-520c-3b45-bc1f-07907ab33cb5",
          "name" : "stateAdAccounts",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 10
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "80573ecd-9d95-3907-ab77-59fd2796370a",
          "name" : "stateCams",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "38e0ed6e-a908-3ff9-8ddf-a40c4cc014d6",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
          "id" : "23b88d76-3d62-306b-84ef-b795a23ddc7d",
          "name" : "ChuanHoaIdsQuerySql",
          "type" : "PROCESSOR"
        },
        "zIndex" : 13
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "68ccbe35-520c-3b45-bc1f-07907ab33cb5",
        "name" : "stateAdAccounts",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -608.0,
          "y" : -56.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LayDsCamTheoDsTaiKhoanAd",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "80573ecd-9d95-3907-ab77-59fd2796370a",
        "name" : "stateCams",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 2496.0,
          "y" : 480.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "TikTokETL",
      "position" : {
        "x" : -200.0,
        "y" : 3448.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "dc3d58b2-a65b-3828-9e50-848affbc76e9",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LayDsCam",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 376.0,
          "y" : -104.0
        },
        "properties" : {
          "esql-max-rows" : "0",
          "dbf-default-precision" : "10",
          "Max Wait Time" : "0 seconds",
          "SQL Query" : "SELECT [Id]\n      ,[CampaignId]\n      ,[AdvertiserId]\n      ,[CampaignName]\n      ,[ObjectiveType]\n      ,[CampaignType]\n      ,[BudgetMode]\n      ,[Budget]\n      ,[OperationStatus]\n      ,[CreateTime]\n      ,[ModifyTime]\n      ,[IsCurrent]\n      ,[EffectiveDate]\n      ,[ExpirationDate]\n      ,[RowVersion]\n      ,[CreationTime]\n      ,[CreatorId]\n      ,[LastModificationTime]\n      ,[LastModifierId]\n  FROM Dim_DimCampaigns\n  WHERE AdvertiserId IN ${stateAdAccounts.advertiserIds.inClause}",
          "Database Connection Pooling Service" : "6fce9190-8f74-3a75-9e56-36c3f8fc6d63",
          "esql-auto-commit" : "true",
          "dbf-user-logical-types" : "false",
          "dbf-default-scale" : "0",
          "compression-format" : "NONE",
          "esql-output-batch-size" : "0",
          "esql-fetch-size" : "0",
          "dbf-normalize" : "false",
          "Content Output Strategy" : "EMPTY"
        },
        "propertyDescriptors" : {
          "esql-max-rows" : {
            "displayName" : "Max Rows Per Flow File",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-max-rows",
            "sensitive" : false
          },
          "dbf-default-precision" : {
            "displayName" : "Default Decimal Precision",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-default-precision",
            "sensitive" : false
          },
          "Max Wait Time" : {
            "displayName" : "Max Wait Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Max Wait Time",
            "sensitive" : false
          },
          "SQL Query" : {
            "displayName" : "SQL Query",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "SQL Query",
            "sensitive" : false
          },
          "Database Connection Pooling Service" : {
            "displayName" : "Database Connection Pooling Service",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Database Connection Pooling Service",
            "sensitive" : false
          },
          "sql-post-query" : {
            "displayName" : "SQL Post-Query",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "sql-post-query",
            "sensitive" : false
          },
          "esql-auto-commit" : {
            "displayName" : "Set Auto Commit",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-auto-commit",
            "sensitive" : false
          },
          "dbf-user-logical-types" : {
            "displayName" : "Use Avro Logical Types",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-user-logical-types",
            "sensitive" : false
          },
          "dbf-default-scale" : {
            "displayName" : "Default Decimal Scale",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-default-scale",
            "sensitive" : false
          },
          "sql-pre-query" : {
            "displayName" : "SQL Pre-Query",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "sql-pre-query",
            "sensitive" : false
          },
          "compression-format" : {
            "displayName" : "Compression Format",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "compression-format",
            "sensitive" : false
          },
          "esql-output-batch-size" : {
            "displayName" : "Output Batch Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-output-batch-size",
            "sensitive" : false
          },
          "esql-fetch-size" : {
            "displayName" : "Fetch Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-fetch-size",
            "sensitive" : false
          },
          "dbf-normalize" : {
            "displayName" : "Normalize Table/Column Names",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-normalize",
            "sensitive" : false
          },
          "Content Output Strategy" : {
            "displayName" : "Content Output Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Content Output Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "23b88d76-3d62-306b-84ef-b795a23ddc7d",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoaIdsQuerySql",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 2432.0,
          "y" : 280.0
        },
        "properties" : {
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateCams.campaignIds.inClause" : "${stateCams.campaignIds\n  :replaceAll('^\\\\[|\\\\]$', '')\n  :replaceAll('\"', '\\'')\n  :prepend('(')\n  :append(')')}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "stateCams.campaignIds.inClause" : {
            "displayName" : "stateCams.campaignIds.inClause",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateCams.campaignIds.inClause",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "749e8720-81cc-3024-8f59-52c95f571c61",
        "maxBackoffPeriod" : "10 mins",
        "name" : "Data to JSON",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 864.0,
          "y" : -112.0
        },
        "properties" : {
          "Include Zero Record FlowFiles" : "true",
          "Record Writer" : "877d4cf8-3ef9-3d3c-965f-0f85798a2a2f",
          "Record Reader" : "40a44711-6955-3e69-b463-371590dfa3ed"
        },
        "propertyDescriptors" : {
          "Include Zero Record FlowFiles" : {
            "displayName" : "Include Zero Record FlowFiles",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Include Zero Record FlowFiles",
            "sensitive" : false
          },
          "Record Writer" : {
            "displayName" : "Record Writer",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Record Writer",
            "sensitive" : false
          },
          "Record Reader" : {
            "displayName" : "Record Reader",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Record Reader",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ConvertRecord",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "8fcde0cc-be3f-34c5-b145-05adb7d5f810",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KhoiTaoLayDanhSach",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : -128.0,
          "y" : -112.0
        },
        "properties" : {
          "stateCams.name" : "state_${stateBc.id}_cams",
          "filename" : "state_${stateBc.id}_cams.json",
          "stateCams.fullpath" : "#{TempPath}${Path.Separator}${state.name}${Path.Separator}state_${stateBc.id}_cams.json",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateCams.path" : "#{TempPath}${Path.Separator}${state.name}",
          "stateCams.filename" : "state_${stateBc.id}_cams.json"
        },
        "propertyDescriptors" : {
          "stateCams.name" : {
            "displayName" : "stateCams.name",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateCams.name",
            "sensitive" : false
          },
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "stateCams.fullpath" : {
            "displayName" : "stateCams.fullpath",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateCams.fullpath",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateCams.path" : {
            "displayName" : "stateCams.path",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateCams.path",
            "sensitive" : false
          },
          "stateCams.filename" : {
            "displayName" : "stateCams.filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateCams.filename",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "21d040b8-f905-3679-8117-a0f8c6a005d2",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 1192.0,
          "y" : 400.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "15f38e0b-9309-3491-a998-a374cf7be9ac",
        "maxBackoffPeriod" : "10 mins",
        "name" : "MapNoiDungLenAttribute",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 1344.0,
          "y" : -112.0
        },
        "properties" : {
          "Destination" : "flowfile-attribute",
          "Max String Length" : "200 MB",
          "Return Type" : "json",
          "Null Value Representation" : "empty string",
          "stateCams.campaignIds" : "$[*].CampaignId",
          "Path Not Found Behavior" : "ignore"
        },
        "propertyDescriptors" : {
          "Destination" : {
            "displayName" : "Destination",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Destination",
            "sensitive" : false
          },
          "Max String Length" : {
            "displayName" : "Max String Length",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Max String Length",
            "sensitive" : false
          },
          "Return Type" : {
            "displayName" : "Return Type",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Return Type",
            "sensitive" : false
          },
          "Null Value Representation" : {
            "displayName" : "Null Value Representation",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Null Value Representation",
            "sensitive" : false
          },
          "stateCams.campaignIds" : {
            "displayName" : "stateCams.campaignIds",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateCams.campaignIds",
            "sensitive" : false
          },
          "Path Not Found Behavior" : {
            "displayName" : "Path Not Found Behavior",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Path Not Found Behavior",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.EvaluateJsonPath",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "01047733-c45c-3884-bc1f-a35d53d136df",
        "maxBackoffPeriod" : "10 mins",
        "name" : "PutFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 2424.0,
          "y" : -8.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${stateCams.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9db9519f-70de-37aa-a88f-0d69ad0fce22",
        "identifier" : "7b07b9bd-a6c6-3fa1-ab0d-a534c990da37",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CheckHasData",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 1872.0,
          "y" : -112.0
        },
        "properties" : {
          "Routing Strategy" : "Route to Property name",
          "hasCams" : "${stateCams.campaignIds:trim():length():gt(2)}"
        },
        "propertyDescriptors" : {
          "Routing Strategy" : {
            "displayName" : "Routing Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Routing Strategy",
            "sensitive" : false
          },
          "hasCams" : {
            "displayName" : "hasCams",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "hasCams",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "34dce1ff-64be-3b05-94c2-3fbc5058eca3",
          "name" : "ChuanHoaIdsQuerySql",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "129e5356-6fa0-3a88-84cb-f2924ca2bfc0",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "85fddaec-c27d-3466-8fa4-3a02ddd4cd1d",
          "name" : "PutFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 13
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "51ead29f-3f70-33b3-8608-670632d0262a",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "56ad24ca-05a8-3671-b7b0-4df5763eb720",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "a378e86c-bd54-3aeb-821e-3501ea3bb712",
          "name" : "GetDimAdAccount",
          "type" : "PROCESSOR"
        },
        "zIndex" : 4
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "f38034df-965c-35b9-9535-acddbfb12f3c",
          "name" : "KhoiTaoLayDanhSach",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "094f2946-9c21-335e-91ca-581d9ce3f9bf",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "f4fbf07e-71ef-3afd-8362-81c93c937378",
          "name" : "stateBc",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 10
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "51ead29f-3f70-33b3-8608-670632d0262a",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "f2cb860a-b911-3ec4-bab4-374d0fd2438c",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "97421189-d4c6-336f-ba04-36333eb74ff4",
          "name" : "MapNoiDungLenAttribute",
          "type" : "PROCESSOR"
        },
        "zIndex" : 12
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "85fddaec-c27d-3466-8fa4-3a02ddd4cd1d",
          "name" : "PutFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "e573563d-19c7-3d10-b36f-6acf1993e26e",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "hasAdAccounts" ],
        "source" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "cc374424-2507-3c27-b9e1-3595e8fc4cac",
          "name" : "CheckHasData",
          "type" : "PROCESSOR"
        },
        "zIndex" : 19
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "51ead29f-3f70-33b3-8608-670632d0262a",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "0e4402ea-45ff-3eba-886c-28f120121c9a",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "85fddaec-c27d-3466-8fa4-3a02ddd4cd1d",
          "name" : "PutFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 8
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "97421189-d4c6-336f-ba04-36333eb74ff4",
          "name" : "MapNoiDungLenAttribute",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "827bb68b-7060-331d-ad14-c65f53ec790e",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "2fbb816c-a61d-3cec-b4bf-315f0559e68a",
          "name" : "Data to JSON",
          "type" : "PROCESSOR"
        },
        "zIndex" : 21
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "51ead29f-3f70-33b3-8608-670632d0262a",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "b83faf49-0fec-30fa-be6a-9df0c674884b",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "unmatched" ],
        "source" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "cc374424-2507-3c27-b9e1-3595e8fc4cac",
          "name" : "CheckHasData",
          "type" : "PROCESSOR"
        },
        "zIndex" : 17
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "51ead29f-3f70-33b3-8608-670632d0262a",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "aa41bb82-b9ed-37a3-b441-14c36a7f5ce3",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "2fbb816c-a61d-3cec-b4bf-315f0559e68a",
          "name" : "Data to JSON",
          "type" : "PROCESSOR"
        },
        "zIndex" : 22
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "cc374424-2507-3c27-b9e1-3595e8fc4cac",
          "name" : "CheckHasData",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "9ff4433d-49ac-381f-8664-00d536a63856",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "matched", "unmatched" ],
        "source" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "97421189-d4c6-336f-ba04-36333eb74ff4",
          "name" : "MapNoiDungLenAttribute",
          "type" : "PROCESSOR"
        },
        "zIndex" : 15
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "a378e86c-bd54-3aeb-821e-3501ea3bb712",
          "name" : "GetDimAdAccount",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "691c7ae2-cbff-3b36-ae61-027cfb700a46",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "f38034df-965c-35b9-9535-acddbfb12f3c",
          "name" : "KhoiTaoLayDanhSach",
          "type" : "PROCESSOR"
        },
        "zIndex" : 2
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "2fbb816c-a61d-3cec-b4bf-315f0559e68a",
          "name" : "Data to JSON",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "5f7e1d3a-a7b2-3def-8190-eaa90ff22e66",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "a378e86c-bd54-3aeb-821e-3501ea3bb712",
          "name" : "GetDimAdAccount",
          "type" : "PROCESSOR"
        },
        "zIndex" : 20
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "d1e693d3-7e6e-31c1-bff8-9b16617a8f29",
          "name" : "stateAdAccount",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "a13ab3de-539a-3104-b6a6-5934b0b2671b",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "08cdcf66-d919-3fdc-b722-a8852546c077",
          "id" : "34dce1ff-64be-3b05-94c2-3fbc5058eca3",
          "name" : "ChuanHoaIdsQuerySql",
          "type" : "PROCESSOR"
        },
        "zIndex" : 14
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "f4fbf07e-71ef-3afd-8362-81c93c937378",
        "name" : "stateBc",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -528.0,
          "y" : -72.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LayDanhSachTaiKhoanQuangCao",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "d1e693d3-7e6e-31c1-bff8-9b16617a8f29",
        "name" : "stateAdAccount",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 2448.0,
          "y" : 456.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -200.0,
        "y" : 3176.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "cc374424-2507-3c27-b9e1-3595e8fc4cac",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CheckHasData",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 1840.0,
          "y" : -104.0
        },
        "properties" : {
          "Routing Strategy" : "Route to Property name",
          "hasAdAccounts" : "${stateAdAccounts.advertiserIds:trim():length():gt(2)}"
        },
        "propertyDescriptors" : {
          "Routing Strategy" : {
            "displayName" : "Routing Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Routing Strategy",
            "sensitive" : false
          },
          "hasAdAccounts" : {
            "displayName" : "hasAdAccounts",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "hasAdAccounts",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "34dce1ff-64be-3b05-94c2-3fbc5058eca3",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoaIdsQuerySql",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 2400.0,
          "y" : 224.0
        },
        "properties" : {
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateAdAccounts.advertiserIds.inClause" : "${stateAdAccounts.advertiserIds\n  :replaceAll('^\\\\[|\\\\]$', '')\n  :replaceAll('\"', '\\'')\n  :prepend('(')\n  :append(')')}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateAdAccounts.advertiserIds.inClause" : {
            "displayName" : "stateAdAccounts.advertiserIds.inClause",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.advertiserIds.inClause",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "a378e86c-bd54-3aeb-821e-3501ea3bb712",
        "maxBackoffPeriod" : "10 mins",
        "name" : "GetDimAdAccount",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 384.0,
          "y" : -112.0
        },
        "properties" : {
          "esql-max-rows" : "0",
          "dbf-default-precision" : "10",
          "Max Wait Time" : "0 seconds",
          "SQL Query" : "SELECT [Id]\n      ,[AdvertiserId]\n      ,[AdvertiserName]\n      ,[Currency]\n      ,[Timezone]\n      ,[Country]\n      ,[Status]\n      ,[Company]\n      ,[OwnerBcId]\n      ,[IsActive]\n      ,[EffectiveDate]\n      ,[ExpiryDate]\n      ,[IsCurrent]\n      ,[RowVersion]\n      ,[CreationTime]\n      ,[CreatorId]\n      ,[LastModificationTime]\n      ,[LastModifierId]\n  FROM Dim_DimAdAccounts d where d.OwnerBcId = '${stateBc.id}' and IsCurrent = 1",
          "Database Connection Pooling Service" : "6fce9190-8f74-3a75-9e56-36c3f8fc6d63",
          "esql-auto-commit" : "true",
          "dbf-user-logical-types" : "false",
          "dbf-default-scale" : "0",
          "compression-format" : "NONE",
          "esql-output-batch-size" : "0",
          "esql-fetch-size" : "0",
          "dbf-normalize" : "false",
          "Content Output Strategy" : "EMPTY"
        },
        "propertyDescriptors" : {
          "esql-max-rows" : {
            "displayName" : "Max Rows Per Flow File",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-max-rows",
            "sensitive" : false
          },
          "dbf-default-precision" : {
            "displayName" : "Default Decimal Precision",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-default-precision",
            "sensitive" : false
          },
          "Max Wait Time" : {
            "displayName" : "Max Wait Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Max Wait Time",
            "sensitive" : false
          },
          "SQL Query" : {
            "displayName" : "SQL Query",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "SQL Query",
            "sensitive" : false
          },
          "Database Connection Pooling Service" : {
            "displayName" : "Database Connection Pooling Service",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Database Connection Pooling Service",
            "sensitive" : false
          },
          "sql-post-query" : {
            "displayName" : "SQL Post-Query",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "sql-post-query",
            "sensitive" : false
          },
          "esql-auto-commit" : {
            "displayName" : "Set Auto Commit",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-auto-commit",
            "sensitive" : false
          },
          "dbf-user-logical-types" : {
            "displayName" : "Use Avro Logical Types",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-user-logical-types",
            "sensitive" : false
          },
          "dbf-default-scale" : {
            "displayName" : "Default Decimal Scale",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-default-scale",
            "sensitive" : false
          },
          "sql-pre-query" : {
            "displayName" : "SQL Pre-Query",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "sql-pre-query",
            "sensitive" : false
          },
          "compression-format" : {
            "displayName" : "Compression Format",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "compression-format",
            "sensitive" : false
          },
          "esql-output-batch-size" : {
            "displayName" : "Output Batch Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-output-batch-size",
            "sensitive" : false
          },
          "esql-fetch-size" : {
            "displayName" : "Fetch Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-fetch-size",
            "sensitive" : false
          },
          "dbf-normalize" : {
            "displayName" : "Normalize Table/Column Names",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-normalize",
            "sensitive" : false
          },
          "Content Output Strategy" : {
            "displayName" : "Content Output Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Content Output Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "97421189-d4c6-336f-ba04-36333eb74ff4",
        "maxBackoffPeriod" : "10 mins",
        "name" : "MapNoiDungLenAttribute",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 1304.0,
          "y" : -104.0
        },
        "properties" : {
          "Destination" : "flowfile-attribute",
          "Max String Length" : "200 MB",
          "Return Type" : "json",
          "stateAdAccounts.advertiserIds" : "$[*].AdvertiserId",
          "Null Value Representation" : "empty string",
          "Path Not Found Behavior" : "ignore"
        },
        "propertyDescriptors" : {
          "Destination" : {
            "displayName" : "Destination",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Destination",
            "sensitive" : false
          },
          "Max String Length" : {
            "displayName" : "Max String Length",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Max String Length",
            "sensitive" : false
          },
          "Return Type" : {
            "displayName" : "Return Type",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Return Type",
            "sensitive" : false
          },
          "stateAdAccounts.advertiserIds" : {
            "displayName" : "stateAdAccounts.advertiserIds",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.advertiserIds",
            "sensitive" : false
          },
          "Null Value Representation" : {
            "displayName" : "Null Value Representation",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Null Value Representation",
            "sensitive" : false
          },
          "Path Not Found Behavior" : {
            "displayName" : "Path Not Found Behavior",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Path Not Found Behavior",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.EvaluateJsonPath",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "f38034df-965c-35b9-9535-acddbfb12f3c",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KhoiTaoLayDanhSach",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : -128.0,
          "y" : -112.0
        },
        "properties" : {
          "filename" : "state_${stateBc.id}_addAccount.json",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateAdAccounts.path" : "#{TempPath}${Path.Separator}${state.name}",
          "stateAdAccounts.fullpath" : "#{TempPath}${Path.Separator}${state.name}${Path.Separator}state_${stateBc.id}_addAccount.json",
          "stateAdAccounts.filename" : "state_${stateBc.id}_addAccount.json",
          "stateAdAccounts.name" : "state_${stateBc.id}_addAccount"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateAdAccounts.path" : {
            "displayName" : "stateAdAccounts.path",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.path",
            "sensitive" : false
          },
          "stateAdAccounts.fullpath" : {
            "displayName" : "stateAdAccounts.fullpath",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.fullpath",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "stateAdAccounts.filename" : {
            "displayName" : "stateAdAccounts.filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.filename",
            "sensitive" : false
          },
          "stateAdAccounts.name" : {
            "displayName" : "stateAdAccounts.name",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.name",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "85fddaec-c27d-3466-8fa4-3a02ddd4cd1d",
        "maxBackoffPeriod" : "10 mins",
        "name" : "PutFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 2408.0,
          "y" : -8.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${stateAdAccounts.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "2fbb816c-a61d-3cec-b4bf-315f0559e68a",
        "maxBackoffPeriod" : "10 mins",
        "name" : "Data to JSON",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 848.0,
          "y" : -104.0
        },
        "properties" : {
          "Include Zero Record FlowFiles" : "true",
          "Record Writer" : "877d4cf8-3ef9-3d3c-965f-0f85798a2a2f",
          "Record Reader" : "40a44711-6955-3e69-b463-371590dfa3ed"
        },
        "propertyDescriptors" : {
          "Include Zero Record FlowFiles" : {
            "displayName" : "Include Zero Record FlowFiles",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Include Zero Record FlowFiles",
            "sensitive" : false
          },
          "Record Writer" : {
            "displayName" : "Record Writer",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Record Writer",
            "sensitive" : false
          },
          "Record Reader" : {
            "displayName" : "Record Reader",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Record Reader",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ConvertRecord",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "08cdcf66-d919-3fdc-b722-a8852546c077",
        "identifier" : "51ead29f-3f70-33b3-8608-670632d0262a",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 1144.0,
          "y" : 392.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "b6706b10-3c15-352e-898d-dabd3112924a",
          "id" : "add339f6-8d10-38fd-b4f5-8702ed779a97",
          "name" : "stateOut",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "b6706b10-3c15-352e-898d-dabd3112924a",
        "identifier" : "43b04656-c6bf-3181-bdbe-b74800db5bac",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "b6706b10-3c15-352e-898d-dabd3112924a",
          "id" : "c0e26efe-1cb7-3e7f-b3b1-f95c8ad5884c",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "b6706b10-3c15-352e-898d-dabd3112924a",
          "id" : "612c0fd0-769b-33cd-be46-5d942c579d26",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "b6706b10-3c15-352e-898d-dabd3112924a",
        "identifier" : "2db6fce2-d156-3c2f-98fe-f8f82bbfa5da",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "b6706b10-3c15-352e-898d-dabd3112924a",
          "id" : "c0e26efe-1cb7-3e7f-b3b1-f95c8ad5884c",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "b6706b10-3c15-352e-898d-dabd3112924a",
          "id" : "972dc870-5394-385b-b09d-19838e60c59a",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "b6706b10-3c15-352e-898d-dabd3112924a",
        "identifier" : "5c416009-3e48-34bb-ba51-7b0c725e5a52",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "b6706b10-3c15-352e-898d-dabd3112924a",
          "id" : "8f965f78-7fec-357c-9a46-cf99d813a961",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "b6706b10-3c15-352e-898d-dabd3112924a",
          "id" : "c0e26efe-1cb7-3e7f-b3b1-f95c8ad5884c",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "b6706b10-3c15-352e-898d-dabd3112924a",
        "identifier" : "884b46f1-dbf3-32db-9f66-fc6d213948bf",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "b6706b10-3c15-352e-898d-dabd3112924a",
          "id" : "972dc870-5394-385b-b09d-19838e60c59a",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "b6706b10-3c15-352e-898d-dabd3112924a",
          "id" : "612c0fd0-769b-33cd-be46-5d942c579d26",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "b6706b10-3c15-352e-898d-dabd3112924a",
        "identifier" : "c7731201-3ec8-3503-9847-f614a11a8689",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "b6706b10-3c15-352e-898d-dabd3112924a",
          "id" : "972dc870-5394-385b-b09d-19838e60c59a",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "b6706b10-3c15-352e-898d-dabd3112924a",
          "id" : "8f965f78-7fec-357c-9a46-cf99d813a961",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "b6706b10-3c15-352e-898d-dabd3112924a",
        "identifier" : "c6709fc6-c28e-35e4-a547-1d45c1606f75",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "b6706b10-3c15-352e-898d-dabd3112924a",
          "id" : "87ef39a4-9be3-31ca-bcb0-fd878c9dbc4f",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "b6706b10-3c15-352e-898d-dabd3112924a",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "b6706b10-3c15-352e-898d-dabd3112924a",
        "identifier" : "87ef39a4-9be3-31ca-bcb0-fd878c9dbc4f",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LuuTrangThaiETL",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "b6706b10-3c15-352e-898d-dabd3112924a",
        "identifier" : "add339f6-8d10-38fd-b4f5-8702ed779a97",
        "name" : "stateOut",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 1464.0,
          "y" : -200.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -200.0,
        "y" : 720.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "b6706b10-3c15-352e-898d-dabd3112924a",
        "identifier" : "972dc870-5394-385b-b09d-19838e60c59a",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${state.name}\",\n  \"isActive\": ${state.isActive},\n  \"lastExecutionTime\": \"${state.lastExecutionTime}\",\n  \"startTime\": \"${state.startTime}\",\n  \"endTime\": \"${state.endTime}\",\n  \"status\": \"${state.status}\",\n  \"sequenceNumber\": \"${state.sequenceNumber}\",\n  \"message\": \"${state.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "b6706b10-3c15-352e-898d-dabd3112924a",
        "identifier" : "c0e26efe-1cb7-3e7f-b3b1-f95c8ad5884c",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${state.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "b6706b10-3c15-352e-898d-dabd3112924a",
        "identifier" : "612c0fd0-769b-33cd-be46-5d942c579d26",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "b6706b10-3c15-352e-898d-dabd3112924a",
        "identifier" : "8f965f78-7fec-357c-9a46-cf99d813a961",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "filename" : "${state.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.lastExecutionTime" : {
            "displayName" : "state.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.lastExecutionTime",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "067d3c1b-d4f9-3f90-9ac3-85ea03c58215",
          "name" : "MapNoiDungLenAttribute",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "ecfbd90f-422e-3ede-8614-c4e184bae08d",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "f69600d2-4fdc-31b1-84eb-d54d2f0b2752",
          "name" : "Data to JSON",
          "type" : "PROCESSOR"
        },
        "zIndex" : 7
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
          "id" : "4356a58a-8f1c-3281-80c0-681178604210",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "b2eeecc8-b854-3413-9ec3-bebd10d57a8e",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "f69600d2-4fdc-31b1-84eb-d54d2f0b2752",
          "name" : "Data to JSON",
          "type" : "PROCESSOR"
        },
        "zIndex" : 16
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
          "id" : "4356a58a-8f1c-3281-80c0-681178604210",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "38fa8f65-7602-31a7-a569-525661bf1fe6",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "d7b07b6c-5ebe-3fd4-8211-28308a4de2dd",
          "name" : "PutFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 18
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
          "id" : "4356a58a-8f1c-3281-80c0-681178604210",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "f09a3cbb-9c2d-3526-b4a0-60c634824da5",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "067d3c1b-d4f9-3f90-9ac3-85ea03c58215",
          "name" : "MapNoiDungLenAttribute",
          "type" : "PROCESSOR"
        },
        "zIndex" : 17
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "14a94c7b-5181-3fa1-8121-8f751311b371",
          "name" : "stateStore",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "331039c1-7a99-30da-8bfa-318005312a3c",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "27df0513-10a6-349d-a980-ccb74762e387",
          "name" : "ChuanHoaIdsQuerySql",
          "type" : "PROCESSOR"
        },
        "zIndex" : 14
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "c47648ac-e1f4-3cec-8078-b7d45fbc2760",
          "name" : "GetDimStores",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "e99907f6-c1ef-31c0-889a-b7d54d7b8963",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "64d2ae21-d926-3556-87ad-7873ceb01762",
          "name" : "KhoiTaoLayDanhSach",
          "type" : "PROCESSOR"
        },
        "zIndex" : 2
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "d7b07b6c-5ebe-3fd4-8211-28308a4de2dd",
          "name" : "PutFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "053c045a-a4be-3c43-8a57-ab12a8c797f5",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "matched", "unmatched" ],
        "source" : {
          "comments" : "",
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "067d3c1b-d4f9-3f90-9ac3-85ea03c58215",
          "name" : "MapNoiDungLenAttribute",
          "type" : "PROCESSOR"
        },
        "zIndex" : 11
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "f69600d2-4fdc-31b1-84eb-d54d2f0b2752",
          "name" : "Data to JSON",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "c55bda55-852a-34e3-8d76-82a5d36cf41b",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "c47648ac-e1f4-3cec-8078-b7d45fbc2760",
          "name" : "GetDimStores",
          "type" : "PROCESSOR"
        },
        "zIndex" : 3
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "27df0513-10a6-349d-a980-ccb74762e387",
          "name" : "ChuanHoaIdsQuerySql",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "8cb7bcff-2110-3475-811a-c7b6a5021294",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "d7b07b6c-5ebe-3fd4-8211-28308a4de2dd",
          "name" : "PutFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 13
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "64d2ae21-d926-3556-87ad-7873ceb01762",
          "name" : "KhoiTaoLayDanhSach",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "94deccbb-eba7-3878-8600-8d552f4e4095",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "a9d9caaa-313d-3197-bad9-d377112f7fdf",
          "name" : "stateStatus",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 10
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
          "id" : "4356a58a-8f1c-3281-80c0-681178604210",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "47d9f4db-6460-3085-89f4-a62e720e26ae",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
          "groupId" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
          "id" : "c47648ac-e1f4-3cec-8078-b7d45fbc2760",
          "name" : "GetDimStores",
          "type" : "PROCESSOR"
        },
        "zIndex" : 15
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "a9d9caaa-313d-3197-bad9-d377112f7fdf",
        "name" : "stateStatus",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -528.0,
          "y" : -72.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LayDanhSachCuaHang",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "14a94c7b-5181-3fa1-8121-8f751311b371",
        "name" : "stateStore",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 2744.0,
          "y" : -120.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -200.0,
        "y" : 992.0
      },
      "processGroups" : [ {
        "comments" : "",
        "componentType" : "PROCESS_GROUP",
        "connections" : [ {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
            "id" : "8af0fb06-e786-3feb-bca4-506fe93d4bf9",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
          "identifier" : "be38f382-9174-38e6-ac32-631815cdfded",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
            "id" : "854d9168-e19d-313d-9fd2-c11a46894794",
            "name" : "CapNhatToContent",
            "type" : "PROCESSOR"
          },
          "zIndex" : 44
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
            "id" : "237dcb4b-fde9-3897-a63c-230a3b43f3ed",
            "name" : "ChuanHoa",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
          "identifier" : "30b43769-573a-32f4-a8df-f2b5b3780c52",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
            "id" : "4356a58a-8f1c-3281-80c0-681178604210",
            "name" : "TrangThai",
            "type" : "INPUT_PORT"
          },
          "zIndex" : 41
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
            "id" : "992246a4-f382-3f39-95f7-7382ffa7f177",
            "name" : "LuuFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
          "identifier" : "0662d3ee-df61-3e66-bf33-013ef6c33669",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
            "id" : "854d9168-e19d-313d-9fd2-c11a46894794",
            "name" : "CapNhatToContent",
            "type" : "PROCESSOR"
          },
          "zIndex" : 43
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
            "id" : "854d9168-e19d-313d-9fd2-c11a46894794",
            "name" : "CapNhatToContent",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
          "identifier" : "31585db3-e064-3a47-9b82-815b7b6fd9de",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
            "id" : "237dcb4b-fde9-3897-a63c-230a3b43f3ed",
            "name" : "ChuanHoa",
            "type" : "PROCESSOR"
          },
          "zIndex" : 42
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
            "id" : "8af0fb06-e786-3feb-bca4-506fe93d4bf9",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
          "identifier" : "cd7495a1-34be-3d82-9ac5-df87f47da794",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
            "id" : "992246a4-f382-3f39-95f7-7382ffa7f177",
            "name" : "LuuFile",
            "type" : "PROCESSOR"
          },
          "zIndex" : 46
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
            "id" : "051e2811-2ed5-3b3e-830f-0739f7b3c9de",
            "name" : "input",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
          "identifier" : "52899f29-22e7-30ef-916e-f486bfb1cc0c",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
            "id" : "992246a4-f382-3f39-95f7-7382ffa7f177",
            "name" : "LuuFile",
            "type" : "PROCESSOR"
          },
          "zIndex" : 47
        } ],
        "controllerServices" : [ ],
        "defaultBackPressureDataSizeThreshold" : "1 GB",
        "defaultBackPressureObjectThreshold" : 10000,
        "defaultFlowFileExpiration" : "0 sec",
        "executionEngine" : "INHERITED",
        "flowFileConcurrency" : "UNBOUNDED",
        "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
        "funnels" : [ ],
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
        "inputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "INPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
          "identifier" : "4356a58a-8f1c-3281-80c0-681178604210",
          "name" : "TrangThai",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : -488.0,
            "y" : -176.0
          },
          "scheduledState" : "ENABLED",
          "type" : "INPUT_PORT"
        } ],
        "labels" : [ ],
        "maxConcurrentTasks" : 1,
        "name" : "KetThucETLVoiLoi",
        "outputPorts" : [ ],
        "parameterContextName" : "TikTokETL",
        "position" : {
          "x" : 1144.0,
          "y" : 296.0
        },
        "processGroups" : [ {
          "comments" : "",
          "componentType" : "PROCESS_GROUP",
          "connections" : [ {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
              "id" : "c3c4a7ad-de0a-3a75-939b-366e09d9a743",
              "name" : "GuiTinNhanTelegram",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
            "identifier" : "e6f52367-d0a0-3239-8581-e817cbc41e7a",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
              "id" : "e0dc167c-2900-32eb-b612-7c490454e953",
              "name" : "ReplaceText",
              "type" : "PROCESSOR"
            },
            "zIndex" : 7
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
              "id" : "052e041b-6b41-3d97-9b6d-592d6cba4a82",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
            "identifier" : "7a4502c4-f247-343e-9788-a77927a20755",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "Response", "Failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
              "id" : "c3c4a7ad-de0a-3a75-939b-366e09d9a743",
              "name" : "GuiTinNhanTelegram",
              "type" : "PROCESSOR"
            },
            "zIndex" : 5
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
              "id" : "e0dc167c-2900-32eb-b612-7c490454e953",
              "name" : "ReplaceText",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
            "identifier" : "f36cc83e-f547-3e58-8c5a-e0f26206dfa5",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "send" ],
            "source" : {
              "comments" : "",
              "groupId" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
              "id" : "ed246d0b-51ee-36e4-9437-c7aab89e4a8b",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "zIndex" : 8
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
              "id" : "c0091410-4db8-3824-bb8d-da474e7e54b3",
              "name" : "LaythongtinTelegramCauHinh",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
            "identifier" : "839e59bd-63f6-39bf-9398-b7cf25ceb6ed",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "groupId" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
              "id" : "051e2811-2ed5-3b3e-830f-0739f7b3c9de",
              "name" : "input",
              "type" : "INPUT_PORT"
            },
            "zIndex" : 1
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
              "id" : "ed246d0b-51ee-36e4-9437-c7aab89e4a8b",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
            "identifier" : "82ac24e3-642a-3c19-8790-91ea3a5b7413",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
              "id" : "c0091410-4db8-3824-bb8d-da474e7e54b3",
              "name" : "LaythongtinTelegramCauHinh",
              "type" : "PROCESSOR"
            },
            "zIndex" : 6
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
              "id" : "052e041b-6b41-3d97-9b6d-592d6cba4a82",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
            "identifier" : "7044dda1-a0d4-3db4-89c5-d85eccca3702",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
              "id" : "e0dc167c-2900-32eb-b612-7c490454e953",
              "name" : "ReplaceText",
              "type" : "PROCESSOR"
            },
            "zIndex" : 9
          } ],
          "controllerServices" : [ ],
          "defaultBackPressureDataSizeThreshold" : "1 GB",
          "defaultBackPressureObjectThreshold" : 10000,
          "defaultFlowFileExpiration" : "0 sec",
          "executionEngine" : "INHERITED",
          "flowFileConcurrency" : "UNBOUNDED",
          "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
          "funnels" : [ ],
          "groupIdentifier" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
          "identifier" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
          "inputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "INPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
            "identifier" : "051e2811-2ed5-3b3e-830f-0739f7b3c9de",
            "name" : "input",
            "portFunction" : "STANDARD",
            "position" : {
              "x" : -1056.0,
              "y" : -248.0
            },
            "scheduledState" : "ENABLED",
            "type" : "INPUT_PORT"
          } ],
          "labels" : [ ],
          "maxConcurrentTasks" : 1,
          "name" : "GuiThongBaoTelegram",
          "outputPorts" : [ ],
          "position" : {
            "x" : 1440.0,
            "y" : -248.0
          },
          "processGroups" : [ ],
          "processors" : [ {
            "autoTerminatedRelationships" : [ "unmatched" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
            "identifier" : "ed246d0b-51ee-36e4-9437-c7aab89e4a8b",
            "maxBackoffPeriod" : "10 mins",
            "name" : "RouteOnAttribute",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : -184.0,
              "y" : -288.0
            },
            "properties" : {
              "Routing Strategy" : "Route to Property name",
              "send" : "${telegram.enabled:equals('true')}"
            },
            "propertyDescriptors" : {
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              },
              "send" : {
                "displayName" : "send",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "send",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
            "identifier" : "e0dc167c-2900-32eb-b612-7c490454e953",
            "maxBackoffPeriod" : "10 mins",
            "name" : "ReplaceText",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 200.0,
              "y" : -288.0
            },
            "properties" : {
              "Regular Expression" : "(?s)^(.*)$",
              "Replacement Value" : "{\"chat_id\":\"#{ChatId}\",\"text\":\"${telegram.text}\"}",
              "Evaluation Mode" : "Entire text",
              "Line-by-Line Evaluation Mode" : "All",
              "Character Set" : "UTF-8",
              "Maximum Buffer Size" : "1 MB",
              "Replacement Strategy" : "Regex Replace"
            },
            "propertyDescriptors" : {
              "Regular Expression" : {
                "displayName" : "Search Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Regular Expression",
                "sensitive" : false
              },
              "Replacement Value" : {
                "displayName" : "Replacement Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Replacement Value",
                "sensitive" : false
              },
              "Evaluation Mode" : {
                "displayName" : "Evaluation Mode",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Evaluation Mode",
                "sensitive" : false
              },
              "Text to Prepend" : {
                "displayName" : "Text to Prepend",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Text to Prepend",
                "sensitive" : false
              },
              "Line-by-Line Evaluation Mode" : {
                "displayName" : "Line-by-Line Evaluation Mode",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Line-by-Line Evaluation Mode",
                "sensitive" : false
              },
              "Character Set" : {
                "displayName" : "Character Set",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Character Set",
                "sensitive" : false
              },
              "Maximum Buffer Size" : {
                "displayName" : "Maximum Buffer Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Maximum Buffer Size",
                "sensitive" : false
              },
              "Replacement Strategy" : {
                "displayName" : "Replacement Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Replacement Strategy",
                "sensitive" : false
              },
              "Text to Append" : {
                "displayName" : "Text to Append",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Text to Append",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.ReplaceText",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "No Retry", "Retry", "Original" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
            "identifier" : "c3c4a7ad-de0a-3a75-939b-366e09d9a743",
            "maxBackoffPeriod" : "10 mins",
            "name" : "GuiTinNhanTelegram",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 656.0,
              "y" : -296.0
            },
            "properties" : {
              "Request Content-Encoding" : "DISABLED",
              "Request Multipart Form-Data Filename Enabled" : "true",
              "Request Chunked Transfer-Encoding Enabled" : "false",
              "HTTP/2 Disabled" : "False",
              "Connection Timeout" : "30 secs",
              "Response Cookie Strategy" : "DISABLED",
              "Socket Read Timeout" : "15 secs",
              "Socket Idle Connections" : "5",
              "Request Body Enabled" : "true",
              "OAuth2 Access Token Refresh Strategy" : "ON_TOKEN_EXPIRATION",
              "HTTP URL" : "https://api.telegram.org/bot#{BotToken}/sendMessage",
              "Socket Idle Timeout" : "5 mins",
              "Response Redirects Enabled" : "True",
              "Socket Write Timeout" : "15 secs",
              "Response FlowFile Naming Strategy" : "RANDOM",
              "Response Cache Enabled" : "false",
              "Request Date Header Enabled" : "True",
              "Request Failure Penalization Enabled" : "false",
              "Response Body Attribute Size" : "256",
              "Response Generation Required" : "false",
              "Response Header Request Attributes Enabled" : "false",
              "HTTP Method" : "POST",
              "Request Content-Type" : "application/json",
              "Request Digest Authentication Enabled" : "false",
              "Response Cache Size" : "10MB",
              "Response Body Ignored" : "false"
            },
            "propertyDescriptors" : {
              "Request Content-Encoding" : {
                "displayName" : "Request Content-Encoding",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Content-Encoding",
                "sensitive" : false
              },
              "proxy-configuration-service" : {
                "displayName" : "Proxy Configuration Service",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "proxy-configuration-service",
                "sensitive" : false
              },
              "Request Multipart Form-Data Filename Enabled" : {
                "displayName" : "Request Multipart Form-Data Filename Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Multipart Form-Data Filename Enabled",
                "sensitive" : false
              },
              "Request Chunked Transfer-Encoding Enabled" : {
                "displayName" : "Request Chunked Transfer-Encoding Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Chunked Transfer-Encoding Enabled",
                "sensitive" : false
              },
              "Response Header Request Attributes Prefix" : {
                "displayName" : "Response Header Request Attributes Prefix",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Header Request Attributes Prefix",
                "sensitive" : false
              },
              "HTTP/2 Disabled" : {
                "displayName" : "HTTP/2 Disabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "HTTP/2 Disabled",
                "sensitive" : false
              },
              "Connection Timeout" : {
                "displayName" : "Connection Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Connection Timeout",
                "sensitive" : false
              },
              "Response Cookie Strategy" : {
                "displayName" : "Response Cookie Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Cookie Strategy",
                "sensitive" : false
              },
              "Request Password" : {
                "displayName" : "Request Password",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Password",
                "sensitive" : true
              },
              "Socket Read Timeout" : {
                "displayName" : "Socket Read Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Socket Read Timeout",
                "sensitive" : false
              },
              "Socket Idle Connections" : {
                "displayName" : "Socket Idle Connections",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Socket Idle Connections",
                "sensitive" : false
              },
              "Request Body Enabled" : {
                "displayName" : "Request Body Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Body Enabled",
                "sensitive" : false
              },
              "OAuth2 Access Token Refresh Strategy" : {
                "displayName" : "OAuth2 Access Token Refresh Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "OAuth2 Access Token Refresh Strategy",
                "sensitive" : false
              },
              "HTTP URL" : {
                "displayName" : "HTTP URL",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "HTTP URL",
                "sensitive" : false
              },
              "Request OAuth2 Access Token Provider" : {
                "displayName" : "Request OAuth2 Access Token Provider",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "Request OAuth2 Access Token Provider",
                "sensitive" : false
              },
              "Socket Idle Timeout" : {
                "displayName" : "Socket Idle Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Socket Idle Timeout",
                "sensitive" : false
              },
              "Response Redirects Enabled" : {
                "displayName" : "Response Redirects Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Redirects Enabled",
                "sensitive" : false
              },
              "Socket Write Timeout" : {
                "displayName" : "Socket Write Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Socket Write Timeout",
                "sensitive" : false
              },
              "Request Header Attributes Pattern" : {
                "displayName" : "Request Header Attributes Pattern",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Header Attributes Pattern",
                "sensitive" : false
              },
              "Response FlowFile Naming Strategy" : {
                "displayName" : "Response FlowFile Naming Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response FlowFile Naming Strategy",
                "sensitive" : false
              },
              "Response Cache Enabled" : {
                "displayName" : "Response Cache Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Cache Enabled",
                "sensitive" : false
              },
              "Request Date Header Enabled" : {
                "displayName" : "Request Date Header Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Date Header Enabled",
                "sensitive" : false
              },
              "Request Failure Penalization Enabled" : {
                "displayName" : "Request Failure Penalization Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Failure Penalization Enabled",
                "sensitive" : false
              },
              "Response Body Attribute Size" : {
                "displayName" : "Response Body Attribute Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Body Attribute Size",
                "sensitive" : false
              },
              "SSL Context Service" : {
                "displayName" : "SSL Context Service",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "SSL Context Service",
                "sensitive" : false
              },
              "Response Generation Required" : {
                "displayName" : "Response Generation Required",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Generation Required",
                "sensitive" : false
              },
              "Request User-Agent" : {
                "displayName" : "Request User-Agent",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request User-Agent",
                "sensitive" : false
              },
              "Response Header Request Attributes Enabled" : {
                "displayName" : "Response Header Request Attributes Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Header Request Attributes Enabled",
                "sensitive" : false
              },
              "HTTP Method" : {
                "displayName" : "HTTP Method",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "HTTP Method",
                "sensitive" : false
              },
              "Request Username" : {
                "displayName" : "Request Username",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Username",
                "sensitive" : false
              },
              "Request Content-Type" : {
                "displayName" : "Request Content-Type",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Content-Type",
                "sensitive" : false
              },
              "Response Body Attribute Name" : {
                "displayName" : "Response Body Attribute Name",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Body Attribute Name",
                "sensitive" : false
              },
              "Request Digest Authentication Enabled" : {
                "displayName" : "Request Digest Authentication Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Digest Authentication Enabled",
                "sensitive" : false
              },
              "Request Multipart Form-Data Name" : {
                "displayName" : "Request Multipart Form-Data Name",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Multipart Form-Data Name",
                "sensitive" : false
              },
              "Response Cache Size" : {
                "displayName" : "Response Cache Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Cache Size",
                "sensitive" : false
              },
              "Response Body Ignored" : {
                "displayName" : "Response Body Ignored",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Body Ignored",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "success" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
            "identifier" : "052e041b-6b41-3d97-9b6d-592d6cba4a82",
            "maxBackoffPeriod" : "10 mins",
            "name" : "LogMessage",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 224.0,
              "y" : 32.0
            },
            "properties" : {
              "log-level" : "info"
            },
            "propertyDescriptors" : {
              "log-message" : {
                "displayName" : "Log message",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-message",
                "sensitive" : false
              },
              "log-level" : {
                "displayName" : "Log Level",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-level",
                "sensitive" : false
              },
              "log-prefix" : {
                "displayName" : "Log prefix",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-prefix",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.LogMessage",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "66eca645-49c6-3425-a4f1-1b671d85eca1",
            "identifier" : "c0091410-4db8-3824-bb8d-da474e7e54b3",
            "maxBackoffPeriod" : "10 mins",
            "name" : "LaythongtinTelegramCauHinh",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : -656.0,
              "y" : -280.0
            },
            "properties" : {
              "telegram.botToken" : "#{BotToken}",
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100",
              "telegram.chatId" : "#{ChatId}",
              "telegram.enabled" : "#{Enabled}",
              "telegram.text" : " MESSAGE ALERT\n Application: NIFI\n Flow: ${state.name}\n Message: ${state.message}"
            },
            "propertyDescriptors" : {
              "telegram.botToken" : {
                "displayName" : "telegram.botToken",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "telegram.botToken",
                "sensitive" : false
              },
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "telegram.chatId" : {
                "displayName" : "telegram.chatId",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "telegram.chatId",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              },
              "telegram.enabled" : {
                "displayName" : "telegram.enabled",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "telegram.enabled",
                "sensitive" : false
              },
              "telegram.text" : {
                "displayName" : "telegram.text",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "telegram.text",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          } ],
          "remoteProcessGroups" : [ ],
          "scheduledState" : "ENABLED",
          "statelessFlowTimeout" : "1 min"
        } ],
        "processors" : [ {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
          "identifier" : "854d9168-e19d-313d-9fd2-c11a46894794",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CapNhatToContent",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 424.0,
            "y" : -232.0
          },
          "properties" : {
            "Regular Expression" : "(?s)(^.*$)",
            "Replacement Value" : "{\n  \"name\": \"${state.name}\",\n  \"isActive\": ${state.isActive},\n  \"lastExecutionTime\": \"${state.lastExecutionTime}\",\n  \"startTime\": \"${state.startTime}\",\n  \"endTime\": \"${state.endTime}\",\n  \"status\": \"${state.status}\",\n  \"sequenceNumber\": \"${state.sequenceNumber}\",\n  \"message\": \"${state.message}\"\n}",
            "Evaluation Mode" : "Entire text",
            "Line-by-Line Evaluation Mode" : "All",
            "Character Set" : "UTF-8",
            "Maximum Buffer Size" : "1 MB",
            "Replacement Strategy" : "Always Replace"
          },
          "propertyDescriptors" : {
            "Regular Expression" : {
              "displayName" : "Search Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Regular Expression",
              "sensitive" : false
            },
            "Replacement Value" : {
              "displayName" : "Replacement Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Value",
              "sensitive" : false
            },
            "Evaluation Mode" : {
              "displayName" : "Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Evaluation Mode",
              "sensitive" : false
            },
            "Text to Prepend" : {
              "displayName" : "Text to Prepend",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Prepend",
              "sensitive" : false
            },
            "Line-by-Line Evaluation Mode" : {
              "displayName" : "Line-by-Line Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Line-by-Line Evaluation Mode",
              "sensitive" : false
            },
            "Character Set" : {
              "displayName" : "Character Set",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Character Set",
              "sensitive" : false
            },
            "Maximum Buffer Size" : {
              "displayName" : "Maximum Buffer Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum Buffer Size",
              "sensitive" : false
            },
            "Replacement Strategy" : {
              "displayName" : "Replacement Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Strategy",
              "sensitive" : false
            },
            "Text to Append" : {
              "displayName" : "Text to Append",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Append",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ReplaceText",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
          "identifier" : "237dcb4b-fde9-3897-a63c-230a3b43f3ed",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ChuanHoa",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 16.0,
            "y" : -224.0
          },
          "properties" : {
            "state.message" : "Li khi ly danh sch ca hng",
            "filename" : "${state.filename}",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100",
            "state.status" : "3",
            "state.isActive" : "false",
            "state.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
          },
          "propertyDescriptors" : {
            "state.message" : {
              "displayName" : "state.message",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.message",
              "sensitive" : false
            },
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "filename" : {
              "displayName" : "filename",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "filename",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "state.status" : {
              "displayName" : "state.status",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.status",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            },
            "state.isActive" : {
              "displayName" : "state.isActive",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.isActive",
              "sensitive" : false
            },
            "state.lastExecutionTime" : {
              "displayName" : "state.lastExecutionTime",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.lastExecutionTime",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "success" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
          "identifier" : "8af0fb06-e786-3feb-bca4-506fe93d4bf9",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LogMessage",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 616.0,
            "y" : 64.0
          },
          "properties" : {
            "log-level" : "info"
          },
          "propertyDescriptors" : {
            "log-message" : {
              "displayName" : "Log message",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-message",
              "sensitive" : false
            },
            "log-level" : {
              "displayName" : "Log Level",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-level",
              "sensitive" : false
            },
            "log-prefix" : {
              "displayName" : "Log prefix",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-prefix",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ "success" ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.LogMessage",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "50dff16d-f6c7-3bd1-b462-78254a45c639",
          "identifier" : "992246a4-f382-3f39-95f7-7382ffa7f177",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LuuFile",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 944.0,
            "y" : -232.0
          },
          "properties" : {
            "Create Missing Directories" : "true",
            "Directory" : "${state.path}",
            "Conflict Resolution Strategy" : "replace"
          },
          "propertyDescriptors" : {
            "Group" : {
              "displayName" : "Group",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Group",
              "sensitive" : false
            },
            "Owner" : {
              "displayName" : "Owner",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Owner",
              "sensitive" : false
            },
            "Create Missing Directories" : {
              "displayName" : "Create Missing Directories",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Create Missing Directories",
              "sensitive" : false
            },
            "Permissions" : {
              "displayName" : "Permissions",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Permissions",
              "sensitive" : false
            },
            "Maximum File Count" : {
              "displayName" : "Maximum File Count",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum File Count",
              "sensitive" : false
            },
            "Last Modified Time" : {
              "displayName" : "Last Modified Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Last Modified Time",
              "sensitive" : false
            },
            "Directory" : {
              "displayName" : "Directory",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory",
              "sensitive" : false
            },
            "Conflict Resolution Strategy" : {
              "displayName" : "Conflict Resolution Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Conflict Resolution Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.PutFile",
          "yieldDuration" : "1 sec"
        } ],
        "remoteProcessGroups" : [ ],
        "scheduledState" : "ENABLED",
        "statelessFlowTimeout" : "1 min"
      } ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "64d2ae21-d926-3556-87ad-7873ceb01762",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KhoiTaoLayDanhSach",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : -128.0,
          "y" : -112.0
        },
        "properties" : {
          "stateStores.path" : "#{TempPath}${Path.Separator}${state.name}",
          "filename" : "state_stotes.json",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateStores.fullpath" : "#{TempPath}${Path.Separator}${state.name}${Path.Separator}state_stotes.json",
          "stateStores.filename" : "state_stotes.json",
          "stateStores.name" : "state_stotes"
        },
        "propertyDescriptors" : {
          "stateStores.path" : {
            "displayName" : "stateStores.path",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateStores.path",
            "sensitive" : false
          },
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateStores.fullpath" : {
            "displayName" : "stateStores.fullpath",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateStores.fullpath",
            "sensitive" : false
          },
          "stateStores.filename" : {
            "displayName" : "stateStores.filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateStores.filename",
            "sensitive" : false
          },
          "stateStores.name" : {
            "displayName" : "stateStores.name",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateStores.name",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "f69600d2-4fdc-31b1-84eb-d54d2f0b2752",
        "maxBackoffPeriod" : "10 mins",
        "name" : "Data to JSON",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 800.0,
          "y" : -104.0
        },
        "properties" : {
          "Include Zero Record FlowFiles" : "true",
          "Record Writer" : "877d4cf8-3ef9-3d3c-965f-0f85798a2a2f",
          "Record Reader" : "40a44711-6955-3e69-b463-371590dfa3ed"
        },
        "propertyDescriptors" : {
          "Include Zero Record FlowFiles" : {
            "displayName" : "Include Zero Record FlowFiles",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Include Zero Record FlowFiles",
            "sensitive" : false
          },
          "Record Writer" : {
            "displayName" : "Record Writer",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Record Writer",
            "sensitive" : false
          },
          "Record Reader" : {
            "displayName" : "Record Reader",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Record Reader",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ConvertRecord",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "27df0513-10a6-349d-a980-ccb74762e387",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoaIdsQuerySql",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 2208.0,
          "y" : -120.0
        },
        "properties" : {
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateStores.storeIds.inClause" : "${stateStores.storeIds\n  :replaceAll('^\\\\[|\\\\]$', '')\n  :replaceAll('\"', '\\'')\n  :prepend('(')\n  :append(')')}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "stateStores.storeIds.inClause" : {
            "displayName" : "stateStores.storeIds.inClause",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateStores.storeIds.inClause",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "d7b07b6c-5ebe-3fd4-8211-28308a4de2dd",
        "maxBackoffPeriod" : "10 mins",
        "name" : "PutFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 1768.0,
          "y" : -128.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${stateStores.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "c47648ac-e1f4-3cec-8078-b7d45fbc2760",
        "maxBackoffPeriod" : "10 mins",
        "name" : "GetDimStores",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 376.0,
          "y" : -104.0
        },
        "properties" : {
          "esql-max-rows" : "0",
          "dbf-default-precision" : "10",
          "Max Wait Time" : "0 seconds",
          "SQL Query" : "SELECT [Id]\n      ,[StoreId]\n      ,[StoreName]\n      ,[Description]\n      ,[StoreUrl]\n      ,[StoreType]\n      ,[Status]\n      ,[Country]\n      ,[Region]\n      ,[CreatedAt]\n      ,[UpdatedAt]\n      ,[EffectiveStartDate]\n      ,[EffectiveEndDate]\n      ,[CreationTime]\n      ,[CreatorId]\n      ,[LastModificationTime]\n      ,[LastModifierId]\n  FROM Dim_DimStores",
          "Database Connection Pooling Service" : "6fce9190-8f74-3a75-9e56-36c3f8fc6d63",
          "esql-auto-commit" : "true",
          "dbf-user-logical-types" : "false",
          "dbf-default-scale" : "0",
          "compression-format" : "NONE",
          "esql-output-batch-size" : "0",
          "esql-fetch-size" : "0",
          "dbf-normalize" : "false",
          "Content Output Strategy" : "EMPTY"
        },
        "propertyDescriptors" : {
          "esql-max-rows" : {
            "displayName" : "Max Rows Per Flow File",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-max-rows",
            "sensitive" : false
          },
          "dbf-default-precision" : {
            "displayName" : "Default Decimal Precision",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-default-precision",
            "sensitive" : false
          },
          "Max Wait Time" : {
            "displayName" : "Max Wait Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Max Wait Time",
            "sensitive" : false
          },
          "SQL Query" : {
            "displayName" : "SQL Query",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "SQL Query",
            "sensitive" : false
          },
          "Database Connection Pooling Service" : {
            "displayName" : "Database Connection Pooling Service",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Database Connection Pooling Service",
            "sensitive" : false
          },
          "sql-post-query" : {
            "displayName" : "SQL Post-Query",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "sql-post-query",
            "sensitive" : false
          },
          "esql-auto-commit" : {
            "displayName" : "Set Auto Commit",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-auto-commit",
            "sensitive" : false
          },
          "dbf-user-logical-types" : {
            "displayName" : "Use Avro Logical Types",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-user-logical-types",
            "sensitive" : false
          },
          "dbf-default-scale" : {
            "displayName" : "Default Decimal Scale",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-default-scale",
            "sensitive" : false
          },
          "sql-pre-query" : {
            "displayName" : "SQL Pre-Query",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "sql-pre-query",
            "sensitive" : false
          },
          "compression-format" : {
            "displayName" : "Compression Format",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "compression-format",
            "sensitive" : false
          },
          "esql-output-batch-size" : {
            "displayName" : "Output Batch Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-output-batch-size",
            "sensitive" : false
          },
          "esql-fetch-size" : {
            "displayName" : "Fetch Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-fetch-size",
            "sensitive" : false
          },
          "dbf-normalize" : {
            "displayName" : "Normalize Table/Column Names",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-normalize",
            "sensitive" : false
          },
          "Content Output Strategy" : {
            "displayName" : "Content Output Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Content Output Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "e833d4e9-1953-37e8-a07f-2ea6df15db64",
        "identifier" : "067d3c1b-d4f9-3f90-9ac3-85ea03c58215",
        "maxBackoffPeriod" : "10 mins",
        "name" : "MapNoiDungLenAttribute",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 1288.0,
          "y" : -112.0
        },
        "properties" : {
          "Destination" : "flowfile-attribute",
          "Max String Length" : "200 MB",
          "Return Type" : "json",
          "Null Value Representation" : "empty string",
          "stateStores.storeIds" : "$[*].StoreId",
          "Path Not Found Behavior" : "ignore"
        },
        "propertyDescriptors" : {
          "Destination" : {
            "displayName" : "Destination",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Destination",
            "sensitive" : false
          },
          "Max String Length" : {
            "displayName" : "Max String Length",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Max String Length",
            "sensitive" : false
          },
          "Return Type" : {
            "displayName" : "Return Type",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Return Type",
            "sensitive" : false
          },
          "Null Value Representation" : {
            "displayName" : "Null Value Representation",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Null Value Representation",
            "sensitive" : false
          },
          "stateStores.storeIds" : {
            "displayName" : "stateStores.storeIds",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateStores.storeIds",
            "sensitive" : false
          },
          "Path Not Found Behavior" : {
            "displayName" : "Path Not Found Behavior",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Path Not Found Behavior",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.EvaluateJsonPath",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
          "id" : "c623dfec-5e0d-3b25-80e2-1f175a6fbc57",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
        "identifier" : "5ea7aff9-33b7-3be9-ad5a-85ca5a4cd483",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
          "id" : "5c638984-e8c9-3d87-95d2-4a1d011c098c",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
          "id" : "5c638984-e8c9-3d87-95d2-4a1d011c098c",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
        "identifier" : "3e829663-fbf3-336a-8a08-738f22320981",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
          "id" : "f09acb22-1f09-3938-8387-c4a157cf45c7",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
          "id" : "c623dfec-5e0d-3b25-80e2-1f175a6fbc57",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
        "identifier" : "16c401e9-259b-34f1-a121-4b5be894df99",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
          "id" : "60479d8c-ce47-3d11-9a3a-6b0dba911fde",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
          "id" : "60479d8c-ce47-3d11-9a3a-6b0dba911fde",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
        "identifier" : "672c6c57-2c98-3b89-9ceb-241d20ca3b7b",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
          "id" : "5c638984-e8c9-3d87-95d2-4a1d011c098c",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
          "id" : "46b6f791-6bb8-3dd9-bb9f-673576df4da5",
          "name" : "input",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
        "identifier" : "e3583d27-6adf-3d96-a506-23d80b73f924",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
          "id" : "60479d8c-ce47-3d11-9a3a-6b0dba911fde",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
          "id" : "f09acb22-1f09-3938-8387-c4a157cf45c7",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
        "identifier" : "9d81a1b4-189c-3fb6-a8b8-e65e6e7651bf",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
          "id" : "3aa4cbad-b604-366e-a9f7-e3512cadb3c7",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
        "identifier" : "3aa4cbad-b604-366e-a9f7-e3512cadb3c7",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "KetThucETLVoiLoi",
      "outputPorts" : [ ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -704.0,
        "y" : 1264.0
      },
      "processGroups" : [ {
        "comments" : "",
        "componentType" : "PROCESS_GROUP",
        "connections" : [ {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
            "id" : "6d9bc578-9c50-31f7-b1d1-0a470cf43c81",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
          "identifier" : "9cc04f0a-f894-3390-950f-131721d3fba0",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "send" ],
          "source" : {
            "comments" : "",
            "groupId" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
            "id" : "622015c0-9bd5-3467-acb4-cccaa7c2fce6",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "zIndex" : 8
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
            "id" : "622015c0-9bd5-3467-acb4-cccaa7c2fce6",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
          "identifier" : "0d88e45f-1dcd-378c-b236-5165c662b97b",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
            "id" : "1422e745-d0a4-3698-9848-7a0c0d268fb5",
            "name" : "LaythongtinTelegramCauHinh",
            "type" : "PROCESSOR"
          },
          "zIndex" : 6
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
            "id" : "1422e745-d0a4-3698-9848-7a0c0d268fb5",
            "name" : "LaythongtinTelegramCauHinh",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
          "identifier" : "0f3a2ba3-95a8-324c-a169-ab18cb0e67e3",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
            "id" : "46b6f791-6bb8-3dd9-bb9f-673576df4da5",
            "name" : "input",
            "type" : "INPUT_PORT"
          },
          "zIndex" : 1
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
            "id" : "eb206fd8-ff5a-33c1-8946-2c1e9b650490",
            "name" : "GuiTinNhanTelegram",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
          "identifier" : "5e5d0eb8-d55a-3dd7-b909-402b0c50e44e",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
            "id" : "6d9bc578-9c50-31f7-b1d1-0a470cf43c81",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "zIndex" : 7
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
            "id" : "235f1f9a-847c-3ccb-8585-3b034c2ed5b1",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
          "identifier" : "d3e4014a-56fc-3038-918c-cd8f8107a877",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
            "id" : "6d9bc578-9c50-31f7-b1d1-0a470cf43c81",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "zIndex" : 9
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
            "id" : "235f1f9a-847c-3ccb-8585-3b034c2ed5b1",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
          "identifier" : "2f9f9230-1c59-31a2-9258-110aab1bf2a8",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "Response", "Failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
            "id" : "eb206fd8-ff5a-33c1-8946-2c1e9b650490",
            "name" : "GuiTinNhanTelegram",
            "type" : "PROCESSOR"
          },
          "zIndex" : 5
        } ],
        "controllerServices" : [ ],
        "defaultBackPressureDataSizeThreshold" : "1 GB",
        "defaultBackPressureObjectThreshold" : 10000,
        "defaultFlowFileExpiration" : "0 sec",
        "executionEngine" : "INHERITED",
        "flowFileConcurrency" : "UNBOUNDED",
        "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
        "funnels" : [ ],
        "groupIdentifier" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
        "identifier" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
        "inputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "INPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
          "identifier" : "46b6f791-6bb8-3dd9-bb9f-673576df4da5",
          "name" : "input",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : -1056.0,
            "y" : -248.0
          },
          "scheduledState" : "ENABLED",
          "type" : "INPUT_PORT"
        } ],
        "labels" : [ ],
        "maxConcurrentTasks" : 1,
        "name" : "GuiThongBaoTelegram",
        "outputPorts" : [ ],
        "position" : {
          "x" : 1424.0,
          "y" : -264.0
        },
        "processGroups" : [ ],
        "processors" : [ {
          "autoTerminatedRelationships" : [ "No Retry", "Retry", "Original" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
          "identifier" : "eb206fd8-ff5a-33c1-8946-2c1e9b650490",
          "maxBackoffPeriod" : "10 mins",
          "name" : "GuiTinNhanTelegram",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 656.0,
            "y" : -296.0
          },
          "properties" : {
            "Request Content-Encoding" : "DISABLED",
            "Request Multipart Form-Data Filename Enabled" : "true",
            "Request Chunked Transfer-Encoding Enabled" : "false",
            "HTTP/2 Disabled" : "False",
            "Connection Timeout" : "30 secs",
            "Response Cookie Strategy" : "DISABLED",
            "Socket Read Timeout" : "15 secs",
            "Socket Idle Connections" : "5",
            "Request Body Enabled" : "true",
            "OAuth2 Access Token Refresh Strategy" : "ON_TOKEN_EXPIRATION",
            "HTTP URL" : "https://api.telegram.org/bot#{BotToken}/sendMessage",
            "Socket Idle Timeout" : "5 mins",
            "Response Redirects Enabled" : "True",
            "Socket Write Timeout" : "15 secs",
            "Response FlowFile Naming Strategy" : "RANDOM",
            "Response Cache Enabled" : "false",
            "Request Date Header Enabled" : "True",
            "Request Failure Penalization Enabled" : "false",
            "Response Body Attribute Size" : "256",
            "Response Generation Required" : "false",
            "Response Header Request Attributes Enabled" : "false",
            "HTTP Method" : "POST",
            "Request Content-Type" : "application/json",
            "Request Digest Authentication Enabled" : "false",
            "Response Cache Size" : "10MB",
            "Response Body Ignored" : "false"
          },
          "propertyDescriptors" : {
            "Request Content-Encoding" : {
              "displayName" : "Request Content-Encoding",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Content-Encoding",
              "sensitive" : false
            },
            "proxy-configuration-service" : {
              "displayName" : "Proxy Configuration Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "proxy-configuration-service",
              "sensitive" : false
            },
            "Request Multipart Form-Data Filename Enabled" : {
              "displayName" : "Request Multipart Form-Data Filename Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Multipart Form-Data Filename Enabled",
              "sensitive" : false
            },
            "Request Chunked Transfer-Encoding Enabled" : {
              "displayName" : "Request Chunked Transfer-Encoding Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Chunked Transfer-Encoding Enabled",
              "sensitive" : false
            },
            "Response Header Request Attributes Prefix" : {
              "displayName" : "Response Header Request Attributes Prefix",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Header Request Attributes Prefix",
              "sensitive" : false
            },
            "HTTP/2 Disabled" : {
              "displayName" : "HTTP/2 Disabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP/2 Disabled",
              "sensitive" : false
            },
            "Connection Timeout" : {
              "displayName" : "Connection Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Connection Timeout",
              "sensitive" : false
            },
            "Response Cookie Strategy" : {
              "displayName" : "Response Cookie Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cookie Strategy",
              "sensitive" : false
            },
            "Request Password" : {
              "displayName" : "Request Password",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Password",
              "sensitive" : true
            },
            "Socket Read Timeout" : {
              "displayName" : "Socket Read Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Read Timeout",
              "sensitive" : false
            },
            "Socket Idle Connections" : {
              "displayName" : "Socket Idle Connections",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Idle Connections",
              "sensitive" : false
            },
            "Request Body Enabled" : {
              "displayName" : "Request Body Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Body Enabled",
              "sensitive" : false
            },
            "OAuth2 Access Token Refresh Strategy" : {
              "displayName" : "OAuth2 Access Token Refresh Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "OAuth2 Access Token Refresh Strategy",
              "sensitive" : false
            },
            "HTTP URL" : {
              "displayName" : "HTTP URL",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP URL",
              "sensitive" : false
            },
            "Request OAuth2 Access Token Provider" : {
              "displayName" : "Request OAuth2 Access Token Provider",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Request OAuth2 Access Token Provider",
              "sensitive" : false
            },
            "Socket Idle Timeout" : {
              "displayName" : "Socket Idle Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Idle Timeout",
              "sensitive" : false
            },
            "Response Redirects Enabled" : {
              "displayName" : "Response Redirects Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Redirects Enabled",
              "sensitive" : false
            },
            "Socket Write Timeout" : {
              "displayName" : "Socket Write Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Write Timeout",
              "sensitive" : false
            },
            "Request Header Attributes Pattern" : {
              "displayName" : "Request Header Attributes Pattern",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Header Attributes Pattern",
              "sensitive" : false
            },
            "Response FlowFile Naming Strategy" : {
              "displayName" : "Response FlowFile Naming Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response FlowFile Naming Strategy",
              "sensitive" : false
            },
            "Response Cache Enabled" : {
              "displayName" : "Response Cache Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cache Enabled",
              "sensitive" : false
            },
            "Request Date Header Enabled" : {
              "displayName" : "Request Date Header Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Date Header Enabled",
              "sensitive" : false
            },
            "Request Failure Penalization Enabled" : {
              "displayName" : "Request Failure Penalization Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Failure Penalization Enabled",
              "sensitive" : false
            },
            "Response Body Attribute Size" : {
              "displayName" : "Response Body Attribute Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Attribute Size",
              "sensitive" : false
            },
            "SSL Context Service" : {
              "displayName" : "SSL Context Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "SSL Context Service",
              "sensitive" : false
            },
            "Response Generation Required" : {
              "displayName" : "Response Generation Required",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Generation Required",
              "sensitive" : false
            },
            "Request User-Agent" : {
              "displayName" : "Request User-Agent",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request User-Agent",
              "sensitive" : false
            },
            "Response Header Request Attributes Enabled" : {
              "displayName" : "Response Header Request Attributes Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Header Request Attributes Enabled",
              "sensitive" : false
            },
            "HTTP Method" : {
              "displayName" : "HTTP Method",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP Method",
              "sensitive" : false
            },
            "Request Username" : {
              "displayName" : "Request Username",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Username",
              "sensitive" : false
            },
            "Request Content-Type" : {
              "displayName" : "Request Content-Type",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Content-Type",
              "sensitive" : false
            },
            "Response Body Attribute Name" : {
              "displayName" : "Response Body Attribute Name",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Attribute Name",
              "sensitive" : false
            },
            "Request Digest Authentication Enabled" : {
              "displayName" : "Request Digest Authentication Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Digest Authentication Enabled",
              "sensitive" : false
            },
            "Request Multipart Form-Data Name" : {
              "displayName" : "Request Multipart Form-Data Name",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Multipart Form-Data Name",
              "sensitive" : false
            },
            "Response Cache Size" : {
              "displayName" : "Response Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cache Size",
              "sensitive" : false
            },
            "Response Body Ignored" : {
              "displayName" : "Response Body Ignored",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Ignored",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "success" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
          "identifier" : "235f1f9a-847c-3ccb-8585-3b034c2ed5b1",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LogMessage",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 224.0,
            "y" : 32.0
          },
          "properties" : {
            "log-level" : "info"
          },
          "propertyDescriptors" : {
            "log-message" : {
              "displayName" : "Log message",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-message",
              "sensitive" : false
            },
            "log-level" : {
              "displayName" : "Log Level",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-level",
              "sensitive" : false
            },
            "log-prefix" : {
              "displayName" : "Log prefix",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-prefix",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.LogMessage",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
          "identifier" : "1422e745-d0a4-3698-9848-7a0c0d268fb5",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LaythongtinTelegramCauHinh",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : -656.0,
            "y" : -280.0
          },
          "properties" : {
            "telegram.botToken" : "#{BotToken}",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100",
            "telegram.chatId" : "#{ChatId}",
            "telegram.enabled" : "#{Enabled}",
            "telegram.text" : " MESSAGE ALERT\n Application: NIFI\n Flow: ${state.name}\n Message: ${state.message}"
          },
          "propertyDescriptors" : {
            "telegram.botToken" : {
              "displayName" : "telegram.botToken",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.botToken",
              "sensitive" : false
            },
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "telegram.chatId" : {
              "displayName" : "telegram.chatId",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.chatId",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            },
            "telegram.enabled" : {
              "displayName" : "telegram.enabled",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.enabled",
              "sensitive" : false
            },
            "telegram.text" : {
              "displayName" : "telegram.text",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.text",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "unmatched" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
          "identifier" : "622015c0-9bd5-3467-acb4-cccaa7c2fce6",
          "maxBackoffPeriod" : "10 mins",
          "name" : "RouteOnAttribute",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : -184.0,
            "y" : -288.0
          },
          "properties" : {
            "Routing Strategy" : "Route to Property name",
            "send" : "${telegram.enabled:equals('true')}"
          },
          "propertyDescriptors" : {
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "send" : {
              "displayName" : "send",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "send",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "dd50c8f6-eb06-32cd-b561-a2a1156418ff",
          "identifier" : "6d9bc578-9c50-31f7-b1d1-0a470cf43c81",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ReplaceText",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 200.0,
            "y" : -288.0
          },
          "properties" : {
            "Regular Expression" : "(?s)^(.*)$",
            "Replacement Value" : "{\"chat_id\":\"#{ChatId}\",\"text\":\"${telegram.text}\"}",
            "Evaluation Mode" : "Entire text",
            "Line-by-Line Evaluation Mode" : "All",
            "Character Set" : "UTF-8",
            "Maximum Buffer Size" : "1 MB",
            "Replacement Strategy" : "Regex Replace"
          },
          "propertyDescriptors" : {
            "Regular Expression" : {
              "displayName" : "Search Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Regular Expression",
              "sensitive" : false
            },
            "Replacement Value" : {
              "displayName" : "Replacement Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Value",
              "sensitive" : false
            },
            "Evaluation Mode" : {
              "displayName" : "Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Evaluation Mode",
              "sensitive" : false
            },
            "Text to Prepend" : {
              "displayName" : "Text to Prepend",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Prepend",
              "sensitive" : false
            },
            "Line-by-Line Evaluation Mode" : {
              "displayName" : "Line-by-Line Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Line-by-Line Evaluation Mode",
              "sensitive" : false
            },
            "Character Set" : {
              "displayName" : "Character Set",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Character Set",
              "sensitive" : false
            },
            "Maximum Buffer Size" : {
              "displayName" : "Maximum Buffer Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum Buffer Size",
              "sensitive" : false
            },
            "Replacement Strategy" : {
              "displayName" : "Replacement Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Strategy",
              "sensitive" : false
            },
            "Text to Append" : {
              "displayName" : "Text to Append",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Append",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ReplaceText",
          "yieldDuration" : "1 sec"
        } ],
        "remoteProcessGroups" : [ ],
        "scheduledState" : "ENABLED",
        "statelessFlowTimeout" : "1 min"
      } ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
        "identifier" : "60479d8c-ce47-3d11-9a3a-6b0dba911fde",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${state.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
        "identifier" : "c623dfec-5e0d-3b25-80e2-1f175a6fbc57",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
        "identifier" : "5c638984-e8c9-3d87-95d2-4a1d011c098c",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${state.name}\",\n  \"isActive\": ${state.isActive},\n  \"lastExecutionTime\": \"${state.lastExecutionTime}\",\n  \"startTime\": \"${state.startTime}\",\n  \"endTime\": \"${state.endTime}\",\n  \"status\": \"${state.status}\",\n  \"sequenceNumber\": \"${state.sequenceNumber}\",\n  \"message\": \"${state.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "721cffdf-dac1-34c1-a222-5e345fc2ef24",
        "identifier" : "f09acb22-1f09-3938-8387-c4a157cf45c7",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "state.message" : "Li khi ly danh sch BC",
          "filename" : "${state.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.status" : "3",
          "state.isActive" : "false",
          "state.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "state.message" : {
            "displayName" : "state.message",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.message",
            "sensitive" : false
          },
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.status" : {
            "displayName" : "state.status",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.status",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.isActive" : {
            "displayName" : "state.isActive",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.isActive",
            "sensitive" : false
          },
          "state.lastExecutionTime" : {
            "displayName" : "state.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.lastExecutionTime",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
          "id" : "65bcb24e-8e54-3675-a6b5-0ae09b42b758",
          "name" : "stateBcOut",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
        "identifier" : "b754a256-a053-3b11-8a9e-777c5601621d",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
          "id" : "51f3d9b1-1ab8-3422-919c-57e6f92abf82",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
          "id" : "9f5692f9-21e1-3f2f-b1e2-8a55c6abee06",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
        "identifier" : "d0a77103-64c7-336c-ad82-cc737fbe9317",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
          "id" : "f5ea6fb0-9706-347f-862f-5802aa2cf5b0",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
          "id" : "f5ea6fb0-9706-347f-862f-5802aa2cf5b0",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
        "identifier" : "57667421-74d0-3ed2-89ae-8eb6683c3575",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
          "id" : "bde7c7e7-5df8-36b4-a1fa-74847a5a5deb",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
          "id" : "51f3d9b1-1ab8-3422-919c-57e6f92abf82",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
        "identifier" : "87f62a25-ee3f-3db8-96ca-1c5ce78de930",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
          "id" : "f5ea6fb0-9706-347f-862f-5802aa2cf5b0",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
          "id" : "9f5692f9-21e1-3f2f-b1e2-8a55c6abee06",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
        "identifier" : "022f9778-725e-3d60-ac1a-8ed1bc3d9923",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
          "id" : "51f3d9b1-1ab8-3422-919c-57e6f92abf82",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
          "id" : "bde7c7e7-5df8-36b4-a1fa-74847a5a5deb",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
        "identifier" : "6ae266d8-f55d-35e7-ad26-211a9217dd1f",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
          "id" : "d60fa9ec-18f5-316a-8b75-58a4cbb697c6",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
        "identifier" : "d60fa9ec-18f5-316a-8b75-58a4cbb697c6",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LuuTrangThaiBCHienTai",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
        "identifier" : "65bcb24e-8e54-3675-a6b5-0ae09b42b758",
        "name" : "stateBcOut",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 1552.0,
          "y" : -154.5
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -200.0,
        "y" : 2880.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
        "identifier" : "51f3d9b1-1ab8-3422-919c-57e6f92abf82",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${stateBc.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
        "identifier" : "f5ea6fb0-9706-347f-862f-5802aa2cf5b0",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${stateBc.name}\",\n  \"isActive\": ${stateBc.isActive},\n  \"lastExecutionTime\": \"${stateBc.lastExecutionTime}\",\n  \"startTime\": \"${stateBc.startTime}\",\n  \"endTime\": \"${stateBc.endTime}\",\n  \"status\": \"${stateBc.status}\",\n  \"sequenceNumber\": \"${stateBc.sequenceNumber}\",\n  \"message\": \"${stateBc.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
        "identifier" : "9f5692f9-21e1-3f2f-b1e2-8a55c6abee06",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "43b7b7f7-e310-345c-a56b-2dbf50856cb3",
        "identifier" : "bde7c7e7-5df8-36b4-a1fa-74847a5a5deb",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "filename" : "${stateBc.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateBc.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateBc.lastExecutionTime" : {
            "displayName" : "stateBc.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateBc.lastExecutionTime",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
          "id" : "666add7a-1036-3107-bd56-eeb4843f46dc",
          "name" : "KhoiTao",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
        "identifier" : "dd11dcf2-566e-3fce-a2f1-ce27f849fe41",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
          "id" : "1a632db3-5e0a-3171-a2d6-70b126d62f39",
          "name" : "Input",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 11
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
          "id" : "929e8512-f37d-3887-aa33-e32879df6c86",
          "name" : "TrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
        "identifier" : "62c0603d-ace6-34fa-bb94-b5916d80da28",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "TrangTiep",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "nextPage" ],
        "source" : {
          "comments" : "",
          "groupId" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
          "id" : "78e62aa6-dbdc-3752-b5b9-e65f192bd978",
          "name" : "KiemTraCoTrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "zIndex" : 6
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
          "id" : "78e62aa6-dbdc-3752-b5b9-e65f192bd978",
          "name" : "KiemTraCoTrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
        "identifier" : "ddbb9a80-74da-347a-893c-cce46f2ad758",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "id" : "2b7988a6-cdb1-37cb-bc25-08fca8d55111",
          "name" : "Ouput",
          "type" : "OUTPUT_PORT"
        },
        "zIndex" : 3
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "id" : "b3dca3ba-63bf-33e4-b315-813ee7abd206",
          "name" : "Input",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
        "identifier" : "51989627-8f85-30c9-94fb-aceb57999f98",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
          "id" : "666add7a-1036-3107-bd56-eeb4843f46dc",
          "name" : "KhoiTao",
          "type" : "PROCESSOR"
        },
        "zIndex" : 2
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "id" : "b3dca3ba-63bf-33e4-b315-813ee7abd206",
          "name" : "Input",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
        "identifier" : "982db4a5-daa3-3446-81ab-21328abc2002",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
          "id" : "929e8512-f37d-3887-aa33-e32879df6c86",
          "name" : "TrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "zIndex" : 7
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
          "id" : "4828f287-46ce-3813-a778-625818bcafe5",
          "name" : "Output",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
        "identifier" : "74db537a-4cf2-3f73-a870-0427e009d54e",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "unmatched" ],
        "source" : {
          "comments" : "",
          "groupId" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
          "id" : "78e62aa6-dbdc-3752-b5b9-e65f192bd978",
          "name" : "KiemTraCoTrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "zIndex" : 10
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
        "identifier" : "1a632db3-5e0a-3171-a2d6-70b126d62f39",
        "name" : "Input",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -344.0,
          "y" : -256.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "ETLGmvMaxProduct",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
        "identifier" : "4828f287-46ce-3813-a778-625818bcafe5",
        "name" : "Output",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 72.0,
          "y" : 856.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "TikTokETL",
      "position" : {
        "x" : -200.0,
        "y" : 3728.0
      },
      "processGroups" : [ {
        "comments" : "",
        "componentType" : "PROCESS_GROUP",
        "connections" : [ {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "id" : "8254b29f-5c2d-310d-a815-b18367a9045d",
            "name" : "stateCamBatch",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "d0bb177b-7db6-3b76-8287-9698b5e1ae99",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "id" : "123dffbf-677b-3fbc-a158-ffa8f74dda40",
            "name" : "stateStore",
            "type" : "OUTPUT_PORT"
          },
          "zIndex" : 32
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "32b11acf-f563-3eac-a3a1-dd018014fcaa",
            "name" : "RouteOnAttributeCheckLastPage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "236f50d7-087d-3978-86a9-237de13fd4bc",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "fc115f5a-433f-32a4-894d-6c4b7fa02d7b",
            "name" : "InsertAndUpdateToDataBase",
            "type" : "PROCESSOR"
          },
          "zIndex" : 23
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "2b7988a6-cdb1-37cb-bc25-08fca8d55111",
            "name" : "Ouput",
            "type" : "OUTPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "94daf46c-bf72-3666-acf0-d16c7528fb9b",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "9b33f39e-382f-39f5-8843-42395fce7e05",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "zIndex" : 7
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "2b7988a6-cdb1-37cb-bc25-08fca8d55111",
            "name" : "Ouput",
            "type" : "OUTPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "b6fda49c-48c7-3a24-96d1-51106290d127",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success", "failure", "not found" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "5790e481-70d2-338f-ba8f-262473e7253e",
            "name" : "CleanupTemp",
            "type" : "PROCESSOR"
          },
          "zIndex" : 15
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "9b33f39e-382f-39f5-8843-42395fce7e05",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "177cffdb-5990-35a6-9bb0-ee6bf36999f1",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success", "failure", "not found" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "eca70d6d-a620-36b6-ad2e-8cfa1a990f46",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "zIndex" : 28
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "1279f327-bf81-3602-b4d6-12ad79553f9f",
            "name" : "SaveRawTemp",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "9865d9d5-4d97-39af-a18c-11bded60de06",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "hasData" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "c84b25a1-559b-3028-9e94-49af220040e5",
            "name" : "CheckHasData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 17
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "eca70d6d-a620-36b6-ad2e-8cfa1a990f46",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "82e0f4e0-c95b-31a0-a4e1-3bf2634224fc",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "52e40b16-58f1-39a2-b104-399d0e3f49ca",
            "name" : "TransformData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 22
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "id" : "1335184a-369f-39a2-a068-2352aa53c9a9",
            "name" : "stateCamBatch",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "cd986c3a-d2c2-3426-97b2-a8dad06e8f85",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "id" : "202de4bf-3c5c-3042-bfcc-43a4ffb6e750",
            "name" : "stateCam",
            "type" : "OUTPUT_PORT"
          },
          "zIndex" : 30
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "4b1310d9-863b-36fe-a025-b9c0e07e149f",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "3a937f58-ea7c-3fdd-892f-5584631888d2",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "4c0bb538-025f-3c1e-bfd2-4288961a88a7",
            "name" : "LayDanhSachProductChuaETL",
            "type" : "PROCESSOR"
          },
          "zIndex" : 3
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "eca70d6d-a620-36b6-ad2e-8cfa1a990f46",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "b33bad92-2577-356b-bcc5-bd67ec0bab25",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "0ae1940d-7fa9-3e2e-9251-785bc339b70f",
            "name" : "LayDanhSachDuLieuETLCu",
            "type" : "PROCESSOR"
          },
          "zIndex" : 19
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "0ae1940d-7fa9-3e2e-9251-785bc339b70f",
            "name" : "LayDanhSachDuLieuETLCu",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "137a60b6-6daa-3a85-aaea-8d769036d9ee",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "id" : "ce9d2283-cec9-341d-8b27-ef09071bfba4",
            "name" : "stateProduct",
            "type" : "OUTPUT_PORT"
          },
          "zIndex" : 33
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "9b33f39e-382f-39f5-8843-42395fce7e05",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "96a38bfa-03ab-35b5-b5ae-fc4ae72489f8",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "4c0bb538-025f-3c1e-bfd2-4288961a88a7",
            "name" : "LayDanhSachProductChuaETL",
            "type" : "PROCESSOR"
          },
          "zIndex" : 4
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "id" : "726c47e9-d071-327e-807d-dfdc8953efde",
            "name" : "stateCamBatch",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "0f034133-70ff-37bc-a99a-63731d0e8a90",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "1279f327-bf81-3602-b4d6-12ad79553f9f",
            "name" : "SaveRawTemp",
            "type" : "PROCESSOR"
          },
          "zIndex" : 29
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "52e40b16-58f1-39a2-b104-399d0e3f49ca",
            "name" : "TransformData",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "f35eb5fe-c69b-3e77-a1eb-05bf8f9d8d75",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "2a69ecd3-7cc4-3f91-a00e-7d2f58597a04",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "zIndex" : 20
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "e22b8d68-78f1-3555-9bd0-0c963e198fe1",
            "name" : "ChuanHoaDuLieuRaw",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "cb25de5f-cbdc-3a52-8147-e0f517750dbc",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "4b1310d9-863b-36fe-a025-b9c0e07e149f",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "zIndex" : 5
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "4c0bb538-025f-3c1e-bfd2-4288961a88a7",
            "name" : "LayDanhSachProductChuaETL",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "1904a864-d1a9-38d4-bcb8-21f469586944",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "faeb278f-0779-3c0c-a0c3-7a99e4a9ab99",
            "name" : "KhoiTao",
            "type" : "PROCESSOR"
          },
          "zIndex" : 2
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "c84b25a1-559b-3028-9e94-49af220040e5",
            "name" : "CheckHasData",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "491c906a-f95f-3fda-9f46-23529956a5a7",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "e22b8d68-78f1-3555-9bd0-0c963e198fe1",
            "name" : "ChuanHoaDuLieuRaw",
            "type" : "PROCESSOR"
          },
          "zIndex" : 8
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "9b33f39e-382f-39f5-8843-42395fce7e05",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "2ae78914-803b-336a-9361-bd077ca764c3",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "NoNewData",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "unmatched" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "c84b25a1-559b-3028-9e94-49af220040e5",
            "name" : "CheckHasData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 10
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "5790e481-70d2-338f-ba8f-262473e7253e",
            "name" : "CleanupTemp",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "ce69004a-310b-38fb-bf4e-001932fc36fd",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "f223349f-a7e2-338f-b693-e510ac1912a4",
            "name" : "UpdateAttributeContinueTrue",
            "type" : "PROCESSOR"
          },
          "zIndex" : 24
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "f223349f-a7e2-338f-b693-e510ac1912a4",
            "name" : "UpdateAttributeContinueTrue",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "b6dc7f79-01a8-389e-9ea8-c702392cc00e",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "unmatched" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "32b11acf-f563-3eac-a3a1-dd018014fcaa",
            "name" : "RouteOnAttributeCheckLastPage",
            "type" : "PROCESSOR"
          },
          "zIndex" : 27
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "9b33f39e-382f-39f5-8843-42395fce7e05",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "fe954228-9db1-37ea-bea9-c169ba9b1fc3",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "1279f327-bf81-3602-b4d6-12ad79553f9f",
            "name" : "SaveRawTemp",
            "type" : "PROCESSOR"
          },
          "zIndex" : 14
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "9b33f39e-382f-39f5-8843-42395fce7e05",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "5776f64d-cd9b-3667-9a7f-adf43dcc43db",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "e22b8d68-78f1-3555-9bd0-0c963e198fe1",
            "name" : "ChuanHoaDuLieuRaw",
            "type" : "PROCESSOR"
          },
          "zIndex" : 9
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "faeb278f-0779-3c0c-a0c3-7a99e4a9ab99",
            "name" : "KhoiTao",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "78abcc37-3210-3229-a2a3-ce19d5165e6e",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "b3dca3ba-63bf-33e4-b315-813ee7abd206",
            "name" : "Input",
            "type" : "INPUT_PORT"
          },
          "zIndex" : 1
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "fc115f5a-433f-32a4-894d-6c4b7fa02d7b",
            "name" : "InsertAndUpdateToDataBase",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "730578d2-bdb0-3c30-8bc4-c5a673985d01",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "52e40b16-58f1-39a2-b104-399d0e3f49ca",
            "name" : "TransformData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 21
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "eca70d6d-a620-36b6-ad2e-8cfa1a990f46",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "fcab5fcc-fb86-3ea1-8415-542db5aab2e0",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "isLastPage" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "32b11acf-f563-3eac-a3a1-dd018014fcaa",
            "name" : "RouteOnAttributeCheckLastPage",
            "type" : "PROCESSOR"
          },
          "zIndex" : 26
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "2a69ecd3-7cc4-3f91-a00e-7d2f58597a04",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "9816402b-b112-3f25-80d7-fbdc6edab961",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "0ae1940d-7fa9-3e2e-9251-785bc339b70f",
            "name" : "LayDanhSachDuLieuETLCu",
            "type" : "PROCESSOR"
          },
          "zIndex" : 18
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "9b33f39e-382f-39f5-8843-42395fce7e05",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "fea4c457-0bef-3210-924e-cc1c771f2ac9",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "4b1310d9-863b-36fe-a025-b9c0e07e149f",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "zIndex" : 6
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "eca70d6d-a620-36b6-ad2e-8cfa1a990f46",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "92ad9057-3708-34a9-961a-c2d6a4effe04",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
            "id" : "fc115f5a-433f-32a4-894d-6c4b7fa02d7b",
            "name" : "InsertAndUpdateToDataBase",
            "type" : "PROCESSOR"
          },
          "zIndex" : 25
        } ],
        "controllerServices" : [ ],
        "defaultBackPressureDataSizeThreshold" : "1 GB",
        "defaultBackPressureObjectThreshold" : 10000,
        "defaultFlowFileExpiration" : "0 sec",
        "executionEngine" : "INHERITED",
        "flowFileConcurrency" : "UNBOUNDED",
        "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
        "funnels" : [ ],
        "groupIdentifier" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
        "identifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
        "inputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "INPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "b3dca3ba-63bf-33e4-b315-813ee7abd206",
          "name" : "Input",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : -598.5404968261719,
            "y" : -248.0
          },
          "scheduledState" : "ENABLED",
          "type" : "INPUT_PORT"
        } ],
        "labels" : [ ],
        "maxConcurrentTasks" : 1,
        "name" : "ETLGmvMaxProductBatch",
        "outputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "OUTPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "2b7988a6-cdb1-37cb-bc25-08fca8d55111",
          "name" : "Ouput",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : 472.0,
            "y" : 1008.0
          },
          "scheduledState" : "ENABLED",
          "type" : "OUTPUT_PORT"
        } ],
        "parameterContextName" : "ETL",
        "position" : {
          "x" : 8.0,
          "y" : 184.0
        },
        "processGroups" : [ {
          "comments" : "",
          "componentType" : "PROCESS_GROUP",
          "connections" : [ {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "41acfc8d-796e-3292-a1b5-a4390f02bf65",
              "name" : "ThucThiThemMoiProduct",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "28e17032-985f-38b1-b558-2afc3ae3184b",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "b5d262c9-1566-3107-bfd8-4e054025acd9",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "zIndex" : 12
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "a3161867-5f0d-30ff-aef0-983d4a7aba7d",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "86f50e94-b1f8-3bdc-bd15-a2377154ecbc",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "d032b404-d8de-3387-abef-d6434d03fd9a",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "zIndex" : 3
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "4513c18e-9cfc-3980-b06e-0d48619836b7",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "00ad23b2-c90b-3742-954d-929dd4d03cd6",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "b5d262c9-1566-3107-bfd8-4e054025acd9",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "zIndex" : 13
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "b5d262c9-1566-3107-bfd8-4e054025acd9",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "f84b50c5-2e15-3bc8-8446-b6ec4246a4bd",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "has_new_product", "unmatched" ],
            "source" : {
              "comments" : "",
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "a3161867-5f0d-30ff-aef0-983d4a7aba7d",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "zIndex" : 14
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "4513c18e-9cfc-3980-b06e-0d48619836b7",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "105f4df7-e83f-3650-93ce-2af135ac2879",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "41acfc8d-796e-3292-a1b5-a4390f02bf65",
              "name" : "ThucThiThemMoiProduct",
              "type" : "PROCESSOR"
            },
            "zIndex" : 10
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "ce9d2283-cec9-341d-8b27-ef09071bfba4",
              "name" : "stateProduct",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "20c471d1-cacc-3377-b194-a81f8d9ef1f5",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "41acfc8d-796e-3292-a1b5-a4390f02bf65",
              "name" : "ThucThiThemMoiProduct",
              "type" : "PROCESSOR"
            },
            "zIndex" : 9
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "577dfe08-cd5f-3548-acf7-82744ab952b1",
              "name" : "KhoiTao",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "737d2f6d-8437-3012-a2b6-600a75e22841",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "8254b29f-5c2d-310d-a815-b18367a9045d",
              "name" : "stateCamBatch",
              "type" : "INPUT_PORT"
            },
            "zIndex" : 1
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "d032b404-d8de-3387-abef-d6434d03fd9a",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "10089ed0-4114-3c55-9bcf-fddbe217c289",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "577dfe08-cd5f-3548-acf7-82744ab952b1",
              "name" : "KhoiTao",
              "type" : "PROCESSOR"
            },
            "zIndex" : 2
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "4513c18e-9cfc-3980-b06e-0d48619836b7",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "502447d9-0982-3e80-b9e3-6e16bef470dc",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "faf567da-f590-3de8-a492-4381d0ccfd15",
              "id" : "d032b404-d8de-3387-abef-d6434d03fd9a",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "zIndex" : 4
          } ],
          "controllerServices" : [ ],
          "defaultBackPressureDataSizeThreshold" : "1 GB",
          "defaultBackPressureObjectThreshold" : 10000,
          "defaultFlowFileExpiration" : "0 sec",
          "executionEngine" : "INHERITED",
          "flowFileConcurrency" : "UNBOUNDED",
          "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
          "funnels" : [ ],
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
          "inputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "INPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "8254b29f-5c2d-310d-a815-b18367a9045d",
            "name" : "stateCamBatch",
            "portFunction" : "STANDARD",
            "position" : {
              "x" : -560.0,
              "y" : -192.0
            },
            "scheduledState" : "ENABLED",
            "type" : "INPUT_PORT"
          } ],
          "labels" : [ ],
          "maxConcurrentTasks" : 1,
          "name" : "LayHoacThemMoiProduct",
          "outputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "OUTPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "ce9d2283-cec9-341d-8b27-ef09071bfba4",
            "name" : "stateProduct",
            "portFunction" : "STANDARD",
            "position" : {
              "x" : 2032.0,
              "y" : -176.0
            },
            "scheduledState" : "ENABLED",
            "type" : "OUTPUT_PORT"
          } ],
          "parameterContextName" : "ETL",
          "position" : {
            "x" : 3416.0,
            "y" : -280.0
          },
          "processGroups" : [ ],
          "processors" : [ {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "a3161867-5f0d-30ff-aef0-983d4a7aba7d",
            "maxBackoffPeriod" : "10 mins",
            "name" : "RouteOnAttribute",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 976.0,
              "y" : -248.0
            },
            "properties" : {
              "Routing Strategy" : "Route to Property name",
              "has_new_product" : "${product.new.count:gt(0)}"
            },
            "propertyDescriptors" : {
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              },
              "has_new_product" : {
                "displayName" : "has_new_product",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "has_new_product",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "577dfe08-cd5f-3548-acf7-82744ab952b1",
            "maxBackoffPeriod" : "10 mins",
            "name" : "KhoiTao",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : -216.0,
              "y" : -232.0
            },
            "properties" : {
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100"
            },
            "propertyDescriptors" : {
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-scripting-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "d032b404-d8de-3387-abef-d6434d03fd9a",
            "maxBackoffPeriod" : "10 mins",
            "name" : "XuLyDuLieuThemMoi",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 232.0,
              "y" : -232.0
            },
            "properties" : {
              "Script Engine" : "Groovy",
              "Script Body" : "import org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport groovy.json.JsonOutput\nimport java.time.OffsetDateTime\nimport java.time.ZoneOffset\nimport java.time.format.DateTimeFormatter\nimport java.io.File\n\ndef flowFile = session.get()\nif (!flowFile) return\n\n// ---------- Helpers ----------\ndef nowUtc = { ->\n    DateTimeFormatter fmt = DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss.SSSSSSS\")\n    OffsetDateTime.now(ZoneOffset.UTC).format(fmt)\n}\n\ndef getStr = { Map m, List<String> keys ->\n    for (k in keys) {\n        def v = m?.get(k)\n        if (v != null) {\n            def s = v.toString().trim()\n            if (s.length() > 0) return s\n        }\n    }\n    return \"\"\n}\n\n// Escape NVARCHAR cho VALUES\ndef sqlQuote = { String s ->\n    def t = (s == null) ? \"\" : s.replace(\"'\", \"''\")\n    return \"N'${t}'\"\n}\n\n// Cc bin th key cho ProductId (ItemGroupId) trong RAW \ndef PRODUCT_ID_KEYS = [\n    \"ItemGroupId\",\"itemGroupId\",\"ItemGroupID\",\n    \"ProductId\",\"productId\",\"product_id\"\n]\n\ntry {\n    // RAW Creative JSON (cha ProductId = ItemGroupId)\n    def rawPath = flowFile.getAttribute(\"stateCurrent.fullPath\")\n    if (!rawPath) {\n        def msg = \"Missing attribute: stateCurrent.fullPath\"\n        log.error(msg)\n        flowFile = session.putAttribute(flowFile, \"error.message\", msg)\n        session.transfer(flowFile, REL_FAILURE)\n        return\n    }\n\n    // ---------- Load RAW Creative ----------\n    def rawList = []\n    def f = new File(rawPath)\n    if (f.exists()) {\n        log.info(\"Reading RAW Creative file: ${rawPath}\")\n        def txt = f.getText(StandardCharsets.UTF_8.name())\n        def parsed = new JsonSlurper().parseText(txt)\n        rawList = (parsed instanceof List) ? parsed : [parsed]\n        log.info(\"RAW Creative records loaded: ${rawList.size()}\")\n        if (!rawList.isEmpty()) {\n            log.debug(\"RAW sample keys: \" + (rawList[0] as Map).keySet().join(\",\"))\n        }\n    } else {\n        log.warn(\"RAW Creative file does not exist: ${rawPath}\")\n    }\n\n    // Ly unique ProductId t RAW Creative\n    def productIds = new LinkedHashSet<String>()\n    rawList.each { r ->\n        def pid = getStr(r as Map, PRODUCT_ID_KEYS)\n        if (pid) productIds.add(pid)\n    }\n    log.info(\"Unique ProductIds (from RAW Creative): ${productIds.size()}\")\n\n    // ---------- Build SQL (INSERT & UPDATE) ----------\n\n    // 1) CTE rawp cha danh sch ProductId\n    String cteRawProducts\n    if (productIds.isEmpty()) {\n        cteRawProducts = \"SELECT CAST(NULL AS NVARCHAR(100)) AS [ProductId] WHERE 1=0\"\n    } else {\n        def valuesClause = productIds.collect { pid -> \"(\" + sqlQuote(pid) + \")\" }.join(\",\\n        \")\n        cteRawProducts = \"SELECT v.[ProductId]\\nFROM (VALUES\\n        ${valuesClause}\\n) AS v([ProductId])\"\n    }\n\n    // 2) INSERT cc ProductId CHA c trong Dim_DimProducts\n    //    -> in  mi ct NOT NULL theo schema nh 1\n    def sbInsert = new StringBuilder()\n    sbInsert.append(\";WITH rawp AS (\\n\")\n            .append(\"    \").append(cteRawProducts).append(\"\\n\")\n            .append(\"), src AS (\\n\")\n            .append(\"    SELECT DISTINCT LTRIM(RTRIM([ProductId])) AS [ProductId]\\n\")\n            .append(\"    FROM rawp\\n\")\n            .append(\"    WHERE [ProductId] IS NOT NULL AND LTRIM(RTRIM([ProductId])) <> ''\\n\")\n            .append(\"), names AS (\\n\")\n            .append(\"    SELECT \\n\")\n            .append(\"        CAST(r.[ItemGroupId] AS NVARCHAR(100))          AS [ProductId],\\n\")\n            .append(\"        MAX(CAST(r.[ProductName]     AS NVARCHAR(500)))   AS [ProductName],\\n\")\n            .append(\"        MAX(CAST(r.[ProductImageUrl] AS NVARCHAR(1000)))  AS [ProductImageUrl],\\n\")\n            .append(\"        MAX(CAST(r.[Currency]        AS NVARCHAR(10)))    AS [Currency]\\n\")\n            .append(\"    FROM dbo.[Raw_RawGmvMaxProductDetailProductReports] r WITH (NOLOCK)\\n\")\n            .append(\"    GROUP BY r.[ItemGroupId]\\n\")\n            .append(\")\\n\")\n            .append(\"INSERT INTO dbo.[Dim_DimProducts] (\\n\")\n            .append(\"    [Id],[ProductId],[ProductName],\\n\")\n            .append(\"    [SKU],[Description],[Category],[SubCategory],[Brand],\\n\")\n            .append(\"    [OriginalPrice],[CurrentPrice],[Currency],\\n\")\n            .append(\"    [Status],[StockQuantity],[AverageRating],[ReviewCount],[SoldQuantity],\\n\")\n            .append(\"    [MainImageUrl],[ProductUrl],\\n\")\n            .append(\"    [CreatedAt],[UpdatedAt],\\n\")\n            .append(\"    [EffectiveStartDate],[EffectiveEndDate],\\n\")\n            .append(\"    [CreationTime],[CreatorId],[LastModificationTime],[LastModifierId]\\n\")\n            .append(\")\\n\")\n            .append(\"SELECT\\n\")\n            .append(\"    NEWID(), s.[ProductId], LEFT(ISNULL(n.[ProductName], N''), 500),\\n\")\n            .append(\"    N'', N'', N'', N'', N'',                                  -- SKU, Description, Category, SubCategory, Brand (NOT NULL)\\n\")\n            .append(\"    NULL, 0, ISNULL(n.[Currency], N''),                        -- OriginalPrice=NULL, CurrentPrice=0 (NOT NULL), Currency (NOT NULL)\\n\")\n            .append(\"    N'ACTIVE', 0, NULL, NULL, 0,                               -- Status (NOT NULL), StockQuantity=0, Review/Rating optional, SoldQuantity=0\\n\")\n            .append(\"    ISNULL(n.[ProductImageUrl], N''), N'',                     -- MainImageUrl (NOT NULL), ProductUrl (NOT NULL)\\n\")\n            .append(\"    SYSUTCDATETIME(), SYSUTCDATETIME(),                        -- CreatedAt, UpdatedAt (NOT NULL)\\n\")\n            .append(\"    SYSUTCDATETIME(), NULL,                                    -- EffectiveStartDate (NOT NULL), EffectiveEndDate = NULL\\n\")\n            .append(\"    SYSUTCDATETIME(), NULL, NULL, NULL                         -- CreationTime (NOT NULL), CreatorId/Last* nullable\\n\")\n            .append(\"FROM src s\\n\")\n            .append(\"LEFT JOIN dbo.[Dim_DimProducts] d ON d.[ProductId] = s.[ProductId]\\n\")\n            .append(\"LEFT JOIN names n ON n.[ProductId] = s.[ProductId]\\n\")\n            .append(\"WHERE d.[ProductId] IS NULL;\")\n\n    String sqlInsert = sbInsert.toString()\n\n    // 3) UPDATE backfill t RawDetail: \n    def sbUpdate = new StringBuilder()\n    sbUpdate.append(\";WITH src AS (\\n\")\n            .append(\"    SELECT \\n\")\n            .append(\"        CAST(r.[ItemGroupId] AS NVARCHAR(100)) AS [ProductId],\\n\")\n            .append(\"        NULLIF(LTRIM(RTRIM(CAST(r.[ProductName]     AS NVARCHAR(500)))), '')  AS [ProductName],\\n\")\n            .append(\"        NULLIF(LTRIM(RTRIM(CAST(r.[ProductImageUrl] AS NVARCHAR(1000)))), '') AS [ProductImageUrl]\\n\")\n            .append(\"    FROM dbo.[Raw_RawGmvMaxProductDetailProductReports] r WITH (NOLOCK)\\n\")\n            .append(\"), agg AS (\\n\")\n            .append(\"    SELECT [ProductId],\\n\")\n            .append(\"           MAX([ProductName])     AS [ProductName],\\n\")\n            .append(\"           MAX([ProductImageUrl]) AS [ProductImageUrl]\\n\")\n            .append(\"    FROM src\\n\")\n            .append(\"    WHERE [ProductId] IS NOT NULL AND LTRIM(RTRIM([ProductId])) <> ''\\n\")\n            .append(\"    GROUP BY [ProductId]\\n\")\n            .append(\")\\n\")\n            .append(\"UPDATE d\\n\")\n            .append(\"   SET d.[ProductName]  = COALESCE(a.[ProductName], d.[ProductName]),\\n\")\n            .append(\"       d.[MainImageUrl] = COALESCE(a.[ProductImageUrl], d.[MainImageUrl]),\\n\")\n            .append(\"       d.[UpdatedAt]    = SYSUTCDATETIME(),\\n\")\n            .append(\"       d.[LastModificationTime] = SYSUTCDATETIME()\\n\")\n            .append(\"FROM dbo.[Dim_DimProducts] d\\n\")\n            .append(\"JOIN agg a ON a.[ProductId] = d.[ProductId]\\n\")\n            .append(\"WHERE (a.[ProductName]     IS NOT NULL AND (d.[ProductName]  IS NULL OR d.[ProductName]  <> a.[ProductName]))\\n\")\n            .append(\"   OR (a.[ProductImageUrl] IS NOT NULL AND (d.[MainImageUrl] IS NULL OR d.[MainImageUrl] <> a.[ProductImageUrl]));\")\n\n    String sqlUpdate = sbUpdate.toString()\n\n    // ---------- Output JSON cho processor sau ----------\n    def result = [\n        rawCount  : rawList.size(),\n        uniqueIds : productIds.size(),\n        sqlInsert : sqlInsert,\n        sqlUpdate : sqlUpdate\n    ]\n    def outJson = JsonOutput.prettyPrint(JsonOutput.toJson(result))\n\n    flowFile = session.write(flowFile, { _, outputStream ->\n        outputStream.write(outJson.getBytes(StandardCharsets.UTF_8))\n    } as StreamCallback)\n\n    flowFile = session.putAttribute(flowFile, \"product.raw.unique.ids\", String.valueOf(productIds.size()))\n    flowFile = session.putAttribute(flowFile, \"sql.update.included\", \"1\")\n    log.info(\"GetOrAddProduct (Creative->Dim via Detail) completed successfully\")\n    session.transfer(flowFile, REL_SUCCESS)\n\n} catch (Throwable t) {\n    log.error(\"GetOrAddProduct script failed\", t)\n    flowFile = session.putAttribute(flowFile, \"error.message\", t.getMessage())\n    session.transfer(flowFile, REL_FAILURE)\n}"
            },
            "propertyDescriptors" : {
              "Script File" : {
                "displayName" : "Script File",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script File",
                "resourceDefinition" : {
                  "cardinality" : "SINGLE",
                  "resourceTypes" : [ "FILE" ]
                },
                "sensitive" : false
              },
              "Script Engine" : {
                "displayName" : "Script Engine",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Engine",
                "sensitive" : false
              },
              "Script Body" : {
                "displayName" : "Script Body",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Body",
                "sensitive" : false
              },
              "Module Directory" : {
                "displayName" : "Module Directory",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Module Directory",
                "resourceDefinition" : {
                  "cardinality" : "MULTIPLE",
                  "resourceTypes" : [ "FILE", "DIRECTORY" ]
                },
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.script.ExecuteScript",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "retry" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "41acfc8d-796e-3292-a1b5-a4390f02bf65",
            "maxBackoffPeriod" : "10 mins",
            "name" : "ThucThiThemMoiProduct",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 1600.0,
              "y" : 72.0
            },
            "properties" : {
              "Support Fragmented Transactions" : "false",
              "Batch Size" : "#{PageSizeMax}",
              "Obtain Generated Keys" : "false",
              "JDBC Connection Pool" : "6fce9190-8f74-3a75-9e56-36c3f8fc6d63",
              "database-session-autocommit" : "true",
              "rollback-on-failure" : "false"
            },
            "propertyDescriptors" : {
              "Support Fragmented Transactions" : {
                "displayName" : "Support Fragmented Transactions",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Support Fragmented Transactions",
                "sensitive" : false
              },
              "putsql-sql-statement" : {
                "displayName" : "SQL Statement",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "putsql-sql-statement",
                "sensitive" : false
              },
              "Transaction Timeout" : {
                "displayName" : "Transaction Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Transaction Timeout",
                "sensitive" : false
              },
              "Batch Size" : {
                "displayName" : "Batch Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Batch Size",
                "sensitive" : false
              },
              "Obtain Generated Keys" : {
                "displayName" : "Obtain Generated Keys",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Obtain Generated Keys",
                "sensitive" : false
              },
              "JDBC Connection Pool" : {
                "displayName" : "JDBC Connection Pool",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "JDBC Connection Pool",
                "sensitive" : false
              },
              "database-session-autocommit" : {
                "displayName" : "Database Session AutoCommit",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "database-session-autocommit",
                "sensitive" : false
              },
              "rollback-on-failure" : {
                "displayName" : "Rollback On Failure",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "rollback-on-failure",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.PutSQL",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-scripting-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "b5d262c9-1566-3107-bfd8-4e054025acd9",
            "maxBackoffPeriod" : "10 mins",
            "name" : "GhiDeCauLenhSqlVaoContentFlow",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 968.0,
              "y" : 56.0
            },
            "properties" : {
              "Script Engine" : "Groovy",
              "Script Body" : "import groovy.json.JsonSlurper\nimport org.apache.commons.io.IOUtils\nimport java.nio.charset.StandardCharsets\nimport org.apache.nifi.processor.io.StreamCallback\n\ndef flowFile = session.get()\nif (!flowFile) return\n\nflowFile = session.write(flowFile, { inputStream, outputStream ->\n    def jsonText = IOUtils.toString(inputStream, StandardCharsets.UTF_8)\n    def obj = new JsonSlurper().parseText(jsonText)\n\n    def parts = []\n    if (obj.sqlUpdate && obj.sqlUpdate.toString().trim()) parts << obj.sqlUpdate.toString().trim()\n    if (obj.sqlInsert && obj.sqlInsert.toString().trim()) parts << obj.sqlInsert.toString().trim()\n\n    def sql = parts.join(\"\\n\")\n    outputStream.write(sql.getBytes(StandardCharsets.UTF_8))\n} as StreamCallback)\n\nsession.transfer(flowFile, REL_SUCCESS)"
            },
            "propertyDescriptors" : {
              "Script File" : {
                "displayName" : "Script File",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script File",
                "resourceDefinition" : {
                  "cardinality" : "SINGLE",
                  "resourceTypes" : [ "FILE" ]
                },
                "sensitive" : false
              },
              "Script Engine" : {
                "displayName" : "Script Engine",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Engine",
                "sensitive" : false
              },
              "Script Body" : {
                "displayName" : "Script Body",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Body",
                "sensitive" : false
              },
              "Module Directory" : {
                "displayName" : "Module Directory",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Module Directory",
                "resourceDefinition" : {
                  "cardinality" : "MULTIPLE",
                  "resourceTypes" : [ "FILE", "DIRECTORY" ]
                },
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.script.ExecuteScript",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "success" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "faf567da-f590-3de8-a492-4381d0ccfd15",
            "identifier" : "4513c18e-9cfc-3980-b06e-0d48619836b7",
            "maxBackoffPeriod" : "10 mins",
            "name" : "LogMessage",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 968.0,
              "y" : 456.0
            },
            "properties" : {
              "log-level" : "info"
            },
            "propertyDescriptors" : {
              "log-message" : {
                "displayName" : "Log message",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-message",
                "sensitive" : false
              },
              "log-level" : {
                "displayName" : "Log Level",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-level",
                "sensitive" : false
              },
              "log-prefix" : {
                "displayName" : "Log prefix",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-prefix",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.LogMessage",
            "yieldDuration" : "1 sec"
          } ],
          "remoteProcessGroups" : [ ],
          "scheduledState" : "ENABLED",
          "statelessFlowTimeout" : "1 min"
        }, {
          "comments" : "",
          "componentType" : "PROCESS_GROUP",
          "connections" : [ {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "32d767fa-de5c-359a-b7ee-ef4ebe08dc53",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "5d15f19e-0185-3e04-8545-9f45318ebf36",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "bad9b90c-08de-3da5-8d4e-d38a5b31edea",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "zIndex" : 12
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "c9244a84-fdbb-3e58-9e5a-040700c17df4",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "fac0aa75-6e6b-3880-9df7-66221ffa32f2",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "40fe6127-24f8-3052-956b-35ecfe5ce177",
              "name" : "KhoiTao",
              "type" : "PROCESSOR"
            },
            "zIndex" : 2
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "01a6c7d5-62db-3ec0-a929-14f1c52b254a",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "47f49030-3f30-3ed8-b9e4-538e06a6ae3e",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "c9244a84-fdbb-3e58-9e5a-040700c17df4",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "zIndex" : 3
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "40fe6127-24f8-3052-956b-35ecfe5ce177",
              "name" : "KhoiTao",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "87c0e16b-fbda-3d7d-af07-f6d663f94f36",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "726c47e9-d071-327e-807d-dfdc8953efde",
              "name" : "stateCamBatch",
              "type" : "INPUT_PORT"
            },
            "zIndex" : 1
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "202de4bf-3c5c-3042-bfcc-43a4ffb6e750",
              "name" : "stateCam",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "55bac32a-9c8a-32f2-9f3f-d07259c06adc",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "6c226012-7fd2-3abf-925a-ac511ab153fa",
              "name" : "ThucThiThemMoiCam",
              "type" : "PROCESSOR"
            },
            "zIndex" : 9
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "bad9b90c-08de-3da5-8d4e-d38a5b31edea",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "1d1f35c2-93de-3739-a1db-e3b383d3877f",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "new_cams", "unmatched" ],
            "source" : {
              "comments" : "",
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "01a6c7d5-62db-3ec0-a929-14f1c52b254a",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "zIndex" : 5
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "32d767fa-de5c-359a-b7ee-ef4ebe08dc53",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "b3523730-22be-326d-b414-909e96d0c31c",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "6c226012-7fd2-3abf-925a-ac511ab153fa",
              "name" : "ThucThiThemMoiCam",
              "type" : "PROCESSOR"
            },
            "zIndex" : 10
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "6c226012-7fd2-3abf-925a-ac511ab153fa",
              "name" : "ThucThiThemMoiCam",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "b20277ba-91db-3231-bed5-193e257700c4",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "bad9b90c-08de-3da5-8d4e-d38a5b31edea",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "zIndex" : 11
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "32d767fa-de5c-359a-b7ee-ef4ebe08dc53",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "44cda065-fcd2-347b-953f-5a854473ac85",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
              "id" : "c9244a84-fdbb-3e58-9e5a-040700c17df4",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "zIndex" : 4
          } ],
          "controllerServices" : [ ],
          "defaultBackPressureDataSizeThreshold" : "1 GB",
          "defaultBackPressureObjectThreshold" : 10000,
          "defaultFlowFileExpiration" : "0 sec",
          "executionEngine" : "INHERITED",
          "flowFileConcurrency" : "UNBOUNDED",
          "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
          "funnels" : [ ],
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
          "inputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "INPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "726c47e9-d071-327e-807d-dfdc8953efde",
            "name" : "stateCamBatch",
            "portFunction" : "STANDARD",
            "position" : {
              "x" : -560.0000016432713,
              "y" : -190.5000198460608
            },
            "scheduledState" : "ENABLED",
            "type" : "INPUT_PORT"
          } ],
          "labels" : [ ],
          "maxConcurrentTasks" : 1,
          "name" : "LayHoacThemMoiCam",
          "outputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "OUTPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "202de4bf-3c5c-3042-bfcc-43a4ffb6e750",
            "name" : "stateCam",
            "portFunction" : "STANDARD",
            "position" : {
              "x" : 2032.0,
              "y" : -176.0
            },
            "scheduledState" : "ENABLED",
            "type" : "OUTPUT_PORT"
          } ],
          "parameterContextName" : "ETL",
          "position" : {
            "x" : 2416.0,
            "y" : -288.0
          },
          "processGroups" : [ ],
          "processors" : [ {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "40fe6127-24f8-3052-956b-35ecfe5ce177",
            "maxBackoffPeriod" : "10 mins",
            "name" : "KhoiTao",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : -216.0,
              "y" : -232.0
            },
            "properties" : {
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100"
            },
            "propertyDescriptors" : {
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "retry" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "6c226012-7fd2-3abf-925a-ac511ab153fa",
            "maxBackoffPeriod" : "10 mins",
            "name" : "ThucThiThemMoiCam",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 1600.0,
              "y" : 72.0
            },
            "properties" : {
              "Support Fragmented Transactions" : "false",
              "Batch Size" : "#{PageSizeMax}",
              "Obtain Generated Keys" : "false",
              "JDBC Connection Pool" : "6fce9190-8f74-3a75-9e56-36c3f8fc6d63",
              "database-session-autocommit" : "true",
              "rollback-on-failure" : "false"
            },
            "propertyDescriptors" : {
              "Support Fragmented Transactions" : {
                "displayName" : "Support Fragmented Transactions",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Support Fragmented Transactions",
                "sensitive" : false
              },
              "putsql-sql-statement" : {
                "displayName" : "SQL Statement",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "putsql-sql-statement",
                "sensitive" : false
              },
              "Transaction Timeout" : {
                "displayName" : "Transaction Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Transaction Timeout",
                "sensitive" : false
              },
              "Batch Size" : {
                "displayName" : "Batch Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Batch Size",
                "sensitive" : false
              },
              "Obtain Generated Keys" : {
                "displayName" : "Obtain Generated Keys",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Obtain Generated Keys",
                "sensitive" : false
              },
              "JDBC Connection Pool" : {
                "displayName" : "JDBC Connection Pool",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "JDBC Connection Pool",
                "sensitive" : false
              },
              "database-session-autocommit" : {
                "displayName" : "Database Session AutoCommit",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "database-session-autocommit",
                "sensitive" : false
              },
              "rollback-on-failure" : {
                "displayName" : "Rollback On Failure",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "rollback-on-failure",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.PutSQL",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "01a6c7d5-62db-3ec0-a929-14f1c52b254a",
            "maxBackoffPeriod" : "10 mins",
            "name" : "RouteOnAttribute",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 1016.0,
              "y" : -208.0
            },
            "properties" : {
              "Routing Strategy" : "Route to Property name",
              "new_cams" : "${cams.new.count:gt(0)}"
            },
            "propertyDescriptors" : {
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              },
              "new_cams" : {
                "displayName" : "new_cams",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "new_cams",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-scripting-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "bad9b90c-08de-3da5-8d4e-d38a5b31edea",
            "maxBackoffPeriod" : "10 mins",
            "name" : "GhiDeCauLenhSqlVaoContentFlow",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 1008.0,
              "y" : 48.0
            },
            "properties" : {
              "Script Engine" : "Groovy",
              "Script Body" : "import groovy.json.JsonSlurper\nimport org.apache.commons.io.IOUtils\nimport java.nio.charset.StandardCharsets\n\ndef flowFile = session.get()\nif (!flowFile) return\n\nflowFile = session.write(flowFile, { inputStream, outputStream ->\n    def jsonText = IOUtils.toString(inputStream, StandardCharsets.UTF_8)\n    def obj = new JsonSlurper().parseText(jsonText)\n\n    def parts = []\n    if (obj.sqlUpdate && obj.sqlUpdate.toString().trim()) parts << obj.sqlUpdate.toString().trim()\n    if (obj.sqlInsert && obj.sqlInsert.toString().trim()) parts << obj.sqlInsert.toString().trim()\n\n    def sql = parts.join(\"\\n\")\n    outputStream.write(sql.getBytes(StandardCharsets.UTF_8))\n} as StreamCallback)\n\nsession.transfer(flowFile, REL_SUCCESS)"
            },
            "propertyDescriptors" : {
              "Script File" : {
                "displayName" : "Script File",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script File",
                "resourceDefinition" : {
                  "cardinality" : "SINGLE",
                  "resourceTypes" : [ "FILE" ]
                },
                "sensitive" : false
              },
              "Script Engine" : {
                "displayName" : "Script Engine",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Engine",
                "sensitive" : false
              },
              "Script Body" : {
                "displayName" : "Script Body",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Body",
                "sensitive" : false
              },
              "Module Directory" : {
                "displayName" : "Module Directory",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Module Directory",
                "resourceDefinition" : {
                  "cardinality" : "MULTIPLE",
                  "resourceTypes" : [ "FILE", "DIRECTORY" ]
                },
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.script.ExecuteScript",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "success" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "32d767fa-de5c-359a-b7ee-ef4ebe08dc53",
            "maxBackoffPeriod" : "10 mins",
            "name" : "LogMessage",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 968.0,
              "y" : 456.0
            },
            "properties" : {
              "log-level" : "info"
            },
            "propertyDescriptors" : {
              "log-message" : {
                "displayName" : "Log message",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-message",
                "sensitive" : false
              },
              "log-level" : {
                "displayName" : "Log Level",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-level",
                "sensitive" : false
              },
              "log-prefix" : {
                "displayName" : "Log prefix",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-prefix",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.LogMessage",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-scripting-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "a9f6b46b-dced-3878-8c01-39848ad0b0e1",
            "identifier" : "c9244a84-fdbb-3e58-9e5a-040700c17df4",
            "maxBackoffPeriod" : "10 mins",
            "name" : "XuLyDuLieuThemMoi",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 272.0,
              "y" : -224.0
            },
            "properties" : {
              "Script Engine" : "Groovy",
              "Script Body" : "import org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport groovy.json.JsonOutput\nimport java.nio.file.Files\nimport java.nio.file.Paths\nimport java.time.OffsetDateTime\nimport java.time.ZoneOffset\nimport java.time.format.DateTimeFormatter\nimport java.util.UUID\n\ndef flowFile = session.get()\nif (!flowFile) return\n\n// ---------- Helpers ----------\ndef escapeSql = { String s ->\n    if (s == null) return null\n    return s.replace(\"'\", \"''\")\n}\n\ndef nowUtc = { ->\n    DateTimeFormatter fmt = DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss.SSSSSSS\")\n    OffsetDateTime.now(ZoneOffset.UTC).format(fmt)\n}\n\n// Ly chui theo nhiu key kh d\ndef getStr = { Map m, List<String> keys ->\n    for (k in keys) {\n        def v = m?.get(k)\n        if (v != null && v.toString().trim().length() > 0) return v.toString()\n    }\n    return \"\"\n}\n\ntry {\n    def rawPath   = flowFile.getAttribute(\"stateCurrent.fullPath\")\n    def dimAAPath = flowFile.getAttribute(\"stateAdAccounts.fullpath\")\n    def camsPath  = flowFile.getAttribute(\"stateCams.fullpath\")\n\n    log.info(\"Starting GetOrAddCam process\")\n    log.info(\"Raw path: ${rawPath}\")\n    log.info(\"DimAA path: ${dimAAPath}\")\n    log.info(\"Cams path: ${camsPath}\")\n\n    if (!rawPath || !dimAAPath || !camsPath) {\n        def miss = []\n        if (!rawPath)   miss << \"stateCurrent.fullPath\"\n        if (!dimAAPath) miss << \"stateAdAccounts.fullpath\"\n        if (!camsPath)  miss << \"stateCams.fullpath\"\n        def errorMsg = \"Missing attributes: \" + miss.join(\", \")\n        log.error(errorMsg)\n        flowFile = session.putAttribute(flowFile, \"error.message\", errorMsg)\n        session.transfer(flowFile, REL_FAILURE)\n        return\n    }\n\n    // ---------- Load RAW ----------\n    def rawList = []\n    if (rawPath) {\n        def f = new File(rawPath)\n        if (f.exists()) {\n            log.info(\"Reading RAW file: ${rawPath}\")\n            def txt = f.getText(StandardCharsets.UTF_8.name())\n            log.info(\"RAW file content length: ${txt.length()}\")\n            def parsed = new JsonSlurper().parseText(txt)\n            rawList = (parsed instanceof List) ? parsed : [parsed]\n            log.info(\"RAW records loaded: ${rawList.size()}\")\n        } else {\n            log.warn(\"RAW file does not exist: ${rawPath}\")\n        }\n    }\n\n    // Map tn chin dch t RAW hin ti ( dng cho INSERT)\n    // key = \"AdvertiserId|CampaignId\" ; value = CampaignName\n    def nameMap = [:]\n    rawList.each { r ->\n        def adv = getStr(r as Map, [\"AdvertiserId\",\"advertiserId\",\"AdAccountId\",\"adAccountId\",\"advertiser_id\"])\n        def cid = getStr(r as Map, [\"CampaignId\",\"campaignId\",\"campaign_id\",\"Id\",\"id\"])\n        def cn  = getStr(r as Map, [\"CampaignName\",\"campaignName\",\"campaign_name\",\"Name\",\"name\",\"title\"])\n        if (adv && cid && cn) {\n            nameMap[\"${adv}|${cid}\"] = cn\n        }\n    }\n    log.info(\"CampaignName map entries: ${nameMap.size()}\")\n\n    // ---------- Load DimAA ----------\n    def dimAAList = []\n    if (dimAAPath) {\n        def f = new File(dimAAPath)\n        if (f.exists()) {\n            log.info(\"Reading DimAA file: ${dimAAPath}\")\n            def txt = f.getText(StandardCharsets.UTF_8.name())\n            log.info(\"DimAA file content length: ${txt.length()}\")\n            def parsed = new JsonSlurper().parseText(txt)\n            dimAAList = (parsed instanceof List) ? parsed : [parsed]\n            log.info(\"DimAA records loaded: ${dimAAList.size()}\")\n        } else {\n            log.warn(\"DimAA file does not exist: ${dimAAPath}\")\n        }\n    }\n\n    // ---------- Load Cams ----------\n    def camsList = []\n    if (camsPath) {\n        def f = new File(camsPath)\n        if (f.exists()) {\n            log.info(\"Reading Cams file: ${camsPath}\")\n            def txt = f.getText(StandardCharsets.UTF_8.name())\n            log.info(\"Cams file content length: ${txt.length()}\")\n            def parsed = new JsonSlurper().parseText(txt)\n            camsList = (parsed instanceof List) ? parsed : [parsed]\n            log.info(\"Cams records loaded: ${camsList.size()}\")\n        } else {\n            log.warn(\"Cams file does not exist: ${camsPath}\")\n        }\n    }\n\n    // 2) Map AdvertiserId -> DimAdAccountId (Id ca dim)\n    def advToDimAA = [:]\n    dimAAList.each { aa ->\n        def advId = getStr(aa as Map, [\"AdvertiserId\",\"advertiserId\"])\n        def dimId = getStr(aa as Map, [\"Id\",\"id\",\"DimAdAccountId\",\"dimAdAccountId\"])\n        if (advId && dimId) advToDimAA[advId] = dimId\n    }\n    log.info(\"Advertiser to DimAA mapping created: ${advToDimAA.size()} mappings\")\n\n    // 3) Tp kha  c trong cams (adv|campaign)\n    def existedKeys = new HashSet<String>()\n    camsList.each { c ->\n        def adv = getStr(c as Map, [\"AdvertiserId\",\"advertiserId\"])\n        def cid = getStr(c as Map, [\"CampaignId\",\"campaignId\",\"Id\",\"id\"])\n        if (adv && cid) existedKeys.add(\"${adv}|${cid}\")\n    }\n    log.info(\"Existing campaign keys: ${existedKeys.size()}\")\n\n    // 4) Ly unique t raw theo (adv|campaign)\n    def rawUnique = new HashSet<String>()\n    rawList.each { r ->\n        def adv = getStr(r as Map, [\"AdvertiserId\",\"advertiserId\",\"AdAccountId\",\"adAccountId\",\"advertiser_id\"])\n        def cid = getStr(r as Map, [\"CampaignId\",\"campaignId\",\"Id\",\"id\",\"campaign_id\"])\n        if (adv && cid) rawUnique.add(\"${adv}|${cid}\")\n    }\n    log.info(\"Unique RAW pairs found: ${rawUnique.size()}\")\n\n    int skippedNoMapping = 0\n    def newCams = []\n    def now = nowUtc()\n\n    rawUnique.each { key ->\n        if (existedKeys.contains(key)) {\n            log.debug(\"Skipping existing campaign key: ${key}\")\n            return\n        }\n        def parts = key.split(\"\\\\|\", 2)\n        def advId = parts[0]\n        def camId = parts[1]\n\n        def dimAdAccountId = advToDimAA[advId]\n        if (!dimAdAccountId) {\n            skippedNoMapping++\n            log.warn(\"No DimAA mapping found for advertiser: ${advId}\")\n            return\n        }\n\n        // tn t map, fallback v CampaignId nu thiu\n        def cname = nameMap[key]\n        if (!cname || cname.trim().isEmpty()) cname = camId\n\n        def id = UUID.randomUUID().toString().toUpperCase()\n        def newCam = [\n            Id                   : id,\n            CampaignId           : camId,\n            DimAdAccountId       : dimAdAccountId,\n            AdvertiserId         : advId,\n            CampaignName         : cname,\n            ObjectiveType        : \"PRODUCT_SALES\",\n            CampaignType         : \"1\",\n            BudgetMode           : \"BUDGET_MODE_INFINITE\",\n            Budget               : null,\n            OperationStatus      : \"ENABLE\",\n            CreateTime           : null,\n            ModifyTime           : null,\n            IsCurrent            : true,\n            EffectiveDate        : now,\n            ExpirationDate       : null,\n            RowVersion           : 1,\n            CreationTime         : now,\n            CreatorId            : null,\n            LastModificationTime : null,\n            LastModifierId       : null\n        ]\n        newCams << newCam\n        existedKeys.add(key)\n        log.debug(\"Created new campaign: ${advId}|${camId} with name '${cname}'\")\n    }\n\n    log.info(\"New campaigns created: ${newCams.size()}\")\n    log.info(\"Skipped campaigns (no mapping): ${skippedNoMapping}\")\n\n    // 5) Build SQL\n    def toSqlValue = { v ->\n        if (v == null) return \"NULL\"\n        if (v instanceof Boolean) return v ? \"1\" : \"0\"\n        if (v instanceof Number) return v.toString()\n        \"N'${escapeSql(v.toString())}'\"\n    }\n\n    // 5a) UPDATE: dng ng tn ct CamelCase trong cc bng RAW\n    def sqlUpdate = \"\"\"\n;WITH src AS (\n    SELECT \n        CAST(r.[AdvertiserId] AS NVARCHAR(100)) AS [AdvertiserId],\n        CAST(r.[CampaignId]   AS NVARCHAR(100)) AS [CampaignId],\n        CAST(r.[CampaignName] AS NVARCHAR(500)) AS [CampaignName]\n    FROM dbo.[Raw_RawGmvMaxCampaigns] r WITH (NOLOCK)\n    WHERE r.[CampaignName] IS NOT NULL AND LTRIM(RTRIM(r.[CampaignName])) <> ''\n\n    UNION ALL\n    SELECT \n        CAST(r.[AdvertiserId] AS NVARCHAR(100)),\n        CAST(r.[CampaignId]   AS NVARCHAR(100)),\n        CAST(r.[CampaignName] AS NVARCHAR(500))\n    FROM dbo.[Raw_RawGmvMaxLiveCampaignReports] r WITH (NOLOCK)\n    WHERE r.[CampaignName] IS NOT NULL AND LTRIM(RTRIM(r.[CampaignName])) <> ''\n\n    UNION ALL\n    SELECT \n        CAST(r.[AdvertiserId] AS NVARCHAR(100)),\n        CAST(r.[CampaignId]   AS NVARCHAR(100)),\n        CAST(r.[CampaignName] AS NVARCHAR(500))\n    FROM dbo.[Raw_RawGmvMaxProductCampaignReports] r WITH (NOLOCK)\n    WHERE r.[CampaignName] IS NOT NULL AND LTRIM(RTRIM(r.[CampaignName])) <> ''\n),\nagg AS (\n    SELECT [AdvertiserId], [CampaignId], MAX([CampaignName]) AS [CampaignName]\n    FROM src\n    GROUP BY [AdvertiserId], [CampaignId]\n)\nUPDATE d\n   SET d.[CampaignName] = a.[CampaignName]\nFROM dbo.[Dim_DimCampaigns] d\nJOIN agg a\n  ON a.[AdvertiserId] = d.[AdvertiserId]\n AND a.[CampaignId]   = d.[CampaignId]\nWHERE (d.[CampaignName] IS NULL OR d.[CampaignName] <> a.[CampaignName]);\n\"\"\".trim()\n\n    // 5b) INSERT cho cc campaign mi (gi nguyn logic c)\n    def sqlList = []\n    newCams.each { c ->\n        def cols = [\n            \"Id\",\"CampaignId\",\"DimAdAccountId\",\"AdvertiserId\",\"CampaignName\",\n            \"ObjectiveType\",\"CampaignType\",\"BudgetMode\",\"Budget\",\"OperationStatus\",\n            \"CreateTime\",\"ModifyTime\",\"IsCurrent\",\"EffectiveDate\",\"ExpirationDate\",\n            \"RowVersion\",\"CreationTime\",\"CreatorId\",\"LastModificationTime\",\"LastModifierId\"\n        ]\n        def vals = [\n            toSqlValue(c.Id),\n            toSqlValue(c.CampaignId),\n            toSqlValue(c.DimAdAccountId),\n            toSqlValue(c.AdvertiserId),\n            toSqlValue(c.CampaignName),\n            toSqlValue(c.ObjectiveType),\n            toSqlValue(c.CampaignType),\n            toSqlValue(c.BudgetMode),\n            (c.Budget == null ? \"NULL\" : toSqlValue(c.Budget)),\n            toSqlValue(c.OperationStatus),\n            toSqlValue(c.CreateTime),\n            toSqlValue(c.ModifyTime),\n            (c.IsCurrent ? \"1\" : \"0\"),\n            toSqlValue(c.EffectiveDate),\n            toSqlValue(c.ExpirationDate),\n            toSqlValue(c.RowVersion),\n            toSqlValue(c.CreationTime),\n            toSqlValue(c.CreatorId),\n            toSqlValue(c.LastModificationTime),\n            toSqlValue(c.LastModifierId)\n        ]\n        sqlList << \"\"\"INSERT INTO [dbo].[Dim_DimCampaigns] (${cols.join(\",\")}) VALUES (${vals.join(\",\")});\"\"\"\n    }\n\n    // Ghp UPDATE + (cc) INSERT\n    def sqlInsert = ([sqlUpdate] + sqlList).join(\"\\n\")\n\n    // 6) Ghi file cams (append)\n    if (!newCams.isEmpty()) {\n        log.info(\"Updating campaigns file with ${newCams.size()} new campaigns\")\n        def updated = []\n        updated.addAll(camsList)\n        updated.addAll(newCams)\n        def pretty = JsonOutput.prettyPrint(JsonOutput.toJson(updated))\n        Files.createDirectories(Paths.get(camsPath).getParent())\n        Files.write(Paths.get(camsPath), pretty.getBytes(StandardCharsets.UTF_8))\n        log.info(\"Campaigns file updated successfully: ${camsPath}\")\n    } else {\n        log.info(\"No new campaigns to add - file not updated\")\n    }\n\n    // 7) Output JSON\n    def result = [\n        rawCount          : rawList.size(),\n        dimAACount        : dimAAList.size(),\n        camsCount         : camsList.size(),\n        uniqueRawPairs    : rawUnique.size(),\n        newCount          : newCams.size(),\n        skippedNoMapping  : skippedNoMapping,\n        sqlUpdate         : sqlUpdate,\n        sqlInsert         : sqlInsert,   // PutSQL s thc thi chui ny\n        newCampaigns      : newCams\n    ]\n    def outJson = JsonOutput.prettyPrint(JsonOutput.toJson(result))\n    flowFile = session.write(flowFile, { inputStream, outputStream ->\n        outputStream.write(outJson.getBytes(StandardCharsets.UTF_8))\n    } as StreamCallback)\n\n    flowFile = session.putAttribute(flowFile, \"sql.update.included\", \"1\")\n    flowFile = session.putAttribute(flowFile, \"cams.new.count\",            String.valueOf(newCams.size()))\n    flowFile = session.putAttribute(flowFile, \"cams.skipped.noMapping\",    String.valueOf(skippedNoMapping))\n    flowFile = session.putAttribute(flowFile, \"cams.file.updatedPath\",     camsPath)\n    flowFile = session.putAttribute(flowFile, \"cams.raw.count\",            String.valueOf(rawList.size()))\n    flowFile = session.putAttribute(flowFile, \"cams.dimAA.count\",          String.valueOf(dimAAList.size()))\n    flowFile = session.putAttribute(flowFile, \"cams.cams.existed.count\",   String.valueOf(camsList.size()))\n    flowFile = session.putAttribute(flowFile, \"cams.raw.unique.pairs\",     String.valueOf(rawUnique.size()))\n\n    log.info(\"GetOrAddCam process completed successfully\")\n    session.transfer(flowFile, REL_SUCCESS)\n} catch (Throwable t) {\n    log.error(\"GetOrAddCam script failed\", t)\n    flowFile = session.putAttribute(flowFile, \"error.message\", t.getMessage())\n    session.transfer(flowFile, REL_FAILURE)\n}"
            },
            "propertyDescriptors" : {
              "Script File" : {
                "displayName" : "Script File",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script File",
                "resourceDefinition" : {
                  "cardinality" : "SINGLE",
                  "resourceTypes" : [ "FILE" ]
                },
                "sensitive" : false
              },
              "Script Engine" : {
                "displayName" : "Script Engine",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Engine",
                "sensitive" : false
              },
              "Script Body" : {
                "displayName" : "Script Body",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Body",
                "sensitive" : false
              },
              "Module Directory" : {
                "displayName" : "Module Directory",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Module Directory",
                "resourceDefinition" : {
                  "cardinality" : "MULTIPLE",
                  "resourceTypes" : [ "FILE", "DIRECTORY" ]
                },
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.script.ExecuteScript",
            "yieldDuration" : "1 sec"
          } ],
          "remoteProcessGroups" : [ ],
          "scheduledState" : "ENABLED",
          "statelessFlowTimeout" : "1 min"
        }, {
          "comments" : "",
          "componentType" : "PROCESS_GROUP",
          "connections" : [ {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "b25500c0-110f-33e7-8780-219b5ec4d7a3",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "81863951-8ecf-3c51-97b5-fe124ca9a6c5",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "e9338c93-c39b-30c1-8e2a-48960de41257",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "zIndex" : 3
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "f65bd2f1-4997-3f3d-afc4-9b9bbc1a0ebf",
              "name" : "ThucThiThemMoiStore",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "dd33fc5c-3330-37bd-9d1a-715ddbb75208",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "626891e3-90bc-3e8e-8c62-721ecd5520b5",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "zIndex" : 12
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "c2a846f0-d2dc-3263-a1d8-d1484761e9ac",
              "name" : "KhoiTao",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "d17b7989-aa30-3d55-bc33-bc06897637df",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "1335184a-369f-39a2-a068-2352aa53c9a9",
              "name" : "stateCamBatch",
              "type" : "INPUT_PORT"
            },
            "zIndex" : 1
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "b6f4ec96-75e9-3b02-a8a1-e49d5745e99c",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "f754b7fe-c6a2-3a46-80b5-bc55eeb0af7c",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "f65bd2f1-4997-3f3d-afc4-9b9bbc1a0ebf",
              "name" : "ThucThiThemMoiStore",
              "type" : "PROCESSOR"
            },
            "zIndex" : 10
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "b6f4ec96-75e9-3b02-a8a1-e49d5745e99c",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "86b17af2-c44e-3e73-8273-30eae70e3b55",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "626891e3-90bc-3e8e-8c62-721ecd5520b5",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "zIndex" : 13
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "b6f4ec96-75e9-3b02-a8a1-e49d5745e99c",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "2699aaae-f178-3a8b-a4ad-bad4bd4403cb",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "e9338c93-c39b-30c1-8e2a-48960de41257",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "zIndex" : 4
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "123dffbf-677b-3fbc-a158-ffa8f74dda40",
              "name" : "stateStore",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "cc8e0ea9-03ff-31fc-a582-e34fb8841dde",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "unmatched" ],
            "source" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "b25500c0-110f-33e7-8780-219b5ec4d7a3",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "zIndex" : 8
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "e9338c93-c39b-30c1-8e2a-48960de41257",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "7ab58951-f840-32d1-950a-dce09d8dd390",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "c2a846f0-d2dc-3263-a1d8-d1484761e9ac",
              "name" : "KhoiTao",
              "type" : "PROCESSOR"
            },
            "zIndex" : 2
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "626891e3-90bc-3e8e-8c62-721ecd5520b5",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "52b03ce6-639f-30c8-978b-6d647d3d6edc",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "has_new_stores" ],
            "source" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "b25500c0-110f-33e7-8780-219b5ec4d7a3",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "zIndex" : 11
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "123dffbf-677b-3fbc-a158-ffa8f74dda40",
              "name" : "stateStore",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "e40dcdc9-faae-3de4-a675-cbfb84f3bb91",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
              "id" : "f65bd2f1-4997-3f3d-afc4-9b9bbc1a0ebf",
              "name" : "ThucThiThemMoiStore",
              "type" : "PROCESSOR"
            },
            "zIndex" : 9
          } ],
          "controllerServices" : [ ],
          "defaultBackPressureDataSizeThreshold" : "1 GB",
          "defaultBackPressureObjectThreshold" : 10000,
          "defaultFlowFileExpiration" : "0 sec",
          "executionEngine" : "INHERITED",
          "flowFileConcurrency" : "UNBOUNDED",
          "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
          "funnels" : [ ],
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
          "inputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "INPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "1335184a-369f-39a2-a068-2352aa53c9a9",
            "name" : "stateCamBatch",
            "portFunction" : "STANDARD",
            "position" : {
              "x" : -560.0000016432713,
              "y" : -190.5000198460608
            },
            "scheduledState" : "ENABLED",
            "type" : "INPUT_PORT"
          } ],
          "labels" : [ ],
          "maxConcurrentTasks" : 1,
          "name" : "LayHoacThemMoiStore",
          "outputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "OUTPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "123dffbf-677b-3fbc-a158-ffa8f74dda40",
            "name" : "stateStore",
            "portFunction" : "STANDARD",
            "position" : {
              "x" : 2032.0,
              "y" : -176.0
            },
            "scheduledState" : "ENABLED",
            "type" : "OUTPUT_PORT"
          } ],
          "parameterContextName" : "ETL",
          "position" : {
            "x" : 2928.0,
            "y" : -288.0
          },
          "processGroups" : [ ],
          "processors" : [ {
            "autoTerminatedRelationships" : [ "success" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "b6f4ec96-75e9-3b02-a8a1-e49d5745e99c",
            "maxBackoffPeriod" : "10 mins",
            "name" : "LogMessage",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 968.0,
              "y" : 456.0
            },
            "properties" : {
              "log-level" : "info"
            },
            "propertyDescriptors" : {
              "log-message" : {
                "displayName" : "Log message",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-message",
                "sensitive" : false
              },
              "log-level" : {
                "displayName" : "Log Level",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-level",
                "sensitive" : false
              },
              "log-prefix" : {
                "displayName" : "Log prefix",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-prefix",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.LogMessage",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-scripting-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "626891e3-90bc-3e8e-8c62-721ecd5520b5",
            "maxBackoffPeriod" : "10 mins",
            "name" : "GhiDeCauLenhSqlVaoContentFlow",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 992.0,
              "y" : 32.0
            },
            "properties" : {
              "Script Engine" : "Groovy",
              "Script Body" : "import groovy.json.JsonSlurper\nimport org.apache.commons.io.IOUtils\nimport java.nio.charset.StandardCharsets\n\ndef flowFile = session.get()\nif(!flowFile) return\n\nflowFile = session.write(flowFile, { inputStream, outputStream ->\n    def jsonText = IOUtils.toString(inputStream, StandardCharsets.UTF_8)\n    def jsonSlurper = new JsonSlurper()\n    def jsonObj = jsonSlurper.parseText(jsonText)\n    \n    // Ly raw string value, khng c du ngoc kp\n    def sqlInsert = jsonObj.sqlInsert\n    outputStream.write(sqlInsert.getBytes(StandardCharsets.UTF_8))\n} as StreamCallback)\n\nsession.transfer(flowFile, REL_SUCCESS)"
            },
            "propertyDescriptors" : {
              "Script File" : {
                "displayName" : "Script File",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script File",
                "resourceDefinition" : {
                  "cardinality" : "SINGLE",
                  "resourceTypes" : [ "FILE" ]
                },
                "sensitive" : false
              },
              "Script Engine" : {
                "displayName" : "Script Engine",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Engine",
                "sensitive" : false
              },
              "Script Body" : {
                "displayName" : "Script Body",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Body",
                "sensitive" : false
              },
              "Module Directory" : {
                "displayName" : "Module Directory",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Module Directory",
                "resourceDefinition" : {
                  "cardinality" : "MULTIPLE",
                  "resourceTypes" : [ "FILE", "DIRECTORY" ]
                },
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.script.ExecuteScript",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-scripting-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "e9338c93-c39b-30c1-8e2a-48960de41257",
            "maxBackoffPeriod" : "10 mins",
            "name" : "XuLyDuLieuThemMoi",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 232.0,
              "y" : -232.0
            },
            "properties" : {
              "Script Engine" : "Groovy",
              "Script Body" : "import org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport groovy.json.JsonOutput\nimport java.nio.file.Files\nimport java.nio.file.Paths\nimport java.time.OffsetDateTime\nimport java.time.ZoneOffset\nimport java.time.format.DateTimeFormatter\nimport java.util.UUID\n\ndef flowFile = session.get()\nif (!flowFile) return\n\ndef readJsonFile = { String path ->\n    try {\n        def p = Paths.get(path)\n        if (!Files.exists(p)) return null\n        def txt = new String(Files.readAllBytes(p), StandardCharsets.UTF_8)\n        if (txt.trim().isEmpty()) return null\n        return new JsonSlurper().parseText(txt)\n    } catch (Throwable t) {\n        log.error(\"Failed to read JSON file: ${path}\", t)\n        return null\n    }\n}\n\ndef escapeSql = { String s ->\n    if (s == null) return null\n    return s.replace(\"'\", \"''\")\n}\n\ndef nowUtcStr = {\n    DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss.SSSSSSS\")\n        .format(OffsetDateTime.now(ZoneOffset.UTC))\n}\n\ntry {\n    def rawPath = flowFile.getAttribute(\"stateCurrent.fullPath\")\n    def storesPath = flowFile.getAttribute(\"stateStores.fullpath\")\n    if (!storesPath) storesPath = flowFile.getAttribute(\"stateStores.fullPath\") // fallback\n\n    if (!rawPath || !storesPath) {\n        def miss = []\n        if (!rawPath)    miss << \"stateCurrent.fullPath\"\n        if (!storesPath) miss << \"stateStores.fullpath/fullPath\"\n        flowFile = session.putAttribute(flowFile, \"error.message\", \"Missing attributes: \" + miss.join(\", \"))\n        session.transfer(flowFile, REL_FAILURE)\n        return\n    }\n\n    // 1) c d liu\n    def rawList = readJsonFile(rawPath)\n    if (!(rawList instanceof List)) rawList = []\n\n    def storesList = readJsonFile(storesPath)\n    if (!(storesList instanceof List)) storesList = []\n\n    // 2) Tp kha  c (StoreId)\n    def existed = new HashSet<String>()\n    storesList.each { s ->\n        def id = (s?.StoreId ?: s?.storeId ?: \"\").toString()\n        if (id) existed.add(id)\n    }\n\n    // 3) Ly danh sch StoreId duy nht t raw\n    def uniqueStoreIds = new HashSet<String>()\n    rawList.each { r ->\n        def sid = (r?.StoreId ?: r?.storeId ?: \"\").toString().trim()\n        if (sid) uniqueStoreIds.add(sid)\n    }\n\n    // 4) To store mi theo mc nh\n    def newStores = []\n    int skippedNoStoreId = 0\n    def now = nowUtcStr()\n\n    uniqueStoreIds.each { sid ->\n        if (!sid) { skippedNoStoreId++; return }\n        if (existed.contains(sid)) return\n\n        def newStore = [\n            Id                    : UUID.randomUUID().toString().toUpperCase(),\n            StoreId               : sid,\n            StoreName             : sid,         // theo yu cu\n            Description           : \"\",          // NOT NULL =>  chui rng\n            StoreUrl              : \"\",          // NOT NULL =>  chui rng\n            StoreType             : \"OFFICIAL\",\n            Status                : \"ACTIVE\",\n            Country               : \"VN\",\n            Region                : \"\",          // NOT NULL =>  chui rng\n            CreatedAt             : null,        // nullable\n            UpdatedAt             : null,        // nullable\n            EffectiveStartDate    : now,         // bt u hiu lc\n            EffectiveEndDate      : null,\n            CreationTime          : now,\n            CreatorId             : null,\n            LastModificationTime  : null,\n            LastModifierId        : null\n        ]\n        newStores << newStore\n        existed.add(sid)\n    }\n\n    // 5) To SQL INSERT\n    def toSqlValue = { v ->\n        if (v == null) return \"NULL\"\n        if (v instanceof Boolean) return v ? \"1\" : \"0\"\n        if (v instanceof Number) return v.toString()\n        return \"N'${escapeSql(v.toString())}'\"\n    }\n\n    def cols = [\n        \"Id\",\"StoreId\",\"StoreName\",\"Description\",\"StoreUrl\",\n        \"StoreType\",\"Status\",\"Country\",\"Region\",\n        \"CreatedAt\",\"UpdatedAt\",\n        \"EffectiveStartDate\",\"EffectiveEndDate\",\n        \"CreationTime\",\"CreatorId\",\"LastModificationTime\",\"LastModifierId\"\n    ]\n\n    def sqlList = []\n    newStores.each { s ->\n        def vals = [\n            toSqlValue(s.Id),\n            toSqlValue(s.StoreId),\n            toSqlValue(s.StoreName),\n            toSqlValue(s.Description),\n            toSqlValue(s.StoreUrl),\n            toSqlValue(s.StoreType),\n            toSqlValue(s.Status),\n            toSqlValue(s.Country),\n            toSqlValue(s.Region),\n            toSqlValue(s.CreatedAt),\n            toSqlValue(s.UpdatedAt),\n            toSqlValue(s.EffectiveStartDate),\n            toSqlValue(s.EffectiveEndDate),\n            toSqlValue(s.CreationTime),\n            toSqlValue(s.CreatorId),\n            toSqlValue(s.LastModificationTime),\n            toSqlValue(s.LastModifierId)\n        ]\n\n        def sql = \"\"\"INSERT INTO [dbo].[Dim_DimStores] (${cols.join(\",\")})\nVALUES (${vals.join(\",\")});\"\"\"\n        sqlList << sql\n    }\n\n    def sqlInsert = sqlList.join(\"\\n\")\n\n    // 6) Ghi  file stores vi mng  cng thm\n    if (!newStores.isEmpty()) {\n        def updated = []\n        updated.addAll(storesList)\n        updated.addAll(newStores)\n        def pretty = JsonOutput.prettyPrint(JsonOutput.toJson(updated))\n        Files.createDirectories(Paths.get(storesPath).getParent())\n        Files.write(Paths.get(storesPath), pretty.getBytes(StandardCharsets.UTF_8))\n    }\n\n    // 7) Ghi content kt qu\n    def result = [\n        newCount        : newStores.size(),\n        skippedNoStoreId: skippedNoStoreId,\n        sqlInsert       : sqlInsert,\n        newStores       : newStores\n    ]\n    def outJson = JsonOutput.prettyPrint(JsonOutput.toJson(result))\n    flowFile = session.write(flowFile, { inputStream, outputStream ->\n        outputStream.write(outJson.getBytes(StandardCharsets.UTF_8))\n    } as StreamCallback)\n\n    // 8) Attributes\n    flowFile = session.putAttribute(flowFile, \"stores.new.count\", String.valueOf(newStores.size()))\n    flowFile = session.putAttribute(flowFile, \"stores.skipped.noStoreId\", String.valueOf(skippedNoStoreId))\n    flowFile = session.putAttribute(flowFile, \"stores.file.updatedPath\", storesPath)\n\n    session.transfer(flowFile, REL_SUCCESS)\n} catch (Throwable t) {\n    log.error(\"GetOrAddStore script failed\", t)\n    flowFile = session.putAttribute(flowFile, \"error.message\", t.getMessage())\n    session.transfer(flowFile, REL_FAILURE)\n}"
            },
            "propertyDescriptors" : {
              "Script File" : {
                "displayName" : "Script File",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script File",
                "resourceDefinition" : {
                  "cardinality" : "SINGLE",
                  "resourceTypes" : [ "FILE" ]
                },
                "sensitive" : false
              },
              "Script Engine" : {
                "displayName" : "Script Engine",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Engine",
                "sensitive" : false
              },
              "Script Body" : {
                "displayName" : "Script Body",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Body",
                "sensitive" : false
              },
              "Module Directory" : {
                "displayName" : "Module Directory",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Module Directory",
                "resourceDefinition" : {
                  "cardinality" : "MULTIPLE",
                  "resourceTypes" : [ "FILE", "DIRECTORY" ]
                },
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.script.ExecuteScript",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "c2a846f0-d2dc-3263-a1d8-d1484761e9ac",
            "maxBackoffPeriod" : "10 mins",
            "name" : "KhoiTao",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : -216.0,
              "y" : -232.0
            },
            "properties" : {
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100"
            },
            "propertyDescriptors" : {
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "retry" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "f65bd2f1-4997-3f3d-afc4-9b9bbc1a0ebf",
            "maxBackoffPeriod" : "10 mins",
            "name" : "ThucThiThemMoiStore",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 1600.0,
              "y" : 72.0
            },
            "properties" : {
              "Support Fragmented Transactions" : "false",
              "Batch Size" : "#{PageSizeMax}",
              "Obtain Generated Keys" : "false",
              "JDBC Connection Pool" : "6fce9190-8f74-3a75-9e56-36c3f8fc6d63",
              "database-session-autocommit" : "true",
              "rollback-on-failure" : "false"
            },
            "propertyDescriptors" : {
              "Support Fragmented Transactions" : {
                "displayName" : "Support Fragmented Transactions",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Support Fragmented Transactions",
                "sensitive" : false
              },
              "putsql-sql-statement" : {
                "displayName" : "SQL Statement",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "putsql-sql-statement",
                "sensitive" : false
              },
              "Transaction Timeout" : {
                "displayName" : "Transaction Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Transaction Timeout",
                "sensitive" : false
              },
              "Batch Size" : {
                "displayName" : "Batch Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Batch Size",
                "sensitive" : false
              },
              "Obtain Generated Keys" : {
                "displayName" : "Obtain Generated Keys",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Obtain Generated Keys",
                "sensitive" : false
              },
              "JDBC Connection Pool" : {
                "displayName" : "JDBC Connection Pool",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "JDBC Connection Pool",
                "sensitive" : false
              },
              "database-session-autocommit" : {
                "displayName" : "Database Session AutoCommit",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "database-session-autocommit",
                "sensitive" : false
              },
              "rollback-on-failure" : {
                "displayName" : "Rollback On Failure",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "rollback-on-failure",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.PutSQL",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "0fe44344-a33e-327c-a4f0-4157bee900a2",
            "identifier" : "b25500c0-110f-33e7-8780-219b5ec4d7a3",
            "maxBackoffPeriod" : "10 mins",
            "name" : "RouteOnAttribute",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 976.0,
              "y" : -248.0
            },
            "properties" : {
              "Routing Strategy" : "Route to Property name",
              "has_new_stores" : "${stores.new.count:gt(0)}"
            },
            "propertyDescriptors" : {
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              },
              "has_new_stores" : {
                "displayName" : "has_new_stores",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "has_new_stores",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          } ],
          "remoteProcessGroups" : [ ],
          "scheduledState" : "ENABLED",
          "statelessFlowTimeout" : "1 min"
        } ],
        "processors" : [ {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-groovyx-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "52e40b16-58f1-39a2-b104-399d0e3f49ca",
          "maxBackoffPeriod" : "10 mins",
          "name" : "TransformData",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2944.0,
            "y" : 664.0
          },
          "properties" : {
            "groovyx-script-body" : "import org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport java.time.LocalDateTime\nimport java.time.format.DateTimeFormatter\nimport java.time.format.DateTimeFormatterBuilder\nimport java.time.temporal.ChronoField\nimport java.util.UUID\nimport java.io.File\n\n// ================= Utils =================\ndef toDimDateId(String isoDateTime) {\n    def d = (isoDateTime ?: \"\").trim()\n    if (!d) return null\n    def day = d.substring(0, 10) // yyyy-MM-dd\n    return day.replace(\"-\", \"\").toInteger() // yyyyMMdd\n}\n\ndef normalizeIso(String dateStr) {\n    def t = (dateStr ?: \"\").trim().replace(' ', 'T')\n    if (!t) return null\n    def parser = new DateTimeFormatterBuilder()\n        .appendPattern(\"yyyy-MM-dd'T'HH:mm:ss\")\n        .optionalStart().appendFraction(ChronoField.NANO_OF_SECOND, 1, 7, true).optionalEnd()\n        .toFormatter()\n    def dt = LocalDateTime.parse(t, parser)\n    return dt.format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss.SSSSSSS\"))\n}\n\ndef esc(String s) { (s == null) ? null : s.replace(\"'\", \"''\") }\ndef q (Object v)  { v == null ? \"NULL\" : \"N'${esc(v?.toString())}'\" }   // NVARCHAR\ndef qv(Object v)  { v == null ? \"NULL\" : \"'${esc(v?.toString())}'\" }    // VARCHAR\n\ndef dec(Object v) { if (v == null) return \"NULL\"; def s=v.toString().trim(); return s==\"\"?\"NULL\":s }\ndef intval(Object v) { if (v==null) return \"NULL\"; try { return Integer.parseInt(v.toString()) } catch(ex){ return \"NULL\"} }\ndef bigint(Object v) { if (v==null) return \"NULL\"; try { return Long.parseLong(v.toString()) } catch(ex){ return \"NULL\"} }\n\ndef nowUtc() { LocalDateTime.now().format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss\")) }\n\ndef safeIsoToSqlDate(Object v) {\n    def iso = normalizeIso(v?.toString())\n    return iso ? \"CONVERT(datetime2(7), ${qv(iso)}, 126)\" : \"NULL\"\n}\n\ndef zeroIfNullDecimal(Object v) { def d=dec(v); return (d==\"NULL\")?\"0\":d }\n\n// TACOS\ndef tacos(cost, grossRevenue) {\n    try {\n        def c = (cost==null || cost.toString().trim()==\"\") ? BigDecimal.ZERO : new BigDecimal(cost.toString())\n        def g = (grossRevenue==null || grossRevenue.toString().trim()==\"\") ? BigDecimal.ZERO : new BigDecimal(grossRevenue.toString())\n        if (g.compareTo(BigDecimal.ZERO)==0) return (c.compareTo(BigDecimal.ZERO)==0) ? BigDecimal.ZERO : null\n        return c.divide(g, 6, BigDecimal.ROUND_HALF_UP)\n    } catch(ex) {\n        return null\n    }\n}\n// =============== End Utils ===============\n\ndef flowFile = session.get()\nif (!flowFile) return\n\n// ---------- Attributes ----------\ndef rawPath         = flowFile.getAttribute('stateCurrent.fullPath')\ndef adAccountsPath  = flowFile.getAttribute('stateAdAccounts.fullpath') // [{AdvertiserId, Id}]\ndef storesPath      = flowFile.getAttribute('stateStores.fullpath')     // [{StoreId, Id}]\ndef camsPath        = flowFile.getAttribute('stateCams.fullpath')       // [{CampaignId, Id}]\ndef dimBcId         = flowFile.getAttribute('stateBc.dimId')\ndef bcId            = flowFile.getAttribute('stateBc.id')\n\n// ---------- Load RAW ----------\ndef rawList = []\nif (rawPath) {\n    def f = new File(rawPath)\n    if (f.exists()) {\n        def txt = f.getText(StandardCharsets.UTF_8.name())\n        def parsed = new JsonSlurper().parseText(txt)\n        rawList = (parsed instanceof List) ? parsed : [parsed]\n    }\n}\n\n// ---------- Load DIM maps ----------\ndef adMap = [:]\nif (adAccountsPath) {\n    def f = new File(adAccountsPath)\n    if (f.exists()) {\n        def list = new JsonSlurper().parseText(f.getText(StandardCharsets.UTF_8.name()))\n        list.each { it -> if (it?.AdvertiserId && it?.Id) adMap[it.AdvertiserId.toString()] = it.Id.toString() }\n    }\n}\n\ndef storeMap = [:]\nif (storesPath) {\n    def f = new File(storesPath)\n    if (f.exists()) {\n        def list = new JsonSlurper().parseText(f.getText(StandardCharsets.UTF_8.name()))\n        list.each { it -> if (it?.StoreId && it?.Id) storeMap[it.StoreId.toString()] = it.Id.toString() }\n    }\n}\n\ndef camMap = [:]\nif (camsPath) {\n    def f = new File(camsPath)\n    if (f.exists()) {\n        def list = new JsonSlurper().parseText(f.getText(StandardCharsets.UTF_8.name()))\n        list.each { it -> if (it?.CampaignId && it?.Id) camMap[it.CampaignId.toString()] = it.Id.toString() }\n    }\n}\n\n// ---------- Load FACT current from flow content ----------\ndef factRows = []\nflowFile = session.write(flowFile, { inp, out ->\n    def content = inp.getText(StandardCharsets.UTF_8.name())\n    if (content?.trim()) {\n        def parsed = new JsonSlurper().parseText(content)\n        factRows = (parsed instanceof List) ? parsed : [parsed]\n        out.write(content.getBytes(StandardCharsets.UTF_8))\n    } else {\n        out.write(\"[]\".getBytes(StandardCharsets.UTF_8))\n    }\n} as StreamCallback)\n\n// Build fact map by key\ndef factMap = [:]\nfactRows.each { f ->\n    def isoDate = normalizeIso(f?.Date)\n    def dimDateId = toDimDateId(isoDate)\n    def k = [\n        (bcId ?: (f?.BcId ?: \"\")).toString().trim(),\n        (f?.AdvertiserId ?: \"\").toString().trim(),\n        (f?.CampaignId   ?: \"\").toString().trim(),\n        (f?.StoreId      ?: \"\").toString().trim(),\n        (dimDateId ?: \"\"),\n        (f?.ProductId    ?: \"\").toString().trim()\n    ].join(\"|\")\n    factMap[k] = f\n}\n\n// ---------- Stage INSERT / UPDATE ----------\ndef inserts = []\ndef updates = []\n\nrawList.each { r ->\n    if (r?.ProductId == null && r?.ItemGroupId != null) r.ProductId = r.ItemGroupId\n\n    def isoDate   = normalizeIso(r?.Date)\n    def dimDateId = toDimDateId(isoDate)\n\n    def key = [\n        (bcId ?: r?.BcId ?: \"\").toString().trim(),\n        (r?.AdvertiserId ?: \"\").toString().trim(),\n        (r?.CampaignId   ?: \"\").toString().trim(),\n        (r?.StoreId      ?: \"\").toString().trim(),\n        (dimDateId ?: \"\"),\n        (r?.ProductId    ?: \"\").toString().trim()\n    ].join(\"|\")\n\n    def existing = factMap[key]\n    if (existing == null) inserts << r\n    else updates << [raw: r, existing: existing]\n}\n\n// ---------- Build SQL ----------\ndef now = nowUtc()\n\ndef valCost         = { v -> zeroIfNullDecimal(v) }\ndef valOrders       = { v -> (intval(v) == \"NULL\") ? \"0\" : intval(v) }\ndef valGrossRevenue = { v -> zeroIfNullDecimal(v) }\n\n// INSERTs (Currency theo AdvertiserId t Raw_RawAdAccounts; u tin CreationTime, fallback CreateTime)\ndef insertValues = inserts.collect { r ->\n    def isoDate      = normalizeIso(r?.Date)\n    def dimDateId    = toDimDateId(isoDate)\n    def id           = UUID.randomUUID().toString()\n\n    def roas       = (r?.ROI != null ? r?.ROI : r?.ROAS)\n    def tacosVal   = tacos(r?.Cost, r?.GrossRevenue)\n\n    def dimAdId    = adMap[r?.AdvertiserId?.toString()]\n    def dimStoreId = storeMap[r?.StoreId?.toString()]\n    def dimCamId   = camMap[r?.CampaignId?.toString()]\n\n    \"\"\"(\n${qv(id)},                               -- Id\n${dimDateId ?: \"NULL\"},                  -- DimDateId\n${qv(dimBcId)},                          -- DimBusinessCenterId\n${qv(dimAdId)},                          -- DimAdAccountId\n${qv(dimCamId)},                         -- DimCampaignId\n${qv(dimStoreId)},                       -- DimStoreId\n${q(r?.CampaignId)},                     -- CampaignId\n${q(r?.StoreId)},                        -- StoreId\n${q(r?.ProductId)},                      -- ProductId\n${q(r?.ProductName)},                    -- ProductName\n${q(bcId)},                              -- BcId\n${valOrders(r?.Orders)},                 -- Orders\n${dec(r?.CostPerOrder)},                 -- CostPerOrder\nNULL,                                    -- CostPerOrderVND (theo Currency)\nNULL,                                    -- CostPerOrderUSD (theo Currency)\n${valGrossRevenue(r?.GrossRevenue)},     -- GrossRevenue\nNULL,                                    -- GrossRevenueVND (theo Currency)\nNULL,                                    -- GrossRevenueUSD (theo Currency)\n${dec(roas)},                            -- ROAS\n${dec(tacosVal)},                        -- TACOS\nNULL,                                    -- Currency (fill  SELECT)\n${qv(now)},                              -- CreationTime\nNULL, NULL, NULL,                        -- CreatorId/LastModificationTime/LastModifierId\n${q(r?.AdvertiserId)},                   -- AdvertiserId\n${safeIsoToSqlDate(r?.Date)},            -- Date\n${q(r?.ProductImageUrl)},                -- ProductImageUrl\n${q(r?.ProductStatus)},                  -- ProductStatus\n${valCost(r?.Cost)}                      -- Cost\n)\"\"\"\n}\n\ndef sqlInsert = insertValues.isEmpty() ? \"\" : \"\"\"\nINSERT INTO [dbo].[Fact_FactGmvMaxProducts]\n([Id],[DimDateId],[DimBusinessCenterId],[DimAdAccountId],[DimCampaignId],[DimStoreId],[DimProductId],\n [CampaignId],[StoreId],[ProductId],[ProductName],[BcId],\n [Orders],[CostPerOrder],[CostPerOrderVND],[CostPerOrderUSD],\n [GrossRevenue],[GrossRevenueVND],[GrossRevenueUSD],\n [ROAS],[TACOS],\n [Currency],[CreationTime],[CreatorId],[LastModificationTime],[LastModifierId],\n [AdvertiserId],[Date],[ProductImageUrl],[ProductStatus],[Cost])\nSELECT\n v.Id,\n v.DimDateId, v.DimBusinessCenterId, v.DimAdAccountId, v.DimCampaignId, v.DimStoreId,\n d.Id AS DimProductId,\n v.CampaignId, v.StoreId, v.ProductId,\n LEFT(v.ProductName, 500) AS ProductName,\n v.BcId,\n v.Orders,\n v.CostPerOrder,\n CASE WHEN COALESCE(cur.Currency, '') = 'VND' THEN v.CostPerOrder ELSE NULL END AS CostPerOrderVND,\n CASE WHEN COALESCE(cur.Currency, '') = 'USD' THEN v.CostPerOrder ELSE NULL END AS CostPerOrderUSD,\n v.GrossRevenue,\n CASE WHEN COALESCE(cur.Currency, '') = 'VND' THEN v.GrossRevenue ELSE NULL END AS GrossRevenueVND,\n CASE WHEN COALESCE(cur.Currency, '') = 'USD' THEN v.GrossRevenue ELSE NULL END AS GrossRevenueUSD,\n v.ROAS, v.TACOS,\n COALESCE(cur.Currency, '') AS Currency,\n v.CreationTime, v.CreatorId, v.LastModificationTime, v.LastModifierId,\n v.AdvertiserId, v.Date,\n LEFT(v.ProductImageUrl, 1000) AS ProductImageUrl,\n v.ProductStatus, v.Cost\nFROM (VALUES\n${insertValues.join(\",\\n\")}\n) AS v(\n Id, DimDateId, DimBusinessCenterId, DimAdAccountId, DimCampaignId, DimStoreId,\n CampaignId, StoreId, ProductId, ProductName, BcId,\n Orders, CostPerOrder, CostPerOrderVND, CostPerOrderUSD,\n GrossRevenue, GrossRevenueVND, GrossRevenueUSD,\n ROAS, TACOS,\n Currency, CreationTime, CreatorId, LastModificationTime, LastModifierId,\n AdvertiserId, Date, ProductImageUrl, ProductStatus, Cost\n)\nJOIN [dbo].[Dim_DimProducts] d WITH (NOLOCK)\n  ON d.ProductId = v.ProductId\nOUTER APPLY (\n  SELECT TOP (1) aa.Currency\n  FROM [dbo].[Raw_RawAdAccounts] aa WITH (NOLOCK)\n  WHERE aa.AdvertiserId = v.AdvertiserId\n  ORDER BY ISNULL(aa.CreationTime, aa.CreateTime) DESC, aa.Id DESC\n) cur;\n\"\"\"\n\n// UPDATEs (Currency theo AdvertiserId; u tin CreationTime, fallback CreateTime)\ndef updateStatements = updates.collect { u ->\n    def r = u.raw\n    def existing = u.existing\n    if (r?.ProductId == null && r?.ItemGroupId != null) r.ProductId = r.ItemGroupId\n\n    def roas     = (r?.ROI != null ? r?.ROI : r?.ROAS)\n    def tacosVal = tacos(r?.Cost, r?.GrossRevenue)\n\n    def whereById = existing?.Id ? \"WHERE f.[Id] = ${qv(existing.Id)}\" : \"\"\"\nWHERE f.[BcId]         = ${q(bcId)}\n  AND f.[AdvertiserId] = ${q(r?.AdvertiserId)}\n  AND f.[CampaignId]   = ${q(r?.CampaignId)}\n  AND f.[StoreId]      = ${q(r?.StoreId)}\n  AND f.[ProductId]    = ${q(r?.ProductId)}\n  AND f.[Date]         = ${safeIsoToSqlDate(r?.Date)}\n\"\"\".trim()\n\n    \"\"\"\nUPDATE f\nSET f.ProductName          = LEFT(${q(r?.ProductName)}, 500),\n    f.Orders               = ${(intval(r?.Orders) == \"NULL\") ? \"0\" : intval(r?.Orders)},\n    f.CostPerOrder         = ${dec(r?.CostPerOrder)},\n    f.CostPerOrderVND      = CASE WHEN COALESCE(cur.Currency, '') = 'VND' THEN ${dec(r?.CostPerOrder)} ELSE NULL END,\n    f.CostPerOrderUSD      = CASE WHEN COALESCE(cur.Currency, '') = 'USD' THEN ${dec(r?.CostPerOrder)} ELSE NULL END,\n    f.GrossRevenue         = ${zeroIfNullDecimal(r?.GrossRevenue)},\n    f.GrossRevenueVND      = CASE WHEN COALESCE(cur.Currency, '') = 'VND' THEN ${zeroIfNullDecimal(r?.GrossRevenue)} ELSE NULL END,\n    f.GrossRevenueUSD      = CASE WHEN COALESCE(cur.Currency, '') = 'USD' THEN ${zeroIfNullDecimal(r?.GrossRevenue)} ELSE NULL END,\n    f.ROAS                 = ${dec(roas)},\n    f.TACOS                = ${dec(tacosVal)},\n    f.Currency             = COALESCE(cur.Currency, ''),\n    f.ProductImageUrl      = LEFT(${q(r?.ProductImageUrl)}, 1000),\n    f.ProductStatus        = ${q(r?.ProductStatus)},\n    f.Cost                 = ${zeroIfNullDecimal(r?.Cost)},\n    f.LastModificationTime = ${qv(now)}\nFROM [dbo].[Fact_FactGmvMaxProducts] f\nOUTER APPLY (\n  SELECT TOP (1) aa.Currency\n  FROM [dbo].[Raw_RawAdAccounts] aa WITH (NOLOCK)\n  WHERE aa.AdvertiserId = f.AdvertiserId\n  ORDER BY ISNULL(aa.CreationTime, aa.CreateTime) DESC, aa.Id DESC\n) cur\n${whereById}\n\"\"\".trim()\n}\n\ndef sqlUpdate = updateStatements.join(\";\\n\")\n\n// ---------- Final SQL ----------\ndef finalSql = new StringBuilder()\nif (sqlInsert?.trim()) finalSql.append(sqlInsert.trim()).append(\";\\n\")\nif (sqlUpdate?.trim()) finalSql.append(sqlUpdate.trim()).append(\";\\n\")\n\nflowFile = session.write(flowFile, { _, out ->\n    out.write((finalSql.toString()).getBytes(StandardCharsets.UTF_8))\n} as StreamCallback)\n\nsession.transfer(flowFile, REL_SUCCESS)",
            "groovyx-failure-strategy" : "rollback"
          },
          "propertyDescriptors" : {
            "groovyx-script-body" : {
              "displayName" : "Script Body",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-body",
              "sensitive" : false
            },
            "groovyx-failure-strategy" : {
              "displayName" : "Failure strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-failure-strategy",
              "sensitive" : false
            },
            "groovyx-additional-classpath" : {
              "displayName" : "Additional classpath",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-additional-classpath",
              "sensitive" : false
            },
            "groovyx-script-file" : {
              "displayName" : "Script File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-file",
              "resourceDefinition" : {
                "cardinality" : "SINGLE",
                "resourceTypes" : [ "FILE" ]
              },
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.groovyx.ExecuteGroovyScript",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "4c0bb538-025f-3c1e-bfd2-4288961a88a7",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LayDanhSachProductChuaETL",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 121.45950317382812,
            "y" : -264.0
          },
          "properties" : {
            "esql-max-rows" : "0",
            "dbf-default-precision" : "10",
            "Max Wait Time" : "0 seconds",
            "SQL Query" : "SELECT TOP (${state.pageSize})\n       r.[Id],\n       r.[BcId],\n       r.[AdvertiserId],\n       r.[StoreId],\n       r.[CampaignId],\n       r.[ItemGroupId] AS [ProductId], \n\t   r.[ProductName],\n       r.[ProductImageUrl],\n\t   r.[ProductStatus],     \n       r.[Orders],\n       r.[CostPerOrder],\n       r.[GrossRevenue],\n       r.[ROI],\n       r.[Cost],\n       r.[Currency],\n       r.[Date],\n       r.[CreationTime],\n       r.[CreatorId],\n       r.[LastModificationTime],\n       r.[LastModifierId]\nFROM [TikTokDWH].[dbo].[Raw_RawGmvMaxProductDetailProductReports] r\nWHERE r.[BcId] = '${stateBc.id}'\n  AND r.[AdvertiserId] IN ${stateAdAccounts.advertiserIds.inClause}\n  AND NOT EXISTS (\n      SELECT 1\n      FROM [TikTokDWH].[dbo].[Fact_FactGmvMaxProducts] f\n      WHERE f.[BcId]         = r.[BcId]\n        AND f.[AdvertiserId] = r.[AdvertiserId]\n        AND f.[CampaignId]   = r.[CampaignId]\n        AND f.[StoreId]      = r.[StoreId]\n        AND f.[ProductId]    = r.[ItemGroupId]\n        AND f.[Date]         = r.[Date]   -- so trc tip theo Date\n  )\nORDER BY r.[Date] DESC, r.[Id] DESC;",
            "Database Connection Pooling Service" : "6fce9190-8f74-3a75-9e56-36c3f8fc6d63",
            "esql-auto-commit" : "true",
            "dbf-user-logical-types" : "false",
            "dbf-default-scale" : "0",
            "compression-format" : "NONE",
            "esql-output-batch-size" : "0",
            "esql-fetch-size" : "0",
            "dbf-normalize" : "false",
            "Content Output Strategy" : "EMPTY"
          },
          "propertyDescriptors" : {
            "esql-max-rows" : {
              "displayName" : "Max Rows Per Flow File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-max-rows",
              "sensitive" : false
            },
            "dbf-default-precision" : {
              "displayName" : "Default Decimal Precision",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-precision",
              "sensitive" : false
            },
            "Max Wait Time" : {
              "displayName" : "Max Wait Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Max Wait Time",
              "sensitive" : false
            },
            "SQL Query" : {
              "displayName" : "SQL Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "SQL Query",
              "sensitive" : false
            },
            "Database Connection Pooling Service" : {
              "displayName" : "Database Connection Pooling Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Database Connection Pooling Service",
              "sensitive" : false
            },
            "sql-post-query" : {
              "displayName" : "SQL Post-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-post-query",
              "sensitive" : false
            },
            "esql-auto-commit" : {
              "displayName" : "Set Auto Commit",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-auto-commit",
              "sensitive" : false
            },
            "dbf-user-logical-types" : {
              "displayName" : "Use Avro Logical Types",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-user-logical-types",
              "sensitive" : false
            },
            "dbf-default-scale" : {
              "displayName" : "Default Decimal Scale",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-scale",
              "sensitive" : false
            },
            "sql-pre-query" : {
              "displayName" : "SQL Pre-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-pre-query",
              "sensitive" : false
            },
            "compression-format" : {
              "displayName" : "Compression Format",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "compression-format",
              "sensitive" : false
            },
            "esql-output-batch-size" : {
              "displayName" : "Output Batch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-output-batch-size",
              "sensitive" : false
            },
            "esql-fetch-size" : {
              "displayName" : "Fetch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-fetch-size",
              "sensitive" : false
            },
            "dbf-normalize" : {
              "displayName" : "Normalize Table/Column Names",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-normalize",
              "sensitive" : false
            },
            "Content Output Strategy" : {
              "displayName" : "Content Output Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Content Output Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "4b1310d9-863b-36fe-a025-b9c0e07e149f",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ConvertRecord",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 520.0,
            "y" : -264.0
          },
          "properties" : {
            "Include Zero Record FlowFiles" : "true",
            "Record Writer" : "877d4cf8-3ef9-3d3c-965f-0f85798a2a2f",
            "Record Reader" : "40a44711-6955-3e69-b463-371590dfa3ed"
          },
          "propertyDescriptors" : {
            "Include Zero Record FlowFiles" : {
              "displayName" : "Include Zero Record FlowFiles",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Include Zero Record FlowFiles",
              "sensitive" : false
            },
            "Record Writer" : {
              "displayName" : "Record Writer",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Writer",
              "sensitive" : false
            },
            "Record Reader" : {
              "displayName" : "Record Reader",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Reader",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ConvertRecord",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "retry" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "fc115f5a-433f-32a4-894d-6c4b7fa02d7b",
          "maxBackoffPeriod" : "10 mins",
          "name" : "InsertAndUpdateToDataBase",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2944.0,
            "y" : 944.0
          },
          "properties" : {
            "Support Fragmented Transactions" : "false",
            "Batch Size" : "#{PageSizeMax}",
            "Obtain Generated Keys" : "false",
            "JDBC Connection Pool" : "6fce9190-8f74-3a75-9e56-36c3f8fc6d63",
            "database-session-autocommit" : "true",
            "rollback-on-failure" : "false"
          },
          "propertyDescriptors" : {
            "Support Fragmented Transactions" : {
              "displayName" : "Support Fragmented Transactions",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Support Fragmented Transactions",
              "sensitive" : false
            },
            "putsql-sql-statement" : {
              "displayName" : "SQL Statement",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "putsql-sql-statement",
              "sensitive" : false
            },
            "Transaction Timeout" : {
              "displayName" : "Transaction Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Transaction Timeout",
              "sensitive" : false
            },
            "Batch Size" : {
              "displayName" : "Batch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Batch Size",
              "sensitive" : false
            },
            "Obtain Generated Keys" : {
              "displayName" : "Obtain Generated Keys",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Obtain Generated Keys",
              "sensitive" : false
            },
            "JDBC Connection Pool" : {
              "displayName" : "JDBC Connection Pool",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "JDBC Connection Pool",
              "sensitive" : false
            },
            "database-session-autocommit" : {
              "displayName" : "Database Session AutoCommit",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "database-session-autocommit",
              "sensitive" : false
            },
            "rollback-on-failure" : {
              "displayName" : "Rollback On Failure",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "rollback-on-failure",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.PutSQL",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "failure" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "2a69ecd3-7cc4-3f91-a00e-7d2f58597a04",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ConvertRecord",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2936.0,
            "y" : 360.0
          },
          "properties" : {
            "Include Zero Record FlowFiles" : "true",
            "Record Writer" : "877d4cf8-3ef9-3d3c-965f-0f85798a2a2f",
            "Record Reader" : "40a44711-6955-3e69-b463-371590dfa3ed"
          },
          "propertyDescriptors" : {
            "Include Zero Record FlowFiles" : {
              "displayName" : "Include Zero Record FlowFiles",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Include Zero Record FlowFiles",
              "sensitive" : false
            },
            "Record Writer" : {
              "displayName" : "Record Writer",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Writer",
              "sensitive" : false
            },
            "Record Reader" : {
              "displayName" : "Record Reader",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Reader",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ConvertRecord",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "faeb278f-0779-3c0c-a0c3-7a99e4a9ab99",
          "maxBackoffPeriod" : "10 mins",
          "name" : "KhoiTao",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : -254.54049682617188,
            "y" : -264.0
          },
          "properties" : {
            "stateCurrent.filename" : "${state.name}-bc-${stateBc.id}-product-page${state.page}.json",
            "filename" : "${state.name}-bc-${stateBc.id}-product-page${state.page}.json",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100",
            "stateCurrent.fullPath" : "#{TempPath}${Path.Separator}${state.name}${Path.Separator}${state.name}-bc-${stateBc.id}-product-page${state.page}.json",
            "skip" : "${state.page:toNumber():minus(1):multiply(${state.pageSize:toNumber()})}",
            "stateCurrent.directory" : "#{TempPath}${Path.Separator}${state.name}"
          },
          "propertyDescriptors" : {
            "stateCurrent.filename" : {
              "displayName" : "stateCurrent.filename",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateCurrent.filename",
              "sensitive" : false
            },
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "filename" : {
              "displayName" : "filename",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "filename",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "stateCurrent.fullPath" : {
              "displayName" : "stateCurrent.fullPath",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateCurrent.fullPath",
              "sensitive" : false
            },
            "skip" : {
              "displayName" : "skip",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "skip",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            },
            "stateCurrent.directory" : {
              "displayName" : "stateCurrent.directory",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateCurrent.directory",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "f223349f-a7e2-338f-b693-e510ac1912a4",
          "maxBackoffPeriod" : "10 mins",
          "name" : "UpdateAttributeContinueTrue",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1504.0,
            "y" : 928.0
          },
          "properties" : {
            "state.continue" : "1",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100"
          },
          "propertyDescriptors" : {
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "state.continue" : {
              "displayName" : "state.continue",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.continue",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "9b33f39e-382f-39f5-8843-42395fce7e05",
          "maxBackoffPeriod" : "10 mins",
          "name" : "UpdateAttributeContinueFalse",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 432.0,
            "y" : 480.0
          },
          "properties" : {
            "state.continue" : "0",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100"
          },
          "propertyDescriptors" : {
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "state.continue" : {
              "displayName" : "state.continue",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.continue",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "eca70d6d-a620-36b6-ad2e-8cfa1a990f46",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CleanupTempFile",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1392.0,
            "y" : 432.0
          },
          "properties" : {
            "Filename" : "${stateCurrent.filename}",
            "Directory Path" : "${stateCurrent.directory}"
          },
          "propertyDescriptors" : {
            "Filename" : {
              "displayName" : "Filename",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Filename",
              "sensitive" : false
            },
            "Directory Path" : {
              "displayName" : "Directory Path",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory Path",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.DeleteFile",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "c84b25a1-559b-3028-9e94-49af220040e5",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CheckHasData",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1458.853271484375,
            "y" : -256.0
          },
          "properties" : {
            "Routing Strategy" : "Route to Property name",
            "hasData" : "${hasData:equals('true')}"
          },
          "propertyDescriptors" : {
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "hasData" : {
              "displayName" : "hasData",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "hasData",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "1279f327-bf81-3602-b4d6-12ad79553f9f",
          "maxBackoffPeriod" : "10 mins",
          "name" : "SaveRawTemp",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1954.853271484375,
            "y" : -264.0
          },
          "properties" : {
            "Create Missing Directories" : "true",
            "Directory" : "${stateCurrent.directory}",
            "Conflict Resolution Strategy" : "replace"
          },
          "propertyDescriptors" : {
            "Group" : {
              "displayName" : "Group",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Group",
              "sensitive" : false
            },
            "Owner" : {
              "displayName" : "Owner",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Owner",
              "sensitive" : false
            },
            "Create Missing Directories" : {
              "displayName" : "Create Missing Directories",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Create Missing Directories",
              "sensitive" : false
            },
            "Permissions" : {
              "displayName" : "Permissions",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Permissions",
              "sensitive" : false
            },
            "Maximum File Count" : {
              "displayName" : "Maximum File Count",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum File Count",
              "sensitive" : false
            },
            "Last Modified Time" : {
              "displayName" : "Last Modified Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Last Modified Time",
              "sensitive" : false
            },
            "Directory" : {
              "displayName" : "Directory",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory",
              "sensitive" : false
            },
            "Conflict Resolution Strategy" : {
              "displayName" : "Conflict Resolution Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Conflict Resolution Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.PutFile",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-groovyx-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "e22b8d68-78f1-3555-9bd0-0c963e198fe1",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ChuanHoaDuLieuRaw",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 984.0,
            "y" : -264.0
          },
          "properties" : {
            "groovyx-script-body" : "import org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport groovy.json.JsonOutput\nimport java.time.LocalDateTime\nimport java.time.format.DateTimeFormatter\nimport java.time.format.DateTimeFormatterBuilder\nimport java.time.temporal.ChronoField\n\ndef flowFile = session.get()\nif (!flowFile) return\n\ndef hasData = false\ndef minDate = ''\ndef maxDate = ''\ndef lastPage = '0' // mc nh\n\n// Helper: chun ho list -> unique, trim, b rng + sort (u tin s)\ndef uniqList = { List raw ->\n    raw\n        .findAll { it != null }\n        .collect { it.toString().trim() }\n        .findAll { it.length() > 0 }\n        .toSet()\n        .toList()\n        .sort { a, b ->\n            try { (new BigDecimal(a) <=> new BigDecimal(b)) } catch (ignored) { a <=> b }\n        }\n}\n\n// Helper xut IN clause\ndef toInClause = { List lst -> '(' + lst.join(',') + ')' } // IN (1,2,3)\ndef toInClauseQuoted = { List lst ->\n    '(' + lst.collect { v ->\n        def s = v == null ? '' : v.toString().replace(\"'\", \"''\")\n        \"'${s}'\"\n    }.join(',') + ')'\n}\n\n// Ly pageSize t attribute\ndef pageSizeAttr = flowFile.getAttribute(\"state.pageSize\") ?: \"0\"\ndef pageSize = pageSizeAttr.toInteger()\n\n// B cha kt qu ID duy nht\ndef advertiserIdsUniq = []\ndef storeIdsUniq = []\ndef campaignIdsUniq = []\n\nflowFile = session.write(flowFile, { inputStream, outputStream ->\n    def content = inputStream.getText(StandardCharsets.UTF_8.name())\n    outputStream.write(content.getBytes(StandardCharsets.UTF_8))\n\n    def json = new JsonSlurper().parseText(content)\n    if (!(json instanceof List)) json = [json]\n\n    hasData = !json.isEmpty()\n\n    if (hasData) {\n        // parse 'Date' linh hot: \"yyyy-MM-dd['T'|' ']HH:mm:ss[.n...][Z]\"\n        def parseFormatter = new DateTimeFormatterBuilder()\n            .appendPattern(\"yyyy-MM-dd'T'HH:mm:ss\")\n            .optionalStart().appendFraction(ChronoField.NANO_OF_SECOND, 1, 7, true).optionalEnd()\n            .toFormatter()\n        def outputFormatter = DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss.SSSSSSS\")\n\n        // === TNH MIN/MAX THEO TRNG Date ===\n        def dates = json*.Date\n            .findAll { it != null }\n            .collect {\n                def s = it.toString().trim().replace(' ', 'T').replaceAll('[Zz]$', '')\n                LocalDateTime.parse(s, parseFormatter)\n            }\n\n        if (!dates.isEmpty()) {\n            minDate = dates.min().format(outputFormatter)\n            maxDate = dates.max().format(outputFormatter)\n        }\n\n        // === LY DANH SCH ID DUY NHT ===\n        advertiserIdsUniq = uniqList(json*.AdvertiserId)\n        storeIdsUniq      = uniqList(json*.StoreId)\n        campaignIdsUniq   = uniqList(json*.CampaignId)\n\n        // === NH DU TRANG CUI ===\n        if (pageSize > 0 && json.size() < pageSize) lastPage = '1'\n    }\n} as StreamCallback)\n\n// Chun b attributes a ra\ndef attrs = [\n    'hasData' : hasData.toString(),\n    'minDate' : minDate,\n    'maxDate' : maxDate,\n    'lastPage': lastPage\n]\n\n// Gn thm cc thuc tnh stateCurrent.* nu c d liu\nif (hasData) {\n    // JSON array\n    attrs['stateCurrent.advertiserIds'] = JsonOutput.toJson(advertiserIdsUniq)\n    attrs['stateCurrent.storeIds']      = JsonOutput.toJson(storeIdsUniq)\n    attrs['stateCurrent.campaignIds']   = JsonOutput.toJson(campaignIdsUniq)\n\n    // IN clause (khng nhy n  hp ID kiu s)\n    attrs['stateCurrent.advertiserIds.inClause'] = toInClauseQuoted(advertiserIdsUniq)\n    attrs['stateCurrent.storeIds.inClause']      = toInClauseQuoted(storeIdsUniq)\n    attrs['stateCurrent.campaignIds.inClause']   = toInClauseQuoted(campaignIdsUniq)\n\n    // Nu cn IN clause cho chui, dng:\n    // attrs['stateCurrent.campaignIds.inClauseQuoted'] = toInClauseQuoted(campaignIdsUniq)\n\n    // Min/Max date theo prefix stateCurrent.*\n    attrs['stateCurrent.minDate'] = (minDate ?: '')\n    attrs['stateCurrent.maxDate'] = (maxDate ?: '')\n}\n\nflowFile = session.putAllAttributes(flowFile, attrs)\nsession.transfer(flowFile, REL_SUCCESS)",
            "groovyx-failure-strategy" : "rollback"
          },
          "propertyDescriptors" : {
            "groovyx-script-body" : {
              "displayName" : "Script Body",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-body",
              "sensitive" : false
            },
            "groovyx-failure-strategy" : {
              "displayName" : "Failure strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-failure-strategy",
              "sensitive" : false
            },
            "groovyx-additional-classpath" : {
              "displayName" : "Additional classpath",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-additional-classpath",
              "sensitive" : false
            },
            "groovyx-script-file" : {
              "displayName" : "Script File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-file",
              "resourceDefinition" : {
                "cardinality" : "SINGLE",
                "resourceTypes" : [ "FILE" ]
              },
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.groovyx.ExecuteGroovyScript",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "0ae1940d-7fa9-3e2e-9251-785bc339b70f",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LayDanhSachDuLieuETLCu",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2936.0,
            "y" : 96.0
          },
          "properties" : {
            "esql-max-rows" : "0",
            "dbf-default-precision" : "10",
            "Max Wait Time" : "0 seconds",
            "SQL Query" : "SELECT\n    f.[Id],\n    f.[DimDateId],\n    f.[DimBusinessCenterId],\n    f.[DimAdAccountId],\n    f.[DimCampaignId],\n    f.[DimStoreId],\n    f.[DimProductId],\n    f.[CampaignId],\n    f.[StoreId],\n    f.[ProductId],\n    f.[BcId],\n    f.[AdvertiserId],\n    CONVERT(varchar(27), f.[Date], 126) AS [Date]\nFROM dbo.Fact_FactGmvMaxProducts AS f\nWHERE f.[Date] >= '${stateCurrent.minDate}'\n  AND f.[Date] <= '${stateCurrent.maxDate}'\n  AND f.[DimBusinessCenterId] = '${stateBc.dimId}'\n  AND f.[AdvertiserId] IN ${stateCurrent.advertiserIds.inClause}\n  AND f.[StoreId]      IN ${stateCurrent.storeIds.inClause}\n  AND f.[CampaignId]   IN ${stateCurrent.campaignIds.inClause}\nORDER BY f.[Date] DESC, f.[Id] DESC;",
            "Database Connection Pooling Service" : "6fce9190-8f74-3a75-9e56-36c3f8fc6d63",
            "esql-auto-commit" : "true",
            "dbf-user-logical-types" : "false",
            "dbf-default-scale" : "0",
            "compression-format" : "NONE",
            "esql-output-batch-size" : "0",
            "esql-fetch-size" : "0",
            "dbf-normalize" : "false",
            "Content Output Strategy" : "EMPTY"
          },
          "propertyDescriptors" : {
            "esql-max-rows" : {
              "displayName" : "Max Rows Per Flow File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-max-rows",
              "sensitive" : false
            },
            "dbf-default-precision" : {
              "displayName" : "Default Decimal Precision",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-precision",
              "sensitive" : false
            },
            "Max Wait Time" : {
              "displayName" : "Max Wait Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Max Wait Time",
              "sensitive" : false
            },
            "SQL Query" : {
              "displayName" : "SQL Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "SQL Query",
              "sensitive" : false
            },
            "Database Connection Pooling Service" : {
              "displayName" : "Database Connection Pooling Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Database Connection Pooling Service",
              "sensitive" : false
            },
            "sql-post-query" : {
              "displayName" : "SQL Post-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-post-query",
              "sensitive" : false
            },
            "esql-auto-commit" : {
              "displayName" : "Set Auto Commit",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-auto-commit",
              "sensitive" : false
            },
            "dbf-user-logical-types" : {
              "displayName" : "Use Avro Logical Types",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-user-logical-types",
              "sensitive" : false
            },
            "dbf-default-scale" : {
              "displayName" : "Default Decimal Scale",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-scale",
              "sensitive" : false
            },
            "sql-pre-query" : {
              "displayName" : "SQL Pre-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-pre-query",
              "sensitive" : false
            },
            "compression-format" : {
              "displayName" : "Compression Format",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "compression-format",
              "sensitive" : false
            },
            "esql-output-batch-size" : {
              "displayName" : "Output Batch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-output-batch-size",
              "sensitive" : false
            },
            "esql-fetch-size" : {
              "displayName" : "Fetch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-fetch-size",
              "sensitive" : false
            },
            "dbf-normalize" : {
              "displayName" : "Normalize Table/Column Names",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-normalize",
              "sensitive" : false
            },
            "Content Output Strategy" : {
              "displayName" : "Content Output Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Content Output Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "5790e481-70d2-338f-ba8f-262473e7253e",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CleanupTemp",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 992.0,
            "y" : 952.0
          },
          "properties" : {
            "Filename" : "${stateCurrent.filename}",
            "Directory Path" : "${stateCurrent.directory}"
          },
          "propertyDescriptors" : {
            "Filename" : {
              "displayName" : "Filename",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Filename",
              "sensitive" : false
            },
            "Directory Path" : {
              "displayName" : "Directory Path",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory Path",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.DeleteFile",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "ee6ebdd3-b27f-3827-889f-57cbd1d8fbd9",
          "identifier" : "32b11acf-f563-3eac-a3a1-dd018014fcaa",
          "maxBackoffPeriod" : "10 mins",
          "name" : "RouteOnAttributeCheckLastPage",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1928.0,
            "y" : 936.0
          },
          "properties" : {
            "Routing Strategy" : "Route to Property name",
            "isLastPage" : "${lastPage:equals('1')}"
          },
          "propertyDescriptors" : {
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "isLastPage" : {
              "displayName" : "isLastPage",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "isLastPage",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        } ],
        "remoteProcessGroups" : [ ],
        "scheduledState" : "ENABLED",
        "statelessFlowTimeout" : "1 min"
      } ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
        "identifier" : "78e62aa6-dbdc-3752-b5b9-e65f192bd978",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KiemTraCoTrangTiepTheo",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : 544.0
        },
        "properties" : {
          "Routing Strategy" : "Route to Property name",
          "nextPage" : "${state.continue:equals(1)}"
        },
        "propertyDescriptors" : {
          "Routing Strategy" : {
            "displayName" : "Routing Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Routing Strategy",
            "sensitive" : false
          },
          "nextPage" : {
            "displayName" : "nextPage",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "nextPage",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
        "identifier" : "666add7a-1036-3107-bd56-eeb4843f46dc",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KhoiTao",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 24.0,
          "y" : -72.0
        },
        "properties" : {
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.page" : "1",
          "stateAdAccounts.advertiserIds.inClause" : "${stateAdAccounts.advertiserIds\n  :replaceAll('^\\\\[|\\\\]$', '')\n  :replaceAll('\"', '\\'')\n  :prepend('(')\n  :append(')')}",
          "state.pageSize" : "#{PageSizeMax}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.page" : {
            "displayName" : "state.page",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.page",
            "sensitive" : false
          },
          "stateAdAccounts.advertiserIds.inClause" : {
            "displayName" : "stateAdAccounts.advertiserIds.inClause",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.advertiserIds.inClause",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.pageSize" : {
            "displayName" : "state.pageSize",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.pageSize",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "4a3e54b2-a5c1-30d2-817c-f9c25711c7f4",
        "identifier" : "929e8512-f37d-3887-aa33-e32879df6c86",
        "maxBackoffPeriod" : "10 mins",
        "name" : "TrangTiepTheo",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 832.0,
          "y" : 208.0
        },
        "properties" : {
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.page" : "${state.page:toNumber():plus(1)}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.page" : {
            "displayName" : "state.page",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.page",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
          "id" : "e8bd7c00-c2df-3a99-bd06-0264162ddb83",
          "name" : "KhoiTao",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
        "identifier" : "6a018232-45cb-362d-8f6b-fed456ea416c",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
          "id" : "1f024838-4692-38aa-a66e-2150644fac99",
          "name" : "input",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
          "id" : "8e78709b-917c-3f39-ba4d-e99ae602e908",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
        "identifier" : "e78ea914-b4d2-3054-9d1c-eb3d43c07970",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
          "id" : "e8bd7c00-c2df-3a99-bd06-0264162ddb83",
          "name" : "KhoiTao",
          "type" : "PROCESSOR"
        },
        "zIndex" : 34
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
          "id" : "1d51748c-cb5d-3f17-b570-d02049b2a48a",
          "name" : "ouput",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
        "identifier" : "6479ff4a-d105-3b9c-861a-888772d02d32",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
          "id" : "8e78709b-917c-3f39-ba4d-e99ae602e908",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
          "id" : "5b948ce4-8dbd-37a0-b054-5b1ff76add22",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
        "identifier" : "1c0f4553-76c8-310c-888e-9a99abce85f4",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
          "id" : "8e78709b-917c-3f39-ba4d-e99ae602e908",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "zIndex" : 36
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
        "identifier" : "1f024838-4692-38aa-a66e-2150644fac99",
        "name" : "input",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 160.0,
          "y" : -704.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LayTrangThaiETL",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
        "identifier" : "1d51748c-cb5d-3f17-b570-d02049b2a48a",
        "name" : "ouput",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 160.0,
          "y" : 112.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -200.0,
        "y" : 8.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
        "identifier" : "5b948ce4-8dbd-37a0-b054-5b1ff76add22",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : -528.0,
          "y" : -192.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-scripting-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
        "identifier" : "8e78709b-917c-3f39-ba4d-e99ae602e908",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LayTrangThai",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 104.0,
          "y" : -192.0
        },
        "properties" : {
          "Script Engine" : "Groovy",
          "Script Body" : "import groovy.json.JsonSlurper\nimport groovy.json.JsonBuilder\nimport java.nio.file.*\nimport java.time.Instant\nimport java.time.ZoneOffset\nimport java.time.format.DateTimeFormatter\nimport java.time.LocalDateTime\nimport java.time.LocalDate\nimport org.apache.nifi.processor.io.OutputStreamCallback\n\ndef flowFile = session.get()\nif (!flowFile) return\n\n// Ly parameters t attributes\ndef etlName   = flowFile.getAttribute('state.name')\ndef statePath = flowFile.getAttribute('state.path')\ndef filename  = flowFile.getAttribute('state.filename')\n\nif (!etlName || !statePath || !filename) {\n    log.error(\"Missing required attributes: state.name, state.path, or state.filename\")\n    flowFile = session.putAttribute(flowFile, 'error.message', 'Missing state.name, state.path, or state.filename attributes')\n    session.transfer(flowFile, REL_FAILURE)\n    return\n}\n\n// To ng dn y \ndef stateFilePath = Paths.get(statePath, filename).toString()\n\ntry {\n    def stateContent = \"\"\n    def stateExists = false\n\n    // nh dng thi gian UTC\n    def formatter = DateTimeFormatter.ofPattern(\"yyyy/MM/dd HH:mm:ss\")\n    def currentTimeUTC = Instant.now().atZone(ZoneOffset.UTC).format(formatter)\n    def defaultStartTime = \"2025/01/01 00:00:00\"\n\n    // Gi tr mc nh cho state\n    def defaultState = [\n        name: etlName,\n        isActive: false,\n        lastExecutionTime: currentTimeUTC,\n        startTime: defaultStartTime,\n        endTime: currentTimeUTC,\n        sequenceNumber: 1, // ln chy u tin\n        status: 0,         // 0: khi to\n        message: \"\"        // trng\n    ]\n\n    // c file trng thi nu c\n    def path = Paths.get(stateFilePath)\n    if (Files.exists(path)) {\n        stateContent = new String(Files.readAllBytes(path), \"UTF-8\")\n        stateExists = true\n        log.info(\"State file found for ETL '${etlName}' at '${stateFilePath}': \" + stateContent)\n    } else {\n        stateContent = new JsonBuilder(defaultState).toString()\n        stateExists = false\n        log.info(\"State file not found for ETL '${etlName}' at '${stateFilePath}', creating default state\")\n    }\n\n    // Parse JSON, li th fallback default\n    def jsonSlurper = new JsonSlurper()\n    Map state\n    try {\n        state = (Map) jsonSlurper.parseText(stateContent)\n    } catch (Throwable ex) {\n        log.warn(\"Invalid state content, fallback to default. Error: ${ex.message}\")\n        state = new LinkedHashMap(defaultState)\n        stateExists = false\n    }\n\n    // Chun ho cc trng c bn\n    state.name = etlName\n    state.isActive = (state.containsKey('isActive') && state.isActive != null) ? state.isActive as Boolean : false\n    state.lastExecutionTime = (state.lastExecutionTime ?: currentTimeUTC)\n    state.startTime = (state.startTime ?: defaultStartTime)\n    state.endTime = (state.endTime ?: currentTimeUTC)\n\n    // Gi tr hin hu  dng cho logic ca s mi\n    def oldEndTime = (state.endTime && state.endTime.toString().trim()) ? state.endTime.toString() : defaultStartTime\n\n    // 3 trng b sung\n    Integer seq = 1\n    if (state.containsKey('sequenceNumber') && state.sequenceNumber != null && \"${state.sequenceNumber}\".isInteger()) {\n        seq = (state.sequenceNumber as Integer)\n        if (seq <= 0) seq = 1\n    }\n    Integer prevStatus = 0\n    if (state.containsKey('status') && state.status != null && \"${state.status}\".isInteger()) {\n        prevStatus = (state.status as Integer)\n    }\n    String msg = (state.containsKey('message') && state.message != null) ? (state.message as String) : \"\"\n\n    // --- LOGIC MI: to ca s ETL mi nu status = 0 hoc 2 ---\n    // Gii thch:\n    //  - 0 (khi to) hoc 2 (hon thnh) => ln ETL trc  kt thc bnh thng.\n    //  - startTime = endTime (c) vi gi pht giy 00:00:00 ; endTime = currentTimeUTC ; lastExecutionTime = endTime (c)\n    boolean shouldCreateNewWindow = stateExists && (prevStatus == 0 || prevStatus == 2)\n    if (shouldCreateNewWindow) {\n        // Parse oldEndTime v t li gi pht giy thnh 00:00:00\n        def newStartTime = oldEndTime\n        try {\n            def oldEndTimeParsed = LocalDateTime.parse(oldEndTime, formatter)\n            def dateOnly = oldEndTimeParsed.toLocalDate()\n            def startOfDay = dateOnly.atStartOfDay()\n            newStartTime = startOfDay.format(formatter)\n            log.info(\"Parsed oldEndTime '${oldEndTime}' to start of day: '${newStartTime}'\")\n        } catch (Exception ex) {\n            log.warn(\"Could not parse oldEndTime '${oldEndTime}', using as-is. Error: ${ex.message}\")\n            newStartTime = oldEndTime\n        }\n        \n        state.startTime = newStartTime\n        state.endTime = currentTimeUTC\n        log.info(\"Create new ETL window: startTime=${state.startTime} (reset to 00:00:00), endTime=${state.endTime}, lastExecutionTime=${state.lastExecutionTime}\")\n    }\n\n    // Nu file  tn ti:\n    //  - Nu prevStatus == 2 (hon thnh) -> tng sequenceNumber\n    //  - t status = 0 (khi to), message = \"\"\n    if (stateExists) {\n        if (prevStatus == 2) {\n            seq = seq + 1\n            log.info(\"Previous status=2 (completed). Increase sequenceNumber to ${seq}\")\n        }\n        prevStatus = 0\n        msg = \"\"\n    } else {\n        // state mi\n        prevStatus = 0\n        msg = \"\"\n        seq = 1\n    }\n\n    // Gn li vo state\n    state.sequenceNumber = seq\n    state.status = prevStatus\n    state.message = msg\n\n    // Ghi attributes ra flowfile\n    flowFile = session.putAttribute(flowFile, 'state.exists', stateExists.toString())\n    flowFile = session.putAttribute(flowFile, 'state.name', state.name.toString())\n    flowFile = session.putAttribute(flowFile, 'state.isActive', state.isActive.toString())\n    flowFile = session.putAttribute(flowFile, 'state.lastExecutionTime', state.lastExecutionTime.toString())\n    flowFile = session.putAttribute(flowFile, 'state.startTime', state.startTime.toString())\n    flowFile = session.putAttribute(flowFile, 'state.endTime', state.endTime.toString())\n    flowFile = session.putAttribute(flowFile, 'state.sequenceNumber', state.sequenceNumber.toString())\n    flowFile = session.putAttribute(flowFile, 'state.status', state.status.toString())\n    flowFile = session.putAttribute(flowFile, 'state.message', state.message.toString())\n    flowFile = session.putAttribute(flowFile, 'state.fullPath', stateFilePath)\n\n    // To JSON content chun ho\n    def stateContentForFlowFile = [\n        name: state.name,\n        isActive: state.isActive,\n        lastExecutionTime: state.lastExecutionTime,\n        startTime: state.startTime,\n        endTime: state.endTime,\n        sequenceNumber: state.sequenceNumber,\n        status: state.status,\n        message: state.message\n    ]\n\n    // Ghi JSON vo content\n    def contentJson = new JsonBuilder(stateContentForFlowFile).toString()\n    flowFile = session.write(flowFile, { outputStream ->\n        outputStream.write(contentJson.getBytes(\"UTF-8\"))\n    } as OutputStreamCallback)\n\n    // Lu ton b JSON sau chun ho vo attribute\n    flowFile = session.putAttribute(flowFile, 'state.content', contentJson)\n\n    session.transfer(flowFile, REL_SUCCESS)\n\n} catch (Exception e) {\n    log.error(\"Error reading state file for ETL '${etlName}' at '${stateFilePath}': \" + e.getMessage(), e)\n    flowFile = session.putAttribute(flowFile, 'error.message', e.getMessage())\n    session.transfer(flowFile, REL_FAILURE)\n}"
        },
        "propertyDescriptors" : {
          "Script File" : {
            "displayName" : "Script File",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script File",
            "resourceDefinition" : {
              "cardinality" : "SINGLE",
              "resourceTypes" : [ "FILE" ]
            },
            "sensitive" : false
          },
          "Script Engine" : {
            "displayName" : "Script Engine",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script Engine",
            "sensitive" : false
          },
          "Script Body" : {
            "displayName" : "Script Body",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script Body",
            "sensitive" : false
          },
          "Module Directory" : {
            "displayName" : "Module Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Module Directory",
            "resourceDefinition" : {
              "cardinality" : "MULTIPLE",
              "resourceTypes" : [ "FILE", "DIRECTORY" ]
            },
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.script.ExecuteScript",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "18980c24-b7b9-34b8-8f87-2bd82d0742a6",
        "identifier" : "e8bd7c00-c2df-3a99-bd06-0264162ddb83",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KhoiTao",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 104.0,
          "y" : -480.0
        },
        "properties" : {
          "filename" : "state.json",
          "state.startTime" : "${now():format(\"yyyy-MM-dd 00:00:00\", \"UTC\")}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.endTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}",
          "state.path" : "#{TempPath}#{Path.Separator}${state.name}",
          "state.isActive" : "false",
          "state.filename" : "state.json"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "state.startTime" : {
            "displayName" : "state.startTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.startTime",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.endTime" : {
            "displayName" : "state.endTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.endTime",
            "sensitive" : false
          },
          "state.path" : {
            "displayName" : "state.path",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.path",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.isActive" : {
            "displayName" : "state.isActive",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.isActive",
            "sensitive" : false
          },
          "state.filename" : {
            "displayName" : "state.filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.filename",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
          "id" : "c9e6116b-f8be-336c-b352-601cc5db7a84",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
        "identifier" : "c6baac0f-8ab1-30fc-9c3a-c41c60708885",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
          "id" : "76323cc2-cbc3-37d4-a22b-4eab50d920a4",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
          "id" : "76323cc2-cbc3-37d4-a22b-4eab50d920a4",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
        "identifier" : "fd9fcd0f-a3a3-39ed-abd3-c3a2e225ad12",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
          "id" : "0c4be40f-420b-3d1f-bb7c-8d3e35bc0a5d",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
          "id" : "77ce4d85-b6a3-38e0-8553-1ba4da30ba7c",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
        "identifier" : "a8c4cbd5-0727-3fda-bf82-7b43ca272a43",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
          "id" : "0e8881ae-6778-343c-a439-0ea19c8b1f47",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
          "id" : "c9e6116b-f8be-336c-b352-601cc5db7a84",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
        "identifier" : "0f637272-d881-33a2-98e9-32b5053c42b2",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
          "id" : "0c4be40f-420b-3d1f-bb7c-8d3e35bc0a5d",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
          "id" : "0c4be40f-420b-3d1f-bb7c-8d3e35bc0a5d",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
        "identifier" : "c9ff7894-671e-301b-a933-c916b9498581",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
          "id" : "77ce4d85-b6a3-38e0-8553-1ba4da30ba7c",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
          "id" : "6458f52c-f730-3fc8-95ca-54c3a703abed",
          "name" : "input",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
        "identifier" : "7ee7dd49-d979-3e18-bad6-fec8d9bf1556",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
          "id" : "76323cc2-cbc3-37d4-a22b-4eab50d920a4",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
        "identifier" : "0e8881ae-6778-343c-a439-0ea19c8b1f47",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "KetThucETLVoiLoi",
      "outputPorts" : [ ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -704.0,
        "y" : 1712.0
      },
      "processGroups" : [ {
        "comments" : "",
        "componentType" : "PROCESS_GROUP",
        "connections" : [ {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
            "id" : "c441e7bc-5e7d-3dae-8d8d-7292a7d9172f",
            "name" : "LaythongtinTelegramCauHinh",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
          "identifier" : "c151cf6e-0b1d-34d4-bac1-785d3543caa6",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
            "id" : "6458f52c-f730-3fc8-95ca-54c3a703abed",
            "name" : "input",
            "type" : "INPUT_PORT"
          },
          "zIndex" : 1
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
            "id" : "410cd2f6-a496-3836-9fba-6e1d3d8e6be4",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
          "identifier" : "d96f0fb8-72b4-3677-bbff-82d295977776",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
            "id" : "e9055679-6c73-3914-b27b-3cb9cd7f2e33",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "zIndex" : 9
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
            "id" : "10a6d58f-4c7e-3c40-8872-774a1ce2027d",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
          "identifier" : "3def16dc-af56-356d-82af-c201bcb4a3e1",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
            "id" : "c441e7bc-5e7d-3dae-8d8d-7292a7d9172f",
            "name" : "LaythongtinTelegramCauHinh",
            "type" : "PROCESSOR"
          },
          "zIndex" : 6
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
            "id" : "410cd2f6-a496-3836-9fba-6e1d3d8e6be4",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
          "identifier" : "9fa729e5-ee15-35bf-96ea-94845d1a36c6",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "Response", "Failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
            "id" : "593f5814-eb9a-395f-8633-507d9a321656",
            "name" : "GuiTinNhanTelegram",
            "type" : "PROCESSOR"
          },
          "zIndex" : 5
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
            "id" : "e9055679-6c73-3914-b27b-3cb9cd7f2e33",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
          "identifier" : "a5191bdb-494a-351f-98f1-2dfd244ec0c0",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "send" ],
          "source" : {
            "comments" : "",
            "groupId" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
            "id" : "10a6d58f-4c7e-3c40-8872-774a1ce2027d",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "zIndex" : 8
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
            "id" : "593f5814-eb9a-395f-8633-507d9a321656",
            "name" : "GuiTinNhanTelegram",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
          "identifier" : "ac274d4b-5a1e-3307-b250-5ede411e9b3a",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
            "id" : "e9055679-6c73-3914-b27b-3cb9cd7f2e33",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "zIndex" : 7
        } ],
        "controllerServices" : [ ],
        "defaultBackPressureDataSizeThreshold" : "1 GB",
        "defaultBackPressureObjectThreshold" : 10000,
        "defaultFlowFileExpiration" : "0 sec",
        "executionEngine" : "INHERITED",
        "flowFileConcurrency" : "UNBOUNDED",
        "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
        "funnels" : [ ],
        "groupIdentifier" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
        "identifier" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
        "inputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "INPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
          "identifier" : "6458f52c-f730-3fc8-95ca-54c3a703abed",
          "name" : "input",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : -1056.0,
            "y" : -248.0
          },
          "scheduledState" : "ENABLED",
          "type" : "INPUT_PORT"
        } ],
        "labels" : [ ],
        "maxConcurrentTasks" : 1,
        "name" : "GuiThongBaoTelegram",
        "outputPorts" : [ ],
        "position" : {
          "x" : 1432.0,
          "y" : -272.0
        },
        "processGroups" : [ ],
        "processors" : [ {
          "autoTerminatedRelationships" : [ "success" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
          "identifier" : "410cd2f6-a496-3836-9fba-6e1d3d8e6be4",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LogMessage",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 224.0,
            "y" : 32.0
          },
          "properties" : {
            "log-level" : "info"
          },
          "propertyDescriptors" : {
            "log-message" : {
              "displayName" : "Log message",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-message",
              "sensitive" : false
            },
            "log-level" : {
              "displayName" : "Log Level",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-level",
              "sensitive" : false
            },
            "log-prefix" : {
              "displayName" : "Log prefix",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-prefix",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.LogMessage",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
          "identifier" : "e9055679-6c73-3914-b27b-3cb9cd7f2e33",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ReplaceText",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 200.0,
            "y" : -288.0
          },
          "properties" : {
            "Regular Expression" : "(?s)^(.*)$",
            "Replacement Value" : "{\"chat_id\":\"#{ChatId}\",\"text\":\"${telegram.text}\"}",
            "Evaluation Mode" : "Entire text",
            "Line-by-Line Evaluation Mode" : "All",
            "Character Set" : "UTF-8",
            "Maximum Buffer Size" : "1 MB",
            "Replacement Strategy" : "Regex Replace"
          },
          "propertyDescriptors" : {
            "Regular Expression" : {
              "displayName" : "Search Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Regular Expression",
              "sensitive" : false
            },
            "Replacement Value" : {
              "displayName" : "Replacement Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Value",
              "sensitive" : false
            },
            "Evaluation Mode" : {
              "displayName" : "Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Evaluation Mode",
              "sensitive" : false
            },
            "Text to Prepend" : {
              "displayName" : "Text to Prepend",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Prepend",
              "sensitive" : false
            },
            "Line-by-Line Evaluation Mode" : {
              "displayName" : "Line-by-Line Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Line-by-Line Evaluation Mode",
              "sensitive" : false
            },
            "Character Set" : {
              "displayName" : "Character Set",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Character Set",
              "sensitive" : false
            },
            "Maximum Buffer Size" : {
              "displayName" : "Maximum Buffer Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum Buffer Size",
              "sensitive" : false
            },
            "Replacement Strategy" : {
              "displayName" : "Replacement Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Strategy",
              "sensitive" : false
            },
            "Text to Append" : {
              "displayName" : "Text to Append",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Append",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ReplaceText",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "No Retry", "Retry", "Original" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
          "identifier" : "593f5814-eb9a-395f-8633-507d9a321656",
          "maxBackoffPeriod" : "10 mins",
          "name" : "GuiTinNhanTelegram",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 656.0,
            "y" : -296.0
          },
          "properties" : {
            "Request Content-Encoding" : "DISABLED",
            "Request Multipart Form-Data Filename Enabled" : "true",
            "Request Chunked Transfer-Encoding Enabled" : "false",
            "HTTP/2 Disabled" : "False",
            "Connection Timeout" : "30 secs",
            "Response Cookie Strategy" : "DISABLED",
            "Socket Read Timeout" : "15 secs",
            "Socket Idle Connections" : "5",
            "Request Body Enabled" : "true",
            "OAuth2 Access Token Refresh Strategy" : "ON_TOKEN_EXPIRATION",
            "HTTP URL" : "https://api.telegram.org/bot#{BotToken}/sendMessage",
            "Socket Idle Timeout" : "5 mins",
            "Response Redirects Enabled" : "True",
            "Socket Write Timeout" : "15 secs",
            "Response FlowFile Naming Strategy" : "RANDOM",
            "Response Cache Enabled" : "false",
            "Request Date Header Enabled" : "True",
            "Request Failure Penalization Enabled" : "false",
            "Response Body Attribute Size" : "256",
            "Response Generation Required" : "false",
            "Response Header Request Attributes Enabled" : "false",
            "HTTP Method" : "POST",
            "Request Content-Type" : "application/json",
            "Request Digest Authentication Enabled" : "false",
            "Response Cache Size" : "10MB",
            "Response Body Ignored" : "false"
          },
          "propertyDescriptors" : {
            "Request Content-Encoding" : {
              "displayName" : "Request Content-Encoding",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Content-Encoding",
              "sensitive" : false
            },
            "proxy-configuration-service" : {
              "displayName" : "Proxy Configuration Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "proxy-configuration-service",
              "sensitive" : false
            },
            "Request Multipart Form-Data Filename Enabled" : {
              "displayName" : "Request Multipart Form-Data Filename Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Multipart Form-Data Filename Enabled",
              "sensitive" : false
            },
            "Request Chunked Transfer-Encoding Enabled" : {
              "displayName" : "Request Chunked Transfer-Encoding Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Chunked Transfer-Encoding Enabled",
              "sensitive" : false
            },
            "Response Header Request Attributes Prefix" : {
              "displayName" : "Response Header Request Attributes Prefix",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Header Request Attributes Prefix",
              "sensitive" : false
            },
            "HTTP/2 Disabled" : {
              "displayName" : "HTTP/2 Disabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP/2 Disabled",
              "sensitive" : false
            },
            "Connection Timeout" : {
              "displayName" : "Connection Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Connection Timeout",
              "sensitive" : false
            },
            "Response Cookie Strategy" : {
              "displayName" : "Response Cookie Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cookie Strategy",
              "sensitive" : false
            },
            "Request Password" : {
              "displayName" : "Request Password",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Password",
              "sensitive" : true
            },
            "Socket Read Timeout" : {
              "displayName" : "Socket Read Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Read Timeout",
              "sensitive" : false
            },
            "Socket Idle Connections" : {
              "displayName" : "Socket Idle Connections",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Idle Connections",
              "sensitive" : false
            },
            "Request Body Enabled" : {
              "displayName" : "Request Body Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Body Enabled",
              "sensitive" : false
            },
            "OAuth2 Access Token Refresh Strategy" : {
              "displayName" : "OAuth2 Access Token Refresh Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "OAuth2 Access Token Refresh Strategy",
              "sensitive" : false
            },
            "HTTP URL" : {
              "displayName" : "HTTP URL",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP URL",
              "sensitive" : false
            },
            "Request OAuth2 Access Token Provider" : {
              "displayName" : "Request OAuth2 Access Token Provider",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Request OAuth2 Access Token Provider",
              "sensitive" : false
            },
            "Socket Idle Timeout" : {
              "displayName" : "Socket Idle Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Idle Timeout",
              "sensitive" : false
            },
            "Response Redirects Enabled" : {
              "displayName" : "Response Redirects Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Redirects Enabled",
              "sensitive" : false
            },
            "Socket Write Timeout" : {
              "displayName" : "Socket Write Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Write Timeout",
              "sensitive" : false
            },
            "Request Header Attributes Pattern" : {
              "displayName" : "Request Header Attributes Pattern",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Header Attributes Pattern",
              "sensitive" : false
            },
            "Response FlowFile Naming Strategy" : {
              "displayName" : "Response FlowFile Naming Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response FlowFile Naming Strategy",
              "sensitive" : false
            },
            "Response Cache Enabled" : {
              "displayName" : "Response Cache Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cache Enabled",
              "sensitive" : false
            },
            "Request Date Header Enabled" : {
              "displayName" : "Request Date Header Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Date Header Enabled",
              "sensitive" : false
            },
            "Request Failure Penalization Enabled" : {
              "displayName" : "Request Failure Penalization Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Failure Penalization Enabled",
              "sensitive" : false
            },
            "Response Body Attribute Size" : {
              "displayName" : "Response Body Attribute Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Attribute Size",
              "sensitive" : false
            },
            "SSL Context Service" : {
              "displayName" : "SSL Context Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "SSL Context Service",
              "sensitive" : false
            },
            "Response Generation Required" : {
              "displayName" : "Response Generation Required",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Generation Required",
              "sensitive" : false
            },
            "Request User-Agent" : {
              "displayName" : "Request User-Agent",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request User-Agent",
              "sensitive" : false
            },
            "Response Header Request Attributes Enabled" : {
              "displayName" : "Response Header Request Attributes Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Header Request Attributes Enabled",
              "sensitive" : false
            },
            "HTTP Method" : {
              "displayName" : "HTTP Method",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP Method",
              "sensitive" : false
            },
            "Request Username" : {
              "displayName" : "Request Username",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Username",
              "sensitive" : false
            },
            "Request Content-Type" : {
              "displayName" : "Request Content-Type",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Content-Type",
              "sensitive" : false
            },
            "Response Body Attribute Name" : {
              "displayName" : "Response Body Attribute Name",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Attribute Name",
              "sensitive" : false
            },
            "Request Digest Authentication Enabled" : {
              "displayName" : "Request Digest Authentication Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Digest Authentication Enabled",
              "sensitive" : false
            },
            "Request Multipart Form-Data Name" : {
              "displayName" : "Request Multipart Form-Data Name",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Multipart Form-Data Name",
              "sensitive" : false
            },
            "Response Cache Size" : {
              "displayName" : "Response Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cache Size",
              "sensitive" : false
            },
            "Response Body Ignored" : {
              "displayName" : "Response Body Ignored",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Ignored",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
          "identifier" : "c441e7bc-5e7d-3dae-8d8d-7292a7d9172f",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LaythongtinTelegramCauHinh",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : -656.0,
            "y" : -280.0
          },
          "properties" : {
            "telegram.botToken" : "#{BotToken}",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100",
            "telegram.chatId" : "#{ChatId}",
            "telegram.enabled" : "#{Enabled}",
            "telegram.text" : " MESSAGE ALERT\n Application: NIFI\n Flow: ${state.name}\n Message: ${state.message}"
          },
          "propertyDescriptors" : {
            "telegram.botToken" : {
              "displayName" : "telegram.botToken",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.botToken",
              "sensitive" : false
            },
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "telegram.chatId" : {
              "displayName" : "telegram.chatId",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.chatId",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            },
            "telegram.enabled" : {
              "displayName" : "telegram.enabled",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.enabled",
              "sensitive" : false
            },
            "telegram.text" : {
              "displayName" : "telegram.text",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.text",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "unmatched" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "fe9716c1-4caf-3bb6-8273-27c89fc036b5",
          "identifier" : "10a6d58f-4c7e-3c40-8872-774a1ce2027d",
          "maxBackoffPeriod" : "10 mins",
          "name" : "RouteOnAttribute",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : -184.0,
            "y" : -288.0
          },
          "properties" : {
            "Routing Strategy" : "Route to Property name",
            "send" : "${telegram.enabled:equals('true')}"
          },
          "propertyDescriptors" : {
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "send" : {
              "displayName" : "send",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "send",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        } ],
        "remoteProcessGroups" : [ ],
        "scheduledState" : "ENABLED",
        "statelessFlowTimeout" : "1 min"
      } ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
        "identifier" : "76323cc2-cbc3-37d4-a22b-4eab50d920a4",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 904.0,
          "y" : -240.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${state.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
        "identifier" : "77ce4d85-b6a3-38e0-8553-1ba4da30ba7c",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "state.message" : "Li khi duyt tng BC",
          "filename" : "${state.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.status" : "3",
          "state.isActive" : "false",
          "state.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "state.message" : {
            "displayName" : "state.message",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.message",
            "sensitive" : false
          },
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.status" : {
            "displayName" : "state.status",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.status",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.isActive" : {
            "displayName" : "state.isActive",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.isActive",
            "sensitive" : false
          },
          "state.lastExecutionTime" : {
            "displayName" : "state.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.lastExecutionTime",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
        "identifier" : "c9e6116b-f8be-336c-b352-601cc5db7a84",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "5ec7a273-da88-3f9f-9b00-669f05cf4b98",
        "identifier" : "0c4be40f-420b-3d1f-bb7c-8d3e35bc0a5d",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${state.name}\",\n  \"isActive\": ${state.isActive},\n  \"lastExecutionTime\": \"${state.lastExecutionTime}\",\n  \"startTime\": \"${state.startTime}\",\n  \"endTime\": \"${state.endTime}\",\n  \"status\": \"${state.status}\",\n  \"sequenceNumber\": \"${state.sequenceNumber}\",\n  \"message\": \"${state.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "c0e34305-e902-372e-8f04-61d91f3e741a",
          "id" : "cbb03be1-877d-31a0-8721-2fb5026b6242",
          "name" : "GuiTinNhanTelegram",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "c0e34305-e902-372e-8f04-61d91f3e741a",
        "identifier" : "91980277-568e-3c63-8a7d-2ad2be8a4b29",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "c0e34305-e902-372e-8f04-61d91f3e741a",
          "id" : "2ca592e9-a44c-3ad2-bb4c-16b8e092b0d5",
          "name" : "ReplaceText",
          "type" : "PROCESSOR"
        },
        "zIndex" : 7
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "c0e34305-e902-372e-8f04-61d91f3e741a",
          "id" : "e941a4ab-838c-395e-b10d-4362d867dab9",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "c0e34305-e902-372e-8f04-61d91f3e741a",
        "identifier" : "ff6bd327-079c-3e49-a62a-7f5b90d2f507",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "Response", "Failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "c0e34305-e902-372e-8f04-61d91f3e741a",
          "id" : "cbb03be1-877d-31a0-8721-2fb5026b6242",
          "name" : "GuiTinNhanTelegram",
          "type" : "PROCESSOR"
        },
        "zIndex" : 5
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "c0e34305-e902-372e-8f04-61d91f3e741a",
          "id" : "2ca592e9-a44c-3ad2-bb4c-16b8e092b0d5",
          "name" : "ReplaceText",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "c0e34305-e902-372e-8f04-61d91f3e741a",
        "identifier" : "585ca471-9a9b-3cdc-9081-ff837b9298d9",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "send" ],
        "source" : {
          "comments" : "",
          "groupId" : "c0e34305-e902-372e-8f04-61d91f3e741a",
          "id" : "f1926ccb-f0ea-3c0c-8db7-3aadaf76d712",
          "name" : "RouteOnAttribute",
          "type" : "PROCESSOR"
        },
        "zIndex" : 8
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "c0e34305-e902-372e-8f04-61d91f3e741a",
          "id" : "e941a4ab-838c-395e-b10d-4362d867dab9",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "c0e34305-e902-372e-8f04-61d91f3e741a",
        "identifier" : "7ad7d384-6478-3338-b312-fde48bb49c3a",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "c0e34305-e902-372e-8f04-61d91f3e741a",
          "id" : "2ca592e9-a44c-3ad2-bb4c-16b8e092b0d5",
          "name" : "ReplaceText",
          "type" : "PROCESSOR"
        },
        "zIndex" : 9
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "c0e34305-e902-372e-8f04-61d91f3e741a",
          "id" : "f1926ccb-f0ea-3c0c-8db7-3aadaf76d712",
          "name" : "RouteOnAttribute",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "c0e34305-e902-372e-8f04-61d91f3e741a",
        "identifier" : "bf7a976e-6aee-398d-a33f-c305584a3505",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "c0e34305-e902-372e-8f04-61d91f3e741a",
          "id" : "4be0d7a3-0c3e-365c-91e4-ea3732ee88ef",
          "name" : "LaythongtinTelegramCauHinh",
          "type" : "PROCESSOR"
        },
        "zIndex" : 6
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "c0e34305-e902-372e-8f04-61d91f3e741a",
          "id" : "4be0d7a3-0c3e-365c-91e4-ea3732ee88ef",
          "name" : "LaythongtinTelegramCauHinh",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "c0e34305-e902-372e-8f04-61d91f3e741a",
        "identifier" : "05ee44e3-5641-358c-8d99-f2de93ffdf94",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "c0e34305-e902-372e-8f04-61d91f3e741a",
          "id" : "9de022c3-2d10-3fa4-a7e3-3425c75612c4",
          "name" : "input",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 1
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "c0e34305-e902-372e-8f04-61d91f3e741a",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "c0e34305-e902-372e-8f04-61d91f3e741a",
        "identifier" : "9de022c3-2d10-3fa4-a7e3-3425c75612c4",
        "name" : "input",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -1056.0,
          "y" : -248.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "GuiThongBaoTelegram",
      "outputPorts" : [ ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -200.0,
        "y" : 5208.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "c0e34305-e902-372e-8f04-61d91f3e741a",
        "identifier" : "2ca592e9-a44c-3ad2-bb4c-16b8e092b0d5",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ReplaceText",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 200.0,
          "y" : -288.0
        },
        "properties" : {
          "Regular Expression" : "(?s)^(.*)$",
          "Replacement Value" : "{\"chat_id\":\"#{ChatId}\",\"text\":\"${telegram.text}\"}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Regex Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "c0e34305-e902-372e-8f04-61d91f3e741a",
        "identifier" : "4be0d7a3-0c3e-365c-91e4-ea3732ee88ef",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LaythongtinTelegramCauHinh",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : -656.0,
          "y" : -280.0
        },
        "properties" : {
          "telegram.botToken" : "#{BotToken}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "telegram.chatId" : "#{ChatId}",
          "telegram.enabled" : "#{Enabled}",
          "telegram.text" : " MESSAGE ALERT\n Application: NIFI\n Flow: ${state.name}\n SequenceNumber: ${state.sequenceNumber}\n Message: ${state.message}\n Time Query: ${state.startTime} - ${state.endTime}"
        },
        "propertyDescriptors" : {
          "telegram.botToken" : {
            "displayName" : "telegram.botToken",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "telegram.botToken",
            "sensitive" : false
          },
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "telegram.chatId" : {
            "displayName" : "telegram.chatId",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "telegram.chatId",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "telegram.enabled" : {
            "displayName" : "telegram.enabled",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "telegram.enabled",
            "sensitive" : false
          },
          "telegram.text" : {
            "displayName" : "telegram.text",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "telegram.text",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "c0e34305-e902-372e-8f04-61d91f3e741a",
        "identifier" : "e941a4ab-838c-395e-b10d-4362d867dab9",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 224.0,
          "y" : 32.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "No Retry", "Retry", "Original" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "c0e34305-e902-372e-8f04-61d91f3e741a",
        "identifier" : "cbb03be1-877d-31a0-8721-2fb5026b6242",
        "maxBackoffPeriod" : "10 mins",
        "name" : "GuiTinNhanTelegram",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 656.0,
          "y" : -296.0
        },
        "properties" : {
          "Request Content-Encoding" : "DISABLED",
          "Request Multipart Form-Data Filename Enabled" : "true",
          "Request Chunked Transfer-Encoding Enabled" : "false",
          "HTTP/2 Disabled" : "False",
          "Connection Timeout" : "30 secs",
          "Response Cookie Strategy" : "DISABLED",
          "Socket Read Timeout" : "15 secs",
          "Socket Idle Connections" : "5",
          "Request Body Enabled" : "true",
          "OAuth2 Access Token Refresh Strategy" : "ON_TOKEN_EXPIRATION",
          "HTTP URL" : "https://api.telegram.org/bot#{BotToken}/sendMessage",
          "Socket Idle Timeout" : "5 mins",
          "Response Redirects Enabled" : "True",
          "Socket Write Timeout" : "15 secs",
          "Response FlowFile Naming Strategy" : "RANDOM",
          "Response Cache Enabled" : "false",
          "Request Date Header Enabled" : "True",
          "Request Failure Penalization Enabled" : "false",
          "Response Body Attribute Size" : "256",
          "Response Generation Required" : "false",
          "Response Header Request Attributes Enabled" : "false",
          "HTTP Method" : "POST",
          "Request Content-Type" : "application/json",
          "Request Digest Authentication Enabled" : "false",
          "Response Cache Size" : "10MB",
          "Response Body Ignored" : "false"
        },
        "propertyDescriptors" : {
          "Request Content-Encoding" : {
            "displayName" : "Request Content-Encoding",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Content-Encoding",
            "sensitive" : false
          },
          "proxy-configuration-service" : {
            "displayName" : "Proxy Configuration Service",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "proxy-configuration-service",
            "sensitive" : false
          },
          "Request Multipart Form-Data Filename Enabled" : {
            "displayName" : "Request Multipart Form-Data Filename Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Multipart Form-Data Filename Enabled",
            "sensitive" : false
          },
          "Request Chunked Transfer-Encoding Enabled" : {
            "displayName" : "Request Chunked Transfer-Encoding Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Chunked Transfer-Encoding Enabled",
            "sensitive" : false
          },
          "Response Header Request Attributes Prefix" : {
            "displayName" : "Response Header Request Attributes Prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Header Request Attributes Prefix",
            "sensitive" : false
          },
          "HTTP/2 Disabled" : {
            "displayName" : "HTTP/2 Disabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "HTTP/2 Disabled",
            "sensitive" : false
          },
          "Connection Timeout" : {
            "displayName" : "Connection Timeout",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Connection Timeout",
            "sensitive" : false
          },
          "Response Cookie Strategy" : {
            "displayName" : "Response Cookie Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Cookie Strategy",
            "sensitive" : false
          },
          "Request Password" : {
            "displayName" : "Request Password",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Password",
            "sensitive" : true
          },
          "Socket Read Timeout" : {
            "displayName" : "Socket Read Timeout",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Socket Read Timeout",
            "sensitive" : false
          },
          "Socket Idle Connections" : {
            "displayName" : "Socket Idle Connections",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Socket Idle Connections",
            "sensitive" : false
          },
          "Request Body Enabled" : {
            "displayName" : "Request Body Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Body Enabled",
            "sensitive" : false
          },
          "OAuth2 Access Token Refresh Strategy" : {
            "displayName" : "OAuth2 Access Token Refresh Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "OAuth2 Access Token Refresh Strategy",
            "sensitive" : false
          },
          "HTTP URL" : {
            "displayName" : "HTTP URL",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "HTTP URL",
            "sensitive" : false
          },
          "Request OAuth2 Access Token Provider" : {
            "displayName" : "Request OAuth2 Access Token Provider",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Request OAuth2 Access Token Provider",
            "sensitive" : false
          },
          "Socket Idle Timeout" : {
            "displayName" : "Socket Idle Timeout",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Socket Idle Timeout",
            "sensitive" : false
          },
          "Response Redirects Enabled" : {
            "displayName" : "Response Redirects Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Redirects Enabled",
            "sensitive" : false
          },
          "Socket Write Timeout" : {
            "displayName" : "Socket Write Timeout",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Socket Write Timeout",
            "sensitive" : false
          },
          "Request Header Attributes Pattern" : {
            "displayName" : "Request Header Attributes Pattern",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Header Attributes Pattern",
            "sensitive" : false
          },
          "Response FlowFile Naming Strategy" : {
            "displayName" : "Response FlowFile Naming Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response FlowFile Naming Strategy",
            "sensitive" : false
          },
          "Response Cache Enabled" : {
            "displayName" : "Response Cache Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Cache Enabled",
            "sensitive" : false
          },
          "Request Date Header Enabled" : {
            "displayName" : "Request Date Header Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Date Header Enabled",
            "sensitive" : false
          },
          "Request Failure Penalization Enabled" : {
            "displayName" : "Request Failure Penalization Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Failure Penalization Enabled",
            "sensitive" : false
          },
          "Response Body Attribute Size" : {
            "displayName" : "Response Body Attribute Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Body Attribute Size",
            "sensitive" : false
          },
          "SSL Context Service" : {
            "displayName" : "SSL Context Service",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "SSL Context Service",
            "sensitive" : false
          },
          "Response Generation Required" : {
            "displayName" : "Response Generation Required",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Generation Required",
            "sensitive" : false
          },
          "Request User-Agent" : {
            "displayName" : "Request User-Agent",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request User-Agent",
            "sensitive" : false
          },
          "Response Header Request Attributes Enabled" : {
            "displayName" : "Response Header Request Attributes Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Header Request Attributes Enabled",
            "sensitive" : false
          },
          "HTTP Method" : {
            "displayName" : "HTTP Method",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "HTTP Method",
            "sensitive" : false
          },
          "Request Username" : {
            "displayName" : "Request Username",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Username",
            "sensitive" : false
          },
          "Request Content-Type" : {
            "displayName" : "Request Content-Type",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Content-Type",
            "sensitive" : false
          },
          "Response Body Attribute Name" : {
            "displayName" : "Response Body Attribute Name",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Body Attribute Name",
            "sensitive" : false
          },
          "Request Digest Authentication Enabled" : {
            "displayName" : "Request Digest Authentication Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Digest Authentication Enabled",
            "sensitive" : false
          },
          "Request Multipart Form-Data Name" : {
            "displayName" : "Request Multipart Form-Data Name",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Multipart Form-Data Name",
            "sensitive" : false
          },
          "Response Cache Size" : {
            "displayName" : "Response Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Cache Size",
            "sensitive" : false
          },
          "Response Body Ignored" : {
            "displayName" : "Response Body Ignored",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Body Ignored",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "unmatched" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "c0e34305-e902-372e-8f04-61d91f3e741a",
        "identifier" : "f1926ccb-f0ea-3c0c-8db7-3aadaf76d712",
        "maxBackoffPeriod" : "10 mins",
        "name" : "RouteOnAttribute",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : -184.0,
          "y" : -288.0
        },
        "properties" : {
          "Routing Strategy" : "Route to Property name",
          "send" : "${telegram.enabled:equals('true')}"
        },
        "propertyDescriptors" : {
          "Routing Strategy" : {
            "displayName" : "Routing Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Routing Strategy",
            "sensitive" : false
          },
          "send" : {
            "displayName" : "send",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "send",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    } ],
    "processors" : [ {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-update-attribute-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "f6935d0d-06f0-3954-a1f0-322e9bb2ede4",
      "maxBackoffPeriod" : "10 mins",
      "name" : "CapNhatTrangThaiETLLaHoanThanh",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -184.0,
        "y" : 4704.0
      },
      "properties" : {
        "state.message" : "Hon thnh",
        "filename" : "${state.filename}",
        "Store State" : "Do not store state",
        "canonical-value-lookup-cache-size" : "100",
        "state.status" : "2",
        "state.isActive" : "false"
      },
      "propertyDescriptors" : {
        "state.message" : {
          "displayName" : "state.message",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.message",
          "sensitive" : false
        },
        "Delete Attributes Expression" : {
          "displayName" : "Delete Attributes Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Delete Attributes Expression",
          "sensitive" : false
        },
        "filename" : {
          "displayName" : "filename",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "filename",
          "sensitive" : false
        },
        "Store State" : {
          "displayName" : "Store State",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Store State",
          "sensitive" : false
        },
        "canonical-value-lookup-cache-size" : {
          "displayName" : "Cache Value Lookup Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "canonical-value-lookup-cache-size",
          "sensitive" : false
        },
        "state.status" : {
          "displayName" : "state.status",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.status",
          "sensitive" : false
        },
        "Stateful Variables Initial Value" : {
          "displayName" : "Stateful Variables Initial Value",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Stateful Variables Initial Value",
          "sensitive" : false
        },
        "state.isActive" : {
          "displayName" : "state.isActive",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.isActive",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "failure" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "d619de88-2c2b-3b99-824e-f04f4f69f7d3",
      "maxBackoffPeriod" : "10 mins",
      "name" : "DataToJSON",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -184.0,
        "y" : 1488.0
      },
      "properties" : {
        "Include Zero Record FlowFiles" : "true",
        "Record Writer" : "877d4cf8-3ef9-3d3c-965f-0f85798a2a2f",
        "Record Reader" : "40a44711-6955-3e69-b463-371590dfa3ed"
      },
      "propertyDescriptors" : {
        "Include Zero Record FlowFiles" : {
          "displayName" : "Include Zero Record FlowFiles",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Include Zero Record FlowFiles",
          "sensitive" : false
        },
        "Record Writer" : {
          "displayName" : "Record Writer",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "Record Writer",
          "sensitive" : false
        },
        "Record Reader" : {
          "displayName" : "Record Reader",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "Record Reader",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.ConvertRecord",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "success" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "0625d3f3-bdcc-3723-8b2e-0bd52a18095a",
      "maxBackoffPeriod" : "10 mins",
      "name" : "LogMessage",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -680.0,
        "y" : 272.0
      },
      "properties" : {
        "log-level" : "info"
      },
      "propertyDescriptors" : {
        "log-message" : {
          "displayName" : "Log message",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-message",
          "sensitive" : false
        },
        "log-level" : {
          "displayName" : "Log Level",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-level",
          "sensitive" : false
        },
        "log-prefix" : {
          "displayName" : "Log prefix",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-prefix",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.LogMessage",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "27cbdf39-7cef-3636-8933-7d1432d20eae",
      "maxBackoffPeriod" : "10 mins",
      "name" : "LayDanhSachBC",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -184.0,
        "y" : 1264.0
      },
      "properties" : {
        "esql-max-rows" : "0",
        "dbf-default-precision" : "10",
        "Max Wait Time" : "0 seconds",
        "SQL Query" : "SELECT *\n  FROM Dim_DimBusinessCenters where IsCurrent = 1",
        "Database Connection Pooling Service" : "6fce9190-8f74-3a75-9e56-36c3f8fc6d63",
        "esql-auto-commit" : "true",
        "dbf-user-logical-types" : "false",
        "dbf-default-scale" : "0",
        "compression-format" : "NONE",
        "esql-output-batch-size" : "0",
        "esql-fetch-size" : "0",
        "dbf-normalize" : "false",
        "Content Output Strategy" : "EMPTY"
      },
      "propertyDescriptors" : {
        "esql-max-rows" : {
          "displayName" : "Max Rows Per Flow File",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "esql-max-rows",
          "sensitive" : false
        },
        "dbf-default-precision" : {
          "displayName" : "Default Decimal Precision",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbf-default-precision",
          "sensitive" : false
        },
        "Max Wait Time" : {
          "displayName" : "Max Wait Time",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Max Wait Time",
          "sensitive" : false
        },
        "SQL Query" : {
          "displayName" : "SQL Query",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "SQL Query",
          "sensitive" : false
        },
        "Database Connection Pooling Service" : {
          "displayName" : "Database Connection Pooling Service",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "Database Connection Pooling Service",
          "sensitive" : false
        },
        "sql-post-query" : {
          "displayName" : "SQL Post-Query",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "sql-post-query",
          "sensitive" : false
        },
        "esql-auto-commit" : {
          "displayName" : "Set Auto Commit",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "esql-auto-commit",
          "sensitive" : false
        },
        "dbf-user-logical-types" : {
          "displayName" : "Use Avro Logical Types",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbf-user-logical-types",
          "sensitive" : false
        },
        "dbf-default-scale" : {
          "displayName" : "Default Decimal Scale",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbf-default-scale",
          "sensitive" : false
        },
        "sql-pre-query" : {
          "displayName" : "SQL Pre-Query",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "sql-pre-query",
          "sensitive" : false
        },
        "compression-format" : {
          "displayName" : "Compression Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "compression-format",
          "sensitive" : false
        },
        "esql-output-batch-size" : {
          "displayName" : "Output Batch Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "esql-output-batch-size",
          "sensitive" : false
        },
        "esql-fetch-size" : {
          "displayName" : "Fetch Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "esql-fetch-size",
          "sensitive" : false
        },
        "dbf-normalize" : {
          "displayName" : "Normalize Table/Column Names",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbf-normalize",
          "sensitive" : false
        },
        "Content Output Strategy" : {
          "displayName" : "Content Output Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Content Output Strategy",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "8e7dcdc3-0278-3846-972a-bd4f37bafec9",
      "maxBackoffPeriod" : "10 mins",
      "name" : "KiemTraETLDangXuLy",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -184.0,
        "y" : 272.0
      },
      "properties" : {
        "Routing Strategy" : "Route to Property name",
        "isProcessing" : "${state.isActive:equals('true')}"
      },
      "propertyDescriptors" : {
        "Routing Strategy" : {
          "displayName" : "Routing Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Routing Strategy",
          "sensitive" : false
        },
        "isProcessing" : {
          "displayName" : "isProcessing",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "isProcessing",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "success" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "85f7c2f9-0155-3de9-9d10-177640448caa",
      "maxBackoffPeriod" : "10 mins",
      "name" : "LogMessage",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -672.0,
        "y" : 2432.0
      },
      "properties" : {
        "log-level" : "info"
      },
      "propertyDescriptors" : {
        "log-message" : {
          "displayName" : "Log message",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-message",
          "sensitive" : false
        },
        "log-level" : {
          "displayName" : "Log Level",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-level",
          "sensitive" : false
        },
        "log-prefix" : {
          "displayName" : "Log prefix",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-prefix",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ "success" ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.LogMessage",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-update-attribute-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "3c787563-45b6-3ab6-8173-03029e8fa19d",
      "maxBackoffPeriod" : "10 mins",
      "name" : "CapNhatTrangThaiBcHienTaiLaHoanThanh",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -184.0,
        "y" : 4000.0
      },
      "properties" : {
        "Store State" : "Do not store state",
        "canonical-value-lookup-cache-size" : "100",
        "stateBc.isActive" : "false",
        "stateBc.message" : "Hon thnh",
        "stateBc.status" : "2"
      },
      "propertyDescriptors" : {
        "Delete Attributes Expression" : {
          "displayName" : "Delete Attributes Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Delete Attributes Expression",
          "sensitive" : false
        },
        "Store State" : {
          "displayName" : "Store State",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Store State",
          "sensitive" : false
        },
        "canonical-value-lookup-cache-size" : {
          "displayName" : "Cache Value Lookup Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "canonical-value-lookup-cache-size",
          "sensitive" : false
        },
        "stateBc.isActive" : {
          "displayName" : "stateBc.isActive",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.isActive",
          "sensitive" : false
        },
        "Stateful Variables Initial Value" : {
          "displayName" : "Stateful Variables Initial Value",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Stateful Variables Initial Value",
          "sensitive" : false
        },
        "stateBc.message" : {
          "displayName" : "stateBc.message",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.message",
          "sensitive" : false
        },
        "stateBc.status" : {
          "displayName" : "stateBc.status",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.status",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "e5cfb2f3-8f0f-3e16-af54-5114cbf73a95",
      "maxBackoffPeriod" : "10 mins",
      "name" : "KiemTraBcDaETLChua",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -184.0,
        "y" : 2432.0
      },
      "properties" : {
        "Routing Strategy" : "Route to Property name",
        "HoanThanhETLRoi" : "${stateBc.sequenceNumber:gt(${state.sequenceNumber})}"
      },
      "propertyDescriptors" : {
        "Routing Strategy" : {
          "displayName" : "Routing Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Routing Strategy",
          "sensitive" : false
        },
        "HoanThanhETLRoi" : {
          "displayName" : "HoanThanhETLRoi",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "HoanThanhETLRoi",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "unmatched" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "74eae803-28d2-32fd-99f0-4a6f45184a5a",
      "maxBackoffPeriod" : "10 mins",
      "name" : "KiemTraDanhSachBcTrong",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : 304.0,
        "y" : 1712.0
      },
      "properties" : {
        "Content Buffer Size" : "100 MB",
        "Match Requirement" : "content must match exactly",
        "isEmptyJsonArray " : "^\\[\\s*\\]$",
        "Character Set" : "UTF-8"
      },
      "propertyDescriptors" : {
        "Content Buffer Size" : {
          "displayName" : "Content Buffer Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Content Buffer Size",
          "sensitive" : false
        },
        "Match Requirement" : {
          "displayName" : "Match Requirement",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Match Requirement",
          "sensitive" : false
        },
        "isEmptyJsonArray " : {
          "displayName" : "isEmptyJsonArray ",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "isEmptyJsonArray ",
          "sensitive" : false
        },
        "Character Set" : {
          "displayName" : "Character Set",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Character Set",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.RouteOnContent",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-update-attribute-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "58621464-e384-349f-aa27-0adcb0d488d8",
      "maxBackoffPeriod" : "10 mins",
      "name" : "CapNhatETLLaDangXuLy",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -184.0,
        "y" : 488.0
      },
      "properties" : {
        "state.message" : "ang x l",
        "filename" : "${state.filename}",
        "Store State" : "Do not store state",
        "canonical-value-lookup-cache-size" : "100",
        "state.status" : "1",
        "state.isActive" : "true"
      },
      "propertyDescriptors" : {
        "state.message" : {
          "displayName" : "state.message",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.message",
          "sensitive" : false
        },
        "Delete Attributes Expression" : {
          "displayName" : "Delete Attributes Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Delete Attributes Expression",
          "sensitive" : false
        },
        "filename" : {
          "displayName" : "filename",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "filename",
          "sensitive" : false
        },
        "Store State" : {
          "displayName" : "Store State",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Store State",
          "sensitive" : false
        },
        "canonical-value-lookup-cache-size" : {
          "displayName" : "Cache Value Lookup Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "canonical-value-lookup-cache-size",
          "sensitive" : false
        },
        "state.status" : {
          "displayName" : "state.status",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.status",
          "sensitive" : false
        },
        "Stateful Variables Initial Value" : {
          "displayName" : "Stateful Variables Initial Value",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Stateful Variables Initial Value",
          "sensitive" : false
        },
        "state.isActive" : {
          "displayName" : "state.isActive",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.isActive",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "success" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "7d64d08a-b2d5-3f72-bd8c-d5c999e73fff",
      "maxBackoffPeriod" : "10 mins",
      "name" : "LogMessage",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -712.0,
        "y" : 4496.0
      },
      "properties" : {
        "log-level" : "info"
      },
      "propertyDescriptors" : {
        "log-message" : {
          "displayName" : "Log message",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-message",
          "sensitive" : false
        },
        "log-level" : {
          "displayName" : "Log Level",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-level",
          "sensitive" : false
        },
        "log-prefix" : {
          "displayName" : "Log prefix",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-prefix",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.LogMessage",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-update-attribute-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "7dca28f1-f4cf-341a-85df-c3285c4f539f",
      "maxBackoffPeriod" : "10 mins",
      "name" : "CapNhatETLLaHoanThanh",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : 296.0,
        "y" : 1936.0
      },
      "properties" : {
        "state.message" : "Hon thnh - BC Empty",
        "filename" : "${state.filename}",
        "Store State" : "Do not store state",
        "canonical-value-lookup-cache-size" : "100",
        "state.status" : "2",
        "state.isActive" : "false"
      },
      "propertyDescriptors" : {
        "state.message" : {
          "displayName" : "state.message",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.message",
          "sensitive" : false
        },
        "Delete Attributes Expression" : {
          "displayName" : "Delete Attributes Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Delete Attributes Expression",
          "sensitive" : false
        },
        "filename" : {
          "displayName" : "filename",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "filename",
          "sensitive" : false
        },
        "Store State" : {
          "displayName" : "Store State",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Store State",
          "sensitive" : false
        },
        "canonical-value-lookup-cache-size" : {
          "displayName" : "Cache Value Lookup Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "canonical-value-lookup-cache-size",
          "sensitive" : false
        },
        "state.status" : {
          "displayName" : "state.status",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.status",
          "sensitive" : false
        },
        "Stateful Variables Initial Value" : {
          "displayName" : "Stateful Variables Initial Value",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Stateful Variables Initial Value",
          "sensitive" : false
        },
        "state.isActive" : {
          "displayName" : "state.isActive",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.isActive",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "2c1f88b7-a870-329b-9710-16d7c0ef6b35",
      "maxBackoffPeriod" : "10 mins",
      "name" : "KiemTraLaBcCuoiCung",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -184.0,
        "y" : 4496.0
      },
      "properties" : {
        "Routing Strategy" : "Route to Property name",
        "bcCuoiCung" : "${fragment.index:toNumber():equals(${fragment.count:toNumber():minus(1)}):and(${state.continue:equals('0')})}"
      },
      "propertyDescriptors" : {
        "Routing Strategy" : {
          "displayName" : "Routing Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Routing Strategy",
          "sensitive" : false
        },
        "bcCuoiCung" : {
          "displayName" : "bcCuoiCung",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "bcCuoiCung",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "61adbd51-67d9-3d52-84d6-23a1a641c4d8",
      "maxBackoffPeriod" : "10 mins",
      "name" : "KhoiTao",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -184.0,
        "y" : -216.0
      },
      "properties" : {
        "character-set" : "UTF-8",
        "state.name" : "ETL_GMV_MAXS_PRODUCT",
        "File Size" : "100MB",
        "Path.Separator" : "#{Path.Separator}",
        "Batch Size" : "1",
        "Unique FlowFiles" : "false",
        "Data Format" : "Text"
      },
      "propertyDescriptors" : {
        "character-set" : {
          "displayName" : "Character Set",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "character-set",
          "sensitive" : false
        },
        "state.name" : {
          "displayName" : "state.name",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.name",
          "sensitive" : false
        },
        "File Size" : {
          "displayName" : "File Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "File Size",
          "sensitive" : false
        },
        "mime-type" : {
          "displayName" : "Mime Type",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "mime-type",
          "sensitive" : false
        },
        "generate-ff-custom-text" : {
          "displayName" : "Custom Text",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "generate-ff-custom-text",
          "sensitive" : false
        },
        "Path.Separator" : {
          "displayName" : "Path.Separator",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "Path.Separator",
          "sensitive" : false
        },
        "Batch Size" : {
          "displayName" : "Batch Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Batch Size",
          "sensitive" : false
        },
        "Unique FlowFiles" : {
          "displayName" : "Unique FlowFiles",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Unique FlowFiles",
          "sensitive" : false
        },
        "Data Format" : {
          "displayName" : "Data Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Data Format",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "60 min",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.GenerateFlowFile",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "failure", "unmatched" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "38823f81-1250-33b7-94e0-7c4e89e40cd8",
      "maxBackoffPeriod" : "10 mins",
      "name" : "ChuyenContentBcLenAttribute",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -184.0,
        "y" : 1936.0
      },
      "properties" : {
        "Destination" : "flowfile-attribute",
        "Max String Length" : "20 MB",
        "stateBc.name" : "$.BcName",
        "stateBc.dimId" : "$.Id",
        "Return Type" : "auto-detect",
        "stateBc.id" : "$.BcId",
        "Null Value Representation" : "empty string",
        "Path Not Found Behavior" : "ignore"
      },
      "propertyDescriptors" : {
        "Destination" : {
          "displayName" : "Destination",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Destination",
          "sensitive" : false
        },
        "Max String Length" : {
          "displayName" : "Max String Length",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Max String Length",
          "sensitive" : false
        },
        "stateBc.name" : {
          "displayName" : "stateBc.name",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.name",
          "sensitive" : false
        },
        "stateBc.dimId" : {
          "displayName" : "stateBc.dimId",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.dimId",
          "sensitive" : false
        },
        "Return Type" : {
          "displayName" : "Return Type",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Return Type",
          "sensitive" : false
        },
        "stateBc.id" : {
          "displayName" : "stateBc.id",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.id",
          "sensitive" : false
        },
        "Null Value Representation" : {
          "displayName" : "Null Value Representation",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Null Value Representation",
          "sensitive" : false
        },
        "Path Not Found Behavior" : {
          "displayName" : "Path Not Found Behavior",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Path Not Found Behavior",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.EvaluateJsonPath",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "483fbf05-05ed-3daf-8b9f-2d2cc72d5a01",
      "maxBackoffPeriod" : "10 mins",
      "name" : "DuyetTungBC",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -184.0,
        "y" : 1712.0
      },
      "properties" : {
        "Max String Length" : "100 MB",
        "Null Value Representation" : "empty string",
        "JsonPath Expression" : "$[*]"
      },
      "propertyDescriptors" : {
        "Max String Length" : {
          "displayName" : "Max String Length",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Max String Length",
          "sensitive" : false
        },
        "Null Value Representation" : {
          "displayName" : "Null Value Representation",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Null Value Representation",
          "sensitive" : false
        },
        "JsonPath Expression" : {
          "displayName" : "JsonPath Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "JsonPath Expression",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.SplitJson",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-update-attribute-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "b853ae00-798e-328a-94e5-ea8573b9145e",
      "maxBackoffPeriod" : "10 mins",
      "name" : "CapNhatBcHienTaiLaDangXuLy",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -184.0,
        "y" : 2656.0
      },
      "properties" : {
        "stateBc.endTime" : "${state.endTime}",
        "Store State" : "Do not store state",
        "canonical-value-lookup-cache-size" : "100",
        "stateBc.sequenceNumber" : "${state.sequenceNumber}",
        "stateBc.isActive" : "true",
        "stateBc.message" : "ang x l",
        "stateBc.status" : "1"
      },
      "propertyDescriptors" : {
        "stateBc.endTime" : {
          "displayName" : "stateBc.endTime",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.endTime",
          "sensitive" : false
        },
        "Delete Attributes Expression" : {
          "displayName" : "Delete Attributes Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Delete Attributes Expression",
          "sensitive" : false
        },
        "Store State" : {
          "displayName" : "Store State",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Store State",
          "sensitive" : false
        },
        "canonical-value-lookup-cache-size" : {
          "displayName" : "Cache Value Lookup Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "canonical-value-lookup-cache-size",
          "sensitive" : false
        },
        "stateBc.sequenceNumber" : {
          "displayName" : "stateBc.sequenceNumber",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.sequenceNumber",
          "sensitive" : false
        },
        "stateBc.isActive" : {
          "displayName" : "stateBc.isActive",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.isActive",
          "sensitive" : false
        },
        "Stateful Variables Initial Value" : {
          "displayName" : "Stateful Variables Initial Value",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Stateful Variables Initial Value",
          "sensitive" : false
        },
        "stateBc.message" : {
          "displayName" : "stateBc.message",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.message",
          "sensitive" : false
        },
        "stateBc.status" : {
          "displayName" : "stateBc.status",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.status",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
      "yieldDuration" : "1 sec"
    } ],
    "remoteProcessGroups" : [ ],
    "scheduledState" : "ENABLED",
    "statelessFlowTimeout" : "1 min"
  },
  "flowEncodingVersion" : "1.0",
  "latest" : false,
  "parameterContexts" : {
    "ETL" : {
      "componentType" : "PARAMETER_CONTEXT",
      "inheritedParameterContexts" : [ ],
      "name" : "ETL",
      "parameters" : [ {
        "description" : "",
        "name" : "TempPath",
        "provided" : false,
        "sensitive" : false,
        "value" : ".\\template\\etl"
      }, {
        "description" : "",
        "name" : "PageSizeMax",
        "provided" : false,
        "sensitive" : false,
        "value" : "500"
      }, {
        "description" : "",
        "name" : "DbAccount",
        "provided" : false,
        "sensitive" : false,
        "value" : "sa"
      }, {
        "description" : "",
        "name" : "Path.Separator",
        "provided" : false,
        "sensitive" : false,
        "value" : "\\"
      }, {
        "description" : "",
        "name" : "DbDriverClassName",
        "provided" : false,
        "sensitive" : false,
        "value" : "com.microsoft.sqlserver.jdbc.SQLServerDriver"
      }, {
        "description" : "",
        "name" : "Enabled",
        "provided" : false,
        "sensitive" : false,
        "value" : "true"
      }, {
        "description" : "",
        "name" : "DbConnectString",
        "provided" : false,
        "sensitive" : false,
        "value" : "jdbc:sqlserver://127.0.0.1:1433;databaseName=TikTokDWH;TrustServerCertificate=true"
      }, {
        "description" : "",
        "name" : "DbDriverLocation",
        "provided" : false,
        "sensitive" : false,
        "value" : ".\\lib\\mssql-jdbc-12.10.1.jre11.jar"
      }, {
        "description" : "",
        "name" : "Directory",
        "provided" : false,
        "sensitive" : false,
        "value" : "${stateCurrent.Directory}"
      } ]
    },
    "TikTokETL" : {
      "componentType" : "PARAMETER_CONTEXT",
      "inheritedParameterContexts" : [ ],
      "name" : "TikTokETL",
      "parameters" : [ {
        "description" : "",
        "name" : "accept",
        "provided" : false,
        "sensitive" : false,
        "value" : "application/json;odata.metadata=minimal;odata.streaming=true"
      }, {
        "description" : "",
        "name" : "api.url",
        "provided" : false,
        "sensitive" : false,
        "value" : "https://app2.southeastasia.cloudapp.azure.com:44383/api/tiktok-video/get-list"
      }, {
        "description" : "",
        "name" : "Cookie",
        "provided" : false,
        "sensitive" : false,
        "value" : ".AspNetCore.Antiforgery=GIATRICOOKIE"
      }, {
        "description" : "",
        "name" : "X-Requested-With",
        "provided" : false,
        "sensitive" : false,
        "value" : "XMLHttpRequest"
      }, {
        "description" : "",
        "name" : "Log Level",
        "provided" : false,
        "sensitive" : false,
        "value" : "info"
      }, {
        "description" : "",
        "name" : "DbFacDimAccount",
        "provided" : false,
        "sensitive" : false,
        "value" : "sa"
      }, {
        "description" : "",
        "name" : "TempPath",
        "provided" : false,
        "sensitive" : false,
        "value" : ".\\tmp\\etl"
      }, {
        "description" : "",
        "name" : "DbDriverClassName",
        "provided" : false,
        "sensitive" : false,
        "value" : "com.microsoft.sqlserver.jdbc.SQLServerDriver"
      }, {
        "description" : "",
        "name" : "DbFactDimPassword",
        "provided" : false,
        "sensitive" : true
      }, {
        "description" : "",
        "name" : "HTTP Method",
        "provided" : false,
        "sensitive" : false,
        "value" : "POST"
      }, {
        "description" : "",
        "name" : "RequestVerificationToken",
        "provided" : false,
        "sensitive" : false,
        "value" : "CfDJ8KO0KjQZsxpOjzNZE7tYUzE6ND9vFRJaIzBoCSzgW535yiP6nE1BEbAmFlcjfNk2EH67bVcPBEWibuish2OMk-DsuFQB20jgBg12j6Q8zutg6CaS3qPDsoSZAP5w6JSAJVpivWol5TfeCBTBDn0gnao"
      }, {
        "description" : "",
        "name" : "api.content-type",
        "provided" : false,
        "sensitive" : false,
        "value" : "application/json;odata.metadata=minimal;odata.streaming=true"
      }, {
        "description" : "",
        "name" : "api.accept",
        "provided" : false,
        "sensitive" : false,
        "value" : "application/json;odata.metadata=minimal;odata.streaming=true"
      }, {
        "description" : "",
        "name" : "DbPassword",
        "provided" : false,
        "sensitive" : true
      }, {
        "description" : "",
        "name" : "DbAccount",
        "provided" : false,
        "sensitive" : false,
        "value" : "sa"
      }, {
        "description" : "",
        "name" : "DbFactDimConnectionString",
        "provided" : false,
        "sensitive" : false,
        "value" : "jdbc:sqlserver://127.0.0.1:1433;databaseName=TikTok;TrustServerCertificate=true"
      }, {
        "description" : "",
        "name" : "DbFactDimDriverClassName",
        "provided" : false,
        "sensitive" : false,
        "value" : "com.microsoft.sqlserver.jdbc.SQLServerDriver"
      }, {
        "description" : "",
        "name" : "api.XRequestedWith",
        "provided" : false,
        "sensitive" : false,
        "value" : "XMLHttpRequest"
      }, {
        "description" : "",
        "name" : "PageSizeMax",
        "provided" : false,
        "sensitive" : false,
        "value" : "500"
      }, {
        "description" : "",
        "name" : "api.token",
        "provided" : false,
        "sensitive" : false,
        "value" : "CfDJ8KO0KjQZsxpOjzNZE7tYUzE6ND9vFRJaIzBoCSzgW535yiP6nE1BEbAmFlcjfNk2EH67bVcPBEWibuish2OMk-DsuFQB20jgBg12j6Q8zutg6CaS3qPDsoSZAP5w6JSAJVpivWol5TfeCBTBDn0gnao"
      }, {
        "description" : "",
        "name" : "Path.Separator",
        "provided" : false,
        "sensitive" : false,
        "value" : "\\"
      }, {
        "description" : "",
        "name" : "DbConnectionString",
        "provided" : false,
        "sensitive" : false,
        "value" : "jdbc:sqlserver://127.0.0.1:1433;databaseName=TikTok;TrustServerCertificate=true"
      }, {
        "description" : "",
        "name" : "DbFactDimDriverLocation",
        "provided" : false,
        "sensitive" : false,
        "value" : ".\\lib\\mssql-jdbc-12.10.1.jre11.jar"
      }, {
        "description" : "",
        "name" : "DbDriverLocation",
        "provided" : false,
        "sensitive" : false,
        "value" : ".\\lib\\mssql-jdbc-12.10.1.jre11.jar"
      }, {
        "description" : "",
        "name" : "Directory",
        "provided" : false,
        "sensitive" : false,
        "value" : "${stateCurrent.Directory}"
      } ]
    }
  },
  "parameterProviders" : { },
  "snapshotMetadata" : {
    "author" : "4df8cad9-d248-48ab-a56c-7d80a4da5f7f",
    "flowIdentifier" : "FACTPRODUCT",
    "timestamp" : 0
  }
}