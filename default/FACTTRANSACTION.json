{
  "externalControllerServices" : { },
  "flow" : {
    "createdTimestamp" : 1767794623303,
    "description" : "",
    "identifier" : "FACTTRANSACTION",
    "lastModifiedTimestamp" : 1767794623303,
    "name" : "FACT_TRANSACTION",
    "versionCount" : 0
  },
  "flowContents" : {
    "comments" : "",
    "componentType" : "PROCESS_GROUP",
    "connections" : [ {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
        "id" : "c382b638-baf1-385c-aa45-bda59cb71aeb",
        "name" : "input",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "b4606268-6f69-3bb5-ae52-fff727cf0860",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
        "id" : "5f4b89b8-5a07-3455-a752-671b8df31567",
        "name" : "stateOut",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 29
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "d936b40f-364c-35e8-a94e-4d5f23ba5ddf",
        "name" : "Data to JSON",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "4352f84a-e616-3225-b7a8-7a39f3c31664",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "1184b385-5627-3cf0-8ad3-4d48098cb10a",
        "name" : "LayDanhSachBC",
        "type" : "PROCESSOR"
      },
      "zIndex" : 7
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
        "id" : "ae7a23f2-5bcd-3d16-96b1-3c3a836f7799",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "8c8d4cbd-4797-30e8-a3c7-a13776d68544",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "25482f77-dfb0-369b-a31e-fb7c21a7b222",
        "name" : "CapNhatBcHienTaiLaDangXuLy",
        "type" : "PROCESSOR"
      },
      "zIndex" : 19
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "08b2ff98-b8bb-32e4-9ce4-5ffd3967374c",
        "name" : "LogMessage",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "c0fe80e3-f673-383c-b5be-6ac0077c0872",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "isProcessing" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "d7492d21-8ebe-3f37-8547-e046bac14eee",
        "name" : "KiemTraETLDangXuLy",
        "type" : "PROCESSOR"
      },
      "zIndex" : 4
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
        "id" : "f0d86be1-3f49-397f-a701-50a078c98885",
        "name" : "Input",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "404befd7-2c0b-36df-b56f-d94356547d5b",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
        "id" : "a9b2785a-2191-35f5-8590-33fc9708ab59",
        "name" : "stateBcOut",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 20
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
        "id" : "7aec53ac-ec32-3f7a-832a-580a90b0470d",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "954cb414-7bfa-3dde-ac0e-94af64b85f70",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "8af962a0-c2d9-3426-9400-31fa8103b35d",
        "name" : "CapNhatETLLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "zIndex" : 14
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "456a83a2-9a41-303a-97ff-395ba9e03db5",
        "name" : "LogMessage",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "e0b88380-af76-39f2-a6ab-6619434592ac",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "unmatched" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "ad506217-9655-39f1-a210-b0488509a982",
        "name" : "KiemTraLaBcCuoiCung",
        "type" : "PROCESSOR"
      },
      "zIndex" : 27
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "73b43455-88e1-3c66-8934-c80568c00bcd",
        "name" : "KiemTraDanhSachBcTrong",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "54a8f355-286a-3e23-9ea8-ab59ffd4b313",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "original" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "511b9f42-ba92-33bd-bac1-28f75e5b2940",
        "name" : "DuyetTungBC",
        "type" : "PROCESSOR"
      },
      "zIndex" : 12
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "9965a42b-6644-329c-bf27-a938fffea6ba",
        "name" : "CapNhatTrangThaiBcHienTaiLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "0b12aba2-1407-327a-801b-d066c1c776ea",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "8a531770-5fda-3562-936d-0ab30a500db6",
        "id" : "ee091853-e064-334a-a57f-86c4cda433cb",
        "name" : "Output",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 23
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
        "id" : "7364ba1b-0e02-3c6f-be6f-5a1c80ad13e0",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "744bb3c9-b07c-3243-aa0c-63ad835c84c4",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "failure" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "511b9f42-ba92-33bd-bac1-28f75e5b2940",
        "name" : "DuyetTungBC",
        "type" : "PROCESSOR"
      },
      "zIndex" : 11
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "511b9f42-ba92-33bd-bac1-28f75e5b2940",
        "name" : "DuyetTungBC",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "b5c6c546-e665-3218-ad72-7ba023c53fd6",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "d936b40f-364c-35e8-a94e-4d5f23ba5ddf",
        "name" : "Data to JSON",
        "type" : "PROCESSOR"
      },
      "zIndex" : 9
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "ad506217-9655-39f1-a210-b0488509a982",
        "name" : "KiemTraLaBcCuoiCung",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "66824950-dd28-381a-9f36-4bfcc05ec8e8",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
        "id" : "32865cfc-c665-3bcf-915f-7d21c76bf330",
        "name" : "stateBcOut",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 25
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
        "id" : "7c1fe654-55f0-3cc7-9d52-180afe8a53be",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "8423d93e-010b-3b9f-b80f-16739ee00ee4",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "fed07305-a57c-33b3-8857-fadd8c49ae3f",
        "name" : "CapNhatTrangThaiETLLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "zIndex" : 28
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
        "id" : "1135ba91-51c9-38e0-ab11-0ce53bb02ec1",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "db714e27-0908-31c0-87c8-6c75f3b0a0e7",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "079dc687-ae4e-38b1-948e-ac31ba8212c5",
        "name" : "CapNhatETLLaDangXuLy",
        "type" : "PROCESSOR"
      },
      "zIndex" : 5
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "6613b6f8-074b-32cd-816f-a99c037e9736",
        "name" : "KiemTraBcDaETLChua",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "3193eb63-d1c7-3ca2-8398-869520411c9c",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
        "id" : "92f04a73-eee2-31f8-a650-89009af7ba11",
        "name" : "stateBcOut",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 16
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "4b7be34f-8c2f-3bc0-aefb-72a410e58db6",
        "name" : "ChuyenContentBcLenAttribute",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "b737d947-d2f2-340e-94e0-bc5c706da34f",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "split" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "511b9f42-ba92-33bd-bac1-28f75e5b2940",
        "name" : "DuyetTungBC",
        "type" : "PROCESSOR"
      },
      "zIndex" : 10
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "d7492d21-8ebe-3f37-8547-e046bac14eee",
        "name" : "KiemTraETLDangXuLy",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "a11adabf-65ad-32c5-b8e3-376d8589aa31",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
        "id" : "f4fb461a-090b-34a7-85ce-92bee35bd23a",
        "name" : "ouput",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 2
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "25482f77-dfb0-369b-a31e-fb7c21a7b222",
        "name" : "CapNhatBcHienTaiLaDangXuLy",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "06a7a633-dc8b-3026-b208-0094bb6b871f",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "unmatched" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "6613b6f8-074b-32cd-816f-a99c037e9736",
        "name" : "KiemTraBcDaETLChua",
        "type" : "PROCESSOR"
      },
      "zIndex" : 18
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "id" : "471deeda-0feb-32e0-ae98-c70d72192379",
        "name" : "stateBc",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "19a2cc02-1afb-369d-bbb6-5dacd8ed03ce",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
        "id" : "20a29de0-ed94-354b-8c39-9a3b003f6393",
        "name" : "Output",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 21
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "1184b385-5627-3cf0-8ad3-4d48098cb10a",
        "name" : "LayDanhSachBC",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "9d2cd0fd-79b1-3b69-ae73-8c635359b423",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
        "id" : "627d8137-90b5-3c37-9d8b-ab70031cbb94",
        "name" : "stateOut",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 6
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "079dc687-ae4e-38b1-948e-ac31ba8212c5",
        "name" : "CapNhatETLLaDangXuLy",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "4a9f35a3-b6b5-341d-8733-f3b4d1cf4a2c",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "unmatched" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "d7492d21-8ebe-3f37-8547-e046bac14eee",
        "name" : "KiemTraETLDangXuLy",
        "type" : "PROCESSOR"
      },
      "zIndex" : 3
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
        "id" : "dceccc88-5916-3bc7-a441-00d88949524d",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "21070668-a41d-3e32-be56-304f42dd8f13",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "9965a42b-6644-329c-bf27-a938fffea6ba",
        "name" : "CapNhatTrangThaiBcHienTaiLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "zIndex" : 24
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "9fc433fd-82c6-3bd1-af39-1e36755d1eaa",
        "name" : "LogMessage",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "eeb5a208-8e59-34cd-bd59-aee3600d6505",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "HoanThanhETLRoi" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "6613b6f8-074b-32cd-816f-a99c037e9736",
        "name" : "KiemTraBcDaETLChua",
        "type" : "PROCESSOR"
      },
      "zIndex" : 17
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
        "id" : "dba68416-cb9b-3dc8-92fc-e694ca2fe23d",
        "name" : "BcId",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "ca7eb31d-6dde-3e2b-a181-679163a1c278",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "matched" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "4b7be34f-8c2f-3bc0-aefb-72a410e58db6",
        "name" : "ChuyenContentBcLenAttribute",
        "type" : "PROCESSOR"
      },
      "zIndex" : 15
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "fed07305-a57c-33b3-8857-fadd8c49ae3f",
        "name" : "CapNhatTrangThaiETLLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "52ae4ca5-aa9c-3be1-a854-8c89a14711d9",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "bcCuoiCung" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "ad506217-9655-39f1-a210-b0488509a982",
        "name" : "KiemTraLaBcCuoiCung",
        "type" : "PROCESSOR"
      },
      "zIndex" : 26
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
        "id" : "44dac373-aece-37bf-aca2-7c014f1a4dab",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "26267ae5-2151-32f3-a8d8-bb9730dbf06b",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "failure" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "1184b385-5627-3cf0-8ad3-4d48098cb10a",
        "name" : "LayDanhSachBC",
        "type" : "PROCESSOR"
      },
      "zIndex" : 8
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "8af962a0-c2d9-3426-9400-31fa8103b35d",
        "name" : "CapNhatETLLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "23114eaf-446a-3fb9-9090-3cc190e89bd9",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "isEmptyJsonArray " ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "73b43455-88e1-3c66-8934-c80568c00bcd",
        "name" : "KiemTraDanhSachBcTrong",
        "type" : "PROCESSOR"
      },
      "zIndex" : 13
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
        "id" : "52916cf9-e808-3dcb-9e23-5f044ec26231",
        "name" : "input",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "e62a5cdf-8b7d-3e60-b0aa-d10cf88a80ac",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "ff83edc8-54ad-3453-b8f6-3c1a06a3be07",
        "name" : "KhoiTao",
        "type" : "PROCESSOR"
      },
      "zIndex" : 1
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "8a531770-5fda-3562-936d-0ab30a500db6",
        "id" : "4dcf6c54-a7ed-3a22-9392-acb68eb42f50",
        "name" : "Input",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "44ec34f3-4ab7-37c4-a84d-6e72327f8c27",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "id" : "7e957881-b2bd-3f28-ac26-35f18c3b933d",
        "name" : "stateAdAccount",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 22
    } ],
    "controllerServices" : [ {
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-record-serialization-services-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "CONTROLLER_SERVICE",
      "controllerServiceApis" : [ {
        "bundle" : {
          "artifact" : "nifi-standard-services-api-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "type" : "org.apache.nifi.serialization.RecordReaderFactory"
      } ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "e99b4c7b-99a5-3c61-a9fb-3523c60d9b83",
      "name" : "AvroReader",
      "properties" : {
        "schema-name" : "${schema.name}",
        "cache-size" : "1000",
        "schema-access-strategy" : "embedded-avro-schema",
        "schema-text" : "${avro.schema}"
      },
      "propertyDescriptors" : {
        "schema-reference-reader" : {
          "displayName" : "Schema Reference Reader",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "schema-reference-reader",
          "sensitive" : false
        },
        "schema-branch" : {
          "displayName" : "Schema Branch",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-branch",
          "sensitive" : false
        },
        "schema-name" : {
          "displayName" : "Schema Name",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-name",
          "sensitive" : false
        },
        "cache-size" : {
          "displayName" : "Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "cache-size",
          "sensitive" : false
        },
        "schema-registry" : {
          "displayName" : "Schema Registry",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "schema-registry",
          "sensitive" : false
        },
        "schema-access-strategy" : {
          "displayName" : "Schema Access Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-access-strategy",
          "sensitive" : false
        },
        "schema-version" : {
          "displayName" : "Schema Version",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-version",
          "sensitive" : false
        },
        "schema-text" : {
          "displayName" : "Schema Text",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-text",
          "sensitive" : false
        }
      },
      "scheduledState" : "DISABLED",
      "type" : "org.apache.nifi.avro.AvroReader"
    }, {
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-record-serialization-services-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "CONTROLLER_SERVICE",
      "controllerServiceApis" : [ {
        "bundle" : {
          "artifact" : "nifi-standard-services-api-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "type" : "org.apache.nifi.serialization.RecordSetWriterFactory"
      } ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "422d4040-1ece-3a3f-b19c-f301d2c4bdce",
      "name" : "JsonRecordSetWriter",
      "properties" : {
        "Allow Scientific Notation" : "false",
        "compression-level" : "1",
        "Pretty Print JSON" : "false",
        "compression-format" : "none",
        "Schema Write Strategy" : "no-schema",
        "suppress-nulls" : "never-suppress",
        "output-grouping" : "output-array",
        "schema-name" : "${schema.name}",
        "schema-access-strategy" : "inherit-record-schema",
        "schema-text" : "${avro.schema}"
      },
      "propertyDescriptors" : {
        "schema-reference-reader" : {
          "displayName" : "Schema Reference Reader",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "schema-reference-reader",
          "sensitive" : false
        },
        "schema-branch" : {
          "displayName" : "Schema Branch",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-branch",
          "sensitive" : false
        },
        "Allow Scientific Notation" : {
          "displayName" : "Allow Scientific Notation",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Allow Scientific Notation",
          "sensitive" : false
        },
        "compression-level" : {
          "displayName" : "Compression Level",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "compression-level",
          "sensitive" : false
        },
        "schema-cache" : {
          "displayName" : "Schema Cache",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "schema-cache",
          "sensitive" : false
        },
        "Timestamp Format" : {
          "displayName" : "Timestamp Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Timestamp Format",
          "sensitive" : false
        },
        "Date Format" : {
          "displayName" : "Date Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Date Format",
          "sensitive" : false
        },
        "Pretty Print JSON" : {
          "displayName" : "Pretty Print JSON",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Pretty Print JSON",
          "sensitive" : false
        },
        "compression-format" : {
          "displayName" : "Compression Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "compression-format",
          "sensitive" : false
        },
        "Schema Write Strategy" : {
          "displayName" : "Schema Write Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Schema Write Strategy",
          "sensitive" : false
        },
        "suppress-nulls" : {
          "displayName" : "Suppress Null Values",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "suppress-nulls",
          "sensitive" : false
        },
        "output-grouping" : {
          "displayName" : "Output Grouping",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "output-grouping",
          "sensitive" : false
        },
        "schema-name" : {
          "displayName" : "Schema Name",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-name",
          "sensitive" : false
        },
        "schema-registry" : {
          "displayName" : "Schema Registry",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "schema-registry",
          "sensitive" : false
        },
        "Time Format" : {
          "displayName" : "Time Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Time Format",
          "sensitive" : false
        },
        "schema-access-strategy" : {
          "displayName" : "Schema Access Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-access-strategy",
          "sensitive" : false
        },
        "schema-version" : {
          "displayName" : "Schema Version",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-version",
          "sensitive" : false
        },
        "schema-text" : {
          "displayName" : "Schema Text",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-text",
          "sensitive" : false
        },
        "Schema Reference Writer" : {
          "displayName" : "Schema Reference Writer",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "Schema Reference Writer",
          "sensitive" : false
        }
      },
      "scheduledState" : "DISABLED",
      "type" : "org.apache.nifi.json.JsonRecordSetWriter"
    }, {
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-dbcp-service-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "CONTROLLER_SERVICE",
      "controllerServiceApis" : [ {
        "bundle" : {
          "artifact" : "nifi-standard-services-api-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "type" : "org.apache.nifi.dbcp.DBCPService"
      } ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "7d601288-eb00-3fcc-934d-d5e3c37f2cfc",
      "name" : "DBCPConnectionPool",
      "properties" : {
        "dbcp-min-idle-conns" : "0",
        "Max Wait Time" : "500 millis",
        "Database Driver Class Name" : "#{DbDriverClassName}",
        "dbcp-min-evictable-idle-time" : "30 mins",
        "Max Total Connections" : "8",
        "dbcp-max-conn-lifetime" : "-1",
        "Database Connection URL" : "#{DbConnectString}",
        "dbcp-time-between-eviction-runs" : "-1",
        "Database User" : "#{DbAccount}",
        "dbcp-soft-min-evictable-idle-time" : "-1",
        "database-driver-locations" : "#{DbDriverLocation}",
        "dbcp-max-idle-conns" : "8"
      },
      "propertyDescriptors" : {
        "dbcp-min-idle-conns" : {
          "displayName" : "Minimum Idle Connections",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-min-idle-conns",
          "sensitive" : false
        },
        "Max Wait Time" : {
          "displayName" : "Max Wait Time",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Max Wait Time",
          "sensitive" : false
        },
        "Database Driver Class Name" : {
          "displayName" : "Database Driver Class Name",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Database Driver Class Name",
          "sensitive" : false
        },
        "dbcp-min-evictable-idle-time" : {
          "displayName" : "Minimum Evictable Idle Time",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-min-evictable-idle-time",
          "sensitive" : false
        },
        "Max Total Connections" : {
          "displayName" : "Max Total Connections",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Max Total Connections",
          "sensitive" : false
        },
        "dbcp-max-conn-lifetime" : {
          "displayName" : "Max Connection Lifetime",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-max-conn-lifetime",
          "sensitive" : false
        },
        "Validation-query" : {
          "displayName" : "Validation query",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Validation-query",
          "sensitive" : false
        },
        "Database Connection URL" : {
          "displayName" : "Database Connection URL",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Database Connection URL",
          "sensitive" : false
        },
        "dbcp-time-between-eviction-runs" : {
          "displayName" : "Time Between Eviction Runs",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-time-between-eviction-runs",
          "sensitive" : false
        },
        "Database User" : {
          "displayName" : "Database User",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Database User",
          "sensitive" : false
        },
        "kerberos-user-service" : {
          "displayName" : "Kerberos User Service",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "kerberos-user-service",
          "sensitive" : false
        },
        "dbcp-soft-min-evictable-idle-time" : {
          "displayName" : "Soft Minimum Evictable Idle Time",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-soft-min-evictable-idle-time",
          "sensitive" : false
        },
        "database-driver-locations" : {
          "displayName" : "Database Driver Location(s)",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "database-driver-locations",
          "resourceDefinition" : {
            "cardinality" : "MULTIPLE",
            "resourceTypes" : [ "FILE", "URL", "DIRECTORY" ]
          },
          "sensitive" : false
        },
        "dbcp-max-idle-conns" : {
          "displayName" : "Max Idle Connections",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-max-idle-conns",
          "sensitive" : false
        },
        "Password" : {
          "displayName" : "Password",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Password",
          "sensitive" : true
        }
      },
      "scheduledState" : "DISABLED",
      "type" : "org.apache.nifi.dbcp.DBCPConnectionPool"
    } ],
    "defaultBackPressureDataSizeThreshold" : "1 GB",
    "defaultBackPressureObjectThreshold" : 10000,
    "defaultFlowFileExpiration" : "0 sec",
    "executionEngine" : "INHERITED",
    "externalControllerServiceReferences" : { },
    "flowFileConcurrency" : "UNBOUNDED",
    "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
    "funnels" : [ ],
    "identifier" : "flow-contents-group",
    "inputPorts" : [ ],
    "labels" : [ ],
    "maxConcurrentTasks" : 1,
    "name" : "FACT_TRANSACTION",
    "outputPorts" : [ ],
    "parameterContextName" : "ETL",
    "position" : {
      "x" : 0.0,
      "y" : 0.0
    },
    "processGroups" : [ {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
          "id" : "321fe815-8696-3900-a7c6-fb376b8d301e",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
        "identifier" : "fbfbe09d-3ce2-3320-ae54-90d4779c0392",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
          "id" : "5e5c1fa7-c1b0-3570-87cb-b100307a3ce9",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
          "id" : "990d0590-0788-37ac-b0d7-c7ab47be8a2c",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
        "identifier" : "8138ea67-de7c-327e-aa54-2d0c6c78844a",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
          "id" : "ae7a23f2-5bcd-3d16-96b1-3c3a836f7799",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
          "id" : "69825a0d-da48-37d9-990a-420e59be2ab9",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
        "identifier" : "a2243d82-57a4-3c77-b112-b85c62832b14",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
          "id" : "5e5c1fa7-c1b0-3570-87cb-b100307a3ce9",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
          "id" : "5e5c1fa7-c1b0-3570-87cb-b100307a3ce9",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
        "identifier" : "03616cf2-dea5-37bb-9ec3-e3ed008ace20",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
          "id" : "990d0590-0788-37ac-b0d7-c7ab47be8a2c",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
          "id" : "a9b2785a-2191-35f5-8590-33fc9708ab59",
          "name" : "stateBcOut",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
        "identifier" : "487e7ef9-26bb-36f2-a976-2265b92876a3",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
          "id" : "69825a0d-da48-37d9-990a-420e59be2ab9",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
          "id" : "321fe815-8696-3900-a7c6-fb376b8d301e",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
        "identifier" : "929dbe85-b20c-3662-8f5f-0e170756d3ef",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
          "id" : "69825a0d-da48-37d9-990a-420e59be2ab9",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
        "identifier" : "ae7a23f2-5bcd-3d16-96b1-3c3a836f7799",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LuuTrangThaiBCHienTai",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
        "identifier" : "a9b2785a-2191-35f5-8590-33fc9708ab59",
        "name" : "stateBcOut",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 1552.0,
          "y" : -154.5
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -224.0,
        "y" : 2504.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
        "identifier" : "990d0590-0788-37ac-b0d7-c7ab47be8a2c",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "filename" : "${stateBc.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateBc.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateBc.lastExecutionTime" : {
            "displayName" : "stateBc.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateBc.lastExecutionTime",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
        "identifier" : "321fe815-8696-3900-a7c6-fb376b8d301e",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
        "identifier" : "5e5c1fa7-c1b0-3570-87cb-b100307a3ce9",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${stateBc.name}\",\n  \"isActive\": ${stateBc.isActive},\n  \"lastExecutionTime\": \"${stateBc.lastExecutionTime}\",\n  \"startTime\": \"${stateBc.startTime}\",\n  \"endTime\": \"${stateBc.endTime}\",\n  \"status\": \"${stateBc.status}\",\n  \"sequenceNumber\": \"${stateBc.sequenceNumber}\",\n  \"message\": \"${stateBc.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "8d0aacc4-d796-3811-a425-a89c32d935fe",
        "identifier" : "69825a0d-da48-37d9-990a-420e59be2ab9",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${stateBc.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
          "id" : "4c341a08-3895-3211-b6f5-1e0309949220",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
        "identifier" : "dc51978f-6e17-36c4-98d5-320be0adb480",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
          "id" : "fdd9126a-8f8d-37d2-8ae3-98277db53068",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
          "id" : "ba44e096-9b5a-39d5-8cc6-f9c9748939cf",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
        "identifier" : "147de615-84c2-31b4-a6ec-849029d452d5",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
          "id" : "7364ba1b-0e02-3c6f-be6f-5a1c80ad13e0",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
          "id" : "b4783806-5c41-336b-ba8b-8ea0a13baf74",
          "name" : "input",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
        "identifier" : "344d3787-6ab4-3d26-acc1-d5153f5e1df2",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
          "id" : "fdd9126a-8f8d-37d2-8ae3-98277db53068",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
          "id" : "c4c2db95-d63c-3590-a612-f2bee3d5d408",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
        "identifier" : "9f81f9c6-8b61-3199-b550-8481141f9991",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
          "id" : "ba44e096-9b5a-39d5-8cc6-f9c9748939cf",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
          "id" : "fdd9126a-8f8d-37d2-8ae3-98277db53068",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
        "identifier" : "38cb6fe3-55fa-324a-bfc8-9f52d921a5c0",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
          "id" : "c4c2db95-d63c-3590-a612-f2bee3d5d408",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
          "id" : "4c341a08-3895-3211-b6f5-1e0309949220",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
        "identifier" : "dd9813dc-3cb0-3883-a535-80f1dd423d92",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
          "id" : "c4c2db95-d63c-3590-a612-f2bee3d5d408",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
        "identifier" : "7364ba1b-0e02-3c6f-be6f-5a1c80ad13e0",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "ETL_Error",
      "outputPorts" : [ ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -728.0,
        "y" : 1352.0
      },
      "processGroups" : [ {
        "comments" : "",
        "componentType" : "PROCESS_GROUP",
        "connections" : [ {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
            "id" : "bf23f841-4dfb-3efc-ab49-1a252b62fa34",
            "name" : "LaythongtinTelegramCauHinh",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
          "identifier" : "a272bd0e-e38b-34ce-a45a-7ece665567b1",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
            "id" : "b4783806-5c41-336b-ba8b-8ea0a13baf74",
            "name" : "input",
            "type" : "INPUT_PORT"
          },
          "zIndex" : 1
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
            "id" : "32e0f9b2-9f34-359f-b504-d0be98556ffd",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
          "identifier" : "58f83816-6435-30a1-a4ec-f7ce11e6d17b",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
            "id" : "bf23f841-4dfb-3efc-ab49-1a252b62fa34",
            "name" : "LaythongtinTelegramCauHinh",
            "type" : "PROCESSOR"
          },
          "zIndex" : 6
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
            "id" : "24178aea-fa77-3aef-aa37-2a9add5e03a7",
            "name" : "GuiTinNhanTelegram",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
          "identifier" : "2efacfe1-943f-35a1-903c-7242165e54ee",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
            "id" : "fd2af8f1-0005-3234-9a75-143c0c8f0ec0",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "zIndex" : 7
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
            "id" : "0e9a01fe-4832-3507-a401-9bc3a79fd3f7",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
          "identifier" : "da5fe299-ba23-3833-9ee9-51c9f2cf3048",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
            "id" : "fd2af8f1-0005-3234-9a75-143c0c8f0ec0",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "zIndex" : 9
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
            "id" : "fd2af8f1-0005-3234-9a75-143c0c8f0ec0",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
          "identifier" : "3ebc4422-fcfc-34bf-b579-95c207bdff57",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "send" ],
          "source" : {
            "comments" : "",
            "groupId" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
            "id" : "32e0f9b2-9f34-359f-b504-d0be98556ffd",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "zIndex" : 8
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
            "id" : "0e9a01fe-4832-3507-a401-9bc3a79fd3f7",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
          "identifier" : "e7e3118b-53a3-338a-adbc-e237f7481abb",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "Response", "Failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
            "id" : "24178aea-fa77-3aef-aa37-2a9add5e03a7",
            "name" : "GuiTinNhanTelegram",
            "type" : "PROCESSOR"
          },
          "zIndex" : 5
        } ],
        "controllerServices" : [ ],
        "defaultBackPressureDataSizeThreshold" : "1 GB",
        "defaultBackPressureObjectThreshold" : 10000,
        "defaultFlowFileExpiration" : "0 sec",
        "executionEngine" : "INHERITED",
        "flowFileConcurrency" : "UNBOUNDED",
        "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
        "funnels" : [ ],
        "groupIdentifier" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
        "identifier" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
        "inputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "INPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
          "identifier" : "b4783806-5c41-336b-ba8b-8ea0a13baf74",
          "name" : "input",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : -1056.0,
            "y" : -248.0
          },
          "scheduledState" : "ENABLED",
          "type" : "INPUT_PORT"
        } ],
        "labels" : [ ],
        "maxConcurrentTasks" : 1,
        "name" : "GuiThongBaoTelegram",
        "outputPorts" : [ ],
        "parameterContextName" : "ETL",
        "position" : {
          "x" : 1432.0,
          "y" : -272.0
        },
        "processGroups" : [ ],
        "processors" : [ {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
          "identifier" : "bf23f841-4dfb-3efc-ab49-1a252b62fa34",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LaythongtinTelegramCauHinh",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : -656.0,
            "y" : -280.0
          },
          "properties" : {
            "telegram.botToken" : "#{BotToken}",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100",
            "telegram.chatId" : "#{ChatId}",
            "telegram.enabled" : "#{Enabled}",
            "telegram.text" : " MESSAGE ALERT\n Application: NIFI\n Flow: ${state.name}\n Message: ${state.message}"
          },
          "propertyDescriptors" : {
            "telegram.botToken" : {
              "displayName" : "telegram.botToken",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.botToken",
              "sensitive" : false
            },
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "telegram.chatId" : {
              "displayName" : "telegram.chatId",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.chatId",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            },
            "telegram.enabled" : {
              "displayName" : "telegram.enabled",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.enabled",
              "sensitive" : false
            },
            "telegram.text" : {
              "displayName" : "telegram.text",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.text",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
          "identifier" : "fd2af8f1-0005-3234-9a75-143c0c8f0ec0",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ReplaceText",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 200.0,
            "y" : -288.0
          },
          "properties" : {
            "Regular Expression" : "(?s)^(.*)$",
            "Replacement Value" : "{\"chat_id\":\"#{ChatId}\",\"text\":\"${telegram.text}\"}",
            "Evaluation Mode" : "Entire text",
            "Line-by-Line Evaluation Mode" : "All",
            "Character Set" : "UTF-8",
            "Maximum Buffer Size" : "1 MB",
            "Replacement Strategy" : "Regex Replace"
          },
          "propertyDescriptors" : {
            "Regular Expression" : {
              "displayName" : "Search Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Regular Expression",
              "sensitive" : false
            },
            "Replacement Value" : {
              "displayName" : "Replacement Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Value",
              "sensitive" : false
            },
            "Evaluation Mode" : {
              "displayName" : "Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Evaluation Mode",
              "sensitive" : false
            },
            "Text to Prepend" : {
              "displayName" : "Text to Prepend",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Prepend",
              "sensitive" : false
            },
            "Line-by-Line Evaluation Mode" : {
              "displayName" : "Line-by-Line Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Line-by-Line Evaluation Mode",
              "sensitive" : false
            },
            "Character Set" : {
              "displayName" : "Character Set",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Character Set",
              "sensitive" : false
            },
            "Maximum Buffer Size" : {
              "displayName" : "Maximum Buffer Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum Buffer Size",
              "sensitive" : false
            },
            "Replacement Strategy" : {
              "displayName" : "Replacement Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Strategy",
              "sensitive" : false
            },
            "Text to Append" : {
              "displayName" : "Text to Append",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Append",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ReplaceText",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "unmatched" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
          "identifier" : "32e0f9b2-9f34-359f-b504-d0be98556ffd",
          "maxBackoffPeriod" : "10 mins",
          "name" : "RouteOnAttribute",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : -184.0,
            "y" : -288.0
          },
          "properties" : {
            "Routing Strategy" : "Route to Property name",
            "send" : "${telegram.enabled:equals('true')}"
          },
          "propertyDescriptors" : {
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "send" : {
              "displayName" : "send",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "send",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "No Retry", "Retry", "Original" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
          "identifier" : "24178aea-fa77-3aef-aa37-2a9add5e03a7",
          "maxBackoffPeriod" : "10 mins",
          "name" : "GuiTinNhanTelegram",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 656.0,
            "y" : -296.0
          },
          "properties" : {
            "Request Content-Encoding" : "DISABLED",
            "Request Multipart Form-Data Filename Enabled" : "true",
            "Request Chunked Transfer-Encoding Enabled" : "false",
            "HTTP/2 Disabled" : "False",
            "Connection Timeout" : "30 secs",
            "Response Cookie Strategy" : "DISABLED",
            "Socket Read Timeout" : "15 secs",
            "Socket Idle Connections" : "5",
            "Request Body Enabled" : "true",
            "OAuth2 Access Token Refresh Strategy" : "ON_TOKEN_EXPIRATION",
            "HTTP URL" : "https://api.telegram.org/bot#{BotToken}/sendMessage",
            "Socket Idle Timeout" : "5 mins",
            "Response Redirects Enabled" : "True",
            "Socket Write Timeout" : "15 secs",
            "Response FlowFile Naming Strategy" : "RANDOM",
            "Response Cache Enabled" : "false",
            "Request Date Header Enabled" : "True",
            "Request Failure Penalization Enabled" : "false",
            "Response Body Attribute Size" : "256",
            "Response Generation Required" : "false",
            "Response Header Request Attributes Enabled" : "false",
            "HTTP Method" : "POST",
            "Request Content-Type" : "application/json",
            "Request Digest Authentication Enabled" : "false",
            "Response Cache Size" : "10MB",
            "Response Body Ignored" : "false"
          },
          "propertyDescriptors" : {
            "Request Content-Encoding" : {
              "displayName" : "Request Content-Encoding",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Content-Encoding",
              "sensitive" : false
            },
            "proxy-configuration-service" : {
              "displayName" : "Proxy Configuration Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "proxy-configuration-service",
              "sensitive" : false
            },
            "Request Multipart Form-Data Filename Enabled" : {
              "displayName" : "Request Multipart Form-Data Filename Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Multipart Form-Data Filename Enabled",
              "sensitive" : false
            },
            "Request Chunked Transfer-Encoding Enabled" : {
              "displayName" : "Request Chunked Transfer-Encoding Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Chunked Transfer-Encoding Enabled",
              "sensitive" : false
            },
            "Response Header Request Attributes Prefix" : {
              "displayName" : "Response Header Request Attributes Prefix",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Header Request Attributes Prefix",
              "sensitive" : false
            },
            "HTTP/2 Disabled" : {
              "displayName" : "HTTP/2 Disabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP/2 Disabled",
              "sensitive" : false
            },
            "Connection Timeout" : {
              "displayName" : "Connection Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Connection Timeout",
              "sensitive" : false
            },
            "Response Cookie Strategy" : {
              "displayName" : "Response Cookie Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cookie Strategy",
              "sensitive" : false
            },
            "Request Password" : {
              "displayName" : "Request Password",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Password",
              "sensitive" : true
            },
            "Socket Read Timeout" : {
              "displayName" : "Socket Read Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Read Timeout",
              "sensitive" : false
            },
            "Socket Idle Connections" : {
              "displayName" : "Socket Idle Connections",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Idle Connections",
              "sensitive" : false
            },
            "Request Body Enabled" : {
              "displayName" : "Request Body Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Body Enabled",
              "sensitive" : false
            },
            "OAuth2 Access Token Refresh Strategy" : {
              "displayName" : "OAuth2 Access Token Refresh Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "OAuth2 Access Token Refresh Strategy",
              "sensitive" : false
            },
            "HTTP URL" : {
              "displayName" : "HTTP URL",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP URL",
              "sensitive" : false
            },
            "Request OAuth2 Access Token Provider" : {
              "displayName" : "Request OAuth2 Access Token Provider",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Request OAuth2 Access Token Provider",
              "sensitive" : false
            },
            "Socket Idle Timeout" : {
              "displayName" : "Socket Idle Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Idle Timeout",
              "sensitive" : false
            },
            "Response Redirects Enabled" : {
              "displayName" : "Response Redirects Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Redirects Enabled",
              "sensitive" : false
            },
            "Socket Write Timeout" : {
              "displayName" : "Socket Write Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Write Timeout",
              "sensitive" : false
            },
            "Request Header Attributes Pattern" : {
              "displayName" : "Request Header Attributes Pattern",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Header Attributes Pattern",
              "sensitive" : false
            },
            "Response FlowFile Naming Strategy" : {
              "displayName" : "Response FlowFile Naming Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response FlowFile Naming Strategy",
              "sensitive" : false
            },
            "Response Cache Enabled" : {
              "displayName" : "Response Cache Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cache Enabled",
              "sensitive" : false
            },
            "Request Date Header Enabled" : {
              "displayName" : "Request Date Header Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Date Header Enabled",
              "sensitive" : false
            },
            "Request Failure Penalization Enabled" : {
              "displayName" : "Request Failure Penalization Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Failure Penalization Enabled",
              "sensitive" : false
            },
            "Response Body Attribute Size" : {
              "displayName" : "Response Body Attribute Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Attribute Size",
              "sensitive" : false
            },
            "SSL Context Service" : {
              "displayName" : "SSL Context Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "SSL Context Service",
              "sensitive" : false
            },
            "Response Generation Required" : {
              "displayName" : "Response Generation Required",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Generation Required",
              "sensitive" : false
            },
            "Request User-Agent" : {
              "displayName" : "Request User-Agent",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request User-Agent",
              "sensitive" : false
            },
            "Response Header Request Attributes Enabled" : {
              "displayName" : "Response Header Request Attributes Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Header Request Attributes Enabled",
              "sensitive" : false
            },
            "HTTP Method" : {
              "displayName" : "HTTP Method",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP Method",
              "sensitive" : false
            },
            "Request Username" : {
              "displayName" : "Request Username",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Username",
              "sensitive" : false
            },
            "Request Content-Type" : {
              "displayName" : "Request Content-Type",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Content-Type",
              "sensitive" : false
            },
            "Response Body Attribute Name" : {
              "displayName" : "Response Body Attribute Name",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Attribute Name",
              "sensitive" : false
            },
            "Request Digest Authentication Enabled" : {
              "displayName" : "Request Digest Authentication Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Digest Authentication Enabled",
              "sensitive" : false
            },
            "Request Multipart Form-Data Name" : {
              "displayName" : "Request Multipart Form-Data Name",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Multipart Form-Data Name",
              "sensitive" : false
            },
            "Response Cache Size" : {
              "displayName" : "Response Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cache Size",
              "sensitive" : false
            },
            "Response Body Ignored" : {
              "displayName" : "Response Body Ignored",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Ignored",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "success" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9da8d101-5cac-3f68-bdb8-a5c09dca8e31",
          "identifier" : "0e9a01fe-4832-3507-a401-9bc3a79fd3f7",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LogMessage",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 224.0,
            "y" : 32.0
          },
          "properties" : {
            "log-level" : "info"
          },
          "propertyDescriptors" : {
            "log-message" : {
              "displayName" : "Log message",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-message",
              "sensitive" : false
            },
            "log-level" : {
              "displayName" : "Log Level",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-level",
              "sensitive" : false
            },
            "log-prefix" : {
              "displayName" : "Log prefix",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-prefix",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.LogMessage",
          "yieldDuration" : "1 sec"
        } ],
        "remoteProcessGroups" : [ ],
        "scheduledState" : "ENABLED",
        "statelessFlowTimeout" : "1 min"
      } ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
        "identifier" : "fdd9126a-8f8d-37d2-8ae3-98277db53068",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 904.0,
          "y" : -240.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${state.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
        "identifier" : "ba44e096-9b5a-39d5-8cc6-f9c9748939cf",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "state.message" : "Li khi duyt tng BC",
          "filename" : "${state.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.status" : "3",
          "state.isActive" : "false",
          "state.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "state.message" : {
            "displayName" : "state.message",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.message",
            "sensitive" : false
          },
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.status" : {
            "displayName" : "state.status",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.status",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.isActive" : {
            "displayName" : "state.isActive",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.isActive",
            "sensitive" : false
          },
          "state.lastExecutionTime" : {
            "displayName" : "state.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.lastExecutionTime",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
        "identifier" : "c4c2db95-d63c-3590-a612-f2bee3d5d408",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${state.name}\",\n  \"isActive\": ${state.isActive},\n  \"lastExecutionTime\": \"${state.lastExecutionTime}\",\n  \"startTime\": \"${state.startTime}\",\n  \"endTime\": \"${state.endTime}\",\n  \"status\": \"${state.status}\",\n  \"sequenceNumber\": \"${state.sequenceNumber}\",\n  \"message\": \"${state.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "6e445b64-dc9e-3b62-b5f1-1316bb7b84ac",
        "identifier" : "4c341a08-3895-3211-b6f5-1e0309949220",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
          "id" : "502cbb62-6134-302a-905c-0a5496a2eb11",
          "name" : "KhoiTaoBc",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
        "identifier" : "7d871daa-d946-35fd-9b83-a4c051836386",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
          "id" : "dba68416-cb9b-3dc8-92fc-e694ca2fe23d",
          "name" : "BcId",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
          "id" : "96340ea4-a87a-38f4-a779-aba72e3d7ee2",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
        "identifier" : "52742de4-ad4c-3122-a92c-6afeba65294d",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
          "id" : "502cbb62-6134-302a-905c-0a5496a2eb11",
          "name" : "KhoiTaoBc",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
          "id" : "92f04a73-eee2-31f8-a650-89009af7ba11",
          "name" : "stateBcOut",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
        "identifier" : "26885de2-288d-3107-b9bb-123f8d93179e",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
          "id" : "96340ea4-a87a-38f4-a779-aba72e3d7ee2",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
          "id" : "686afe99-4630-3e6a-a3c2-5da257e91eb1",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
        "identifier" : "510fbf7e-9bc2-3630-8d76-ce6b9e0e1ec3",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
          "id" : "96340ea4-a87a-38f4-a779-aba72e3d7ee2",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "zIndex" : 45
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
        "identifier" : "dba68416-cb9b-3dc8-92fc-e694ca2fe23d",
        "name" : "BcId",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LayTrangThaiBCHienTai",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
        "identifier" : "92f04a73-eee2-31f8-a650-89009af7ba11",
        "name" : "stateBcOut",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 1280.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -224.0,
        "y" : 1784.0
      },
      "processGroups" : [ {
        "comments" : "",
        "componentType" : "PROCESS_GROUP",
        "connections" : [ {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
            "id" : "b665c722-2d67-3d19-bde1-829f9e2467c0",
            "name" : "CapNhatToContent",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
          "identifier" : "a0a372e4-c89f-3aaa-9755-460a0290adbd",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
            "id" : "3fdbdc96-cd24-3bf9-9fbe-4cd07dc7e9a0",
            "name" : "ChuanHoa",
            "type" : "PROCESSOR"
          },
          "zIndex" : 42
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
            "id" : "ff699bb0-71a5-38e6-ad87-033b59a7a595",
            "name" : "input",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
          "identifier" : "1fdb03a6-d6ca-310b-9699-12a7a85e4684",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
            "id" : "a4ea147e-2549-3a7d-927a-1346f53073fe",
            "name" : "LuuFile",
            "type" : "PROCESSOR"
          },
          "zIndex" : 47
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
            "id" : "a4ea147e-2549-3a7d-927a-1346f53073fe",
            "name" : "LuuFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
          "identifier" : "6c941494-db41-3312-afe8-cdd11d0ac7ab",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
            "id" : "b665c722-2d67-3d19-bde1-829f9e2467c0",
            "name" : "CapNhatToContent",
            "type" : "PROCESSOR"
          },
          "zIndex" : 43
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
            "id" : "aa937d82-fc0b-3241-8397-4df7ce718268",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
          "identifier" : "d4713ce1-1b73-3c56-8725-ce27ed01b907",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
            "id" : "b665c722-2d67-3d19-bde1-829f9e2467c0",
            "name" : "CapNhatToContent",
            "type" : "PROCESSOR"
          },
          "zIndex" : 44
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
            "id" : "aa937d82-fc0b-3241-8397-4df7ce718268",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
          "identifier" : "5c375a71-8dcc-3461-855e-4eb030214fa1",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
            "id" : "a4ea147e-2549-3a7d-927a-1346f53073fe",
            "name" : "LuuFile",
            "type" : "PROCESSOR"
          },
          "zIndex" : 46
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
            "id" : "3fdbdc96-cd24-3bf9-9fbe-4cd07dc7e9a0",
            "name" : "ChuanHoa",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
          "identifier" : "652151cf-aec8-3dd1-b026-56879ae28b3c",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
            "id" : "686afe99-4630-3e6a-a3c2-5da257e91eb1",
            "name" : "TrangThai",
            "type" : "INPUT_PORT"
          },
          "zIndex" : 41
        } ],
        "controllerServices" : [ ],
        "defaultBackPressureDataSizeThreshold" : "1 GB",
        "defaultBackPressureObjectThreshold" : 10000,
        "defaultFlowFileExpiration" : "0 sec",
        "executionEngine" : "INHERITED",
        "flowFileConcurrency" : "UNBOUNDED",
        "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
        "funnels" : [ ],
        "groupIdentifier" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
        "identifier" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
        "inputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "INPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
          "identifier" : "686afe99-4630-3e6a-a3c2-5da257e91eb1",
          "name" : "TrangThai",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : -488.0,
            "y" : -176.0
          },
          "scheduledState" : "ENABLED",
          "type" : "INPUT_PORT"
        } ],
        "labels" : [ ],
        "maxConcurrentTasks" : 1,
        "name" : "LuuTrangThaiBCHienTaiVoiLoi",
        "outputPorts" : [ ],
        "parameterContextName" : "TikTokETL",
        "position" : {
          "x" : 600.0,
          "y" : 72.0
        },
        "processGroups" : [ {
          "comments" : "",
          "componentType" : "PROCESS_GROUP",
          "connections" : [ {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
              "id" : "d222dfa4-a968-31c0-9ce1-7f9d9c403280",
              "name" : "ReplaceText",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
            "identifier" : "c9693666-10dc-355b-a519-1b2668da495f",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "send" ],
            "source" : {
              "comments" : "",
              "groupId" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
              "id" : "01209bf4-7f78-3160-ac61-8b63e473c7e4",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "zIndex" : 8
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
              "id" : "8ef1aaaa-ce13-3e41-a3a9-d346758f2e20",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
            "identifier" : "0b30fc73-4093-351a-b6b9-4f3f5fe822f6",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "Response", "Failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
              "id" : "4b2b73b8-9e59-320b-891a-5930c55e0bfb",
              "name" : "GuiTinNhanTelegram",
              "type" : "PROCESSOR"
            },
            "zIndex" : 5
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
              "id" : "01209bf4-7f78-3160-ac61-8b63e473c7e4",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
            "identifier" : "32cf9d50-8449-3c1c-944e-501ed4e680ca",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
              "id" : "c20f343c-3681-32d5-9551-4007be7b9b27",
              "name" : "LaythongtinTelegramCauHinh",
              "type" : "PROCESSOR"
            },
            "zIndex" : 6
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
              "id" : "c20f343c-3681-32d5-9551-4007be7b9b27",
              "name" : "LaythongtinTelegramCauHinh",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
            "identifier" : "8142bb1e-871d-3023-9cfd-353cdaf9c11e",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "groupId" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
              "id" : "ff699bb0-71a5-38e6-ad87-033b59a7a595",
              "name" : "input",
              "type" : "INPUT_PORT"
            },
            "zIndex" : 1
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
              "id" : "8ef1aaaa-ce13-3e41-a3a9-d346758f2e20",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
            "identifier" : "f368ef3a-63a1-3a96-925a-c517c74e9079",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
              "id" : "d222dfa4-a968-31c0-9ce1-7f9d9c403280",
              "name" : "ReplaceText",
              "type" : "PROCESSOR"
            },
            "zIndex" : 9
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
              "id" : "4b2b73b8-9e59-320b-891a-5930c55e0bfb",
              "name" : "GuiTinNhanTelegram",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
            "identifier" : "ef981494-af98-3ad6-b732-7b72acd350f7",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
              "id" : "d222dfa4-a968-31c0-9ce1-7f9d9c403280",
              "name" : "ReplaceText",
              "type" : "PROCESSOR"
            },
            "zIndex" : 7
          } ],
          "controllerServices" : [ ],
          "defaultBackPressureDataSizeThreshold" : "1 GB",
          "defaultBackPressureObjectThreshold" : 10000,
          "defaultFlowFileExpiration" : "0 sec",
          "executionEngine" : "INHERITED",
          "flowFileConcurrency" : "UNBOUNDED",
          "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
          "funnels" : [ ],
          "groupIdentifier" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
          "identifier" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
          "inputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "INPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
            "identifier" : "ff699bb0-71a5-38e6-ad87-033b59a7a595",
            "name" : "input",
            "portFunction" : "STANDARD",
            "position" : {
              "x" : -1056.0,
              "y" : -248.0
            },
            "scheduledState" : "ENABLED",
            "type" : "INPUT_PORT"
          } ],
          "labels" : [ ],
          "maxConcurrentTasks" : 1,
          "name" : "GuiThongBaoTelegram",
          "outputPorts" : [ ],
          "position" : {
            "x" : 1376.0,
            "y" : -256.0
          },
          "processGroups" : [ ],
          "processors" : [ {
            "autoTerminatedRelationships" : [ "No Retry", "Retry", "Original" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
            "identifier" : "4b2b73b8-9e59-320b-891a-5930c55e0bfb",
            "maxBackoffPeriod" : "10 mins",
            "name" : "GuiTinNhanTelegram",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 656.0,
              "y" : -296.0
            },
            "properties" : {
              "Request Content-Encoding" : "DISABLED",
              "Request Multipart Form-Data Filename Enabled" : "true",
              "Request Chunked Transfer-Encoding Enabled" : "false",
              "HTTP/2 Disabled" : "False",
              "Connection Timeout" : "30 secs",
              "Response Cookie Strategy" : "DISABLED",
              "Socket Read Timeout" : "15 secs",
              "Socket Idle Connections" : "5",
              "Request Body Enabled" : "true",
              "OAuth2 Access Token Refresh Strategy" : "ON_TOKEN_EXPIRATION",
              "HTTP URL" : "https://api.telegram.org/bot#{BotToken}/sendMessage",
              "Socket Idle Timeout" : "5 mins",
              "Response Redirects Enabled" : "True",
              "Socket Write Timeout" : "15 secs",
              "Response FlowFile Naming Strategy" : "RANDOM",
              "Response Cache Enabled" : "false",
              "Request Date Header Enabled" : "True",
              "Request Failure Penalization Enabled" : "false",
              "Response Body Attribute Size" : "256",
              "Response Generation Required" : "false",
              "Response Header Request Attributes Enabled" : "false",
              "HTTP Method" : "POST",
              "Request Content-Type" : "application/json",
              "Request Digest Authentication Enabled" : "false",
              "Response Cache Size" : "10MB",
              "Response Body Ignored" : "false"
            },
            "propertyDescriptors" : {
              "Request Content-Encoding" : {
                "displayName" : "Request Content-Encoding",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Content-Encoding",
                "sensitive" : false
              },
              "proxy-configuration-service" : {
                "displayName" : "Proxy Configuration Service",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "proxy-configuration-service",
                "sensitive" : false
              },
              "Request Multipart Form-Data Filename Enabled" : {
                "displayName" : "Request Multipart Form-Data Filename Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Multipart Form-Data Filename Enabled",
                "sensitive" : false
              },
              "Request Chunked Transfer-Encoding Enabled" : {
                "displayName" : "Request Chunked Transfer-Encoding Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Chunked Transfer-Encoding Enabled",
                "sensitive" : false
              },
              "Response Header Request Attributes Prefix" : {
                "displayName" : "Response Header Request Attributes Prefix",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Header Request Attributes Prefix",
                "sensitive" : false
              },
              "HTTP/2 Disabled" : {
                "displayName" : "HTTP/2 Disabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "HTTP/2 Disabled",
                "sensitive" : false
              },
              "Connection Timeout" : {
                "displayName" : "Connection Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Connection Timeout",
                "sensitive" : false
              },
              "Response Cookie Strategy" : {
                "displayName" : "Response Cookie Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Cookie Strategy",
                "sensitive" : false
              },
              "Request Password" : {
                "displayName" : "Request Password",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Password",
                "sensitive" : true
              },
              "Socket Read Timeout" : {
                "displayName" : "Socket Read Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Socket Read Timeout",
                "sensitive" : false
              },
              "Socket Idle Connections" : {
                "displayName" : "Socket Idle Connections",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Socket Idle Connections",
                "sensitive" : false
              },
              "Request Body Enabled" : {
                "displayName" : "Request Body Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Body Enabled",
                "sensitive" : false
              },
              "OAuth2 Access Token Refresh Strategy" : {
                "displayName" : "OAuth2 Access Token Refresh Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "OAuth2 Access Token Refresh Strategy",
                "sensitive" : false
              },
              "HTTP URL" : {
                "displayName" : "HTTP URL",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "HTTP URL",
                "sensitive" : false
              },
              "Request OAuth2 Access Token Provider" : {
                "displayName" : "Request OAuth2 Access Token Provider",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "Request OAuth2 Access Token Provider",
                "sensitive" : false
              },
              "Socket Idle Timeout" : {
                "displayName" : "Socket Idle Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Socket Idle Timeout",
                "sensitive" : false
              },
              "Response Redirects Enabled" : {
                "displayName" : "Response Redirects Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Redirects Enabled",
                "sensitive" : false
              },
              "Socket Write Timeout" : {
                "displayName" : "Socket Write Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Socket Write Timeout",
                "sensitive" : false
              },
              "Request Header Attributes Pattern" : {
                "displayName" : "Request Header Attributes Pattern",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Header Attributes Pattern",
                "sensitive" : false
              },
              "Response FlowFile Naming Strategy" : {
                "displayName" : "Response FlowFile Naming Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response FlowFile Naming Strategy",
                "sensitive" : false
              },
              "Response Cache Enabled" : {
                "displayName" : "Response Cache Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Cache Enabled",
                "sensitive" : false
              },
              "Request Date Header Enabled" : {
                "displayName" : "Request Date Header Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Date Header Enabled",
                "sensitive" : false
              },
              "Request Failure Penalization Enabled" : {
                "displayName" : "Request Failure Penalization Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Failure Penalization Enabled",
                "sensitive" : false
              },
              "Response Body Attribute Size" : {
                "displayName" : "Response Body Attribute Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Body Attribute Size",
                "sensitive" : false
              },
              "SSL Context Service" : {
                "displayName" : "SSL Context Service",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "SSL Context Service",
                "sensitive" : false
              },
              "Response Generation Required" : {
                "displayName" : "Response Generation Required",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Generation Required",
                "sensitive" : false
              },
              "Request User-Agent" : {
                "displayName" : "Request User-Agent",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request User-Agent",
                "sensitive" : false
              },
              "Response Header Request Attributes Enabled" : {
                "displayName" : "Response Header Request Attributes Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Header Request Attributes Enabled",
                "sensitive" : false
              },
              "HTTP Method" : {
                "displayName" : "HTTP Method",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "HTTP Method",
                "sensitive" : false
              },
              "Request Username" : {
                "displayName" : "Request Username",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Username",
                "sensitive" : false
              },
              "Request Content-Type" : {
                "displayName" : "Request Content-Type",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Content-Type",
                "sensitive" : false
              },
              "Response Body Attribute Name" : {
                "displayName" : "Response Body Attribute Name",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Body Attribute Name",
                "sensitive" : false
              },
              "Request Digest Authentication Enabled" : {
                "displayName" : "Request Digest Authentication Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Digest Authentication Enabled",
                "sensitive" : false
              },
              "Request Multipart Form-Data Name" : {
                "displayName" : "Request Multipart Form-Data Name",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Multipart Form-Data Name",
                "sensitive" : false
              },
              "Response Cache Size" : {
                "displayName" : "Response Cache Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Cache Size",
                "sensitive" : false
              },
              "Response Body Ignored" : {
                "displayName" : "Response Body Ignored",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Body Ignored",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
            "identifier" : "c20f343c-3681-32d5-9551-4007be7b9b27",
            "maxBackoffPeriod" : "10 mins",
            "name" : "LaythongtinTelegramCauHinh",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : -656.0,
              "y" : -280.0
            },
            "properties" : {
              "telegram.botToken" : "#{BotToken}",
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100",
              "telegram.chatId" : "#{ChatId}",
              "telegram.enabled" : "#{Enabled}",
              "telegram.text" : " MESSAGE ALERT\n Application: NIFI\n Flow: ${state.name}\n Message: ${state.message}"
            },
            "propertyDescriptors" : {
              "telegram.botToken" : {
                "displayName" : "telegram.botToken",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "telegram.botToken",
                "sensitive" : false
              },
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "telegram.chatId" : {
                "displayName" : "telegram.chatId",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "telegram.chatId",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              },
              "telegram.enabled" : {
                "displayName" : "telegram.enabled",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "telegram.enabled",
                "sensitive" : false
              },
              "telegram.text" : {
                "displayName" : "telegram.text",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "telegram.text",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "success" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
            "identifier" : "8ef1aaaa-ce13-3e41-a3a9-d346758f2e20",
            "maxBackoffPeriod" : "10 mins",
            "name" : "LogMessage",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 224.0,
              "y" : 32.0
            },
            "properties" : {
              "log-level" : "info"
            },
            "propertyDescriptors" : {
              "log-message" : {
                "displayName" : "Log message",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-message",
                "sensitive" : false
              },
              "log-level" : {
                "displayName" : "Log Level",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-level",
                "sensitive" : false
              },
              "log-prefix" : {
                "displayName" : "Log prefix",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-prefix",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.LogMessage",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
            "identifier" : "d222dfa4-a968-31c0-9ce1-7f9d9c403280",
            "maxBackoffPeriod" : "10 mins",
            "name" : "ReplaceText",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 200.0,
              "y" : -288.0
            },
            "properties" : {
              "Regular Expression" : "(?s)^(.*)$",
              "Replacement Value" : "{\"chat_id\":\"#{ChatId}\",\"text\":\"${telegram.text}\"}",
              "Evaluation Mode" : "Entire text",
              "Line-by-Line Evaluation Mode" : "All",
              "Character Set" : "UTF-8",
              "Maximum Buffer Size" : "1 MB",
              "Replacement Strategy" : "Regex Replace"
            },
            "propertyDescriptors" : {
              "Regular Expression" : {
                "displayName" : "Search Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Regular Expression",
                "sensitive" : false
              },
              "Replacement Value" : {
                "displayName" : "Replacement Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Replacement Value",
                "sensitive" : false
              },
              "Evaluation Mode" : {
                "displayName" : "Evaluation Mode",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Evaluation Mode",
                "sensitive" : false
              },
              "Text to Prepend" : {
                "displayName" : "Text to Prepend",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Text to Prepend",
                "sensitive" : false
              },
              "Line-by-Line Evaluation Mode" : {
                "displayName" : "Line-by-Line Evaluation Mode",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Line-by-Line Evaluation Mode",
                "sensitive" : false
              },
              "Character Set" : {
                "displayName" : "Character Set",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Character Set",
                "sensitive" : false
              },
              "Maximum Buffer Size" : {
                "displayName" : "Maximum Buffer Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Maximum Buffer Size",
                "sensitive" : false
              },
              "Replacement Strategy" : {
                "displayName" : "Replacement Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Replacement Strategy",
                "sensitive" : false
              },
              "Text to Append" : {
                "displayName" : "Text to Append",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Text to Append",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.ReplaceText",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "unmatched" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "be275897-8c59-3ae7-b735-b5ceb76ded03",
            "identifier" : "01209bf4-7f78-3160-ac61-8b63e473c7e4",
            "maxBackoffPeriod" : "10 mins",
            "name" : "RouteOnAttribute",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : -184.0,
              "y" : -288.0
            },
            "properties" : {
              "Routing Strategy" : "Route to Property name",
              "send" : "${telegram.enabled:equals('true')}"
            },
            "propertyDescriptors" : {
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              },
              "send" : {
                "displayName" : "send",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "send",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          } ],
          "remoteProcessGroups" : [ ],
          "scheduledState" : "ENABLED",
          "statelessFlowTimeout" : "1 min"
        } ],
        "processors" : [ {
          "autoTerminatedRelationships" : [ "success" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
          "identifier" : "aa937d82-fc0b-3241-8397-4df7ce718268",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LogMessage",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 616.0,
            "y" : 64.0
          },
          "properties" : {
            "log-level" : "info"
          },
          "propertyDescriptors" : {
            "log-message" : {
              "displayName" : "Log message",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-message",
              "sensitive" : false
            },
            "log-level" : {
              "displayName" : "Log Level",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-level",
              "sensitive" : false
            },
            "log-prefix" : {
              "displayName" : "Log prefix",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-prefix",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ "success" ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.LogMessage",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
          "identifier" : "a4ea147e-2549-3a7d-927a-1346f53073fe",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LuuFile",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 944.0,
            "y" : -232.0
          },
          "properties" : {
            "Create Missing Directories" : "true",
            "Directory" : "${stateBc.path}",
            "Conflict Resolution Strategy" : "replace"
          },
          "propertyDescriptors" : {
            "Group" : {
              "displayName" : "Group",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Group",
              "sensitive" : false
            },
            "Owner" : {
              "displayName" : "Owner",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Owner",
              "sensitive" : false
            },
            "Create Missing Directories" : {
              "displayName" : "Create Missing Directories",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Create Missing Directories",
              "sensitive" : false
            },
            "Permissions" : {
              "displayName" : "Permissions",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Permissions",
              "sensitive" : false
            },
            "Maximum File Count" : {
              "displayName" : "Maximum File Count",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum File Count",
              "sensitive" : false
            },
            "Last Modified Time" : {
              "displayName" : "Last Modified Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Last Modified Time",
              "sensitive" : false
            },
            "Directory" : {
              "displayName" : "Directory",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory",
              "sensitive" : false
            },
            "Conflict Resolution Strategy" : {
              "displayName" : "Conflict Resolution Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Conflict Resolution Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.PutFile",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
          "identifier" : "b665c722-2d67-3d19-bde1-829f9e2467c0",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CapNhatToContent",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 424.0,
            "y" : -232.0
          },
          "properties" : {
            "Regular Expression" : "(?s)(^.*$)",
            "Replacement Value" : "{\n  \"name\": \"${stateBc.name}\",\n  \"isActive\": ${stateBc.isActive},\n  \"lastExecutionTime\": \"${stateBc.lastExecutionTime}\",\n  \"startTime\": \"${stateBc.startTime}\",\n  \"endTime\": \"${stateBc.endTime}\",\n  \"status\": \"${stateBc.status}\",\n  \"sequenceNumber\": \"${stateBc.sequenceNumber}\",\n  \"message\": \"${stateBc.message}\"\n}",
            "Evaluation Mode" : "Entire text",
            "Line-by-Line Evaluation Mode" : "All",
            "Character Set" : "UTF-8",
            "Maximum Buffer Size" : "1 MB",
            "Replacement Strategy" : "Always Replace"
          },
          "propertyDescriptors" : {
            "Regular Expression" : {
              "displayName" : "Search Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Regular Expression",
              "sensitive" : false
            },
            "Replacement Value" : {
              "displayName" : "Replacement Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Value",
              "sensitive" : false
            },
            "Evaluation Mode" : {
              "displayName" : "Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Evaluation Mode",
              "sensitive" : false
            },
            "Text to Prepend" : {
              "displayName" : "Text to Prepend",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Prepend",
              "sensitive" : false
            },
            "Line-by-Line Evaluation Mode" : {
              "displayName" : "Line-by-Line Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Line-by-Line Evaluation Mode",
              "sensitive" : false
            },
            "Character Set" : {
              "displayName" : "Character Set",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Character Set",
              "sensitive" : false
            },
            "Maximum Buffer Size" : {
              "displayName" : "Maximum Buffer Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum Buffer Size",
              "sensitive" : false
            },
            "Replacement Strategy" : {
              "displayName" : "Replacement Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Strategy",
              "sensitive" : false
            },
            "Text to Append" : {
              "displayName" : "Text to Append",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Append",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ReplaceText",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "57954ff4-c684-3f76-8b9f-1926b493d4f4",
          "identifier" : "3fdbdc96-cd24-3bf9-9fbe-4cd07dc7e9a0",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ChuanHoa",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 16.0,
            "y" : -224.0
          },
          "properties" : {
            "state.message" : "Ly trng thi Bc ${stateBc.name} li",
            "filename" : "${stateBc.filename}",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100",
            "stateBc.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}",
            "stateBc.isActive" : "false",
            "stateBc.message" : "Ly trng thi Bc ${stateBc.name} li",
            "stateBc.status" : "3"
          },
          "propertyDescriptors" : {
            "state.message" : {
              "displayName" : "state.message",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.message",
              "sensitive" : false
            },
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "filename" : {
              "displayName" : "filename",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "filename",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "stateBc.lastExecutionTime" : {
              "displayName" : "stateBc.lastExecutionTime",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateBc.lastExecutionTime",
              "sensitive" : false
            },
            "stateBc.isActive" : {
              "displayName" : "stateBc.isActive",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateBc.isActive",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            },
            "stateBc.message" : {
              "displayName" : "stateBc.message",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateBc.message",
              "sensitive" : false
            },
            "stateBc.status" : {
              "displayName" : "stateBc.status",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateBc.status",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        } ],
        "remoteProcessGroups" : [ ],
        "scheduledState" : "ENABLED",
        "statelessFlowTimeout" : "1 min"
      } ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
        "identifier" : "502cbb62-6134-302a-905c-0a5496a2eb11",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KhoiTaoBc",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : -98.10848017609499,
          "y" : -206.47323369608057
        },
        "properties" : {
          "stateBc.path" : "#{TempPath}${Path.Separator}${state.name}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateBc.name" : "${stateBc.id}",
          "stateBc.filename" : "state_${stateBc.id}.json"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "stateBc.path" : {
            "displayName" : "stateBc.path",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateBc.path",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateBc.name" : {
            "displayName" : "stateBc.name",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateBc.name",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "stateBc.filename" : {
            "displayName" : "stateBc.filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateBc.filename",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-scripting-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "213ec045-ea3a-3d7a-92bc-dc4546fdb581",
        "identifier" : "96340ea4-a87a-38f4-a779-aba72e3d7ee2",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LayTrangThai",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : -208.0
        },
        "properties" : {
          "Script Engine" : "Groovy",
          "Script Body" : "// Ly trng thi ca BC hin ti\nimport groovy.json.JsonSlurper\nimport groovy.json.JsonBuilder\nimport java.nio.file.*\nimport java.time.Instant\nimport java.time.ZoneOffset\nimport java.time.format.DateTimeFormatter\nimport java.time.LocalDateTime\nimport java.time.LocalDate\nimport org.apache.nifi.processor.io.OutputStreamCallback\n\ndef flowFile = session.get()\nif (!flowFile) return\n\n// --- Helpers ---\nboolean isIntSafe(def v) {\n    if (v == null) return false\n    try { Integer.parseInt(v.toString()); return true } catch (ignored) { return false }\n}\n\n// Ly parameters t attributes (stateBc.*)\ndef etlName   = flowFile.getAttribute('stateBc.name')\ndef statePath = flowFile.getAttribute('stateBc.path')\ndef filename  = flowFile.getAttribute('stateBc.filename')\n\nif (!etlName || !statePath || !filename) {\n    log.error(\"Missing required attributes: stateBc.name, stateBc.path, or stateBc.filename\")\n    flowFile = session.putAttribute(flowFile, 'error.message', 'Missing stateBc.name, stateBc.path, or stateBc.filename attributes')\n    session.transfer(flowFile, REL_FAILURE)\n    return\n}\n\n// To ng dn y \ndef stateFilePath = Paths.get(statePath, filename).toString()\n\ntry {\n    def stateContent = \"\"\n    def stateExists = false\n\n    // Thi gian UTC & mc nh\n    def formatter = DateTimeFormatter.ofPattern(\"yyyy/MM/dd HH:mm:ss\")\n    def currentTimeUTC = Instant.now().atZone(ZoneOffset.UTC).format(formatter)\n    def defaultStartTime = \"2025/01/01 00:00:00\"\n\n    // State mc nh\n    def defaultState = [\n        name: etlName,\n        isActive: false,\n        lastExecutionTime: currentTimeUTC,\n        startTime: defaultStartTime,\n        endTime: currentTimeUTC,\n        sequenceNumber: 1, // ln chy u tin\n        status: 0,         // 0: khi to\n        message: \"\"        // trng\n    ]\n\n    // c file nu c\n    def path = Paths.get(stateFilePath)\n    if (Files.exists(path)) {\n        stateContent = new String(Files.readAllBytes(path), \"UTF-8\")\n        stateExists = true\n        log.info(\"stateBc file found for ETL '${etlName}' at '${stateFilePath}': ${stateContent}\")\n    } else {\n        stateContent = new JsonBuilder(defaultState).toString()\n        stateExists = false\n        log.info(\"stateBc file not found for ETL '${etlName}' at '${stateFilePath}', creating default content\")\n    }\n\n    // Parse JSON (fallback default nu li)\n    def jsonSlurper = new JsonSlurper()\n    Map state\n    try {\n        state = (Map) jsonSlurper.parseText(stateContent)\n    } catch (Throwable ex) {\n        log.warn(\"Invalid stateBc content, fallback to default. Error: ${ex.message}\")\n        state = new LinkedHashMap(defaultState)\n        stateExists = false\n    }\n\n    // Chun ho trng\n    state.name = etlName\n    state.isActive = (state.containsKey('isActive') && state.isActive != null) ? state.isActive as Boolean : false\n    state.lastExecutionTime = (state.lastExecutionTime ?: currentTimeUTC)\n    state.startTime = (state.startTime ?: defaultStartTime)\n    state.endTime = (state.endTime ?: currentTimeUTC)\n\n    // Gi tr hin hu  dng cho logic ca s mi\n    def oldEndTime = (state.endTime && state.endTime.toString().trim()) ? state.endTime.toString() : defaultStartTime\n\n    // sequenceNumber / status / message\n    Integer seq = 1\n    if (state.containsKey('sequenceNumber') && isIntSafe(state.sequenceNumber)) {\n        seq = (state.sequenceNumber as Integer)\n        if (seq <= 0) seq = 1\n    }\n    Integer prevStatus = 0\n    if (state.containsKey('status') && isIntSafe(state.status)) {\n        prevStatus = (state.status as Integer)\n    }\n    String msg = (state.containsKey('message') && state.message != null) ? (state.message as String) : \"\"\n\n    // --- LOGIC MI: to ca s ETL mi nu status = 0 hoc 2 ---\n    // Gii thch:\n    //  - 0 (khi to) hoc 2 (hon thnh) => ln ETL trc  kt thc bnh thng.\n    //  - startTime = endTime (c) vi gi pht giy 00:00:00 ; endTime = currentTimeUTC ; lastExecutionTime = endTime (c)\n    boolean shouldCreateNewWindow = stateExists && (prevStatus == 0 || prevStatus == 2)\n    if (shouldCreateNewWindow) {\n        // Parse oldEndTime v t li gi pht giy thnh 00:00:00\n        def newStartTime = oldEndTime\n        try {\n            def oldEndTimeParsed = LocalDateTime.parse(oldEndTime, formatter)\n            def dateOnly = oldEndTimeParsed.toLocalDate()\n            def startOfDay = dateOnly.atStartOfDay()\n            newStartTime = startOfDay.format(formatter)\n            log.info(\"stateBc: Parsed oldEndTime '${oldEndTime}' to start of day: '${newStartTime}'\")\n        } catch (Exception ex) {\n            log.warn(\"stateBc: Could not parse oldEndTime '${oldEndTime}', using as-is. Error: ${ex.message}\")\n            newStartTime = oldEndTime\n        }\n        \n        state.startTime = newStartTime\n        state.endTime = currentTimeUTC\n        log.info(\"stateBc: Create new ETL window: startTime=${state.startTime} (reset to 00:00:00), endTime=${state.endTime}, lastExecutionTime=${state.lastExecutionTime}\")\n    }\n\n    // Logic khi c t file c sn:\n    // - t status = 0\n    // - nu status c == 2 => tng sequenceNumber\n    // - message = \"\"\n    if (stateExists) {\n        if (prevStatus == 2) {\n            seq = seq + 1\n            log.info(\"stateBc: Previous status=2 (completed). Increase sequenceNumber to ${seq}\")\n        }\n        prevStatus = 0\n        msg = \"\"\n    } else {\n        // state mi\n        prevStatus = 0\n        msg = \"\"\n        seq = 1\n    }\n\n    // Gn li vo state\n    state.sequenceNumber = seq\n    state.status = prevStatus\n    state.message = msg\n\n    // Ghi attributes ra flowfile (prefix stateBc.*)\n    flowFile = session.putAttribute(flowFile, 'stateBc.exists', stateExists.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.name', state.name.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.isActive', state.isActive.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.lastExecutionTime', state.lastExecutionTime.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.startTime', state.startTime.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.endTime', state.endTime.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.sequenceNumber', state.sequenceNumber.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.status', state.status.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.message', state.message.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.fullPath', stateFilePath)\n\n    // JSON content chun ho\n    def stateContentForFlowFile = [\n        name: state.name,\n        isActive: state.isActive,\n        lastExecutionTime: state.lastExecutionTime,\n        startTime: state.startTime,\n        endTime: state.endTime,\n        sequenceNumber: state.sequenceNumber,\n        status: state.status,\n        message: state.message\n    ]\n\n    // Ghi JSON stateBc vo flowFile content\n    def contentJson = new JsonBuilder(stateContentForFlowFile).toString()\n    flowFile = session.write(flowFile, { outputStream ->\n        outputStream.write(contentJson.getBytes(\"UTF-8\"))\n    } as OutputStreamCallback)\n\n    // Lu li JSON vo attribute\n    flowFile = session.putAttribute(flowFile, 'stateBc.content', contentJson)\n\n    session.transfer(flowFile, REL_SUCCESS)\n\n} catch (Exception e) {\n    log.error(\"Error reading stateBc file for ETL '${etlName}' at '${stateFilePath}': ${e.message}\", e)\n    flowFile = session.putAttribute(flowFile, 'error.message', e.getMessage())\n    session.transfer(flowFile, REL_FAILURE)\n}"
        },
        "propertyDescriptors" : {
          "Script File" : {
            "displayName" : "Script File",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script File",
            "resourceDefinition" : {
              "cardinality" : "SINGLE",
              "resourceTypes" : [ "FILE" ]
            },
            "sensitive" : false
          },
          "Script Engine" : {
            "displayName" : "Script Engine",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script Engine",
            "sensitive" : false
          },
          "Script Body" : {
            "displayName" : "Script Body",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script Body",
            "sensitive" : false
          },
          "Module Directory" : {
            "displayName" : "Module Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Module Directory",
            "resourceDefinition" : {
              "cardinality" : "MULTIPLE",
              "resourceTypes" : [ "FILE", "DIRECTORY" ]
            },
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.script.ExecuteScript",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
          "id" : "9fbfd258-e70d-35b8-a097-80de1d96cec0",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
        "identifier" : "cd63e786-1f57-3a9a-a19b-e10c600ca662",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
          "id" : "877a3bae-6dcb-3e9a-9ede-a5ced2ab63fa",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
          "id" : "877a3bae-6dcb-3e9a-9ede-a5ced2ab63fa",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
        "identifier" : "f0d7d0be-f464-3008-a3ef-1e092430fd7d",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
          "id" : "72e616ad-50f9-35a1-8843-7b15eeeffd61",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
          "id" : "9fbfd258-e70d-35b8-a097-80de1d96cec0",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
        "identifier" : "230b19b1-6e96-3b64-b25d-ecc1f8f90e15",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
          "id" : "5bb8aea2-9ab0-3f00-b891-0a0cb6b03f4c",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
          "id" : "5bb8aea2-9ab0-3f00-b891-0a0cb6b03f4c",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
        "identifier" : "e9b0a515-3bc0-3981-9829-33a72e1327de",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
          "id" : "877a3bae-6dcb-3e9a-9ede-a5ced2ab63fa",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
          "id" : "72e616ad-50f9-35a1-8843-7b15eeeffd61",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
        "identifier" : "cda3ce9b-841c-3a31-98a5-808848897a9b",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
          "id" : "44dac373-aece-37bf-aca2-7c014f1a4dab",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "23a0e79e-595a-38c6-9d60-b86862757d29",
          "id" : "f86ee18d-d2c0-36e2-b0f7-b175f66da500",
          "name" : "input",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
        "identifier" : "7f3a4305-7fde-38f2-bc02-fcf35b87e59c",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
          "id" : "5bb8aea2-9ab0-3f00-b891-0a0cb6b03f4c",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
        "identifier" : "44dac373-aece-37bf-aca2-7c014f1a4dab",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "ETL_Error",
      "outputPorts" : [ ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -728.0,
        "y" : 928.0
      },
      "processGroups" : [ {
        "comments" : "",
        "componentType" : "PROCESS_GROUP",
        "connections" : [ {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "23a0e79e-595a-38c6-9d60-b86862757d29",
            "id" : "a825b30f-2930-33ad-b02d-4cb9f830338b",
            "name" : "GuiTinNhanTelegram",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "23a0e79e-595a-38c6-9d60-b86862757d29",
          "identifier" : "f7253cc5-c341-3a54-ba16-8f7b7b907f4e",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "23a0e79e-595a-38c6-9d60-b86862757d29",
            "id" : "bdb6659b-490f-318b-91e7-2fcbed1d68f9",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "zIndex" : 7
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "23a0e79e-595a-38c6-9d60-b86862757d29",
            "id" : "fa8972b5-5117-3dc3-a5f8-abcee7c8f0e5",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "23a0e79e-595a-38c6-9d60-b86862757d29",
          "identifier" : "14aee1b6-72a9-3360-b374-d8229abc4ccc",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "23a0e79e-595a-38c6-9d60-b86862757d29",
            "id" : "f2babbf6-0767-39ef-b7e0-c42592199a57",
            "name" : "LaythongtinTelegramCauHinh",
            "type" : "PROCESSOR"
          },
          "zIndex" : 6
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "23a0e79e-595a-38c6-9d60-b86862757d29",
            "id" : "bfda05f7-7549-35ed-8a54-d0c8cffbc582",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "23a0e79e-595a-38c6-9d60-b86862757d29",
          "identifier" : "e1f1849a-7396-336b-bdfa-14538787e59d",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "Response", "Failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "23a0e79e-595a-38c6-9d60-b86862757d29",
            "id" : "a825b30f-2930-33ad-b02d-4cb9f830338b",
            "name" : "GuiTinNhanTelegram",
            "type" : "PROCESSOR"
          },
          "zIndex" : 5
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "23a0e79e-595a-38c6-9d60-b86862757d29",
            "id" : "f2babbf6-0767-39ef-b7e0-c42592199a57",
            "name" : "LaythongtinTelegramCauHinh",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "23a0e79e-595a-38c6-9d60-b86862757d29",
          "identifier" : "e0ad0c20-082f-3138-914d-c7fdac24bd48",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "23a0e79e-595a-38c6-9d60-b86862757d29",
            "id" : "f86ee18d-d2c0-36e2-b0f7-b175f66da500",
            "name" : "input",
            "type" : "INPUT_PORT"
          },
          "zIndex" : 1
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "23a0e79e-595a-38c6-9d60-b86862757d29",
            "id" : "bdb6659b-490f-318b-91e7-2fcbed1d68f9",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "23a0e79e-595a-38c6-9d60-b86862757d29",
          "identifier" : "f068e604-0213-3c26-90cd-f1a97c42358e",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "send" ],
          "source" : {
            "comments" : "",
            "groupId" : "23a0e79e-595a-38c6-9d60-b86862757d29",
            "id" : "fa8972b5-5117-3dc3-a5f8-abcee7c8f0e5",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "zIndex" : 8
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "23a0e79e-595a-38c6-9d60-b86862757d29",
            "id" : "bfda05f7-7549-35ed-8a54-d0c8cffbc582",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "23a0e79e-595a-38c6-9d60-b86862757d29",
          "identifier" : "b5c8dbb5-f7e3-378d-a37c-b887317a465f",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "23a0e79e-595a-38c6-9d60-b86862757d29",
            "id" : "bdb6659b-490f-318b-91e7-2fcbed1d68f9",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "zIndex" : 9
        } ],
        "controllerServices" : [ ],
        "defaultBackPressureDataSizeThreshold" : "1 GB",
        "defaultBackPressureObjectThreshold" : 10000,
        "defaultFlowFileExpiration" : "0 sec",
        "executionEngine" : "INHERITED",
        "flowFileConcurrency" : "UNBOUNDED",
        "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
        "funnels" : [ ],
        "groupIdentifier" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
        "identifier" : "23a0e79e-595a-38c6-9d60-b86862757d29",
        "inputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "INPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "23a0e79e-595a-38c6-9d60-b86862757d29",
          "identifier" : "f86ee18d-d2c0-36e2-b0f7-b175f66da500",
          "name" : "input",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : -1056.0,
            "y" : -248.0
          },
          "scheduledState" : "ENABLED",
          "type" : "INPUT_PORT"
        } ],
        "labels" : [ ],
        "maxConcurrentTasks" : 1,
        "name" : "GuiThongBaoTelegram",
        "outputPorts" : [ ],
        "parameterContextName" : "ETL",
        "position" : {
          "x" : 1424.0,
          "y" : -264.0
        },
        "processGroups" : [ ],
        "processors" : [ {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "23a0e79e-595a-38c6-9d60-b86862757d29",
          "identifier" : "f2babbf6-0767-39ef-b7e0-c42592199a57",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LaythongtinTelegramCauHinh",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : -656.0,
            "y" : -280.0
          },
          "properties" : {
            "telegram.botToken" : "#{BotToken}",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100",
            "telegram.chatId" : "#{ChatId}",
            "telegram.enabled" : "#{Enabled}",
            "telegram.text" : " MESSAGE ALERT\n Application: NIFI\n Flow: ${state.name}\n Message: ${state.message}"
          },
          "propertyDescriptors" : {
            "telegram.botToken" : {
              "displayName" : "telegram.botToken",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.botToken",
              "sensitive" : false
            },
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "telegram.chatId" : {
              "displayName" : "telegram.chatId",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.chatId",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            },
            "telegram.enabled" : {
              "displayName" : "telegram.enabled",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.enabled",
              "sensitive" : false
            },
            "telegram.text" : {
              "displayName" : "telegram.text",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.text",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "unmatched" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "23a0e79e-595a-38c6-9d60-b86862757d29",
          "identifier" : "fa8972b5-5117-3dc3-a5f8-abcee7c8f0e5",
          "maxBackoffPeriod" : "10 mins",
          "name" : "RouteOnAttribute",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : -184.0,
            "y" : -288.0
          },
          "properties" : {
            "Routing Strategy" : "Route to Property name",
            "send" : "${telegram.enabled:equals('true')}"
          },
          "propertyDescriptors" : {
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "send" : {
              "displayName" : "send",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "send",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "No Retry", "Retry", "Original" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "23a0e79e-595a-38c6-9d60-b86862757d29",
          "identifier" : "a825b30f-2930-33ad-b02d-4cb9f830338b",
          "maxBackoffPeriod" : "10 mins",
          "name" : "GuiTinNhanTelegram",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 656.0,
            "y" : -296.0
          },
          "properties" : {
            "Request Content-Encoding" : "DISABLED",
            "Request Multipart Form-Data Filename Enabled" : "true",
            "Request Chunked Transfer-Encoding Enabled" : "false",
            "HTTP/2 Disabled" : "False",
            "Connection Timeout" : "30 secs",
            "Response Cookie Strategy" : "DISABLED",
            "Socket Read Timeout" : "15 secs",
            "Socket Idle Connections" : "5",
            "Request Body Enabled" : "true",
            "OAuth2 Access Token Refresh Strategy" : "ON_TOKEN_EXPIRATION",
            "HTTP URL" : "https://api.telegram.org/bot#{BotToken}/sendMessage",
            "Socket Idle Timeout" : "5 mins",
            "Response Redirects Enabled" : "True",
            "Socket Write Timeout" : "15 secs",
            "Response FlowFile Naming Strategy" : "RANDOM",
            "Response Cache Enabled" : "false",
            "Request Date Header Enabled" : "True",
            "Request Failure Penalization Enabled" : "false",
            "Response Body Attribute Size" : "256",
            "Response Generation Required" : "false",
            "Response Header Request Attributes Enabled" : "false",
            "HTTP Method" : "POST",
            "Request Content-Type" : "application/json",
            "Request Digest Authentication Enabled" : "false",
            "Response Cache Size" : "10MB",
            "Response Body Ignored" : "false"
          },
          "propertyDescriptors" : {
            "Request Content-Encoding" : {
              "displayName" : "Request Content-Encoding",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Content-Encoding",
              "sensitive" : false
            },
            "proxy-configuration-service" : {
              "displayName" : "Proxy Configuration Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "proxy-configuration-service",
              "sensitive" : false
            },
            "Request Multipart Form-Data Filename Enabled" : {
              "displayName" : "Request Multipart Form-Data Filename Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Multipart Form-Data Filename Enabled",
              "sensitive" : false
            },
            "Request Chunked Transfer-Encoding Enabled" : {
              "displayName" : "Request Chunked Transfer-Encoding Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Chunked Transfer-Encoding Enabled",
              "sensitive" : false
            },
            "Response Header Request Attributes Prefix" : {
              "displayName" : "Response Header Request Attributes Prefix",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Header Request Attributes Prefix",
              "sensitive" : false
            },
            "HTTP/2 Disabled" : {
              "displayName" : "HTTP/2 Disabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP/2 Disabled",
              "sensitive" : false
            },
            "Connection Timeout" : {
              "displayName" : "Connection Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Connection Timeout",
              "sensitive" : false
            },
            "Response Cookie Strategy" : {
              "displayName" : "Response Cookie Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cookie Strategy",
              "sensitive" : false
            },
            "Request Password" : {
              "displayName" : "Request Password",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Password",
              "sensitive" : true
            },
            "Socket Read Timeout" : {
              "displayName" : "Socket Read Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Read Timeout",
              "sensitive" : false
            },
            "Socket Idle Connections" : {
              "displayName" : "Socket Idle Connections",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Idle Connections",
              "sensitive" : false
            },
            "Request Body Enabled" : {
              "displayName" : "Request Body Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Body Enabled",
              "sensitive" : false
            },
            "OAuth2 Access Token Refresh Strategy" : {
              "displayName" : "OAuth2 Access Token Refresh Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "OAuth2 Access Token Refresh Strategy",
              "sensitive" : false
            },
            "HTTP URL" : {
              "displayName" : "HTTP URL",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP URL",
              "sensitive" : false
            },
            "Request OAuth2 Access Token Provider" : {
              "displayName" : "Request OAuth2 Access Token Provider",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Request OAuth2 Access Token Provider",
              "sensitive" : false
            },
            "Socket Idle Timeout" : {
              "displayName" : "Socket Idle Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Idle Timeout",
              "sensitive" : false
            },
            "Response Redirects Enabled" : {
              "displayName" : "Response Redirects Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Redirects Enabled",
              "sensitive" : false
            },
            "Socket Write Timeout" : {
              "displayName" : "Socket Write Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Write Timeout",
              "sensitive" : false
            },
            "Request Header Attributes Pattern" : {
              "displayName" : "Request Header Attributes Pattern",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Header Attributes Pattern",
              "sensitive" : false
            },
            "Response FlowFile Naming Strategy" : {
              "displayName" : "Response FlowFile Naming Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response FlowFile Naming Strategy",
              "sensitive" : false
            },
            "Response Cache Enabled" : {
              "displayName" : "Response Cache Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cache Enabled",
              "sensitive" : false
            },
            "Request Date Header Enabled" : {
              "displayName" : "Request Date Header Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Date Header Enabled",
              "sensitive" : false
            },
            "Request Failure Penalization Enabled" : {
              "displayName" : "Request Failure Penalization Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Failure Penalization Enabled",
              "sensitive" : false
            },
            "Response Body Attribute Size" : {
              "displayName" : "Response Body Attribute Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Attribute Size",
              "sensitive" : false
            },
            "SSL Context Service" : {
              "displayName" : "SSL Context Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "SSL Context Service",
              "sensitive" : false
            },
            "Response Generation Required" : {
              "displayName" : "Response Generation Required",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Generation Required",
              "sensitive" : false
            },
            "Request User-Agent" : {
              "displayName" : "Request User-Agent",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request User-Agent",
              "sensitive" : false
            },
            "Response Header Request Attributes Enabled" : {
              "displayName" : "Response Header Request Attributes Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Header Request Attributes Enabled",
              "sensitive" : false
            },
            "HTTP Method" : {
              "displayName" : "HTTP Method",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP Method",
              "sensitive" : false
            },
            "Request Username" : {
              "displayName" : "Request Username",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Username",
              "sensitive" : false
            },
            "Request Content-Type" : {
              "displayName" : "Request Content-Type",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Content-Type",
              "sensitive" : false
            },
            "Response Body Attribute Name" : {
              "displayName" : "Response Body Attribute Name",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Attribute Name",
              "sensitive" : false
            },
            "Request Digest Authentication Enabled" : {
              "displayName" : "Request Digest Authentication Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Digest Authentication Enabled",
              "sensitive" : false
            },
            "Request Multipart Form-Data Name" : {
              "displayName" : "Request Multipart Form-Data Name",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Multipart Form-Data Name",
              "sensitive" : false
            },
            "Response Cache Size" : {
              "displayName" : "Response Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cache Size",
              "sensitive" : false
            },
            "Response Body Ignored" : {
              "displayName" : "Response Body Ignored",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Ignored",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "success" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "23a0e79e-595a-38c6-9d60-b86862757d29",
          "identifier" : "bfda05f7-7549-35ed-8a54-d0c8cffbc582",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LogMessage",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 224.0,
            "y" : 32.0
          },
          "properties" : {
            "log-level" : "info"
          },
          "propertyDescriptors" : {
            "log-message" : {
              "displayName" : "Log message",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-message",
              "sensitive" : false
            },
            "log-level" : {
              "displayName" : "Log Level",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-level",
              "sensitive" : false
            },
            "log-prefix" : {
              "displayName" : "Log prefix",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-prefix",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.LogMessage",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "23a0e79e-595a-38c6-9d60-b86862757d29",
          "identifier" : "bdb6659b-490f-318b-91e7-2fcbed1d68f9",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ReplaceText",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 200.0,
            "y" : -288.0
          },
          "properties" : {
            "Regular Expression" : "(?s)^(.*)$",
            "Replacement Value" : "{\"chat_id\":\"#{ChatId}\",\"text\":\"${telegram.text}\"}",
            "Evaluation Mode" : "Entire text",
            "Line-by-Line Evaluation Mode" : "All",
            "Character Set" : "UTF-8",
            "Maximum Buffer Size" : "1 MB",
            "Replacement Strategy" : "Regex Replace"
          },
          "propertyDescriptors" : {
            "Regular Expression" : {
              "displayName" : "Search Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Regular Expression",
              "sensitive" : false
            },
            "Replacement Value" : {
              "displayName" : "Replacement Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Value",
              "sensitive" : false
            },
            "Evaluation Mode" : {
              "displayName" : "Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Evaluation Mode",
              "sensitive" : false
            },
            "Text to Prepend" : {
              "displayName" : "Text to Prepend",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Prepend",
              "sensitive" : false
            },
            "Line-by-Line Evaluation Mode" : {
              "displayName" : "Line-by-Line Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Line-by-Line Evaluation Mode",
              "sensitive" : false
            },
            "Character Set" : {
              "displayName" : "Character Set",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Character Set",
              "sensitive" : false
            },
            "Maximum Buffer Size" : {
              "displayName" : "Maximum Buffer Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum Buffer Size",
              "sensitive" : false
            },
            "Replacement Strategy" : {
              "displayName" : "Replacement Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Strategy",
              "sensitive" : false
            },
            "Text to Append" : {
              "displayName" : "Text to Append",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Append",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ReplaceText",
          "yieldDuration" : "1 sec"
        } ],
        "remoteProcessGroups" : [ ],
        "scheduledState" : "ENABLED",
        "statelessFlowTimeout" : "1 min"
      } ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
        "identifier" : "5bb8aea2-9ab0-3f00-b891-0a0cb6b03f4c",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${state.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
        "identifier" : "72e616ad-50f9-35a1-8843-7b15eeeffd61",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "state.message" : "Li khi ly danh sch BC",
          "filename" : "${state.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.status" : "3",
          "state.isActive" : "false",
          "state.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "state.message" : {
            "displayName" : "state.message",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.message",
            "sensitive" : false
          },
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.status" : {
            "displayName" : "state.status",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.status",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.isActive" : {
            "displayName" : "state.isActive",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.isActive",
            "sensitive" : false
          },
          "state.lastExecutionTime" : {
            "displayName" : "state.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.lastExecutionTime",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
        "identifier" : "877a3bae-6dcb-3e9a-9ede-a5ced2ab63fa",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${state.name}\",\n  \"isActive\": ${state.isActive},\n  \"lastExecutionTime\": \"${state.lastExecutionTime}\",\n  \"startTime\": \"${state.startTime}\",\n  \"endTime\": \"${state.endTime}\",\n  \"status\": \"${state.status}\",\n  \"sequenceNumber\": \"${state.sequenceNumber}\",\n  \"message\": \"${state.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "7b353d4e-0ba0-3ed1-954c-6ecd893165ea",
        "identifier" : "9fbfd258-e70d-35b8-a097-80de1d96cec0",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
          "id" : "5d41d1da-b786-3534-963e-4d3f331500b1",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
        "identifier" : "d1da8c95-f2b2-326c-a041-b055aca66e53",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
          "id" : "c4676ca1-d093-3222-8b11-a00f83908b0f",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
          "id" : "c094dd00-7b6b-362a-b9a6-9cc20c64b3fb",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
        "identifier" : "6177bea9-a0a0-388b-857e-1562b32e4035",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
          "id" : "7aec53ac-ec32-3f7a-832a-580a90b0470d",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
          "id" : "c4676ca1-d093-3222-8b11-a00f83908b0f",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
        "identifier" : "317f544e-b93a-389e-a8a4-0175f2c8734e",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
          "id" : "c094dd00-7b6b-362a-b9a6-9cc20c64b3fb",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
          "id" : "80f8866a-d24a-3627-9a93-514eadbdf8e1",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
        "identifier" : "dec2daf0-cb60-342c-9108-e398bc17a07c",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
          "id" : "c4676ca1-d093-3222-8b11-a00f83908b0f",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
          "id" : "5d41d1da-b786-3534-963e-4d3f331500b1",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
        "identifier" : "957aaf91-22c6-3f10-b698-5432ac6a82f3",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
          "id" : "80f8866a-d24a-3627-9a93-514eadbdf8e1",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
        "identifier" : "7aec53ac-ec32-3f7a-832a-580a90b0470d",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LuuTrangThaiETL",
      "outputPorts" : [ ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : 272.0,
        "y" : 1784.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
        "identifier" : "c4676ca1-d093-3222-8b11-a00f83908b0f",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${state.name}\",\n  \"isActive\": ${state.isActive},\n  \"lastExecutionTime\": \"${state.lastExecutionTime}\",\n  \"startTime\": \"${state.startTime}\",\n  \"endTime\": \"${state.endTime}\",\n  \"status\": \"${state.status}\",\n  \"sequenceNumber\": \"${state.sequenceNumber}\",\n  \"message\": \"${state.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
        "identifier" : "c094dd00-7b6b-362a-b9a6-9cc20c64b3fb",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "filename" : "${state.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.lastExecutionTime" : {
            "displayName" : "state.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.lastExecutionTime",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
        "identifier" : "80f8866a-d24a-3627-9a93-514eadbdf8e1",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${state.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "02c61280-00c0-3861-899f-b0bcb3eb5217",
        "identifier" : "5d41d1da-b786-3534-963e-4d3f331500b1",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
          "id" : "f4fb461a-090b-34a7-85ce-92bee35bd23a",
          "name" : "ouput",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
        "identifier" : "b6e1befd-789d-3d96-a25e-f416a8a2f7cc",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
          "id" : "016d66a6-34b5-3bb7-b8bc-ed37ab9e301b",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
          "id" : "b6792ef3-0a29-38e8-9ca4-48b112825e38",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
        "identifier" : "2fb73bc0-90e9-312f-841e-24fbfa63a206",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
          "id" : "016d66a6-34b5-3bb7-b8bc-ed37ab9e301b",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "zIndex" : 36
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
          "id" : "016d66a6-34b5-3bb7-b8bc-ed37ab9e301b",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
        "identifier" : "5cec4bfd-b500-3323-aad9-1858733496ef",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
          "id" : "82a9f268-d470-3bc8-9f4d-18483911d508",
          "name" : "KhoiTao",
          "type" : "PROCESSOR"
        },
        "zIndex" : 34
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
          "id" : "82a9f268-d470-3bc8-9f4d-18483911d508",
          "name" : "KhoiTao",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
        "identifier" : "400a7e3a-0345-334d-896a-30018c4db672",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
          "id" : "52916cf9-e808-3dcb-9e23-5f044ec26231",
          "name" : "input",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
        "identifier" : "52916cf9-e808-3dcb-9e23-5f044ec26231",
        "name" : "input",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 160.0,
          "y" : -704.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LayTrangThaiETL",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
        "identifier" : "f4fb461a-090b-34a7-85ce-92bee35bd23a",
        "name" : "ouput",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 160.0,
          "y" : 112.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -224.0,
        "y" : -16.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
        "identifier" : "b6792ef3-0a29-38e8-9ca4-48b112825e38",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : -528.0,
          "y" : -192.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-scripting-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
        "identifier" : "016d66a6-34b5-3bb7-b8bc-ed37ab9e301b",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LayTrangThai",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 104.0,
          "y" : -192.0
        },
        "properties" : {
          "Script Engine" : "Groovy",
          "Script Body" : "import groovy.json.JsonSlurper\nimport groovy.json.JsonBuilder\nimport java.nio.file.*\nimport java.time.Instant\nimport java.time.ZoneOffset\nimport java.time.format.DateTimeFormatter\nimport java.time.LocalDateTime\nimport java.time.LocalDate\nimport org.apache.nifi.processor.io.OutputStreamCallback\n\ndef flowFile = session.get()\nif (!flowFile) return\n\n// Ly parameters t attributes\ndef etlName   = flowFile.getAttribute('state.name')\ndef statePath = flowFile.getAttribute('state.path')\ndef filename  = flowFile.getAttribute('state.filename')\n\nif (!etlName || !statePath || !filename) {\n    log.error(\"Missing required attributes: state.name, state.path, or state.filename\")\n    flowFile = session.putAttribute(flowFile, 'error.message', 'Missing state.name, state.path, or state.filename attributes')\n    session.transfer(flowFile, REL_FAILURE)\n    return\n}\n\n// To ng dn y \ndef stateFilePath = Paths.get(statePath, filename).toString()\n\ntry {\n    def stateContent = \"\"\n    def stateExists = false\n\n    // nh dng thi gian UTC\n    def formatter = DateTimeFormatter.ofPattern(\"yyyy/MM/dd HH:mm:ss\")\n    def currentTimeUTC = Instant.now().atZone(ZoneOffset.UTC).format(formatter)\n    def defaultStartTime = \"2025/01/01 00:00:00\"\n\n    // Gi tr mc nh cho state\n    def defaultState = [\n        name: etlName,\n        isActive: false,\n        lastExecutionTime: currentTimeUTC,\n        startTime: defaultStartTime,\n        endTime: currentTimeUTC,\n        sequenceNumber: 1, // ln chy u tin\n        status: 0,         // 0: khi to\n        message: \"\"        // trng\n    ]\n\n    // c file trng thi nu c\n    def path = Paths.get(stateFilePath)\n    if (Files.exists(path)) {\n        stateContent = new String(Files.readAllBytes(path), \"UTF-8\")\n        stateExists = true\n        log.info(\"State file found for ETL '${etlName}' at '${stateFilePath}': \" + stateContent)\n    } else {\n        stateContent = new JsonBuilder(defaultState).toString()\n        stateExists = false\n        log.info(\"State file not found for ETL '${etlName}' at '${stateFilePath}', creating default state\")\n    }\n\n    // Parse JSON, li th fallback default\n    def jsonSlurper = new JsonSlurper()\n    Map state\n    try {\n        state = (Map) jsonSlurper.parseText(stateContent)\n    } catch (Throwable ex) {\n        log.warn(\"Invalid state content, fallback to default. Error: ${ex.message}\")\n        state = new LinkedHashMap(defaultState)\n        stateExists = false\n    }\n\n    // Chun ho cc trng c bn\n    state.name = etlName\n    state.isActive = (state.containsKey('isActive') && state.isActive != null) ? state.isActive as Boolean : false\n    state.lastExecutionTime = (state.lastExecutionTime ?: currentTimeUTC)\n    state.startTime = (state.startTime ?: defaultStartTime)\n    state.endTime = (state.endTime ?: currentTimeUTC)\n\n    // Gi tr hin hu  dng cho logic ca s mi\n    def oldEndTime = (state.endTime && state.endTime.toString().trim()) ? state.endTime.toString() : defaultStartTime\n\n    // 3 trng b sung\n    Integer seq = 1\n    if (state.containsKey('sequenceNumber') && state.sequenceNumber != null && \"${state.sequenceNumber}\".isInteger()) {\n        seq = (state.sequenceNumber as Integer)\n        if (seq <= 0) seq = 1\n    }\n    Integer prevStatus = 0\n    if (state.containsKey('status') && state.status != null && \"${state.status}\".isInteger()) {\n        prevStatus = (state.status as Integer)\n    }\n    String msg = (state.containsKey('message') && state.message != null) ? (state.message as String) : \"\"\n\n    // --- LOGIC MI: to ca s ETL mi nu status = 0 hoc 2 ---\n    // Gii thch:\n    //  - 0 (khi to) hoc 2 (hon thnh) => ln ETL trc  kt thc bnh thng.\n    //  - startTime = endTime (c) vi gi pht giy 00:00:00 ; endTime = currentTimeUTC ; lastExecutionTime = endTime (c)\n    boolean shouldCreateNewWindow = stateExists && (prevStatus == 0 || prevStatus == 2)\n    if (shouldCreateNewWindow) {\n        // Parse oldEndTime v t li gi pht giy thnh 00:00:00\n        def newStartTime = oldEndTime\n        try {\n            def oldEndTimeParsed = LocalDateTime.parse(oldEndTime, formatter)\n            def dateOnly = oldEndTimeParsed.toLocalDate()\n            def startOfDay = dateOnly.atStartOfDay()\n            newStartTime = startOfDay.format(formatter)\n            log.info(\"Parsed oldEndTime '${oldEndTime}' to start of day: '${newStartTime}'\")\n        } catch (Exception ex) {\n            log.warn(\"Could not parse oldEndTime '${oldEndTime}', using as-is. Error: ${ex.message}\")\n            newStartTime = oldEndTime\n        }\n        \n        state.startTime = newStartTime\n        state.endTime = currentTimeUTC\n        log.info(\"Create new ETL window: startTime=${state.startTime} (reset to 00:00:00), endTime=${state.endTime}, lastExecutionTime=${state.lastExecutionTime}\")\n    }\n\n    // Nu file  tn ti:\n    //  - Nu prevStatus == 2 (hon thnh) -> tng sequenceNumber\n    //  - t status = 0 (khi to), message = \"\"\n    if (stateExists) {\n        if (prevStatus == 2) {\n            seq = seq + 1\n            log.info(\"Previous status=2 (completed). Increase sequenceNumber to ${seq}\")\n        }\n        prevStatus = 0\n        msg = \"\"\n    } else {\n        // state mi\n        prevStatus = 0\n        msg = \"\"\n        seq = 1\n    }\n\n    // Gn li vo state\n    state.sequenceNumber = seq\n    state.status = prevStatus\n    state.message = msg\n\n    // Ghi attributes ra flowfile\n    flowFile = session.putAttribute(flowFile, 'state.exists', stateExists.toString())\n    flowFile = session.putAttribute(flowFile, 'state.name', state.name.toString())\n    flowFile = session.putAttribute(flowFile, 'state.isActive', state.isActive.toString())\n    flowFile = session.putAttribute(flowFile, 'state.lastExecutionTime', state.lastExecutionTime.toString())\n    flowFile = session.putAttribute(flowFile, 'state.startTime', state.startTime.toString())\n    flowFile = session.putAttribute(flowFile, 'state.endTime', state.endTime.toString())\n    flowFile = session.putAttribute(flowFile, 'state.sequenceNumber', state.sequenceNumber.toString())\n    flowFile = session.putAttribute(flowFile, 'state.status', state.status.toString())\n    flowFile = session.putAttribute(flowFile, 'state.message', state.message.toString())\n    flowFile = session.putAttribute(flowFile, 'state.fullPath', stateFilePath)\n\n    // To JSON content chun ho\n    def stateContentForFlowFile = [\n        name: state.name,\n        isActive: state.isActive,\n        lastExecutionTime: state.lastExecutionTime,\n        startTime: state.startTime,\n        endTime: state.endTime,\n        sequenceNumber: state.sequenceNumber,\n        status: state.status,\n        message: state.message\n    ]\n\n    // Ghi JSON vo content\n    def contentJson = new JsonBuilder(stateContentForFlowFile).toString()\n    flowFile = session.write(flowFile, { outputStream ->\n        outputStream.write(contentJson.getBytes(\"UTF-8\"))\n    } as OutputStreamCallback)\n\n    // Lu ton b JSON sau chun ho vo attribute\n    flowFile = session.putAttribute(flowFile, 'state.content', contentJson)\n\n    session.transfer(flowFile, REL_SUCCESS)\n\n} catch (Exception e) {\n    log.error(\"Error reading state file for ETL '${etlName}' at '${stateFilePath}': \" + e.getMessage(), e)\n    flowFile = session.putAttribute(flowFile, 'error.message', e.getMessage())\n    session.transfer(flowFile, REL_FAILURE)\n}"
        },
        "propertyDescriptors" : {
          "Script File" : {
            "displayName" : "Script File",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script File",
            "resourceDefinition" : {
              "cardinality" : "SINGLE",
              "resourceTypes" : [ "FILE" ]
            },
            "sensitive" : false
          },
          "Script Engine" : {
            "displayName" : "Script Engine",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script Engine",
            "sensitive" : false
          },
          "Script Body" : {
            "displayName" : "Script Body",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script Body",
            "sensitive" : false
          },
          "Module Directory" : {
            "displayName" : "Module Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Module Directory",
            "resourceDefinition" : {
              "cardinality" : "MULTIPLE",
              "resourceTypes" : [ "FILE", "DIRECTORY" ]
            },
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.script.ExecuteScript",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9955c4ef-114c-36de-bd1a-5a525b6dfd28",
        "identifier" : "82a9f268-d470-3bc8-9f4d-18483911d508",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KhoiTao",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 104.0,
          "y" : -480.0
        },
        "properties" : {
          "filename" : "state.json",
          "state.startTime" : "${now():format(\"yyyy-MM-dd 00:00:00\", \"UTC\")}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.endTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}",
          "state.path" : "#{TempPath}#{Path.Separator}${state.name}",
          "state.isActive" : "false",
          "state.filename" : "state.json"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "state.startTime" : {
            "displayName" : "state.startTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.startTime",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.endTime" : {
            "displayName" : "state.endTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.endTime",
            "sensitive" : false
          },
          "state.path" : {
            "displayName" : "state.path",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.path",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.isActive" : {
            "displayName" : "state.isActive",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.isActive",
            "sensitive" : false
          },
          "state.filename" : {
            "displayName" : "state.filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.filename",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "id" : "70f159fd-f176-3301-8750-3b397544eff5",
          "name" : "Input",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8a531770-5fda-3562-936d-0ab30a500db6",
        "identifier" : "1b417275-06bd-3663-aaf1-9453ec1b5639",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "8a531770-5fda-3562-936d-0ab30a500db6",
          "id" : "966ba929-576a-3e7e-a51b-c538cd982701",
          "name" : "KhoiTao",
          "type" : "PROCESSOR"
        },
        "zIndex" : 2
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "id" : "70f159fd-f176-3301-8750-3b397544eff5",
          "name" : "Input",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8a531770-5fda-3562-936d-0ab30a500db6",
        "identifier" : "b5e753a5-9357-38d6-a4fd-16c6fda8a49d",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "8a531770-5fda-3562-936d-0ab30a500db6",
          "id" : "8ef11ecd-3057-3765-97c7-6c56e2067f03",
          "name" : "TrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "zIndex" : 7
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8a531770-5fda-3562-936d-0ab30a500db6",
          "id" : "966ba929-576a-3e7e-a51b-c538cd982701",
          "name" : "KhoiTao",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8a531770-5fda-3562-936d-0ab30a500db6",
        "identifier" : "1a672038-551b-3f9b-8426-6064200870b0",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "8a531770-5fda-3562-936d-0ab30a500db6",
          "id" : "4dcf6c54-a7ed-3a22-9392-acb68eb42f50",
          "name" : "Input",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 11
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8a531770-5fda-3562-936d-0ab30a500db6",
          "id" : "8d1a8f94-0064-3c8b-8108-d3f1ee42e9f7",
          "name" : "KiemTraCoTrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8a531770-5fda-3562-936d-0ab30a500db6",
        "identifier" : "e353f2ed-92f6-34c5-8ab3-d6b2352a9d96",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "id" : "cfd2447a-e85d-35d2-8cd9-77fbd44f0a39",
          "name" : "Ouput",
          "type" : "OUTPUT_PORT"
        },
        "zIndex" : 3
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8a531770-5fda-3562-936d-0ab30a500db6",
          "id" : "8ef11ecd-3057-3765-97c7-6c56e2067f03",
          "name" : "TrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8a531770-5fda-3562-936d-0ab30a500db6",
        "identifier" : "9cd2ed22-8971-3f61-9d5f-c3f9706b1a1c",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "TrangTiep",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "nextPage" ],
        "source" : {
          "comments" : "",
          "groupId" : "8a531770-5fda-3562-936d-0ab30a500db6",
          "id" : "8d1a8f94-0064-3c8b-8108-d3f1ee42e9f7",
          "name" : "KiemTraCoTrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "zIndex" : 6
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "8a531770-5fda-3562-936d-0ab30a500db6",
          "id" : "ee091853-e064-334a-a57f-86c4cda433cb",
          "name" : "Output",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8a531770-5fda-3562-936d-0ab30a500db6",
        "identifier" : "ca68697d-37db-3c37-a0ca-5f36c38b7588",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "unmatched" ],
        "source" : {
          "comments" : "",
          "groupId" : "8a531770-5fda-3562-936d-0ab30a500db6",
          "id" : "8d1a8f94-0064-3c8b-8108-d3f1ee42e9f7",
          "name" : "KiemTraCoTrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "zIndex" : 10
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "8a531770-5fda-3562-936d-0ab30a500db6",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "8a531770-5fda-3562-936d-0ab30a500db6",
        "identifier" : "4dcf6c54-a7ed-3a22-9392-acb68eb42f50",
        "name" : "Input",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -344.0,
          "y" : -256.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "ETLAdAccountTransactionBatch",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "8a531770-5fda-3562-936d-0ab30a500db6",
        "identifier" : "ee091853-e064-334a-a57f-86c4cda433cb",
        "name" : "Output",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 72.0,
          "y" : 856.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -224.0,
        "y" : 3304.0
      },
      "processGroups" : [ {
        "comments" : "",
        "componentType" : "PROCESS_GROUP",
        "connections" : [ {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "9bb15efb-b244-3a64-8775-42b855e8e922",
            "name" : "TransformData",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "d3d7f9ba-d29c-3b9b-a6be-300a93cfd862",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "d4361335-fac8-3466-bfcb-00e43aab33db",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "zIndex" : 20
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "88b377b2-20ba-3787-b77a-ee69ae677a82",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "402011df-d31f-3f05-a6a6-69a2a75de763",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "eb898e32-6c06-33af-b31e-9637c7f664cc",
            "name" : "InsertAndUpdateToDataBase",
            "type" : "PROCESSOR"
          },
          "zIndex" : 25
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "08ff6aa5-ccbb-3638-b7b9-c0e63989af19",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "24b7c523-47c3-350e-9282-7c5554d9d01f",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "NoNewData",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "unmatched" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "0a25552e-4ec6-3e8e-b561-d195e18c3f13",
            "name" : "CheckHasData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 10
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "88b377b2-20ba-3787-b77a-ee69ae677a82",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "c22600df-49f9-3e05-aa15-6576396e7507",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "isLastPage" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "f1881636-03cd-3a99-b56f-278d672f4acc",
            "name" : "RouteOnAttributeCheckLastPage",
            "type" : "PROCESSOR"
          },
          "zIndex" : 26
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "3b3004b8-c8b2-30e9-8782-cf798c7a631d",
            "name" : "CleanupTemp",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "8ee60a31-b45a-31d1-ad9d-689cefc51fb7",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "4157a3c8-f6d4-39b1-9511-3d38b3bb5a86",
            "name" : "UpdateAttributeContinueTrue",
            "type" : "PROCESSOR"
          },
          "zIndex" : 24
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "id" : "1e5e7a0c-2b40-3df0-9611-6f55e1e93725",
            "name" : "stateCamBatch",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "61caa658-bc75-3a4a-9948-e898524d426e",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "0419f1bd-6dcf-3feb-b55f-3031445b9a75",
            "name" : "SaveRawTemp",
            "type" : "PROCESSOR"
          },
          "zIndex" : 29
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "0419f1bd-6dcf-3feb-b55f-3031445b9a75",
            "name" : "SaveRawTemp",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "985e171b-f63c-34c2-8bdf-3cb96b898d64",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "hasData" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "0a25552e-4ec6-3e8e-b561-d195e18c3f13",
            "name" : "CheckHasData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 17
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "0d81a09c-36ef-3eeb-a7c4-06f1e89b3b07",
            "name" : "LayDanhSachDuLieuETLCu",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "7db21d76-1494-3b96-afec-e166a2823dc5",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "id" : "ff7e7f85-ecc9-370d-8a8f-2c94bb2ba666",
            "name" : "stateProduct",
            "type" : "OUTPUT_PORT"
          },
          "zIndex" : 34
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "eb898e32-6c06-33af-b31e-9637c7f664cc",
            "name" : "InsertAndUpdateToDataBase",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "c3c3125e-e13d-3e27-8d6f-2c70222dd2fb",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "9bb15efb-b244-3a64-8775-42b855e8e922",
            "name" : "TransformData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 21
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "08ff6aa5-ccbb-3638-b7b9-c0e63989af19",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "e185c1fd-4162-3315-9e36-25e208902b6d",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "0419f1bd-6dcf-3feb-b55f-3031445b9a75",
            "name" : "SaveRawTemp",
            "type" : "PROCESSOR"
          },
          "zIndex" : 14
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "08ff6aa5-ccbb-3638-b7b9-c0e63989af19",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "9f4a31f4-5b6b-35ed-a94e-56c9fbd18f37",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "ab83dc7b-df94-3f6a-8628-ec00a3129c51",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "zIndex" : 6
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "08ff6aa5-ccbb-3638-b7b9-c0e63989af19",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "ec87f65d-df78-30f9-bc9f-e3ac975504df",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "3b0efc67-0701-3878-b5fb-f1b732e17f53",
            "name" : "ChuanHoaDuLieuRaw",
            "type" : "PROCESSOR"
          },
          "zIndex" : 9
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "2334c7e4-522b-35f7-8f99-8d45a99c4aaa",
            "name" : "KhoiTao",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "6bab1555-1c16-3909-8ca2-515ae4d1d505",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "70f159fd-f176-3301-8750-3b397544eff5",
            "name" : "Input",
            "type" : "INPUT_PORT"
          },
          "zIndex" : 1
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "cfd2447a-e85d-35d2-8cd9-77fbd44f0a39",
            "name" : "Ouput",
            "type" : "OUTPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "46dc830b-4d4f-3d92-a4fa-9e42dfdec82a",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success", "failure", "not found" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "3b3004b8-c8b2-30e9-8782-cf798c7a631d",
            "name" : "CleanupTemp",
            "type" : "PROCESSOR"
          },
          "zIndex" : 15
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "d4361335-fac8-3466-bfcb-00e43aab33db",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "8ec225c5-2caf-30af-af3f-c775d806f770",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "0d81a09c-36ef-3eeb-a7c4-06f1e89b3b07",
            "name" : "LayDanhSachDuLieuETLCu",
            "type" : "PROCESSOR"
          },
          "zIndex" : 31
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "3b0efc67-0701-3878-b5fb-f1b732e17f53",
            "name" : "ChuanHoaDuLieuRaw",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "c75f9b20-0e3e-35f5-b578-4c452b0409cf",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "ab83dc7b-df94-3f6a-8628-ec00a3129c51",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "zIndex" : 5
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "88b377b2-20ba-3787-b77a-ee69ae677a82",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "b663f62e-20d8-33df-b94d-4264a77a27fa",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "9bb15efb-b244-3a64-8775-42b855e8e922",
            "name" : "TransformData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 22
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "cfd2447a-e85d-35d2-8cd9-77fbd44f0a39",
            "name" : "Ouput",
            "type" : "OUTPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "09717cfe-df0e-3d1c-99fc-6a0641bf1a50",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "08ff6aa5-ccbb-3638-b7b9-c0e63989af19",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "zIndex" : 7
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "88b377b2-20ba-3787-b77a-ee69ae677a82",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "c3ff8f34-3a65-3272-a8c3-feced39ea2f3",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "0d81a09c-36ef-3eeb-a7c4-06f1e89b3b07",
            "name" : "LayDanhSachDuLieuETLCu",
            "type" : "PROCESSOR"
          },
          "zIndex" : 19
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "id" : "bb823dc8-9382-3bfe-b0e3-7cf90229f763",
            "name" : "stateCamBatch",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "24e25145-1eb8-33ff-bbfc-5e2fcfc58bef",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "id" : "3adc15e6-15e5-30ff-8b91-b73d9faf6741",
            "name" : "stateProduct",
            "type" : "OUTPUT_PORT"
          },
          "zIndex" : 33
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "4157a3c8-f6d4-39b1-9511-3d38b3bb5a86",
            "name" : "UpdateAttributeContinueTrue",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "37fbb1b9-3908-3d81-955b-55fe22e5df1c",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "unmatched" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "f1881636-03cd-3a99-b56f-278d672f4acc",
            "name" : "RouteOnAttributeCheckLastPage",
            "type" : "PROCESSOR"
          },
          "zIndex" : 27
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "f1881636-03cd-3a99-b56f-278d672f4acc",
            "name" : "RouteOnAttributeCheckLastPage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "2b74bcda-e017-3ea6-89a0-e1ddccd8c1aa",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "eb898e32-6c06-33af-b31e-9637c7f664cc",
            "name" : "InsertAndUpdateToDataBase",
            "type" : "PROCESSOR"
          },
          "zIndex" : 23
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "ab83dc7b-df94-3f6a-8628-ec00a3129c51",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "801b9e43-0999-3f16-8e5a-313ef668be84",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "17a4155a-da01-31cd-a711-923147b8e536",
            "name" : "LayDanhSachAdAccountTransactionChuaETL",
            "type" : "PROCESSOR"
          },
          "zIndex" : 3
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "17a4155a-da01-31cd-a711-923147b8e536",
            "name" : "LayDanhSachAdAccountTransactionChuaETL",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "20132841-36dd-3196-82e9-7f83e5553dfb",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "2334c7e4-522b-35f7-8f99-8d45a99c4aaa",
            "name" : "KhoiTao",
            "type" : "PROCESSOR"
          },
          "zIndex" : 2
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "08ff6aa5-ccbb-3638-b7b9-c0e63989af19",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "2e5d4719-6f79-3dd8-96ce-66ac3103e3a8",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success", "failure", "not found" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "88b377b2-20ba-3787-b77a-ee69ae677a82",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "zIndex" : 28
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "08ff6aa5-ccbb-3638-b7b9-c0e63989af19",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "02079f26-c5b4-375a-8f45-490b9e2b69dc",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "17a4155a-da01-31cd-a711-923147b8e536",
            "name" : "LayDanhSachAdAccountTransactionChuaETL",
            "type" : "PROCESSOR"
          },
          "zIndex" : 4
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "0a25552e-4ec6-3e8e-b561-d195e18c3f13",
            "name" : "CheckHasData",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "4cb949a8-c23c-37e5-8a20-67ae0a836a5f",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
            "id" : "3b0efc67-0701-3878-b5fb-f1b732e17f53",
            "name" : "ChuanHoaDuLieuRaw",
            "type" : "PROCESSOR"
          },
          "zIndex" : 8
        } ],
        "controllerServices" : [ ],
        "defaultBackPressureDataSizeThreshold" : "1 GB",
        "defaultBackPressureObjectThreshold" : 10000,
        "defaultFlowFileExpiration" : "0 sec",
        "executionEngine" : "INHERITED",
        "flowFileConcurrency" : "UNBOUNDED",
        "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
        "funnels" : [ ],
        "groupIdentifier" : "8a531770-5fda-3562-936d-0ab30a500db6",
        "identifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
        "inputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "INPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "70f159fd-f176-3301-8750-3b397544eff5",
          "name" : "Input",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : -134.344482421875,
            "y" : -193.37796020507812
          },
          "scheduledState" : "ENABLED",
          "type" : "INPUT_PORT"
        } ],
        "labels" : [ ],
        "maxConcurrentTasks" : 1,
        "name" : "ETLAdAccountTransactionBatch",
        "outputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "OUTPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "cfd2447a-e85d-35d2-8cd9-77fbd44f0a39",
          "name" : "Ouput",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : 472.0,
            "y" : 1008.0
          },
          "scheduledState" : "ENABLED",
          "type" : "OUTPUT_PORT"
        } ],
        "parameterContextName" : "ETL",
        "position" : {
          "x" : 0.0,
          "y" : 184.0
        },
        "processGroups" : [ {
          "comments" : "",
          "componentType" : "PROCESS_GROUP",
          "connections" : [ {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "57040e55-cdf3-3ed0-a325-4a26fd1dff01",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "3d8a3ac5-efec-3532-82a9-8f14974e756a",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "77c1fba2-1e24-3a2a-951c-b1e4e33bf3bc",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "zIndex" : 4
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "57040e55-cdf3-3ed0-a325-4a26fd1dff01",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "12207964-3138-3ae5-9a2e-d4f7647fb972",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "c6a84c7f-7270-37d5-8e4f-c767820d8587",
              "name" : "ThucThiThemMoiProduct",
              "type" : "PROCESSOR"
            },
            "zIndex" : 10
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "fb0bf154-6624-322e-b164-f546d9878545",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "ff67de17-7969-359f-9d91-d3f8819f04cf",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "77c1fba2-1e24-3a2a-951c-b1e4e33bf3bc",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "zIndex" : 3
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "57040e55-cdf3-3ed0-a325-4a26fd1dff01",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "e0e60e99-e752-3e45-b628-ef38431cf9cc",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "52b80243-c792-3cb8-952f-a00565e8b2ec",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "zIndex" : 13
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "3adc15e6-15e5-30ff-8b91-b73d9faf6741",
              "name" : "stateProduct",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "4dcdcae5-dc34-3a37-a3d2-d32d843a1843",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "c6a84c7f-7270-37d5-8e4f-c767820d8587",
              "name" : "ThucThiThemMoiProduct",
              "type" : "PROCESSOR"
            },
            "zIndex" : 9
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "52b80243-c792-3cb8-952f-a00565e8b2ec",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "cfa34ec6-df1e-3e1d-9984-f15b712ce1b3",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "has_new_product", "unmatched" ],
            "source" : {
              "comments" : "",
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "fb0bf154-6624-322e-b164-f546d9878545",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "zIndex" : 14
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "77c1fba2-1e24-3a2a-951c-b1e4e33bf3bc",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "dcb60531-5ab1-3d1a-958c-d96ab5692351",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "b88b20b8-9fb2-3bbb-a430-f33d4c15fbc0",
              "name" : "KhoiTao",
              "type" : "PROCESSOR"
            },
            "zIndex" : 2
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "b88b20b8-9fb2-3bbb-a430-f33d4c15fbc0",
              "name" : "KhoiTao",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "0fd7f78b-67fb-3807-9435-46d733eae91c",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "1e5e7a0c-2b40-3df0-9611-6f55e1e93725",
              "name" : "stateCamBatch",
              "type" : "INPUT_PORT"
            },
            "zIndex" : 1
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "c6a84c7f-7270-37d5-8e4f-c767820d8587",
              "name" : "ThucThiThemMoiProduct",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "4ab3076e-745a-3e1f-b5f8-4348683b32a0",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "b88d63f6-880e-372a-8517-faf2000724f0",
              "id" : "52b80243-c792-3cb8-952f-a00565e8b2ec",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "zIndex" : 12
          } ],
          "controllerServices" : [ ],
          "defaultBackPressureDataSizeThreshold" : "1 GB",
          "defaultBackPressureObjectThreshold" : 10000,
          "defaultFlowFileExpiration" : "0 sec",
          "executionEngine" : "INHERITED",
          "flowFileConcurrency" : "UNBOUNDED",
          "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
          "funnels" : [ ],
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
          "inputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "INPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "1e5e7a0c-2b40-3df0-9611-6f55e1e93725",
            "name" : "stateCamBatch",
            "portFunction" : "STANDARD",
            "position" : {
              "x" : -560.0,
              "y" : -192.0
            },
            "scheduledState" : "ENABLED",
            "type" : "INPUT_PORT"
          } ],
          "labels" : [ ],
          "maxConcurrentTasks" : 1,
          "name" : "LayHoacThemMoiTransactionPaymentPort",
          "outputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "OUTPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "3adc15e6-15e5-30ff-8b91-b73d9faf6741",
            "name" : "stateProduct",
            "portFunction" : "STANDARD",
            "position" : {
              "x" : 2032.0,
              "y" : -176.0
            },
            "scheduledState" : "ENABLED",
            "type" : "OUTPUT_PORT"
          } ],
          "parameterContextName" : "ETL",
          "position" : {
            "x" : 2912.0,
            "y" : -232.0
          },
          "processGroups" : [ ],
          "processors" : [ {
            "autoTerminatedRelationships" : [ "retry" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "c6a84c7f-7270-37d5-8e4f-c767820d8587",
            "maxBackoffPeriod" : "10 mins",
            "name" : "ThucThiThemMoiProduct",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 1600.0,
              "y" : 72.0
            },
            "properties" : {
              "Support Fragmented Transactions" : "false",
              "Batch Size" : "#{PageSizeMax}",
              "Obtain Generated Keys" : "false",
              "JDBC Connection Pool" : "7d601288-eb00-3fcc-934d-d5e3c37f2cfc",
              "database-session-autocommit" : "true",
              "rollback-on-failure" : "false"
            },
            "propertyDescriptors" : {
              "Support Fragmented Transactions" : {
                "displayName" : "Support Fragmented Transactions",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Support Fragmented Transactions",
                "sensitive" : false
              },
              "putsql-sql-statement" : {
                "displayName" : "SQL Statement",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "putsql-sql-statement",
                "sensitive" : false
              },
              "Transaction Timeout" : {
                "displayName" : "Transaction Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Transaction Timeout",
                "sensitive" : false
              },
              "Batch Size" : {
                "displayName" : "Batch Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Batch Size",
                "sensitive" : false
              },
              "Obtain Generated Keys" : {
                "displayName" : "Obtain Generated Keys",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Obtain Generated Keys",
                "sensitive" : false
              },
              "JDBC Connection Pool" : {
                "displayName" : "JDBC Connection Pool",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "JDBC Connection Pool",
                "sensitive" : false
              },
              "database-session-autocommit" : {
                "displayName" : "Database Session AutoCommit",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "database-session-autocommit",
                "sensitive" : false
              },
              "rollback-on-failure" : {
                "displayName" : "Rollback On Failure",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "rollback-on-failure",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.PutSQL",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "fb0bf154-6624-322e-b164-f546d9878545",
            "maxBackoffPeriod" : "10 mins",
            "name" : "RouteOnAttribute",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 976.0,
              "y" : -248.0
            },
            "properties" : {
              "Routing Strategy" : "Route to Property name",
              "has_new_product" : "${product.new.count:gt(0)}"
            },
            "propertyDescriptors" : {
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              },
              "has_new_product" : {
                "displayName" : "has_new_product",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "has_new_product",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "b88b20b8-9fb2-3bbb-a430-f33d4c15fbc0",
            "maxBackoffPeriod" : "10 mins",
            "name" : "KhoiTao",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : -216.0,
              "y" : -232.0
            },
            "properties" : {
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100"
            },
            "propertyDescriptors" : {
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "success" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "57040e55-cdf3-3ed0-a325-4a26fd1dff01",
            "maxBackoffPeriod" : "10 mins",
            "name" : "LogMessage",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 968.0,
              "y" : 456.0
            },
            "properties" : {
              "log-level" : "info"
            },
            "propertyDescriptors" : {
              "log-message" : {
                "displayName" : "Log message",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-message",
                "sensitive" : false
              },
              "log-level" : {
                "displayName" : "Log Level",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-level",
                "sensitive" : false
              },
              "log-prefix" : {
                "displayName" : "Log prefix",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-prefix",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.LogMessage",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-scripting-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "52b80243-c792-3cb8-952f-a00565e8b2ec",
            "maxBackoffPeriod" : "10 mins",
            "name" : "GhiDeCauLenhSqlVaoContentFlow",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 968.0,
              "y" : 56.0
            },
            "properties" : {
              "Script Engine" : "Groovy",
              "Script Body" : "import groovy.json.JsonSlurper\nimport org.apache.commons.io.IOUtils\nimport java.nio.charset.StandardCharsets\nimport org.apache.nifi.processor.io.StreamCallback\n\ndef flowFile = session.get()\nif (!flowFile) return\n\nflowFile = session.write(flowFile, { inputStream, outputStream ->\n    def jsonText = IOUtils.toString(inputStream, StandardCharsets.UTF_8)\n    def obj = new JsonSlurper().parseText(jsonText)\n\n    def parts = []\n    if (obj.sqlUpdate && obj.sqlUpdate.toString().trim()) parts << obj.sqlUpdate.toString().trim()\n    if (obj.sqlInsert && obj.sqlInsert.toString().trim()) parts << obj.sqlInsert.toString().trim()\n\n    def sql = parts.join(\"\\n\")\n    outputStream.write(sql.getBytes(StandardCharsets.UTF_8))\n} as StreamCallback)\n\nsession.transfer(flowFile, REL_SUCCESS)"
            },
            "propertyDescriptors" : {
              "Script File" : {
                "displayName" : "Script File",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script File",
                "resourceDefinition" : {
                  "cardinality" : "SINGLE",
                  "resourceTypes" : [ "FILE" ]
                },
                "sensitive" : false
              },
              "Script Engine" : {
                "displayName" : "Script Engine",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Engine",
                "sensitive" : false
              },
              "Script Body" : {
                "displayName" : "Script Body",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Body",
                "sensitive" : false
              },
              "Module Directory" : {
                "displayName" : "Module Directory",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Module Directory",
                "resourceDefinition" : {
                  "cardinality" : "MULTIPLE",
                  "resourceTypes" : [ "FILE", "DIRECTORY" ]
                },
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.script.ExecuteScript",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-scripting-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b88d63f6-880e-372a-8517-faf2000724f0",
            "identifier" : "77c1fba2-1e24-3a2a-951c-b1e4e33bf3bc",
            "maxBackoffPeriod" : "10 mins",
            "name" : "XuLyDuLieuThemMoi",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 232.0,
              "y" : -232.0
            },
            "properties" : {
              "Script Engine" : "Groovy",
              "Script Body" : "import org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport groovy.json.JsonOutput\nimport java.io.File\n\ndef flowFile = session.get()\nif (!flowFile) return\n\ndef sqlQuoteN = { String s ->\n    def t = (s == null) ? \"\" : s.replace(\"'\", \"''\")\n    return \"N'${t}'\"\n}\ndef strOrEmpty = { Object v -> v == null ? \"\" : v.toString().trim() }\n\ntry {\n    def rawPath = flowFile.getAttribute(\"stateCurrent.fullPath\")\n    if (!rawPath) {\n        def msg = \"Missing attribute: stateCurrent.fullPath\"\n        log.error(msg)\n        flowFile = session.putAttribute(flowFile, \"error.message\", msg)\n        session.transfer(flowFile, REL_FAILURE)\n        return\n    }\n\n    // ----- Load RAW -----\n    def rawList = []\n    def f = new File(rawPath)\n    if (f.exists()) {\n        def txt = f.getText(StandardCharsets.UTF_8.name())\n        def parsed = new JsonSlurper().parseText(txt)\n        rawList = (parsed instanceof List) ? parsed : [parsed]\n    } else {\n        log.warn(\"RAW file not found: ${rawPath}\")\n    }\n\n    // Unique PID + Name\n    def pids = new LinkedHashSet<String>()\n    def pidNameMap = [:] as Map<String,String>\n    rawList.each { rObj ->\n        def r = rObj as Map\n        def pid  = strOrEmpty(r.get(\"PaymentPortfolioId\"))\n        def name = strOrEmpty(r.get(\"PaymentPortfolioName\"))\n        if (pid) {\n            pids.add(pid)\n            if (name) pidNameMap[pid] = name\n        }\n    }\n\n    // ----- CTE VALUES -----\n    String cteValues\n    if (pids.isEmpty()) {\n        cteValues = \"SELECT CAST(NULL AS NVARCHAR(200)) AS [PaymentPortfolioId], CAST(NULL AS NVARCHAR(500)) AS [PaymentPortfolioName] WHERE 1=0\"\n    } else {\n        def valuesRows = pids.collect { pid ->\n            def name = pidNameMap.containsKey(pid) ? pidNameMap[pid] : null\n            \"(\" + sqlQuoteN(pid) + \", \" + (name == null ? \"NULL\" : sqlQuoteN(name)) + \")\"\n        }.join(\",\\n        \")\n        cteValues = \"SELECT v.[PaymentPortfolioId], v.[PaymentPortfolioName]\\nFROM (VALUES\\n        ${valuesRows}\\n) AS v([PaymentPortfolioId],[PaymentPortfolioName])\"\n    }\n\n    def DEFAULT_GUID = '00000000-0000-0000-0000-000000000000'\n\n    // ----- INSERT  -----\n    def sbInsert = new StringBuilder()\n    sbInsert.append(\"\"\"\nIF NOT EXISTS (SELECT 1 FROM dbo.Dim_DimTransactionPaymentPort WHERE Id='${DEFAULT_GUID}')\nBEGIN\n    INSERT INTO dbo.Dim_DimTransactionPaymentPort\n        (Id, PaymentPortfolioId, PaymentPortfolioName, IsActive, RowVersion, CreationTime, CreatorId)\n    VALUES ('${DEFAULT_GUID}', N'', NULL, 1, 0, SYSUTCDATETIME(), NULL);\nEND;\n\n-- Xc nh CreatorId nullable  chn gi tr ph hp\nDECLARE @CreatorIdIsNullable bit =\n(SELECT c.is_nullable\n   FROM sys.columns c\n  WHERE c.object_id = OBJECT_ID(N'dbo.Dim_DimTransactionPaymentPort')\n    AND c.name = N'CreatorId');\n\nDECLARE @CreatorIdValue uniqueidentifier =\n    CASE WHEN @CreatorIdIsNullable = 1 THEN NULL ELSE '${DEFAULT_GUID}' END;\n\n;WITH rawp AS (\n    ${cteValues}\n),\nsrc AS (\n    SELECT DISTINCT\n           LTRIM(RTRIM([PaymentPortfolioId])) AS [PaymentPortfolioId],\n           NULLIF(LTRIM(RTRIM([PaymentPortfolioName])), N'') AS [PaymentPortfolioName]\n    FROM rawp\n    WHERE [PaymentPortfolioId] IS NOT NULL AND LTRIM(RTRIM([PaymentPortfolioId])) <> N''\n)\nINSERT INTO dbo.Dim_DimTransactionPaymentPort\n    (Id, PaymentPortfolioId, PaymentPortfolioName, IsActive, EffectiveDate, ExpirationDate, RowVersion, CreationTime, CreatorId)\nSELECT NEWID(),\n       s.PaymentPortfolioId,\n       s.PaymentPortfolioName,        -- nu khng c tn -> NULL\n       1,\n       NULL,                          -- EffectiveDate\n       NULL,                          -- ExpirationDate\n       0,                             -- RowVersion\n       SYSUTCDATETIME(),\n       @CreatorIdValue\nFROM src s\nLEFT JOIN dbo.Dim_DimTransactionPaymentPort d\n  ON d.PaymentPortfolioId = s.PaymentPortfolioId\nWHERE d.Id IS NULL;\n\"\"\".trim())\n\n    String sqlInsert = sbInsert.toString()\n\n    // ----- UPDATE (ch cp nht khi c tn mi; khng p Unknown) -----\n    def sbUpdate = new StringBuilder()\n    sbUpdate.append(\"\"\"\n;WITH src AS (\n    ${cteValues}\n),\nagg AS (\n    SELECT\n        LTRIM(RTRIM([PaymentPortfolioId])) AS [PaymentPortfolioId],\n        NULLIF(MAX(NULLIF(LTRIM(RTRIM([PaymentPortfolioName])), N'')), NULL) AS [PaymentPortfolioName]\n    FROM src\n    WHERE [PaymentPortfolioId] IS NOT NULL AND LTRIM(RTRIM([PaymentPortfolioId])) <> N''\n    GROUP BY LTRIM(RTRIM([PaymentPortfolioId]))\n)\nUPDATE d\n   SET d.PaymentPortfolioName = a.PaymentPortfolioName,\n       d.RowVersion           = d.RowVersion + 1\nFROM dbo.Dim_DimTransactionPaymentPort d\nJOIN agg a\n  ON a.PaymentPortfolioId = d.PaymentPortfolioId\nWHERE a.PaymentPortfolioName IS NOT NULL\n  AND (d.PaymentPortfolioName IS NULL OR d.PaymentPortfolioName <> a.PaymentPortfolioName);\n\"\"\".trim())\n\n    String sqlUpdate = sbUpdate.toString()\n\n    // ----- Output -----\n    def result = [\n        rawCount   : rawList.size(),\n        uniquePids : pids.size(),\n        sqlInsert  : sqlInsert,\n        sqlUpdate  : sqlUpdate\n    ]\n    def outJson = JsonOutput.prettyPrint(JsonOutput.toJson(result))\n\n    flowFile = session.write(flowFile, { _, os ->\n        os.write(outJson.getBytes(StandardCharsets.UTF_8))\n    } as StreamCallback)\n\n    flowFile = session.putAttribute(flowFile, \"dim.portfolio.unique.count\", String.valueOf(pids.size()))\n    flowFile = session.putAttribute(flowFile, \"sql.update.included\", \"1\")\n    log.info(\"Backfill Dim_DimTransactionPaymentPort SQL generated (NULL when name missing). uniquePids=${pids.size()}\")\n    session.transfer(flowFile, REL_SUCCESS)\n\n} catch (Throwable t) {\n    log.error(\"Generate Dim_DimTransactionPaymentPort SQL failed\", t)\n    flowFile = session.putAttribute(flowFile, \"error.message\", t.getMessage())\n    session.transfer(flowFile, REL_FAILURE)\n}"
            },
            "propertyDescriptors" : {
              "Script File" : {
                "displayName" : "Script File",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script File",
                "resourceDefinition" : {
                  "cardinality" : "SINGLE",
                  "resourceTypes" : [ "FILE" ]
                },
                "sensitive" : false
              },
              "Script Engine" : {
                "displayName" : "Script Engine",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Engine",
                "sensitive" : false
              },
              "Script Body" : {
                "displayName" : "Script Body",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Body",
                "sensitive" : false
              },
              "Module Directory" : {
                "displayName" : "Module Directory",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Module Directory",
                "resourceDefinition" : {
                  "cardinality" : "MULTIPLE",
                  "resourceTypes" : [ "FILE", "DIRECTORY" ]
                },
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.script.ExecuteScript",
            "yieldDuration" : "1 sec"
          } ],
          "remoteProcessGroups" : [ ],
          "scheduledState" : "ENABLED",
          "statelessFlowTimeout" : "1 min"
        }, {
          "comments" : "",
          "componentType" : "PROCESS_GROUP",
          "connections" : [ {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "d163554e-a6b5-387e-8169-7823d369e0ab",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "e291454f-0ece-314c-b479-1865bdb9e034",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "920676f7-10e0-336c-959f-f47dcb078c20",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "zIndex" : 13
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "ca7ccda5-3622-382d-80db-a2f4577c751a",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "c7f81617-cfd8-3811-8938-5ebdc6c8fe39",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "53e11499-aa83-339f-9a1c-41ffbc853f15",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "zIndex" : 3
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "a4d373da-41c5-3aa8-a479-5a6aa09d8e5a",
              "name" : "KhoiTao",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "086af4d0-62eb-3674-8b80-6f479fba112f",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "bb823dc8-9382-3bfe-b0e3-7cf90229f763",
              "name" : "stateCamBatch",
              "type" : "INPUT_PORT"
            },
            "zIndex" : 1
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "920676f7-10e0-336c-959f-f47dcb078c20",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "d0497fba-0a94-3b9f-b9d9-52c50ca4edb6",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "hasNewAccounts" ],
            "source" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "ca7ccda5-3622-382d-80db-a2f4577c751a",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "zIndex" : 16
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "d163554e-a6b5-387e-8169-7823d369e0ab",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "3c6dba25-c89d-346a-9d06-9256f0701ddd",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "d6974dad-c9d4-3820-956c-8815ffa31bfb",
              "name" : "ThucThiThemMoiAdAccount",
              "type" : "PROCESSOR"
            },
            "zIndex" : 10
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "ff7e7f85-ecc9-370d-8a8f-2c94bb2ba666",
              "name" : "stateProduct",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "a12a6c09-4b61-3a09-b1ba-1f3e17c0a199",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "d6974dad-c9d4-3820-956c-8815ffa31bfb",
              "name" : "ThucThiThemMoiAdAccount",
              "type" : "PROCESSOR"
            },
            "zIndex" : 9
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "d6974dad-c9d4-3820-956c-8815ffa31bfb",
              "name" : "ThucThiThemMoiAdAccount",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "4a041ecb-8326-376a-b7c0-4376085ccc39",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "920676f7-10e0-336c-959f-f47dcb078c20",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "zIndex" : 12
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "d163554e-a6b5-387e-8169-7823d369e0ab",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "b47db52d-1b2c-3741-9bbc-c2fd09ca208a",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "53e11499-aa83-339f-9a1c-41ffbc853f15",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "zIndex" : 4
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "ff7e7f85-ecc9-370d-8a8f-2c94bb2ba666",
              "name" : "stateProduct",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "58923027-c090-35ff-b076-2665a7132c89",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "unmatched" ],
            "source" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "ca7ccda5-3622-382d-80db-a2f4577c751a",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "zIndex" : 15
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "53e11499-aa83-339f-9a1c-41ffbc853f15",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "7ec97906-bd33-3049-8278-ce5d74b9956d",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
              "id" : "a4d373da-41c5-3aa8-a479-5a6aa09d8e5a",
              "name" : "KhoiTao",
              "type" : "PROCESSOR"
            },
            "zIndex" : 2
          } ],
          "controllerServices" : [ ],
          "defaultBackPressureDataSizeThreshold" : "1 GB",
          "defaultBackPressureObjectThreshold" : 10000,
          "defaultFlowFileExpiration" : "0 sec",
          "executionEngine" : "INHERITED",
          "flowFileConcurrency" : "UNBOUNDED",
          "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
          "funnels" : [ ],
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
          "inputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "INPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "bb823dc8-9382-3bfe-b0e3-7cf90229f763",
            "name" : "stateCamBatch",
            "portFunction" : "STANDARD",
            "position" : {
              "x" : -560.0,
              "y" : -192.0
            },
            "scheduledState" : "ENABLED",
            "type" : "INPUT_PORT"
          } ],
          "labels" : [ ],
          "maxConcurrentTasks" : 1,
          "name" : "LayHoacThemMoiAdAccount",
          "outputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "OUTPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "ff7e7f85-ecc9-370d-8a8f-2c94bb2ba666",
            "name" : "stateProduct",
            "portFunction" : "STANDARD",
            "position" : {
              "x" : 2032.0,
              "y" : -176.0
            },
            "scheduledState" : "ENABLED",
            "type" : "OUTPUT_PORT"
          } ],
          "parameterContextName" : "ETL",
          "position" : {
            "x" : 3400.0,
            "y" : -240.0
          },
          "processGroups" : [ ],
          "processors" : [ {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "a4d373da-41c5-3aa8-a479-5a6aa09d8e5a",
            "maxBackoffPeriod" : "10 mins",
            "name" : "KhoiTao",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : -216.0,
              "y" : -232.0
            },
            "properties" : {
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100"
            },
            "propertyDescriptors" : {
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-scripting-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "920676f7-10e0-336c-959f-f47dcb078c20",
            "maxBackoffPeriod" : "10 mins",
            "name" : "GhiDeCauLenhSqlVaoContentFlow",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 968.0,
              "y" : 56.0
            },
            "properties" : {
              "Script Engine" : "Groovy",
              "Script Body" : "import groovy.json.JsonSlurper\nimport org.apache.commons.io.IOUtils\nimport java.nio.charset.StandardCharsets\n\ndef flowFile = session.get()\nif(!flowFile) return\n\nflowFile = session.write(flowFile, { inputStream, outputStream ->\n    def jsonText = IOUtils.toString(inputStream, StandardCharsets.UTF_8)\n    def jsonSlurper = new JsonSlurper()\n    def jsonObj = jsonSlurper.parseText(jsonText)\n    \n    // Ly raw string value, khng c du ngoc kp\n    def sqlInsert = jsonObj.sqlInsert\n    outputStream.write(sqlInsert.getBytes(StandardCharsets.UTF_8))\n} as StreamCallback)\n\nsession.transfer(flowFile, REL_SUCCESS)"
            },
            "propertyDescriptors" : {
              "Script File" : {
                "displayName" : "Script File",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script File",
                "resourceDefinition" : {
                  "cardinality" : "SINGLE",
                  "resourceTypes" : [ "FILE" ]
                },
                "sensitive" : false
              },
              "Script Engine" : {
                "displayName" : "Script Engine",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Engine",
                "sensitive" : false
              },
              "Script Body" : {
                "displayName" : "Script Body",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Body",
                "sensitive" : false
              },
              "Module Directory" : {
                "displayName" : "Module Directory",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Module Directory",
                "resourceDefinition" : {
                  "cardinality" : "MULTIPLE",
                  "resourceTypes" : [ "FILE", "DIRECTORY" ]
                },
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.script.ExecuteScript",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "retry" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "d6974dad-c9d4-3820-956c-8815ffa31bfb",
            "maxBackoffPeriod" : "10 mins",
            "name" : "ThucThiThemMoiAdAccount",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 1600.0,
              "y" : 72.0
            },
            "properties" : {
              "Support Fragmented Transactions" : "false",
              "Batch Size" : "#{PageSizeMax}",
              "Obtain Generated Keys" : "false",
              "JDBC Connection Pool" : "7d601288-eb00-3fcc-934d-d5e3c37f2cfc",
              "database-session-autocommit" : "true",
              "rollback-on-failure" : "false"
            },
            "propertyDescriptors" : {
              "Support Fragmented Transactions" : {
                "displayName" : "Support Fragmented Transactions",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Support Fragmented Transactions",
                "sensitive" : false
              },
              "putsql-sql-statement" : {
                "displayName" : "SQL Statement",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "putsql-sql-statement",
                "sensitive" : false
              },
              "Transaction Timeout" : {
                "displayName" : "Transaction Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Transaction Timeout",
                "sensitive" : false
              },
              "Batch Size" : {
                "displayName" : "Batch Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Batch Size",
                "sensitive" : false
              },
              "Obtain Generated Keys" : {
                "displayName" : "Obtain Generated Keys",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Obtain Generated Keys",
                "sensitive" : false
              },
              "JDBC Connection Pool" : {
                "displayName" : "JDBC Connection Pool",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "JDBC Connection Pool",
                "sensitive" : false
              },
              "database-session-autocommit" : {
                "displayName" : "Database Session AutoCommit",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "database-session-autocommit",
                "sensitive" : false
              },
              "rollback-on-failure" : {
                "displayName" : "Rollback On Failure",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "rollback-on-failure",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.PutSQL",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "ca7ccda5-3622-382d-80db-a2f4577c751a",
            "maxBackoffPeriod" : "10 mins",
            "name" : "RouteOnAttribute",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 976.0,
              "y" : -248.0
            },
            "properties" : {
              "hasNewAccounts" : "${adaccounts.new.count:gt(0)}",
              "Routing Strategy" : "Route to Property name"
            },
            "propertyDescriptors" : {
              "hasNewAccounts" : {
                "displayName" : "hasNewAccounts",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "hasNewAccounts",
                "sensitive" : false
              },
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-scripting-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "53e11499-aa83-339f-9a1c-41ffbc853f15",
            "maxBackoffPeriod" : "10 mins",
            "name" : "XuLyDuLieuThemMoi",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 232.0,
              "y" : -232.0
            },
            "properties" : {
              "Script Engine" : "Groovy",
              "Script Body" : "import org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport groovy.json.JsonOutput\nimport java.nio.file.Files\nimport java.nio.file.Paths\nimport java.time.*\nimport java.time.format.DateTimeFormatter\nimport java.util.UUID\n\ndef flowFile = session.get()\nif (!flowFile) return\n\n// ---------- Helpers ----------\ndef readJsonFile = { String path ->\n    try {\n        def p = Paths.get(path)\n        if (!Files.exists(p)) return null\n        def txt = new String(Files.readAllBytes(p), StandardCharsets.UTF_8)\n        if (txt.trim().isEmpty()) return null\n        return new JsonSlurper().parseText(txt)\n    } catch (Throwable t) {\n        return null\n    }\n}\ndef escapeSql = { String s -> s == null ? null : s.replace(\"'\", \"''\") }\ndef str = { Object v -> v == null ? \"\" : v.toString().trim() }\n\ndef parseInClause = { String s ->\n    if (!s) return [] as List\n    def t = s.trim()\n    if (t.startsWith(\"(\") && t.endsWith(\")\")) t = t.substring(1, t.length()-1)\n    if (t.trim().isEmpty()) return []\n    return t.split(\",\").collect { it.trim().replaceAll(\"^'+|'+\\$\", \"\") }.findAll { it }\n}\n\n// Parse t trng Date (CreateTime  i tn thnh Date)\ndef parseInstant = { Object v ->\n    if (v == null) return null\n    def s = v.toString().trim()\n    if (!s) return null\n    try { return OffsetDateTime.parse(s).toInstant() } catch (Throwable ignore) {}\n    try {\n        def fmt = DateTimeFormatter.ofPattern(\"yyyy-MM-dd HH:mm:ss[.SSSSSSS]\")\n        return LocalDateTime.parse(s, fmt).toInstant(ZoneOffset.UTC)\n    } catch (Throwable ignore) {}\n    try { return Instant.ofEpochMilli(Long.parseLong(s)) } catch (Throwable ignore) {}\n    try { return Instant.ofEpochSecond(Long.parseLong(s)) } catch (Throwable ignore) {}\n    return null\n}\n\ndef toSqlValue = { v ->\n    if (v == null) return \"NULL\"\n    if (v instanceof Boolean) return v ? \"1\" : \"0\"\n    if (v instanceof Number) return v.toString()\n    return \"N'${escapeSql(v.toString())}'\"\n}\n\ntry {\n    // ---- Inputs ----\n    def rawPath = flowFile.getAttribute(\"stateCurrent.fullPath\")\n    if (!rawPath) {\n        flowFile = session.putAttribute(flowFile, \"error.message\", \"Missing attribute: stateCurrent.fullPath\")\n        session.transfer(flowFile, REL_FAILURE); return\n    }\n\n    // RAW temp (transactions)\n    def rawList = readJsonFile(rawPath)\n    if (!(rawList instanceof List)) rawList = []\n\n    // Dim (ton b AdvertiserId hin c) ly t attribute IN CLAUSE\n    def inClause = flowFile.getAttribute(\"stateAdAccounts.advertiserIds.inClause\")\n    List dimIds = parseInClause(inClause)\n    def dimSet = new HashSet<String>(dimIds.collect { it?.toString()?.trim() }.findAll { it })\n\n    // 1) Chn bn ghi mi nht theo Date cho mi AccountId (nu 1 account c nhiu transaction)\n    def latestByAcc = [:]  // accId -> [rec, ts]\n    rawList.each { r0 ->\n        def r = r0 as Map\n        def acc = str(r.AccountId ?: r.accountId)\n        if (!acc) return\n        def ts = parseInstant(r.Date ?: r.date) ?: Instant.EPOCH\n        def cur = latestByAcc[acc]\n        if (cur == null || ts.isAfter(cur.ts as Instant)) {\n            latestByAcc[acc] = [rec: r, ts: ts]\n        }\n    }\n\n    // 2) Lc ra AccountId mi so vi Dim (KHNG quan tm BcId)\n    def newAccounts = []\n    latestByAcc.each { accId, holder ->\n        if (dimSet.contains(accId)) return\n        def r = holder.rec as Map\n        newAccounts << [\n            OwnerBcId      : str(r.BcId ?: r.bcId),\n            AdvertiserId   : accId,\n            AdvertiserName : str(r.AccountName ?: r.accountName),\n            Currency       : str(r.Currency ?: r.currency),\n            Timezone       : str(r.Timezone ?: r.timezone)\n        ]\n    }\n\n    // 3) Sinh SQL INSERT idempotent: mi account bc IF NOT EXISTS (AdvertiserId, IsCurrent=1)\n    def cols = [\n        \"Id\",\"OwnerBcId\",\"AdvertiserId\",\"AdvertiserName\",\n        \"Currency\",\"Timezone\",\"Country\",\"Status\",\"Company\",\n        \"IsActive\",\"EffectiveDate\",\"ExpiryDate\",\"IsCurrent\",\n        \"RowVersion\",\"CreationTime\",\"CreatorId\",\"LastModificationTime\",\"LastModifierId\"\n    ]\n\n    def sqlList = []\n    newAccounts.each { a ->\n        def vals = [\n            \"NEWID()\",                                      // Id\n            toSqlValue(a.OwnerBcId),                        // OwnerBcId\n            toSqlValue(a.AdvertiserId),                     // AdvertiserId\n            toSqlValue(a.AdvertiserName ?: \"\"),             // AdvertiserName\n            toSqlValue(a.Currency ?: \"\"),                   // Currency\n            toSqlValue(a.Timezone ?: \"\"),                   // Timezone\n            \"N''\",                                          // Country (RAW khng c)\n            \"N''\",                                          // Status  (RAW khng c)\n            \"NULL\",                                         // Company\n            \"1\",                                            // IsActive\n            \"SYSUTCDATETIME()\",                             // EffectiveDate\n            \"NULL\",                                         // ExpiryDate\n            \"1\",                                            // IsCurrent\n            \"0\",                                            // RowVersion\n            \"SYSUTCDATETIME()\",                             // CreationTime\n            \"NULL\",                                         // CreatorId\n            \"NULL\",                                         // LastModificationTime\n            \"NULL\"                                          // LastModifierId\n        ]\n        def sql = \"\"\"\nIF NOT EXISTS (\n    SELECT 1\n    FROM dbo.Dim_DimAdAccounts WITH (UPDLOCK, HOLDLOCK)\n    WHERE AdvertiserId = ${toSqlValue(a.AdvertiserId)} AND IsCurrent = 1\n)\nBEGIN\n    INSERT INTO dbo.Dim_DimAdAccounts (${cols.join(\",\")})\n    VALUES (${vals.join(\",\")});\nEND;\n\"\"\".trim()\n        sqlList << sql\n    }\n    def sqlInsert = sqlList.join(\"\\n\")\n\n    // 4) Ghi content kt qu ( PutSQL c)\n    def result = [\n        newCount    : newAccounts.size(),\n        sqlInsert   : sqlInsert,\n        newAccounts : newAccounts\n    ]\n    def outJson = JsonOutput.prettyPrint(JsonOutput.toJson(result))\n    flowFile = session.write(flowFile, { inputStream, outputStream ->\n        outputStream.write(outJson.getBytes(StandardCharsets.UTF_8))\n    } as StreamCallback)\n\n    // 5) Attributes  RouteOnAttribute\n    flowFile = session.putAttribute(flowFile, \"adaccounts.new.count\", String.valueOf(newAccounts.size()))\n\n    session.transfer(flowFile, REL_SUCCESS)\n\n} catch (Throwable t) {\n    flowFile = session.putAttribute(flowFile, \"error.message\", t.getMessage())\n    session.transfer(flowFile, REL_FAILURE)\n}"
            },
            "propertyDescriptors" : {
              "Script File" : {
                "displayName" : "Script File",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script File",
                "resourceDefinition" : {
                  "cardinality" : "SINGLE",
                  "resourceTypes" : [ "FILE" ]
                },
                "sensitive" : false
              },
              "Script Engine" : {
                "displayName" : "Script Engine",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Engine",
                "sensitive" : false
              },
              "Script Body" : {
                "displayName" : "Script Body",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Body",
                "sensitive" : false
              },
              "Module Directory" : {
                "displayName" : "Module Directory",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Module Directory",
                "resourceDefinition" : {
                  "cardinality" : "MULTIPLE",
                  "resourceTypes" : [ "FILE", "DIRECTORY" ]
                },
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.script.ExecuteScript",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "success" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b27d2dd1-206b-37a6-a18b-7ad425c5d077",
            "identifier" : "d163554e-a6b5-387e-8169-7823d369e0ab",
            "maxBackoffPeriod" : "10 mins",
            "name" : "LogMessage",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 968.0,
              "y" : 456.0
            },
            "properties" : {
              "log-level" : "info"
            },
            "propertyDescriptors" : {
              "log-message" : {
                "displayName" : "Log message",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-message",
                "sensitive" : false
              },
              "log-level" : {
                "displayName" : "Log Level",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-level",
                "sensitive" : false
              },
              "log-prefix" : {
                "displayName" : "Log prefix",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-prefix",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.LogMessage",
            "yieldDuration" : "1 sec"
          } ],
          "remoteProcessGroups" : [ ],
          "scheduledState" : "ENABLED",
          "statelessFlowTimeout" : "1 min"
        } ],
        "processors" : [ {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "17a4155a-da01-31cd-a711-923147b8e536",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LayDanhSachAdAccountTransactionChuaETL",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 608.0,
            "y" : -208.0
          },
          "properties" : {
            "esql-max-rows" : "0",
            "dbf-default-precision" : "10",
            "Max Wait Time" : "0 seconds",
            "SQL Query" : "SELECT TOP (${state.pageSize})\n       r.[Id],\n       r.[BcId],\n       r.[AccountId],\n       r.[PaymentPortfolioId],\n       r.[TransactionId],\n       r.[Amount],\n       r.[Subtotal],\n       r.[TaxAmount],\n       r.[Currency],\n       r.[AmountType],\n       r.[TransactionType],\n       r.[BillingType],\n       r.[Timezone],\n       r.[CreateTime]               AS [Date],   -- dng CreateTime lm thi im giao dch\n       r.[InvoiceId],\n       r.[SerialNumber],\n       r.[CreationTime],\n       r.[CreatorId],\n       r.[LastModificationTime],\n       r.[LastModifierId]\nFROM dbo.[Raw_RawTransactions] r\nWHERE r.[BcId] = '${stateBc.id}'\n  -- Account transaction: phi c AccountId\n  AND (r.[AccountId] IS NOT NULL AND LTRIM(RTRIM(r.[AccountId])) <> '')\n  -- cha c trong Fact\n  AND NOT EXISTS (\n      SELECT 1\n      FROM dbo.[Fact_FactTransactions] f\n      WHERE f.[Type] = 'AdAccount'\n        AND f.[DimBusinessCenterId] = '${stateBc.dimId}'\n        AND f.[EntityId]            = r.[AccountId]\n        AND f.[TransactionId]       = r.[TransactionId]\n       AND ISNULL(NULLIF(f.[PaymentPortfolioId], N''), N'__NULL__')\n           = ISNULL(r.[PaymentPortfolioId], N'__NULL__')\n        AND f.[Date]                = r.[CreateTime]  -- khp tuyt i datetime2(7)\n  )\nORDER BY r.[CreateTime] DESC, r.[Id] DESC;",
            "Database Connection Pooling Service" : "7d601288-eb00-3fcc-934d-d5e3c37f2cfc",
            "esql-auto-commit" : "true",
            "dbf-user-logical-types" : "false",
            "dbf-default-scale" : "0",
            "compression-format" : "NONE",
            "esql-output-batch-size" : "0",
            "esql-fetch-size" : "0",
            "dbf-normalize" : "false",
            "Content Output Strategy" : "EMPTY"
          },
          "propertyDescriptors" : {
            "esql-max-rows" : {
              "displayName" : "Max Rows Per Flow File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-max-rows",
              "sensitive" : false
            },
            "dbf-default-precision" : {
              "displayName" : "Default Decimal Precision",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-precision",
              "sensitive" : false
            },
            "Max Wait Time" : {
              "displayName" : "Max Wait Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Max Wait Time",
              "sensitive" : false
            },
            "SQL Query" : {
              "displayName" : "SQL Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "SQL Query",
              "sensitive" : false
            },
            "Database Connection Pooling Service" : {
              "displayName" : "Database Connection Pooling Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Database Connection Pooling Service",
              "sensitive" : false
            },
            "sql-post-query" : {
              "displayName" : "SQL Post-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-post-query",
              "sensitive" : false
            },
            "esql-auto-commit" : {
              "displayName" : "Set Auto Commit",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-auto-commit",
              "sensitive" : false
            },
            "dbf-user-logical-types" : {
              "displayName" : "Use Avro Logical Types",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-user-logical-types",
              "sensitive" : false
            },
            "dbf-default-scale" : {
              "displayName" : "Default Decimal Scale",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-scale",
              "sensitive" : false
            },
            "sql-pre-query" : {
              "displayName" : "SQL Pre-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-pre-query",
              "sensitive" : false
            },
            "compression-format" : {
              "displayName" : "Compression Format",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "compression-format",
              "sensitive" : false
            },
            "esql-output-batch-size" : {
              "displayName" : "Output Batch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-output-batch-size",
              "sensitive" : false
            },
            "esql-fetch-size" : {
              "displayName" : "Fetch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-fetch-size",
              "sensitive" : false
            },
            "dbf-normalize" : {
              "displayName" : "Normalize Table/Column Names",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-normalize",
              "sensitive" : false
            },
            "Content Output Strategy" : {
              "displayName" : "Content Output Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Content Output Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "ab83dc7b-df94-3f6a-8628-ec00a3129c51",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ConvertRecord",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1012.966552734375,
            "y" : -208.0
          },
          "properties" : {
            "Include Zero Record FlowFiles" : "true",
            "Record Writer" : "422d4040-1ece-3a3f-b19c-f301d2c4bdce",
            "Record Reader" : "e99b4c7b-99a5-3c61-a9fb-3523c60d9b83"
          },
          "propertyDescriptors" : {
            "Include Zero Record FlowFiles" : {
              "displayName" : "Include Zero Record FlowFiles",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Include Zero Record FlowFiles",
              "sensitive" : false
            },
            "Record Writer" : {
              "displayName" : "Record Writer",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Writer",
              "sensitive" : false
            },
            "Record Reader" : {
              "displayName" : "Record Reader",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Reader",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ConvertRecord",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "0419f1bd-6dcf-3feb-b55f-3031445b9a75",
          "maxBackoffPeriod" : "10 mins",
          "name" : "SaveRawTemp",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2448.0,
            "y" : -208.0
          },
          "properties" : {
            "Create Missing Directories" : "true",
            "Directory" : "${stateCurrent.directory}",
            "Conflict Resolution Strategy" : "replace"
          },
          "propertyDescriptors" : {
            "Group" : {
              "displayName" : "Group",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Group",
              "sensitive" : false
            },
            "Owner" : {
              "displayName" : "Owner",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Owner",
              "sensitive" : false
            },
            "Create Missing Directories" : {
              "displayName" : "Create Missing Directories",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Create Missing Directories",
              "sensitive" : false
            },
            "Permissions" : {
              "displayName" : "Permissions",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Permissions",
              "sensitive" : false
            },
            "Maximum File Count" : {
              "displayName" : "Maximum File Count",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum File Count",
              "sensitive" : false
            },
            "Last Modified Time" : {
              "displayName" : "Last Modified Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Last Modified Time",
              "sensitive" : false
            },
            "Directory" : {
              "displayName" : "Directory",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory",
              "sensitive" : false
            },
            "Conflict Resolution Strategy" : {
              "displayName" : "Conflict Resolution Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Conflict Resolution Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.PutFile",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "failure" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "d4361335-fac8-3466-bfcb-00e43aab33db",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ConvertRecord",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2936.0,
            "y" : 360.0
          },
          "properties" : {
            "Include Zero Record FlowFiles" : "true",
            "Record Writer" : "422d4040-1ece-3a3f-b19c-f301d2c4bdce",
            "Record Reader" : "e99b4c7b-99a5-3c61-a9fb-3523c60d9b83"
          },
          "propertyDescriptors" : {
            "Include Zero Record FlowFiles" : {
              "displayName" : "Include Zero Record FlowFiles",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Include Zero Record FlowFiles",
              "sensitive" : false
            },
            "Record Writer" : {
              "displayName" : "Record Writer",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Writer",
              "sensitive" : false
            },
            "Record Reader" : {
              "displayName" : "Record Reader",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Reader",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ConvertRecord",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "3b3004b8-c8b2-30e9-8782-cf798c7a631d",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CleanupTemp",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 992.0,
            "y" : 952.0
          },
          "properties" : {
            "Filename" : "${stateCurrent.filename}",
            "Directory Path" : "${stateCurrent.directory}"
          },
          "propertyDescriptors" : {
            "Filename" : {
              "displayName" : "Filename",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Filename",
              "sensitive" : false
            },
            "Directory Path" : {
              "displayName" : "Directory Path",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory Path",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.DeleteFile",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "f1881636-03cd-3a99-b56f-278d672f4acc",
          "maxBackoffPeriod" : "10 mins",
          "name" : "RouteOnAttributeCheckLastPage",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2008.0,
            "y" : 944.0
          },
          "properties" : {
            "Routing Strategy" : "Route to Property name",
            "isLastPage" : "${lastPage:equals('1')}"
          },
          "propertyDescriptors" : {
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "isLastPage" : {
              "displayName" : "isLastPage",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "isLastPage",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-groovyx-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "9bb15efb-b244-3a64-8775-42b855e8e922",
          "maxBackoffPeriod" : "10 mins",
          "name" : "TransformData",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2944.0,
            "y" : 656.0
          },
          "properties" : {
            "groovyx-script-body" : "import org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport java.time.LocalDateTime\nimport java.time.format.DateTimeFormatter\nimport java.time.format.DateTimeFormatterBuilder\nimport java.time.temporal.ChronoField\nimport java.util.UUID\nimport java.io.File\n\n// ================= Utils =================\ndef toDimDateId(String isoDateTime) {\n    def d = (isoDateTime ?: \"\").trim()\n    if (!d) return null\n    def day = d.substring(0, 10)\n    return day.replace(\"-\", \"\").toInteger()\n}\ndef normalizeIso(String dateStr) {\n    def t = (dateStr ?: \"\").trim().replace(' ', 'T')\n    if (!t) return null\n    def parser = new DateTimeFormatterBuilder()\n        .appendPattern(\"yyyy-MM-dd'T'HH:mm:ss\")\n        .optionalStart().appendFraction(ChronoField.NANO_OF_SECOND, 1, 7, true).optionalEnd()\n        .toFormatter()\n    def dt = LocalDateTime.parse(t, parser)\n    return dt.format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss.SSSSSSS\"))\n}\ndef esc(String s) { (s == null) ? null : s.replace(\"'\", \"''\") }\ndef q(Object v)  { v == null ? \"NULL\" : \"N'${esc(v.toString())}'\" }\ndef qv(Object v) { v == null ? \"NULL\" : \"'${esc(v.toString())}'\" }\ndef dec(Object v) { if (v == null) return \"NULL\"; def s=v.toString().trim(); s==\"\"?\"NULL\":s }\ndef sqlNow() { \"SYSUTCDATETIME()\" }\ndef safeIsoToSqlDate(Object v) {\n    def iso = normalizeIso(v?.toString())\n    return iso ? \"CONVERT(datetime2(7), ${qv(iso)}, 126)\" : \"NULL\"\n}\n// NOT NULL defaults\ndef dec0(Object v){ def x = dec(v); x == \"NULL\" ? \"0.0\" : x }\ndef int0(Object v){ def x = dec(v); x == \"NULL\" ? \"0\"   : x }\n\n// ---- NEW: NVARCHAR NULL nu null/blank, ngc li N'...'\ndef qNullIfBlank(Object v) {\n    def s = (v == null) ? \"\" : v.toString().trim()\n    return s == \"\" ? \"NULL\" : \"N'${esc(s)}'\"\n}\n// ---- NEW: Chun ho biu thc so snh chui: '' ~ NULL\ndef normStrExpr(Object v) {\n    // Tr v ISNULL(NULLIF(N'val', N''), N'__NULL__') hoc ISNULL(NULL,NULL)...\n    \"ISNULL(NULLIF(${q(v)}, N''), N'__NULL__')\"\n}\n\n// Lookup DimAdAccountId theo AdvertiserId (AccountId)\ndef dimAdIdExpr = { String advId ->\n    def a = (advId ?: \"\").trim()\n    if (!a) return \"NULL\"\n    return \"\"\"(\n        SELECT TOP (1) d.[Id]\n        FROM [dbo].[Dim_DimAdAccounts] d\n        WHERE d.[AdvertiserId] = ${q(a)}\n        ORDER BY ISNULL(d.[IsActive],1) DESC,\n                 d.[Id] DESC\n    )\"\"\"\n}\n// =============== End Utils ===============\n\ndef flowFile = session.get()\nif (!flowFile) return\n\n// ---------- Attributes ----------\ndef rawPath  = flowFile.getAttribute('stateCurrent.fullPath')\ndef dimBcId  = flowFile.getAttribute('stateBc.dimId')\ndef bcId     = flowFile.getAttribute('stateBc.id')\n\n// ---------- Load RAW ----------\ndef rawList = []\nif (rawPath) {\n    def f = new File(rawPath)\n    if (f.exists()) {\n        def txt = f.getText(StandardCharsets.UTF_8.name())\n        def parsed = new JsonSlurper().parseText(txt)\n        rawList = (parsed instanceof List) ? parsed : [parsed]\n    }\n}\n\n// ---------- Load FACT snapshot t flow content ----------\ndef factRows = []\nflowFile = session.write(flowFile, { inp, out ->\n    def content = inp.getText(StandardCharsets.UTF_8.name())\n    if (content?.trim()) {\n        def parsed = new JsonSlurper().parseText(content)\n        factRows = (parsed instanceof List) ? parsed : [parsed]\n        out.write(content.getBytes(StandardCharsets.UTF_8))\n    } else {\n        out.write(\"[]\".getBytes(StandardCharsets.UTF_8))\n    }\n} as StreamCallback)\n\n// ---- factMap: KEY = BcId|AccountId|PaymentPortfolioIdOrNULL|TransactionId|Date(ISO7)\ndef factMap = [:]\nfactRows.each { f ->\n    def isoDate = normalizeIso(f?.Date)\n    def key = [\n        (bcId ?: \"\").toString().trim(),\n        (f?.EntityId ?: \"\").toString().trim(),\n        (f?.PaymentPortfolioId ?: \"__NULL__\").toString(),\n        (f?.TransactionId ?: \"\").toString(),\n        (isoDate ?: \"\")\n    ].join(\"|\")\n    factMap[key] = f\n}\n\n// ---- Lc RAW: ch AdAccount transactions (AccountId c gi tr)\nrawList = rawList.findAll { (it?.AccountId ?: \"\").toString().trim() != \"\" }\n\n// ---- DEDUP RAW cng KEY, chn bn mi hn theo CreateTime/Id\ndef newer = { a, b ->\n    def da = a?.Date ? normalizeIso(a.Date) : (a?.CreateTime ? normalizeIso(a.CreateTime) : null)\n    def db = b?.Date ? normalizeIso(b.Date) : (b?.CreateTime ? normalizeIso(b.CreateTime) : null)\n    if (da && db && da != db) return da > db\n    (a?.Id?.toString() ?: \"\") > (b?.Id?.toString() ?: \"\")\n}\ndef dedup = [:]\nrawList.each { r ->\n    def isoDate = normalizeIso(r?.Date ?: r?.CreateTime)\n    def key = [\n        (bcId ?: r?.BcId ?: \"\").toString().trim(),\n        (r?.AccountId ?: \"\").toString().trim(),\n        (r?.PaymentPortfolioId ?: \"__NULL__\").toString(),\n        (r?.TransactionId ?: \"\").toString(),\n        (isoDate ?: \"\")\n    ].join(\"|\")\n    def cur = dedup[key]\n    if (cur == null || newer(r, cur)) dedup[key] = r\n}\nrawList = dedup.values().toList()\n\n// ---- Stage INSERT / UPDATE\ndef inserts = []; def updates = []\nrawList.each { r ->\n    def isoDate = normalizeIso(r?.Date ?: r?.CreateTime)\n    def key = [\n        (bcId ?: r?.BcId ?: \"\").toString().trim(),\n        (r?.AccountId ?: \"\").toString().trim(),\n        (r?.PaymentPortfolioId ?: \"__NULL__\").toString(),\n        (r?.TransactionId ?: \"\").toString(),\n        (isoDate ?: \"\")\n    ].join(\"|\")\n    def existing = factMap[key]\n    if (existing == null) inserts << r else updates << [raw: r, existing: existing]\n}\n\n// ---- FK DimTransactionPaymentPortId (lookup Dim, fallback all-zero)\ndef DEFAULT_GUID = \"00000000-0000-0000-0000-000000000000\"\ndef dimPortExpr = { String pid ->\n    def p = (pid ?: \"\").trim()\n    if (p == \"\") {\n        return \"'${DEFAULT_GUID}'\"\n    } else {\n        return \"\"\"COALESCE(\n    (SELECT TOP 1 [Id] FROM dbo.[Dim_DimTransactionPaymentPort] WITH (NOLOCK)\n     WHERE [PaymentPortfolioId] = N'${esc(p)}'),\n    '${DEFAULT_GUID}'\n)\"\"\"\n    }\n}\n\n// ================= Build SQL =================\n\n// ---- INSERT ----\ndef insertValues = inserts.collect { r ->\n    def isoDate   = normalizeIso(r?.Date ?: r?.CreateTime)\n    def dimDateId = toDimDateId(isoDate)\n    def currency  = (r?.Currency ?: null)\n    def isUSD = (currency == 'USD')\n    def isVND = (currency == 'VND')\n    def id    = UUID.randomUUID().toString()\n    def acct  = (r?.AccountId ?: \"\").toString().trim()\n    def dimPort = dimPortExpr(r?.PaymentPortfolioId)\n\n    \"\"\"(\n${qv(id)},                              -- Id\n${dimDateId ?: \"NULL\"},                 -- DimDateId\n${dimAdIdExpr(acct)},                   -- DimAdAccountId\n${qv(dimBcId)},                         -- DimBusinessCenterId\nN'AdAccount',                           -- Type\n${q(acct)},                             -- EntityId (AccountId)\n${dec0(r?.Amount)},                     -- Amount\n${q(currency)},                         -- Currency\n${q(r?.InvoiceId)},                     -- InvoiceId\n${q(r?.SerialNumber)},                  -- InvoiceSerialNumber\n${q(r?.Timezone)},                      -- Timezone\n${safeIsoToSqlDate(isoDate)},           -- Date\n${sqlNow()},                            -- CreationTime\n${qv(r?.CreatorId)},                    -- CreatorId\n${int0(r?.AmountType)},                 -- AmountType\n${isUSD ? dec0(r?.Amount)   : \"0.0\"},   -- AmountUSD\n${isVND ? dec0(r?.Amount)   : \"0.0\"},   -- AmountVND\n${int0(r?.BillingType)},                -- BillingType\n${dimPort},                             -- DimTransactionPaymentPortId\n${qNullIfBlank(r?.PaymentPortfolioId)}, -- PaymentPortfolioId (NULL nu thiu/blank)\n${dec0(r?.Subtotal)},                   -- Subtotal\n${isUSD ? dec0(r?.Subtotal) : \"0.0\"},   -- SubtotalUSD\n${isVND ? dec0(r?.Subtotal) : \"0.0\"},   -- SubtotalVND\n${dec0(r?.TaxAmount)},                  -- TaxAmount\n${isUSD ? dec0(r?.TaxAmount): \"0.0\"},   -- TaxAmountUSD\n${isVND ? dec0(r?.TaxAmount): \"0.0\"},   -- TaxAmountVND\n${q(r?.TransactionId)},                 -- TransactionId\n${int0(r?.TransactionType)}             -- TransactionType\n)\"\"\"\n}\n\ndef sqlInsert = insertValues.isEmpty() ? \"\" : \"\"\"\nINSERT INTO [dbo].[Fact_FactTransactions]\n([Id],\n [DimDateId],[DimAdAccountId],[DimBusinessCenterId],\n [Type],[EntityId],\n [Amount],[Currency],\n [InvoiceId],[InvoiceSerialNumber],\n [Timezone],[Date],\n [CreationTime],[CreatorId],\n [AmountType],[AmountUSD],[AmountVND],\n [BillingType],\n [DimTransactionPaymentPortId],[PaymentPortfolioId],\n [Subtotal],[SubtotalUSD],[SubtotalVND],\n [TaxAmount],[TaxAmountUSD],[TaxAmountVND],\n [TransactionId],[TransactionType])\nVALUES\n${insertValues.join(\",\\n\")}\n\"\"\".trim()\n\n// ---- UPDATE ----\ndef updateStatements = updates.collect { u ->\n    def r = u.raw; def e = u.existing\n    def isoDate   = normalizeIso(r?.Date ?: r?.CreateTime)\n    def dimDateId = toDimDateId(isoDate)\n    def currency  = (r?.Currency ?: null)\n    def isUSD = (currency == 'USD'); def isVND = (currency == 'VND')\n    def acct  = (r?.AccountId ?: \"\").toString().trim()\n    def dimPort = dimPortExpr(r?.PaymentPortfolioId)\n\n    // WHERE chun ho PaymentPortfolioId: '' ~ NULL  C HAI V\n    def whereById = e?.Id ? \"WHERE [Id] = N'${esc(e.Id.toString())}'\" : \"\"\"\nWHERE [Type] = N'AdAccount'\n  AND [EntityId] = ${q(acct)}\n  AND [DimBusinessCenterId] = ${qv(dimBcId)}\n  AND ISNULL(NULLIF([PaymentPortfolioId], N''), N'__NULL__')\n      = ${normStrExpr(r?.PaymentPortfolioId)}\n  AND [TransactionId] = ${q(r?.TransactionId)}\n  AND [Date] = ${safeIsoToSqlDate(isoDate)}\n\"\"\".trim()\n\n    \"\"\"\nUPDATE [dbo].[Fact_FactTransactions]\nSET DimDateId                   = ${dimDateId ?: \"NULL\"},\n    DimAdAccountId              = ${dimAdIdExpr(acct)},\n    Currency                    = ${q(currency)},\n    Timezone                    = ${q(r?.Timezone)},\n    Date                        = ${safeIsoToSqlDate(isoDate)},\n    Amount                      = ${dec0(r?.Amount)},\n    AmountType                  = ${int0(r?.AmountType)},\n    AmountUSD                   = ${isUSD ? dec0(r?.Amount)   : \"0.0\"},\n    AmountVND                   = ${isVND ? dec0(r?.Amount)   : \"0.0\"},\n    BillingType                 = ${int0(r?.BillingType)},\n    DimTransactionPaymentPortId = ${dimPort},\n    PaymentPortfolioId          = ${qNullIfBlank(r?.PaymentPortfolioId)}, -- NULL nu thiu/blank\n    Subtotal                    = ${dec0(r?.Subtotal)},\n    SubtotalUSD                 = ${isUSD ? dec0(r?.Subtotal) : \"0.0\"},\n    SubtotalVND                 = ${isVND ? dec0(r?.Subtotal) : \"0.0\"},\n    TaxAmount                   = ${dec0(r?.TaxAmount)},\n    TaxAmountUSD                = ${isUSD ? dec0(r?.TaxAmount): \"0.0\"},\n    TaxAmountVND                = ${isVND ? dec0(r?.TaxAmount): \"0.0\"},\n    InvoiceId                   = ${q(r?.InvoiceId)},\n    InvoiceSerialNumber         = ${q(r?.SerialNumber)},\n    TransactionId               = ${q(r?.TransactionId)},\n    TransactionType             = ${int0(r?.TransactionType)}\n${whereById}\n\"\"\".trim()\n}\ndef sqlUpdate = updateStatements.join(\";\\n\")\n\n// ---------- Final SQL ----------\ndef finalSql = new StringBuilder()\nif (sqlInsert) finalSql.append(sqlInsert).append(\";\\n\")\nif (sqlUpdate) finalSql.append(sqlUpdate).append(\";\\n\")\n\nflowFile = session.write(flowFile, { _, out ->\n    out.write(finalSql.toString().getBytes(StandardCharsets.UTF_8))\n} as StreamCallback)\n\nsession.transfer(flowFile, REL_SUCCESS)",
            "groovyx-failure-strategy" : "rollback"
          },
          "propertyDescriptors" : {
            "groovyx-script-body" : {
              "displayName" : "Script Body",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-body",
              "sensitive" : false
            },
            "groovyx-failure-strategy" : {
              "displayName" : "Failure strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-failure-strategy",
              "sensitive" : false
            },
            "groovyx-additional-classpath" : {
              "displayName" : "Additional classpath",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-additional-classpath",
              "sensitive" : false
            },
            "groovyx-script-file" : {
              "displayName" : "Script File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-file",
              "resourceDefinition" : {
                "cardinality" : "SINGLE",
                "resourceTypes" : [ "FILE" ]
              },
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.groovyx.ExecuteGroovyScript",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "08ff6aa5-ccbb-3638-b7b9-c0e63989af19",
          "maxBackoffPeriod" : "10 mins",
          "name" : "UpdateAttributeContinueFalse",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 432.0,
            "y" : 480.0
          },
          "properties" : {
            "state.continue" : "0",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100"
          },
          "propertyDescriptors" : {
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "state.continue" : {
              "displayName" : "state.continue",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.continue",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "0d81a09c-36ef-3eeb-a7c4-06f1e89b3b07",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LayDanhSachDuLieuETLCu",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2936.0,
            "y" : 96.0
          },
          "properties" : {
            "esql-max-rows" : "0",
            "dbf-default-precision" : "10",
            "Max Wait Time" : "0 seconds",
            "SQL Query" : "SELECT \n    f.[Id],\n    f.[Type],\n    f.[EntityId],\n    CONVERT(varchar(27), f.[Date], 126) AS [Date]\nFROM dbo.[Fact_FactTransactions] f\nWHERE f.[DimBusinessCenterId] = '${stateBc.dimId}'\n  AND f.[EntityId] IN ${stateCurrent.advertiserIds.inClause}\n  AND f.[Type] = 'AdAccount'\n  AND f.[Date] >= '${stateCurrent.minDate}'\n  AND f.[Date] <= '${stateCurrent.maxDate}'\nORDER BY f.[Date] DESC;",
            "Database Connection Pooling Service" : "7d601288-eb00-3fcc-934d-d5e3c37f2cfc",
            "esql-auto-commit" : "true",
            "dbf-user-logical-types" : "false",
            "dbf-default-scale" : "0",
            "compression-format" : "NONE",
            "esql-output-batch-size" : "0",
            "esql-fetch-size" : "0",
            "dbf-normalize" : "false",
            "Content Output Strategy" : "EMPTY"
          },
          "propertyDescriptors" : {
            "esql-max-rows" : {
              "displayName" : "Max Rows Per Flow File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-max-rows",
              "sensitive" : false
            },
            "dbf-default-precision" : {
              "displayName" : "Default Decimal Precision",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-precision",
              "sensitive" : false
            },
            "Max Wait Time" : {
              "displayName" : "Max Wait Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Max Wait Time",
              "sensitive" : false
            },
            "SQL Query" : {
              "displayName" : "SQL Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "SQL Query",
              "sensitive" : false
            },
            "Database Connection Pooling Service" : {
              "displayName" : "Database Connection Pooling Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Database Connection Pooling Service",
              "sensitive" : false
            },
            "sql-post-query" : {
              "displayName" : "SQL Post-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-post-query",
              "sensitive" : false
            },
            "esql-auto-commit" : {
              "displayName" : "Set Auto Commit",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-auto-commit",
              "sensitive" : false
            },
            "dbf-user-logical-types" : {
              "displayName" : "Use Avro Logical Types",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-user-logical-types",
              "sensitive" : false
            },
            "dbf-default-scale" : {
              "displayName" : "Default Decimal Scale",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-scale",
              "sensitive" : false
            },
            "sql-pre-query" : {
              "displayName" : "SQL Pre-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-pre-query",
              "sensitive" : false
            },
            "compression-format" : {
              "displayName" : "Compression Format",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "compression-format",
              "sensitive" : false
            },
            "esql-output-batch-size" : {
              "displayName" : "Output Batch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-output-batch-size",
              "sensitive" : false
            },
            "esql-fetch-size" : {
              "displayName" : "Fetch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-fetch-size",
              "sensitive" : false
            },
            "dbf-normalize" : {
              "displayName" : "Normalize Table/Column Names",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-normalize",
              "sensitive" : false
            },
            "Content Output Strategy" : {
              "displayName" : "Content Output Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Content Output Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-groovyx-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "3b0efc67-0701-3878-b5fb-f1b732e17f53",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ChuanHoaDuLieuRaw",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1420.966552734375,
            "y" : -192.0
          },
          "properties" : {
            "groovyx-script-body" : "import org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport groovy.json.JsonOutput\nimport java.time.LocalDate\nimport java.time.LocalDateTime\nimport java.time.format.DateTimeFormatter\nimport java.time.format.DateTimeFormatterBuilder\nimport java.time.temporal.ChronoField\n\ndef flowFile = session.get()\nif (!flowFile) return\n\ndef hasData = false\ndef minDate = ''\ndef maxDate = ''\ndef lastPage = '0' // mc nh\n\n// Helper: chun ho list -> unique, trim, b rng + sort (u tin s)\ndef uniqList = { List raw ->\n    (raw ?: [])\n        .findAll { it != null }\n        .collect { it.toString().trim() }\n        .findAll { it.length() > 0 }\n        .toSet()\n        .toList()\n        .sort { a, b ->\n            try { (new BigDecimal(a) <=> new BigDecimal(b)) } catch (ignored) { a <=> b }\n        }\n}\n\n// Helper: IN clause c nhy n (an ton chui/s). Rng -> (NULL)\ndef toInClauseQuoted = { List lst ->\n    if (!lst || lst.isEmpty()) return \"(NULL)\"\n    '(' + lst.collect { v ->\n        def s = v.toString().replace(\"'\", \"''\")\n        \"'${s}'\"\n    }.join(',') + ')'\n}\n\n// Helper parse Date linh hot -> LocalDate\ndef parseToLocalDate = { String s ->\n    if (s == null) return null\n    def t = s.trim()\n    try { return LocalDate.parse(t, DateTimeFormatter.ISO_LOCAL_DATE) } catch (ignored) {}\n    def s2 = t.replace(' ', 'T').replaceAll('[Zz]$', '')\n    try {\n        def dtf = new DateTimeFormatterBuilder()\n            .appendPattern(\"yyyy-MM-dd'T'HH:mm:ss\")\n            .optionalStart().appendFraction(ChronoField.NANO_OF_SECOND, 1, 9, true).optionalEnd()\n            .toFormatter()\n        return LocalDateTime.parse(s2, dtf).toLocalDate()\n    } catch (ignored) {}\n    return null\n}\n\n// Parse JSON array an ton t attribute\ndef safeParseJsonArray = { String jsonText ->\n    try {\n        def v = new JsonSlurper().parseText(jsonText ?: '[]')\n        (v instanceof List) ? v : []\n    } catch (ignored) { [] }\n}\n\n// Ly pageSize t attribute (an ton)\ndef pageSize = 0\ntry { pageSize = (flowFile.getAttribute(\"state.pageSize\") ?: \"0\").toInteger() } catch (ignored) { pageSize = 0 }\n\n// B cha ID t body\nList advertiserIdsFromBody = []\n\nflowFile = session.write(flowFile, { inputStream, outputStream ->\n    def content = inputStream.getText(StandardCharsets.UTF_8.name())\n    outputStream.write(content.getBytes(StandardCharsets.UTF_8))\n\n    def json = new JsonSlurper().parseText(content)\n    if (!(json instanceof List)) json = [json]\n\n    hasData = !json.isEmpty()\n\n    if (hasData) {\n        // === TNH MIN/MAX THEO TRNG Date (a v yyyy-MM-dd) ===\n        def dates = json*.Date\n            .findAll { it != null }\n            .collect { parseToLocalDate(it.toString()) }\n            .findAll { it != null }\n\n        if (!dates.isEmpty()) {\n            minDate = dates.min().toString()  // yyyy-MM-dd\n            maxDate = dates.max().toString()  // yyyy-MM-dd\n        }\n\n        // === LY DANH SCH AdvertiserId DUY NHT T BODY ===\n        advertiserIdsFromBody = uniqList(json*.AdvertiserId)\n\n        // === NH DU TRANG CUI ===\n        if (pageSize > 0 && json.size() < pageSize) lastPage = '1'\n    }\n} as StreamCallback)\n\n// ---------- Canonicalize: Body -> stateCurrent -> stateAdAccounts ----------\nList canonicalIds = advertiserIdsFromBody\nif (canonicalIds.isEmpty()) {\n    canonicalIds = uniqList( safeParseJsonArray(flowFile.getAttribute('stateCurrent.advertiserIds')) )\n}\nif (canonicalIds.isEmpty()) {\n    canonicalIds = uniqList( safeParseJsonArray(flowFile.getAttribute('stateAdAccounts.advertiserIds')) )\n}\n\n// T GI: MI TH SINH T canonicalIds\ndef canonicalJson     = JsonOutput.toJson(canonicalIds)\ndef canonicalInClause = toInClauseQuoted(canonicalIds)\n\n// Chun b attributes a ra\ndef attrs = [\n    'hasData' : hasData.toString(),\n    'minDate' : minDate, // gi cp tng qut\n    'maxDate' : maxDate,\n    'lastPage': lastPage,\n\n    // stateCurrent.* (LUN set t canonical)\n    'stateCurrent.advertiserIds'          : canonicalJson,\n    'stateCurrent.advertiserIds.inClause' : canonicalInClause,\n\n    // Min/Max date theo prefix stateCurrent.* (fallback nh nu lt ny khng tnh c)\n    'stateCurrent.minDate' : (minDate ?: (flowFile.getAttribute('stateCurrent.minDate') ?: (flowFile.getAttribute('minDate') ?: ''))),\n    'stateCurrent.maxDate' : (maxDate ?: (flowFile.getAttribute('stateCurrent.maxDate') ?: (flowFile.getAttribute('maxDate') ?: '')))\n]\n\n// Ghi attributes\nflowFile = session.putAllAttributes(flowFile, attrs)\nsession.transfer(flowFile, REL_SUCCESS)",
            "groovyx-failure-strategy" : "rollback"
          },
          "propertyDescriptors" : {
            "groovyx-script-body" : {
              "displayName" : "Script Body",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-body",
              "sensitive" : false
            },
            "groovyx-failure-strategy" : {
              "displayName" : "Failure strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-failure-strategy",
              "sensitive" : false
            },
            "groovyx-additional-classpath" : {
              "displayName" : "Additional classpath",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-additional-classpath",
              "sensitive" : false
            },
            "groovyx-script-file" : {
              "displayName" : "Script File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-file",
              "resourceDefinition" : {
                "cardinality" : "SINGLE",
                "resourceTypes" : [ "FILE" ]
              },
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.groovyx.ExecuteGroovyScript",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "0a25552e-4ec6-3e8e-b561-d195e18c3f13",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CheckHasData",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1956.966552734375,
            "y" : -200.0
          },
          "properties" : {
            "Routing Strategy" : "Route to Property name",
            "hasData" : "${hasData:equals('true')}"
          },
          "propertyDescriptors" : {
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "hasData" : {
              "displayName" : "hasData",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "hasData",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "retry" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "eb898e32-6c06-33af-b31e-9637c7f664cc",
          "maxBackoffPeriod" : "10 mins",
          "name" : "InsertAndUpdateToDataBase",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2944.0,
            "y" : 944.0
          },
          "properties" : {
            "Support Fragmented Transactions" : "false",
            "Batch Size" : "#{PageSizeMax}",
            "Obtain Generated Keys" : "false",
            "JDBC Connection Pool" : "7d601288-eb00-3fcc-934d-d5e3c37f2cfc",
            "database-session-autocommit" : "true",
            "rollback-on-failure" : "false"
          },
          "propertyDescriptors" : {
            "Support Fragmented Transactions" : {
              "displayName" : "Support Fragmented Transactions",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Support Fragmented Transactions",
              "sensitive" : false
            },
            "putsql-sql-statement" : {
              "displayName" : "SQL Statement",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "putsql-sql-statement",
              "sensitive" : false
            },
            "Transaction Timeout" : {
              "displayName" : "Transaction Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Transaction Timeout",
              "sensitive" : false
            },
            "Batch Size" : {
              "displayName" : "Batch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Batch Size",
              "sensitive" : false
            },
            "Obtain Generated Keys" : {
              "displayName" : "Obtain Generated Keys",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Obtain Generated Keys",
              "sensitive" : false
            },
            "JDBC Connection Pool" : {
              "displayName" : "JDBC Connection Pool",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "JDBC Connection Pool",
              "sensitive" : false
            },
            "database-session-autocommit" : {
              "displayName" : "Database Session AutoCommit",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "database-session-autocommit",
              "sensitive" : false
            },
            "rollback-on-failure" : {
              "displayName" : "Rollback On Failure",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "rollback-on-failure",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.PutSQL",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "4157a3c8-f6d4-39b1-9511-3d38b3bb5a86",
          "maxBackoffPeriod" : "10 mins",
          "name" : "UpdateAttributeContinueTrue",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1504.0,
            "y" : 928.0
          },
          "properties" : {
            "state.continue" : "1",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100"
          },
          "propertyDescriptors" : {
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "state.continue" : {
              "displayName" : "state.continue",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.continue",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "2334c7e4-522b-35f7-8f99-8d45a99c4aaa",
          "maxBackoffPeriod" : "10 mins",
          "name" : "KhoiTao",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 233.655517578125,
            "y" : -201.37796020507812
          },
          "properties" : {
            "stateCurrent.filename" : "${state.name}-bc-${stateBc.id}-ad-page${state.page}.json",
            "filename" : "${state.name}-bc-${stateBc.id}-ad-page${state.page}.json",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100",
            "stateCurrent.fullPath" : "#{TempPath}${Path.Separator}${state.name}${Path.Separator}${state.name}-bc-${stateBc.id}-ad-page${state.page}.json",
            "skip" : "${state.page:toNumber():minus(1):multiply(${state.pageSize:toNumber()})}",
            "stateCurrent.directory" : "#{TempPath}${Path.Separator}${state.name}"
          },
          "propertyDescriptors" : {
            "stateCurrent.filename" : {
              "displayName" : "stateCurrent.filename",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateCurrent.filename",
              "sensitive" : false
            },
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "filename" : {
              "displayName" : "filename",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "filename",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "stateCurrent.fullPath" : {
              "displayName" : "stateCurrent.fullPath",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateCurrent.fullPath",
              "sensitive" : false
            },
            "skip" : {
              "displayName" : "skip",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "skip",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            },
            "stateCurrent.directory" : {
              "displayName" : "stateCurrent.directory",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateCurrent.directory",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "9778838b-2e74-36b8-a9f6-6f4552227b21",
          "identifier" : "88b377b2-20ba-3787-b77a-ee69ae677a82",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CleanupTempFile",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1392.0,
            "y" : 432.0
          },
          "properties" : {
            "Filename" : "${stateCurrent.filename}",
            "Directory Path" : "${stateCurrent.directory}"
          },
          "propertyDescriptors" : {
            "Filename" : {
              "displayName" : "Filename",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Filename",
              "sensitive" : false
            },
            "Directory Path" : {
              "displayName" : "Directory Path",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory Path",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.DeleteFile",
          "yieldDuration" : "1 sec"
        } ],
        "remoteProcessGroups" : [ ],
        "scheduledState" : "ENABLED",
        "statelessFlowTimeout" : "1 min"
      } ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "8a531770-5fda-3562-936d-0ab30a500db6",
        "identifier" : "8ef11ecd-3057-3765-97c7-6c56e2067f03",
        "maxBackoffPeriod" : "10 mins",
        "name" : "TrangTiepTheo",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 808.0,
          "y" : 352.0
        },
        "properties" : {
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.page" : "${state.page:toNumber():plus(1)}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.page" : {
            "displayName" : "state.page",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.page",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "8a531770-5fda-3562-936d-0ab30a500db6",
        "identifier" : "966ba929-576a-3e7e-a51b-c538cd982701",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KhoiTao",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 24.0,
          "y" : -72.0
        },
        "properties" : {
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.page" : "1",
          "stateAdAccounts.advertiserIds.inClause" : "${stateAdAccounts.advertiserIds\n  :replaceAll('^\\\\[|\\\\]$', '')\n  :replaceAll('\"', '\\'')\n  :prepend('(')\n  :append(')')}",
          "state.pageSize" : "#{PageSizeMax}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.page" : {
            "displayName" : "state.page",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.page",
            "sensitive" : false
          },
          "stateAdAccounts.advertiserIds.inClause" : {
            "displayName" : "stateAdAccounts.advertiserIds.inClause",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.advertiserIds.inClause",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.pageSize" : {
            "displayName" : "state.pageSize",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.pageSize",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "8a531770-5fda-3562-936d-0ab30a500db6",
        "identifier" : "8d1a8f94-0064-3c8b-8108-d3f1ee42e9f7",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KiemTraCoTrangTiepTheo",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : 544.0
        },
        "properties" : {
          "Routing Strategy" : "Route to Property name",
          "nextPage" : "${state.continue:equals(1)}"
        },
        "propertyDescriptors" : {
          "Routing Strategy" : {
            "displayName" : "Routing Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Routing Strategy",
            "sensitive" : false
          },
          "nextPage" : {
            "displayName" : "nextPage",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "nextPage",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
          "id" : "1ec54c16-fc0f-30df-b856-52767be88a43",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
        "identifier" : "9890192c-645c-3316-b3b8-3389c72eb852",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
          "id" : "095b02cd-f207-3c43-a45d-0dd19f16f403",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
          "id" : "32865cfc-c665-3bcf-915f-7d21c76bf330",
          "name" : "stateBcOut",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
        "identifier" : "6babaa97-3c2f-321c-a13a-2d33c4a1cf50",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
          "id" : "095b02cd-f207-3c43-a45d-0dd19f16f403",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
          "id" : "d8954d91-e86a-3737-b374-cb02310a5425",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
        "identifier" : "e3a9990a-4eec-3cf4-9259-c088a746518e",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
          "id" : "dceccc88-5916-3bc7-a441-00d88949524d",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
          "id" : "1ec54c16-fc0f-30df-b856-52767be88a43",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
        "identifier" : "cae60a67-6a7f-3130-ad91-461d8c4692c9",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
          "id" : "f7d470df-fee6-36c7-8b07-0bfc6fb1b77d",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
          "id" : "095b02cd-f207-3c43-a45d-0dd19f16f403",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
        "identifier" : "114ce492-11aa-3b3d-a0ae-270b22134bbe",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
          "id" : "f7d470df-fee6-36c7-8b07-0bfc6fb1b77d",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
          "id" : "f7d470df-fee6-36c7-8b07-0bfc6fb1b77d",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
        "identifier" : "947bfb21-db3b-3355-bae9-7820def3b3c5",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
          "id" : "d8954d91-e86a-3737-b374-cb02310a5425",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
        "identifier" : "dceccc88-5916-3bc7-a441-00d88949524d",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LuuTrangThaiBCHienTai",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
        "identifier" : "32865cfc-c665-3bcf-915f-7d21c76bf330",
        "name" : "stateBcOut",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 1552.0,
          "y" : -154.5
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -224.0,
        "y" : 3784.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
        "identifier" : "f7d470df-fee6-36c7-8b07-0bfc6fb1b77d",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${stateBc.name}\",\n  \"isActive\": ${stateBc.isActive},\n  \"lastExecutionTime\": \"${stateBc.lastExecutionTime}\",\n  \"startTime\": \"${stateBc.startTime}\",\n  \"endTime\": \"${stateBc.endTime}\",\n  \"status\": \"${stateBc.status}\",\n  \"sequenceNumber\": \"${stateBc.sequenceNumber}\",\n  \"message\": \"${stateBc.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
        "identifier" : "1ec54c16-fc0f-30df-b856-52767be88a43",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
        "identifier" : "d8954d91-e86a-3737-b374-cb02310a5425",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "filename" : "${stateBc.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateBc.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateBc.lastExecutionTime" : {
            "displayName" : "stateBc.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateBc.lastExecutionTime",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "391780b9-4cfa-3267-b45d-ed78cb7e7481",
        "identifier" : "095b02cd-f207-3c43-a45d-0dd19f16f403",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${stateBc.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
          "id" : "fe351910-c447-388e-9287-2669f83d07f4",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
        "identifier" : "2a18d8eb-70a2-3d11-bbf0-affcb098fad3",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
          "id" : "0b6fd737-67dd-329c-b962-adb04e9607d9",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
          "id" : "0b6fd737-67dd-329c-b962-adb04e9607d9",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
        "identifier" : "8c52bd9f-fee6-386e-930c-94bcd4f7905c",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
          "id" : "7c1fe654-55f0-3cc7-9d52-180afe8a53be",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
          "id" : "c7c3349d-2beb-3dc0-ba9e-1680dee94455",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
        "identifier" : "a7859a5c-80db-30e4-a279-2129cc003400",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
          "id" : "333ba028-e4c2-3d16-b20e-e723235ec3ce",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
          "id" : "333ba028-e4c2-3d16-b20e-e723235ec3ce",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
        "identifier" : "94cc14c9-1d38-304d-97b9-99763ae16386",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
          "id" : "fe351910-c447-388e-9287-2669f83d07f4",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
          "id" : "5f4b89b8-5a07-3455-a752-671b8df31567",
          "name" : "stateOut",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
        "identifier" : "0da0ea66-b5da-353d-896c-3a428e60b83f",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
          "id" : "333ba028-e4c2-3d16-b20e-e723235ec3ce",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
          "id" : "c7c3349d-2beb-3dc0-ba9e-1680dee94455",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
        "identifier" : "4061e19d-69b1-3ad1-8e89-2d5ae3eb00bf",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
          "id" : "fe351910-c447-388e-9287-2669f83d07f4",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
        "identifier" : "7c1fe654-55f0-3cc7-9d52-180afe8a53be",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LuuTrangThaiETL",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
        "identifier" : "5f4b89b8-5a07-3455-a752-671b8df31567",
        "name" : "stateOut",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 1464.0,
          "y" : -200.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -216.0,
        "y" : 4496.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
        "identifier" : "0b6fd737-67dd-329c-b962-adb04e9607d9",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "filename" : "${state.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.lastExecutionTime" : {
            "displayName" : "state.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.lastExecutionTime",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
        "identifier" : "fe351910-c447-388e-9287-2669f83d07f4",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${state.name}\",\n  \"isActive\": ${state.isActive},\n  \"lastExecutionTime\": \"${state.lastExecutionTime}\",\n  \"startTime\": \"${state.startTime}\",\n  \"endTime\": \"${state.endTime}\",\n  \"status\": \"${state.status}\",\n  \"sequenceNumber\": \"${state.sequenceNumber}\",\n  \"message\": \"${state.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
        "identifier" : "c7c3349d-2beb-3dc0-ba9e-1680dee94455",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "34ef94ef-11f8-3de0-b746-90777c64b9f4",
        "identifier" : "333ba028-e4c2-3d16-b20e-e723235ec3ce",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${state.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
          "id" : "c3cbff74-077e-3a3a-bdfb-da5c672457e1",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
        "identifier" : "bc0b166b-fe4d-3b07-b83e-c4555897c3ae",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
          "id" : "43a82799-1374-392a-aec7-e82755cabf31",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
          "id" : "627d8137-90b5-3c37-9d8b-ab70031cbb94",
          "name" : "stateOut",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
        "identifier" : "eac4d6c7-61b0-39ee-a366-68caea25e2d1",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
          "id" : "43a82799-1374-392a-aec7-e82755cabf31",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
          "id" : "856975b7-1d26-3082-aee7-71072c7d95ca",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
        "identifier" : "602fb3e7-f1e7-33cb-9eec-14a4f8285025",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
          "id" : "2891a515-ce9e-36e5-852c-65397588f8ec",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
          "id" : "c3cbff74-077e-3a3a-bdfb-da5c672457e1",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
        "identifier" : "52d3d131-c43a-31f7-811d-981cd37fe1e3",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
          "id" : "856975b7-1d26-3082-aee7-71072c7d95ca",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
          "id" : "2891a515-ce9e-36e5-852c-65397588f8ec",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
        "identifier" : "5224194c-5ea8-3544-94aa-cf3c6af7bbad",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
          "id" : "1135ba91-51c9-38e0-ab11-0ce53bb02ec1",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
          "id" : "43a82799-1374-392a-aec7-e82755cabf31",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
        "identifier" : "904cac93-66c3-3bd8-8bd9-d0278a507025",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
          "id" : "856975b7-1d26-3082-aee7-71072c7d95ca",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
        "identifier" : "1135ba91-51c9-38e0-ab11-0ce53bb02ec1",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LuuTrangThaiETL",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
        "identifier" : "627d8137-90b5-3c37-9d8b-ab70031cbb94",
        "name" : "stateOut",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 1464.0,
          "y" : -200.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -224.0,
        "y" : 664.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
        "identifier" : "c3cbff74-077e-3a3a-bdfb-da5c672457e1",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
        "identifier" : "856975b7-1d26-3082-aee7-71072c7d95ca",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${state.name}\",\n  \"isActive\": ${state.isActive},\n  \"lastExecutionTime\": \"${state.lastExecutionTime}\",\n  \"startTime\": \"${state.startTime}\",\n  \"endTime\": \"${state.endTime}\",\n  \"status\": \"${state.status}\",\n  \"sequenceNumber\": \"${state.sequenceNumber}\",\n  \"message\": \"${state.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
        "identifier" : "2891a515-ce9e-36e5-852c-65397588f8ec",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "filename" : "${state.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.lastExecutionTime" : {
            "displayName" : "state.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.lastExecutionTime",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "a41da1b5-3808-3c4b-899d-166d9f36333e",
        "identifier" : "43a82799-1374-392a-aec7-e82755cabf31",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${state.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
          "id" : "4bf949b3-e880-32aa-9b8d-b956e25f1131",
          "name" : "TrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
        "identifier" : "5f540f16-39bd-3ad8-a7fb-ffc73c4af827",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "TrangTiep",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "nextPage" ],
        "source" : {
          "comments" : "",
          "groupId" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
          "id" : "f145692b-e82e-379c-960a-4a34f1fe069a",
          "name" : "KiemTraCoTrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "zIndex" : 6
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "id" : "77e3cac9-669d-3a29-82aa-716cf52f3bf1",
          "name" : "Input",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
        "identifier" : "dc188f66-44cf-3994-ad13-2677d4f2f1de",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
          "id" : "4bf949b3-e880-32aa-9b8d-b956e25f1131",
          "name" : "TrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "zIndex" : 7
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
          "id" : "72677135-944c-3ff0-9990-11189aef8b1f",
          "name" : "KhoiTao",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
        "identifier" : "7ba4c588-3ee8-3c49-afdf-4e76ff0fab73",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
          "id" : "f0d86be1-3f49-397f-a701-50a078c98885",
          "name" : "Input",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 11
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "id" : "77e3cac9-669d-3a29-82aa-716cf52f3bf1",
          "name" : "Input",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
        "identifier" : "c2d7d160-4690-348d-ac77-bb3a59ffd6ff",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
          "id" : "72677135-944c-3ff0-9990-11189aef8b1f",
          "name" : "KhoiTao",
          "type" : "PROCESSOR"
        },
        "zIndex" : 2
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
          "id" : "f145692b-e82e-379c-960a-4a34f1fe069a",
          "name" : "KiemTraCoTrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
        "identifier" : "6250704f-ec27-3ee2-9562-c153fe81973e",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "id" : "37939672-0cee-37b3-9b1e-b8a591ea6a3a",
          "name" : "Ouput",
          "type" : "OUTPUT_PORT"
        },
        "zIndex" : 3
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
          "id" : "20a29de0-ed94-354b-8c39-9a3b003f6393",
          "name" : "Output",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
        "identifier" : "3a3e4dc7-3c51-3711-b71d-0c41df2b28cd",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "unmatched" ],
        "source" : {
          "comments" : "",
          "groupId" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
          "id" : "f145692b-e82e-379c-960a-4a34f1fe069a",
          "name" : "KiemTraCoTrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "zIndex" : 10
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
        "identifier" : "f0d86be1-3f49-397f-a701-50a078c98885",
        "name" : "Input",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -344.0,
          "y" : -256.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "ETLBcTransactionBatch",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
        "identifier" : "20a29de0-ed94-354b-8c39-9a3b003f6393",
        "name" : "Output",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 72.0,
          "y" : 856.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -224.0,
        "y" : 2784.0
      },
      "processGroups" : [ {
        "comments" : "",
        "componentType" : "PROCESS_GROUP",
        "connections" : [ {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "bef40e46-4b3f-3179-aa9a-c5cdfda28523",
            "name" : "TransformData",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "898ef263-8c49-3dfe-8a3a-de3f1d2fb978",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "1c9b576f-a982-390c-be82-b4663964d3c9",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "zIndex" : 20
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "a514a036-163f-3c4e-acfb-8987709fad5c",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "c13a2abe-06ce-3ff4-bcf4-929ff7bf159c",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success", "failure", "not found" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "9a9c0cf9-fd29-3701-9017-3dac634384e1",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "zIndex" : 28
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "f23d9a5f-1eb8-3fae-9853-f7714b896289",
            "name" : "ChuanHoaDuLieuRaw",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "901d0321-7d4c-387e-b459-ae90626c1e00",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "1d1ef791-26c3-39d3-ab2a-96c76b980129",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "zIndex" : 5
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "a514a036-163f-3c4e-acfb-8987709fad5c",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "7f70c941-dce2-3ff3-b05c-7e4591bc818a",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "815ad431-3c7d-35bb-9c73-5514abc71f60",
            "name" : "LayDanhSachBcTransactionChuaETL",
            "type" : "PROCESSOR"
          },
          "zIndex" : 4
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "232b5208-4771-3492-bc7e-3c51e1e6064a",
            "name" : "CheckHasData",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "d2d624ea-9f31-3c7e-9ad6-d2c872baf5c8",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "f23d9a5f-1eb8-3fae-9853-f7714b896289",
            "name" : "ChuanHoaDuLieuRaw",
            "type" : "PROCESSOR"
          },
          "zIndex" : 8
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "9a9c0cf9-fd29-3701-9017-3dac634384e1",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "0858d24a-a7d5-3d0c-b56b-299679418451",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "a83dd1d5-9600-33b1-9b39-c8cba0bb28ea",
            "name" : "LayDanhSachDuLieuETLCu",
            "type" : "PROCESSOR"
          },
          "zIndex" : 19
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "76f4eb38-5ef4-3ff3-94b4-30a2ef01c6b6",
            "name" : "RouteOnAttributeCheckLastPage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "1a474b41-78ba-3d27-8c1c-05a6ae894a30",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "0699d613-3698-3abd-9e4d-4513d7bb2ef5",
            "name" : "InsertAndUpdateToDataBase",
            "type" : "PROCESSOR"
          },
          "zIndex" : 23
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "0699d613-3698-3abd-9e4d-4513d7bb2ef5",
            "name" : "InsertAndUpdateToDataBase",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "525430e4-9307-3976-a3b8-7efa239f3286",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "bef40e46-4b3f-3179-aa9a-c5cdfda28523",
            "name" : "TransformData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 21
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "a514a036-163f-3c4e-acfb-8987709fad5c",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "8ce39b76-8e57-3625-b4a1-ecacee90a054",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "NoNewData",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "unmatched" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "232b5208-4771-3492-bc7e-3c51e1e6064a",
            "name" : "CheckHasData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 10
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "id" : "9fcffc90-63c4-31c4-9d9b-77a4594fc50d",
            "name" : "stateCamBatch",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "1b14cfde-8a69-39c5-b3ae-a38fedfa6285",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "a566dc09-9845-33b5-84a3-04a36826839f",
            "name" : "SaveRawTemp",
            "type" : "PROCESSOR"
          },
          "zIndex" : 30
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "dc813a0a-7b41-37ce-b978-860439aeeb8d",
            "name" : "UpdateAttributeContinueTrue",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "e9a62a04-fbe4-32d7-9875-0b9a739e910f",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "unmatched" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "76f4eb38-5ef4-3ff3-94b4-30a2ef01c6b6",
            "name" : "RouteOnAttributeCheckLastPage",
            "type" : "PROCESSOR"
          },
          "zIndex" : 27
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "37939672-0cee-37b3-9b1e-b8a591ea6a3a",
            "name" : "Ouput",
            "type" : "OUTPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "05bf8441-5c19-3c4e-8e5d-f2dbbc8572a6",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "a514a036-163f-3c4e-acfb-8987709fad5c",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "zIndex" : 7
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "a514a036-163f-3c4e-acfb-8987709fad5c",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "f4fb0806-f32b-369d-a658-587bbe6a1090",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "a566dc09-9845-33b5-84a3-04a36826839f",
            "name" : "SaveRawTemp",
            "type" : "PROCESSOR"
          },
          "zIndex" : 14
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "815ad431-3c7d-35bb-9c73-5514abc71f60",
            "name" : "LayDanhSachBcTransactionChuaETL",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "9136a288-d16a-3e14-aa85-30f1fee031d9",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "728615ac-4aeb-3fbe-b95c-758ab6b103e5",
            "name" : "KhoiTao",
            "type" : "PROCESSOR"
          },
          "zIndex" : 2
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "1d1ef791-26c3-39d3-ab2a-96c76b980129",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "305a3741-d4f0-3d53-84f8-b82249a7f44d",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "815ad431-3c7d-35bb-9c73-5514abc71f60",
            "name" : "LayDanhSachBcTransactionChuaETL",
            "type" : "PROCESSOR"
          },
          "zIndex" : 3
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "a83dd1d5-9600-33b1-9b39-c8cba0bb28ea",
            "name" : "LayDanhSachDuLieuETLCu",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "1e512374-95a1-31ad-ac77-eebd2101be5b",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "id" : "e999c634-c7c7-3533-b5d5-c5fca197302e",
            "name" : "stateProduct",
            "type" : "OUTPUT_PORT"
          },
          "zIndex" : 31
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "37939672-0cee-37b3-9b1e-b8a591ea6a3a",
            "name" : "Ouput",
            "type" : "OUTPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "4034b132-07bf-3d61-aaf0-dd819a86cabc",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success", "failure", "not found" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "dce7434e-d3fc-326b-87cc-0c86fa6696db",
            "name" : "CleanupTemp",
            "type" : "PROCESSOR"
          },
          "zIndex" : 15
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "a514a036-163f-3c4e-acfb-8987709fad5c",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "205f1baa-28cf-300b-8467-a77abacd3338",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "f23d9a5f-1eb8-3fae-9853-f7714b896289",
            "name" : "ChuanHoaDuLieuRaw",
            "type" : "PROCESSOR"
          },
          "zIndex" : 9
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "a514a036-163f-3c4e-acfb-8987709fad5c",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "2f9455ce-8590-37dd-9446-398985a8916c",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "1d1ef791-26c3-39d3-ab2a-96c76b980129",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "zIndex" : 6
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "dce7434e-d3fc-326b-87cc-0c86fa6696db",
            "name" : "CleanupTemp",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "d0fa7666-af8b-3a1b-bf49-8067857ecb4b",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "dc813a0a-7b41-37ce-b978-860439aeeb8d",
            "name" : "UpdateAttributeContinueTrue",
            "type" : "PROCESSOR"
          },
          "zIndex" : 24
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "9a9c0cf9-fd29-3701-9017-3dac634384e1",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "ba83fc3a-6813-3f39-b74b-ce28ca30c01a",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "bef40e46-4b3f-3179-aa9a-c5cdfda28523",
            "name" : "TransformData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 22
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "9a9c0cf9-fd29-3701-9017-3dac634384e1",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "86e4f75a-9c32-3fae-8e73-54557e030f61",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "isLastPage" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "76f4eb38-5ef4-3ff3-94b4-30a2ef01c6b6",
            "name" : "RouteOnAttributeCheckLastPage",
            "type" : "PROCESSOR"
          },
          "zIndex" : 26
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "728615ac-4aeb-3fbe-b95c-758ab6b103e5",
            "name" : "KhoiTao",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "73d518dd-d81a-3037-9364-f986850b7a49",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "77e3cac9-669d-3a29-82aa-716cf52f3bf1",
            "name" : "Input",
            "type" : "INPUT_PORT"
          },
          "zIndex" : 1
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "a566dc09-9845-33b5-84a3-04a36826839f",
            "name" : "SaveRawTemp",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "c6f8dec4-eaab-320e-abb8-528876279ddf",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "hasData" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "232b5208-4771-3492-bc7e-3c51e1e6064a",
            "name" : "CheckHasData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 17
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "9a9c0cf9-fd29-3701-9017-3dac634384e1",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "25ef72d5-e560-34e9-b901-47250a4e805d",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "0699d613-3698-3abd-9e4d-4513d7bb2ef5",
            "name" : "InsertAndUpdateToDataBase",
            "type" : "PROCESSOR"
          },
          "zIndex" : 25
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "1c9b576f-a982-390c-be82-b4663964d3c9",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "260be775-33bf-382a-83c0-74aa090b3d51",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
            "id" : "a83dd1d5-9600-33b1-9b39-c8cba0bb28ea",
            "name" : "LayDanhSachDuLieuETLCu",
            "type" : "PROCESSOR"
          },
          "zIndex" : 18
        } ],
        "controllerServices" : [ ],
        "defaultBackPressureDataSizeThreshold" : "1 GB",
        "defaultBackPressureObjectThreshold" : 10000,
        "defaultFlowFileExpiration" : "0 sec",
        "executionEngine" : "INHERITED",
        "flowFileConcurrency" : "UNBOUNDED",
        "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
        "funnels" : [ ],
        "groupIdentifier" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
        "identifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
        "inputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "INPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "77e3cac9-669d-3a29-82aa-716cf52f3bf1",
          "name" : "Input",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : -136.0,
            "y" : -200.0
          },
          "scheduledState" : "ENABLED",
          "type" : "INPUT_PORT"
        } ],
        "labels" : [ ],
        "maxConcurrentTasks" : 1,
        "name" : "ETLBcTransactionBatch",
        "outputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "OUTPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "37939672-0cee-37b3-9b1e-b8a591ea6a3a",
          "name" : "Ouput",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : 472.0,
            "y" : 1008.0
          },
          "scheduledState" : "ENABLED",
          "type" : "OUTPUT_PORT"
        } ],
        "parameterContextName" : "TikTokETL",
        "position" : {
          "x" : 8.0,
          "y" : 184.0
        },
        "processGroups" : [ {
          "comments" : "",
          "componentType" : "PROCESS_GROUP",
          "connections" : [ {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "91cf2874-9ae9-3ea2-83c0-d3295b711e0f",
              "name" : "KhoiTao",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "1f622825-4c57-354a-a262-13ad350ca103",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "9fcffc90-63c4-31c4-9d9b-77a4594fc50d",
              "name" : "stateCamBatch",
              "type" : "INPUT_PORT"
            },
            "zIndex" : 1
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "e999c634-c7c7-3533-b5d5-c5fca197302e",
              "name" : "stateProduct",
              "type" : "OUTPUT_PORT"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "06ed0100-1b90-38a2-808e-980d2aa316d9",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "4be96f89-f820-3c48-b65b-ced16e43ed01",
              "name" : "ThucThiThemMoiProduct",
              "type" : "PROCESSOR"
            },
            "zIndex" : 9
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "502b7ddc-c187-3c51-9f43-ba2e982a8ce5",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "6c69d196-fe38-3958-bd99-07663f6e680e",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "has_new_product", "unmatched" ],
            "source" : {
              "comments" : "",
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "54481957-73e6-3f4e-ad0a-e667a0fdda2b",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "zIndex" : 14
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "637c9340-5968-3b9c-97fc-0589ed62c530",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "3389e3c5-1361-389a-b86a-eceee255634c",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "91cf2874-9ae9-3ea2-83c0-d3295b711e0f",
              "name" : "KhoiTao",
              "type" : "PROCESSOR"
            },
            "zIndex" : 2
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "54481957-73e6-3f4e-ad0a-e667a0fdda2b",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "fa4a647a-9163-398f-b70e-255180971500",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "637c9340-5968-3b9c-97fc-0589ed62c530",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "zIndex" : 3
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "e7d051e4-8a06-3964-8041-e52c0fb37803",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "107389bd-2d8e-387f-b541-0252b213e88b",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "502b7ddc-c187-3c51-9f43-ba2e982a8ce5",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "zIndex" : 13
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "e7d051e4-8a06-3964-8041-e52c0fb37803",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "790e4985-0ac1-346d-89ff-3c1465dad72f",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "637c9340-5968-3b9c-97fc-0589ed62c530",
              "name" : "XuLyDuLieuThemMoi",
              "type" : "PROCESSOR"
            },
            "zIndex" : 4
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "4be96f89-f820-3c48-b65b-ced16e43ed01",
              "name" : "ThucThiThemMoiProduct",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "6e416093-495e-3c39-90fb-5a945d84a2f3",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "502b7ddc-c187-3c51-9f43-ba2e982a8ce5",
              "name" : "GhiDeCauLenhSqlVaoContentFlow",
              "type" : "PROCESSOR"
            },
            "zIndex" : 12
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "e7d051e4-8a06-3964-8041-e52c0fb37803",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "6080c112-496a-375f-bd8c-b27195133a1f",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
              "id" : "4be96f89-f820-3c48-b65b-ced16e43ed01",
              "name" : "ThucThiThemMoiProduct",
              "type" : "PROCESSOR"
            },
            "zIndex" : 10
          } ],
          "controllerServices" : [ ],
          "defaultBackPressureDataSizeThreshold" : "1 GB",
          "defaultBackPressureObjectThreshold" : 10000,
          "defaultFlowFileExpiration" : "0 sec",
          "executionEngine" : "INHERITED",
          "flowFileConcurrency" : "UNBOUNDED",
          "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
          "funnels" : [ ],
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
          "inputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "INPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "9fcffc90-63c4-31c4-9d9b-77a4594fc50d",
            "name" : "stateCamBatch",
            "portFunction" : "STANDARD",
            "position" : {
              "x" : -560.0,
              "y" : -192.0
            },
            "scheduledState" : "ENABLED",
            "type" : "INPUT_PORT"
          } ],
          "labels" : [ ],
          "maxConcurrentTasks" : 1,
          "name" : "LayHoacThemMoiTransactionPaymentPort",
          "outputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "OUTPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "e999c634-c7c7-3533-b5d5-c5fca197302e",
            "name" : "stateProduct",
            "portFunction" : "STANDARD",
            "position" : {
              "x" : 2032.0,
              "y" : -176.0
            },
            "scheduledState" : "ENABLED",
            "type" : "OUTPUT_PORT"
          } ],
          "parameterContextName" : "TikTokETL",
          "position" : {
            "x" : 2960.0,
            "y" : -224.0
          },
          "processGroups" : [ ],
          "processors" : [ {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-scripting-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "502b7ddc-c187-3c51-9f43-ba2e982a8ce5",
            "maxBackoffPeriod" : "10 mins",
            "name" : "GhiDeCauLenhSqlVaoContentFlow",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 968.0,
              "y" : 56.0
            },
            "properties" : {
              "Script Engine" : "Groovy",
              "Script Body" : "import groovy.json.JsonSlurper\nimport org.apache.commons.io.IOUtils\nimport java.nio.charset.StandardCharsets\nimport org.apache.nifi.processor.io.StreamCallback\n\ndef flowFile = session.get()\nif (!flowFile) return\n\nflowFile = session.write(flowFile, { inputStream, outputStream ->\n    def jsonText = IOUtils.toString(inputStream, StandardCharsets.UTF_8)\n    def obj = new JsonSlurper().parseText(jsonText)\n\n    def parts = []\n    if (obj.sqlUpdate && obj.sqlUpdate.toString().trim()) parts << obj.sqlUpdate.toString().trim()\n    if (obj.sqlInsert && obj.sqlInsert.toString().trim()) parts << obj.sqlInsert.toString().trim()\n\n    def sql = parts.join(\"\\n\")\n    outputStream.write(sql.getBytes(StandardCharsets.UTF_8))\n} as StreamCallback)\n\nsession.transfer(flowFile, REL_SUCCESS)"
            },
            "propertyDescriptors" : {
              "Script File" : {
                "displayName" : "Script File",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script File",
                "resourceDefinition" : {
                  "cardinality" : "SINGLE",
                  "resourceTypes" : [ "FILE" ]
                },
                "sensitive" : false
              },
              "Script Engine" : {
                "displayName" : "Script Engine",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Engine",
                "sensitive" : false
              },
              "Script Body" : {
                "displayName" : "Script Body",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Body",
                "sensitive" : false
              },
              "Module Directory" : {
                "displayName" : "Module Directory",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Module Directory",
                "resourceDefinition" : {
                  "cardinality" : "MULTIPLE",
                  "resourceTypes" : [ "FILE", "DIRECTORY" ]
                },
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.script.ExecuteScript",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "91cf2874-9ae9-3ea2-83c0-d3295b711e0f",
            "maxBackoffPeriod" : "10 mins",
            "name" : "KhoiTao",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : -216.0,
              "y" : -232.0
            },
            "properties" : {
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100"
            },
            "propertyDescriptors" : {
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "54481957-73e6-3f4e-ad0a-e667a0fdda2b",
            "maxBackoffPeriod" : "10 mins",
            "name" : "RouteOnAttribute",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 976.0,
              "y" : -248.0
            },
            "properties" : {
              "Routing Strategy" : "Route to Property name",
              "has_new_product" : "${product.new.count:gt(0)}"
            },
            "propertyDescriptors" : {
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              },
              "has_new_product" : {
                "displayName" : "has_new_product",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "has_new_product",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "success" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "e7d051e4-8a06-3964-8041-e52c0fb37803",
            "maxBackoffPeriod" : "10 mins",
            "name" : "LogMessage",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 968.0,
              "y" : 456.0
            },
            "properties" : {
              "log-level" : "info"
            },
            "propertyDescriptors" : {
              "log-message" : {
                "displayName" : "Log message",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-message",
                "sensitive" : false
              },
              "log-level" : {
                "displayName" : "Log Level",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-level",
                "sensitive" : false
              },
              "log-prefix" : {
                "displayName" : "Log prefix",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-prefix",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.LogMessage",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-scripting-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "637c9340-5968-3b9c-97fc-0589ed62c530",
            "maxBackoffPeriod" : "10 mins",
            "name" : "XuLyDuLieuThemMoi",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 232.0,
              "y" : -232.0
            },
            "properties" : {
              "Script Engine" : "Groovy",
              "Script Body" : "import org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport groovy.json.JsonOutput\nimport java.io.File\n\ndef flowFile = session.get()\nif (!flowFile) return\n\ndef sqlQuoteN = { String s ->\n    def t = (s == null) ? \"\" : s.replace(\"'\", \"''\")\n    return \"N'${t}'\"\n}\ndef strOrEmpty = { Object v -> v == null ? \"\" : v.toString().trim() }\n\ntry {\n    def rawPath = flowFile.getAttribute(\"stateCurrent.fullPath\")\n    if (!rawPath) {\n        def msg = \"Missing attribute: stateCurrent.fullPath\"\n        log.error(msg)\n        flowFile = session.putAttribute(flowFile, \"error.message\", msg)\n        session.transfer(flowFile, REL_FAILURE)\n        return\n    }\n\n    // ----- Load RAW -----\n    def rawList = []\n    def f = new File(rawPath)\n    if (f.exists()) {\n        def txt = f.getText(StandardCharsets.UTF_8.name())\n        def parsed = new JsonSlurper().parseText(txt)\n        rawList = (parsed instanceof List) ? parsed : [parsed]\n    } else {\n        log.warn(\"RAW file not found: ${rawPath}\")\n    }\n\n    // Unique PID + Name\n    def pids = new LinkedHashSet<String>()\n    def pidNameMap = [:] as Map<String,String>\n    rawList.each { rObj ->\n        def r = rObj as Map\n        def pid  = strOrEmpty(r.get(\"PaymentPortfolioId\"))\n        def name = strOrEmpty(r.get(\"PaymentPortfolioName\"))\n        if (pid) {\n            pids.add(pid)\n            if (name) pidNameMap[pid] = name\n        }\n    }\n\n    // ----- CTE VALUES -----\n    String cteValues\n    if (pids.isEmpty()) {\n        cteValues = \"SELECT CAST(NULL AS NVARCHAR(200)) AS [PaymentPortfolioId], CAST(NULL AS NVARCHAR(500)) AS [PaymentPortfolioName] WHERE 1=0\"\n    } else {\n        def valuesRows = pids.collect { pid ->\n            def name = pidNameMap.containsKey(pid) ? pidNameMap[pid] : null\n            \"(\" + sqlQuoteN(pid) + \", \" + (name == null ? \"NULL\" : sqlQuoteN(name)) + \")\"\n        }.join(\",\\n        \")\n        cteValues = \"SELECT v.[PaymentPortfolioId], v.[PaymentPortfolioName]\\nFROM (VALUES\\n        ${valuesRows}\\n) AS v([PaymentPortfolioId],[PaymentPortfolioName])\"\n    }\n\n    def DEFAULT_GUID = '00000000-0000-0000-0000-000000000000'\n\n    // ----- INSERT  -----\n    def sbInsert = new StringBuilder()\n    sbInsert.append(\"\"\"\nIF NOT EXISTS (SELECT 1 FROM dbo.Dim_DimTransactionPaymentPort WHERE Id='${DEFAULT_GUID}')\nBEGIN\n    INSERT INTO dbo.Dim_DimTransactionPaymentPort\n        (Id, PaymentPortfolioId, PaymentPortfolioName, IsActive, RowVersion, CreationTime, CreatorId)\n    VALUES ('${DEFAULT_GUID}', N'', NULL, 1, 0, SYSUTCDATETIME(), NULL);\nEND;\n\n-- Xc nh CreatorId nullable  chn gi tr ph hp\nDECLARE @CreatorIdIsNullable bit =\n(SELECT c.is_nullable\n   FROM sys.columns c\n  WHERE c.object_id = OBJECT_ID(N'dbo.Dim_DimTransactionPaymentPort')\n    AND c.name = N'CreatorId');\n\nDECLARE @CreatorIdValue uniqueidentifier =\n    CASE WHEN @CreatorIdIsNullable = 1 THEN NULL ELSE '${DEFAULT_GUID}' END;\n\n;WITH rawp AS (\n    ${cteValues}\n),\nsrc AS (\n    SELECT DISTINCT\n           LTRIM(RTRIM([PaymentPortfolioId])) AS [PaymentPortfolioId],\n           NULLIF(LTRIM(RTRIM([PaymentPortfolioName])), N'') AS [PaymentPortfolioName]\n    FROM rawp\n    WHERE [PaymentPortfolioId] IS NOT NULL AND LTRIM(RTRIM([PaymentPortfolioId])) <> N''\n)\nINSERT INTO dbo.Dim_DimTransactionPaymentPort\n    (Id, PaymentPortfolioId, PaymentPortfolioName, IsActive, EffectiveDate, ExpirationDate, RowVersion, CreationTime, CreatorId)\nSELECT NEWID(),\n       s.PaymentPortfolioId,\n       s.PaymentPortfolioName,        -- nu khng c tn -> NULL\n       1,\n       NULL,                          -- EffectiveDate\n       NULL,                          -- ExpirationDate\n       0,                             -- RowVersion\n       SYSUTCDATETIME(),\n       @CreatorIdValue\nFROM src s\nLEFT JOIN dbo.Dim_DimTransactionPaymentPort d\n  ON d.PaymentPortfolioId = s.PaymentPortfolioId\nWHERE d.Id IS NULL;\n\"\"\".trim())\n\n    String sqlInsert = sbInsert.toString()\n\n    // ----- UPDATE (ch cp nht khi c tn mi; khng p Unknown) -----\n    def sbUpdate = new StringBuilder()\n    sbUpdate.append(\"\"\"\n;WITH src AS (\n    ${cteValues}\n),\nagg AS (\n    SELECT\n        LTRIM(RTRIM([PaymentPortfolioId])) AS [PaymentPortfolioId],\n        NULLIF(MAX(NULLIF(LTRIM(RTRIM([PaymentPortfolioName])), N'')), NULL) AS [PaymentPortfolioName]\n    FROM src\n    WHERE [PaymentPortfolioId] IS NOT NULL AND LTRIM(RTRIM([PaymentPortfolioId])) <> N''\n    GROUP BY LTRIM(RTRIM([PaymentPortfolioId]))\n)\nUPDATE d\n   SET d.PaymentPortfolioName = a.PaymentPortfolioName,\n       d.RowVersion           = d.RowVersion + 1\nFROM dbo.Dim_DimTransactionPaymentPort d\nJOIN agg a\n  ON a.PaymentPortfolioId = d.PaymentPortfolioId\nWHERE a.PaymentPortfolioName IS NOT NULL\n  AND (d.PaymentPortfolioName IS NULL OR d.PaymentPortfolioName <> a.PaymentPortfolioName);\n\"\"\".trim())\n\n    String sqlUpdate = sbUpdate.toString()\n\n    // ----- Output -----\n    def result = [\n        rawCount   : rawList.size(),\n        uniquePids : pids.size(),\n        sqlInsert  : sqlInsert,\n        sqlUpdate  : sqlUpdate\n    ]\n    def outJson = JsonOutput.prettyPrint(JsonOutput.toJson(result))\n\n    flowFile = session.write(flowFile, { _, os ->\n        os.write(outJson.getBytes(StandardCharsets.UTF_8))\n    } as StreamCallback)\n\n    flowFile = session.putAttribute(flowFile, \"dim.portfolio.unique.count\", String.valueOf(pids.size()))\n    flowFile = session.putAttribute(flowFile, \"sql.update.included\", \"1\")\n    log.info(\"Backfill Dim_DimTransactionPaymentPort SQL generated (NULL when name missing). uniquePids=${pids.size()}\")\n    session.transfer(flowFile, REL_SUCCESS)\n\n} catch (Throwable t) {\n    log.error(\"Generate Dim_DimTransactionPaymentPort SQL failed\", t)\n    flowFile = session.putAttribute(flowFile, \"error.message\", t.getMessage())\n    session.transfer(flowFile, REL_FAILURE)\n}"
            },
            "propertyDescriptors" : {
              "Script File" : {
                "displayName" : "Script File",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script File",
                "resourceDefinition" : {
                  "cardinality" : "SINGLE",
                  "resourceTypes" : [ "FILE" ]
                },
                "sensitive" : false
              },
              "Script Engine" : {
                "displayName" : "Script Engine",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Engine",
                "sensitive" : false
              },
              "Script Body" : {
                "displayName" : "Script Body",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Script Body",
                "sensitive" : false
              },
              "Module Directory" : {
                "displayName" : "Module Directory",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Module Directory",
                "resourceDefinition" : {
                  "cardinality" : "MULTIPLE",
                  "resourceTypes" : [ "FILE", "DIRECTORY" ]
                },
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.script.ExecuteScript",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "retry" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "07e38864-ff01-38f6-93fb-1df6d2f0e66a",
            "identifier" : "4be96f89-f820-3c48-b65b-ced16e43ed01",
            "maxBackoffPeriod" : "10 mins",
            "name" : "ThucThiThemMoiProduct",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 1600.0,
              "y" : 72.0
            },
            "properties" : {
              "Support Fragmented Transactions" : "false",
              "Batch Size" : "#{PageSizeMax}",
              "Obtain Generated Keys" : "false",
              "JDBC Connection Pool" : "7d601288-eb00-3fcc-934d-d5e3c37f2cfc",
              "database-session-autocommit" : "true",
              "rollback-on-failure" : "false"
            },
            "propertyDescriptors" : {
              "Support Fragmented Transactions" : {
                "displayName" : "Support Fragmented Transactions",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Support Fragmented Transactions",
                "sensitive" : false
              },
              "putsql-sql-statement" : {
                "displayName" : "SQL Statement",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "putsql-sql-statement",
                "sensitive" : false
              },
              "Transaction Timeout" : {
                "displayName" : "Transaction Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Transaction Timeout",
                "sensitive" : false
              },
              "Batch Size" : {
                "displayName" : "Batch Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Batch Size",
                "sensitive" : false
              },
              "Obtain Generated Keys" : {
                "displayName" : "Obtain Generated Keys",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Obtain Generated Keys",
                "sensitive" : false
              },
              "JDBC Connection Pool" : {
                "displayName" : "JDBC Connection Pool",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "JDBC Connection Pool",
                "sensitive" : false
              },
              "database-session-autocommit" : {
                "displayName" : "Database Session AutoCommit",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "database-session-autocommit",
                "sensitive" : false
              },
              "rollback-on-failure" : {
                "displayName" : "Rollback On Failure",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "rollback-on-failure",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.PutSQL",
            "yieldDuration" : "1 sec"
          } ],
          "remoteProcessGroups" : [ ],
          "scheduledState" : "ENABLED",
          "statelessFlowTimeout" : "1 min"
        } ],
        "processors" : [ {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "a514a036-163f-3c4e-acfb-8987709fad5c",
          "maxBackoffPeriod" : "10 mins",
          "name" : "UpdateAttributeContinueFalse",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 432.0,
            "y" : 480.0
          },
          "properties" : {
            "state.continue" : "0",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100"
          },
          "propertyDescriptors" : {
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "state.continue" : {
              "displayName" : "state.continue",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.continue",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "76f4eb38-5ef4-3ff3-94b4-30a2ef01c6b6",
          "maxBackoffPeriod" : "10 mins",
          "name" : "RouteOnAttributeCheckLastPage",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1928.0,
            "y" : 936.0
          },
          "properties" : {
            "Routing Strategy" : "Route to Property name",
            "isLastPage" : "${lastPage:equals('1')}"
          },
          "propertyDescriptors" : {
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "isLastPage" : {
              "displayName" : "isLastPage",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "isLastPage",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "retry" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "0699d613-3698-3abd-9e4d-4513d7bb2ef5",
          "maxBackoffPeriod" : "10 mins",
          "name" : "InsertAndUpdateToDataBase",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2944.0,
            "y" : 944.0
          },
          "properties" : {
            "Support Fragmented Transactions" : "false",
            "Batch Size" : "#{PageSizeMax}",
            "Obtain Generated Keys" : "false",
            "JDBC Connection Pool" : "7d601288-eb00-3fcc-934d-d5e3c37f2cfc",
            "database-session-autocommit" : "true",
            "rollback-on-failure" : "false"
          },
          "propertyDescriptors" : {
            "Support Fragmented Transactions" : {
              "displayName" : "Support Fragmented Transactions",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Support Fragmented Transactions",
              "sensitive" : false
            },
            "putsql-sql-statement" : {
              "displayName" : "SQL Statement",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "putsql-sql-statement",
              "sensitive" : false
            },
            "Transaction Timeout" : {
              "displayName" : "Transaction Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Transaction Timeout",
              "sensitive" : false
            },
            "Batch Size" : {
              "displayName" : "Batch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Batch Size",
              "sensitive" : false
            },
            "Obtain Generated Keys" : {
              "displayName" : "Obtain Generated Keys",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Obtain Generated Keys",
              "sensitive" : false
            },
            "JDBC Connection Pool" : {
              "displayName" : "JDBC Connection Pool",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "JDBC Connection Pool",
              "sensitive" : false
            },
            "database-session-autocommit" : {
              "displayName" : "Database Session AutoCommit",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "database-session-autocommit",
              "sensitive" : false
            },
            "rollback-on-failure" : {
              "displayName" : "Rollback On Failure",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "rollback-on-failure",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.PutSQL",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "dc813a0a-7b41-37ce-b978-860439aeeb8d",
          "maxBackoffPeriod" : "10 mins",
          "name" : "UpdateAttributeContinueTrue",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1504.0,
            "y" : 928.0
          },
          "properties" : {
            "state.continue" : "1",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100"
          },
          "propertyDescriptors" : {
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "state.continue" : {
              "displayName" : "state.continue",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.continue",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "failure" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "1c9b576f-a982-390c-be82-b4663964d3c9",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ConvertRecord",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2936.0,
            "y" : 360.0
          },
          "properties" : {
            "Include Zero Record FlowFiles" : "true",
            "Record Writer" : "422d4040-1ece-3a3f-b19c-f301d2c4bdce",
            "Record Reader" : "e99b4c7b-99a5-3c61-a9fb-3523c60d9b83"
          },
          "propertyDescriptors" : {
            "Include Zero Record FlowFiles" : {
              "displayName" : "Include Zero Record FlowFiles",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Include Zero Record FlowFiles",
              "sensitive" : false
            },
            "Record Writer" : {
              "displayName" : "Record Writer",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Writer",
              "sensitive" : false
            },
            "Record Reader" : {
              "displayName" : "Record Reader",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Reader",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ConvertRecord",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "dce7434e-d3fc-326b-87cc-0c86fa6696db",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CleanupTemp",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 992.0,
            "y" : 952.0
          },
          "properties" : {
            "Filename" : "${stateCurrent.filename}",
            "Directory Path" : "${stateCurrent.directory}"
          },
          "propertyDescriptors" : {
            "Filename" : {
              "displayName" : "Filename",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Filename",
              "sensitive" : false
            },
            "Directory Path" : {
              "displayName" : "Directory Path",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory Path",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.DeleteFile",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "1d1ef791-26c3-39d3-ab2a-96c76b980129",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ConvertRecord",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1008.0,
            "y" : -208.0
          },
          "properties" : {
            "Include Zero Record FlowFiles" : "true",
            "Record Writer" : "422d4040-1ece-3a3f-b19c-f301d2c4bdce",
            "Record Reader" : "e99b4c7b-99a5-3c61-a9fb-3523c60d9b83"
          },
          "propertyDescriptors" : {
            "Include Zero Record FlowFiles" : {
              "displayName" : "Include Zero Record FlowFiles",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Include Zero Record FlowFiles",
              "sensitive" : false
            },
            "Record Writer" : {
              "displayName" : "Record Writer",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Writer",
              "sensitive" : false
            },
            "Record Reader" : {
              "displayName" : "Record Reader",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Reader",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ConvertRecord",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "815ad431-3c7d-35bb-9c73-5514abc71f60",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LayDanhSachBcTransactionChuaETL",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 608.0,
            "y" : -208.0
          },
          "properties" : {
            "esql-max-rows" : "0",
            "dbf-default-precision" : "10",
            "Max Wait Time" : "0 seconds",
            "SQL Query" : "SELECT TOP (${state.pageSize})\n       r.[Id],\n       r.[BcId],\n       r.[PaymentPortfolioId],\n       r.[TransactionId],\n       r.[Amount],\n       r.[Subtotal],\n       r.[TaxAmount],\n       r.[Currency],\n       r.[AmountType],\n       r.[TransactionType],\n       r.[BillingType],\n       r.[Timezone],\n       r.[CreateTime],\n       r.[InvoiceId],\n       r.[SerialNumber],\n       r.[CreationTime],\n       r.[CreatorId],\n       r.[LastModificationTime],\n       r.[LastModifierId]\nFROM dbo.[Raw_RawTransactions] r\nWHERE r.[BcId] = '${stateBc.id}'\n  -- BC transaction: AccountId khng c gi tr\n  AND (r.[AccountId] IS NULL OR LTRIM(RTRIM(r.[AccountId])) = '')\n  AND NOT EXISTS (\n      SELECT 1\n      FROM dbo.[Fact_FactTransactions] f\n      WHERE f.[Type] = 'BusinessCenter'\n        AND f.[EntityId] = r.[BcId]\n        AND f.[TransactionId] = r.[TransactionId]\n        AND ISNULL(NULLIF(f.[PaymentPortfolioId], N''), N'__NULL__')\n            = ISNULL(r.[PaymentPortfolioId], N'__NULL__')\n        AND f.[Date]     = r.[CreateTime]      -- datetime2(7) khp tuyt i\n  )\nORDER BY r.[CreateTime] DESC, r.[Id] DESC;",
            "Database Connection Pooling Service" : "7d601288-eb00-3fcc-934d-d5e3c37f2cfc",
            "esql-auto-commit" : "true",
            "dbf-user-logical-types" : "false",
            "dbf-default-scale" : "0",
            "compression-format" : "NONE",
            "esql-output-batch-size" : "0",
            "esql-fetch-size" : "0",
            "dbf-normalize" : "false",
            "Content Output Strategy" : "EMPTY"
          },
          "propertyDescriptors" : {
            "esql-max-rows" : {
              "displayName" : "Max Rows Per Flow File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-max-rows",
              "sensitive" : false
            },
            "dbf-default-precision" : {
              "displayName" : "Default Decimal Precision",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-precision",
              "sensitive" : false
            },
            "Max Wait Time" : {
              "displayName" : "Max Wait Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Max Wait Time",
              "sensitive" : false
            },
            "SQL Query" : {
              "displayName" : "SQL Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "SQL Query",
              "sensitive" : false
            },
            "Database Connection Pooling Service" : {
              "displayName" : "Database Connection Pooling Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Database Connection Pooling Service",
              "sensitive" : false
            },
            "sql-post-query" : {
              "displayName" : "SQL Post-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-post-query",
              "sensitive" : false
            },
            "esql-auto-commit" : {
              "displayName" : "Set Auto Commit",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-auto-commit",
              "sensitive" : false
            },
            "dbf-user-logical-types" : {
              "displayName" : "Use Avro Logical Types",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-user-logical-types",
              "sensitive" : false
            },
            "dbf-default-scale" : {
              "displayName" : "Default Decimal Scale",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-scale",
              "sensitive" : false
            },
            "sql-pre-query" : {
              "displayName" : "SQL Pre-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-pre-query",
              "sensitive" : false
            },
            "compression-format" : {
              "displayName" : "Compression Format",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "compression-format",
              "sensitive" : false
            },
            "esql-output-batch-size" : {
              "displayName" : "Output Batch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-output-batch-size",
              "sensitive" : false
            },
            "esql-fetch-size" : {
              "displayName" : "Fetch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-fetch-size",
              "sensitive" : false
            },
            "dbf-normalize" : {
              "displayName" : "Normalize Table/Column Names",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-normalize",
              "sensitive" : false
            },
            "Content Output Strategy" : {
              "displayName" : "Content Output Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Content Output Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-groovyx-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "f23d9a5f-1eb8-3fae-9853-f7714b896289",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ChuanHoaDuLieuRaw",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1416.0,
            "y" : -192.0
          },
          "properties" : {
            "groovyx-script-body" : "import org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport java.time.LocalDate\nimport java.time.LocalDateTime\nimport java.time.format.DateTimeFormatter\nimport java.time.format.DateTimeFormatterBuilder\nimport java.time.temporal.ChronoField\n\ndef flowFile = session.get()\nif (!flowFile) return\n\ndef hasData = false\ndef minDate = ''\ndef maxDate = ''\ndef lastPage = '0' // mc nh\n\n// Helper parse Date linh hot -> LocalDate\ndef parseToLocalDate = { String s ->\n    if (s == null) return null\n    def t = s.trim()\n    // yyyy-MM-dd\n    try { return LocalDate.parse(t, DateTimeFormatter.ISO_LOCAL_DATE) } catch (ignored) {}\n    // yyyy-MM-dd HH:mm:ss[.fraction] hoc ISO vi 'T'\n    def s2 = t.replace('T', 'T').replaceAll('[Zz]$', '')\n    try {\n        def dtf = new DateTimeFormatterBuilder()\n            .appendPattern(\"yyyy-MM-dd['T'][' ']HH:mm:ss\")\n            .optionalStart().appendLiteral('.').optionalEnd()\n            .optionalStart().appendFraction(ChronoField.NANO_OF_SECOND, 1, 9, false).optionalEnd()\n            .toFormatter()\n        return LocalDateTime.parse(t.replace(' ', 'T').replaceAll('[Zz]$', ''), dtf).toLocalDate()\n    } catch (ignored) {}\n    return null\n}\n\n// Ly pageSize t attribute\ndef pageSizeAttr = flowFile.getAttribute(\"state.pageSize\") ?: \"0\"\ndef pageSize = 0\ntry { pageSize = pageSizeAttr.toInteger() } catch (ignored) { pageSize = 0 }\n\nflowFile = session.write(flowFile, { inputStream, outputStream ->\n    def content = inputStream.getText(StandardCharsets.UTF_8.name())\n    // gi nguyn content\n    outputStream.write(content.getBytes(StandardCharsets.UTF_8))\n\n    def json = new JsonSlurper().parseText(content)\n    if (!(json instanceof List)) json = [json]\n\n    hasData = !json.isEmpty()\n\n    if (hasData) {\n        // === TNH MIN/MAX THEO TRNG Date (a v yyyy-MM-dd) ===\n        def dates = json*.Date\n            .findAll { it != null }\n            .collect { parseToLocalDate(it.toString()) }\n            .findAll { it != null }\n\n        if (!dates.isEmpty()) {\n            minDate = dates.min().toString()  // yyyy-MM-dd\n            maxDate = dates.max().toString()  // yyyy-MM-dd\n        }\n\n        // === NH DU TRANG CUI ===\n        if (pageSize > 0 && json.size() < pageSize) lastPage = '1'\n    }\n} as StreamCallback)\n\n// Chun b attributes a ra (ti gin)\ndef attrs = [\n    'hasData' : hasData.toString(),\n    'minDate' : minDate,\n    'maxDate' : maxDate,\n    'lastPage': lastPage\n]\n\n// Gn thm cc thuc tnh stateCurrent.* nu c d liu\nif (hasData) {\n    attrs['stateCurrent.minDate'] = (minDate ?: '')\n    attrs['stateCurrent.maxDate'] = (maxDate ?: '')\n}\n\nflowFile = session.putAllAttributes(flowFile, attrs)\nsession.transfer(flowFile, REL_SUCCESS)",
            "groovyx-failure-strategy" : "rollback"
          },
          "propertyDescriptors" : {
            "groovyx-script-body" : {
              "displayName" : "Script Body",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-body",
              "sensitive" : false
            },
            "groovyx-failure-strategy" : {
              "displayName" : "Failure strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-failure-strategy",
              "sensitive" : false
            },
            "groovyx-additional-classpath" : {
              "displayName" : "Additional classpath",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-additional-classpath",
              "sensitive" : false
            },
            "groovyx-script-file" : {
              "displayName" : "Script File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-file",
              "resourceDefinition" : {
                "cardinality" : "SINGLE",
                "resourceTypes" : [ "FILE" ]
              },
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.groovyx.ExecuteGroovyScript",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-groovyx-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "bef40e46-4b3f-3179-aa9a-c5cdfda28523",
          "maxBackoffPeriod" : "10 mins",
          "name" : "TransformData",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2944.0,
            "y" : 664.0
          },
          "properties" : {
            "groovyx-script-body" : "import org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport java.time.LocalDateTime\nimport java.time.format.DateTimeFormatter\nimport java.time.format.DateTimeFormatterBuilder\nimport java.time.temporal.ChronoField\nimport java.util.UUID\nimport java.io.File\n\n// ================= Utils =================\ndef toDimDateId(String isoDateTime) {\n    def d = (isoDateTime ?: \"\").trim()\n    if (!d) return null\n    def day = d.substring(0, 10) // yyyy-MM-dd\n    return day.replace(\"-\", \"\").toInteger() // yyyyMMdd\n}\n\n// Chun ha ISO (thm phn thp phn ti 7 ch s)\ndef normalizeIso(String dateStr) {\n    def t = (dateStr ?: \"\").trim().replace(' ', 'T')\n    if (!t) return null\n    def parser = new DateTimeFormatterBuilder()\n        .appendPattern(\"yyyy-MM-dd'T'HH:mm:ss\")\n        .optionalStart().appendFraction(ChronoField.NANO_OF_SECOND, 1, 7, true).optionalEnd()\n        .toFormatter()\n    def dt = LocalDateTime.parse(t, parser)\n    return dt.format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss.SSSSSSS\"))\n}\n\n// Escape 1 du nhy n\ndef esc(String s) { (s == null) ? null : s.replace(\"'\", \"''\") }\n\n// NVARCHAR/VARCHAR quoting\ndef q(Object v)  { v == null ? \"NULL\" : \"N'${esc(v.toString())}'\" }\ndef qv(Object v) { v == null ? \"NULL\" : \"'${esc(v.toString())}'\" }\n\n// Numeric gi nguyn/NULL\ndef dec(Object v) {\n    if (v == null) return \"NULL\"\n    def s = v.toString().trim()\n    return s == \"\" ? \"NULL\" : s\n}\n\n// now UTC (SQL expr)\ndef sqlNow() { \"SYSUTCDATETIME()\" }\n\n// ISO string -> datetime2(7) (SQL expr)\ndef safeIsoToSqlDate(Object v) {\n    def iso = normalizeIso(v?.toString())\n    return iso ? \"CONVERT(datetime2(7), ${qv(iso)}, 126)\" : \"NULL\"\n}\n\n// NOT NULL s: fallback 0.0 / 0\ndef dec0(Object v){ def x = dec(v); x == \"NULL\" ? \"0.0\" : x }\ndef int0(Object v){ def x = dec(v); x == \"NULL\" ? \"0\"   : x }\n\n// ================= Main =================\ndef flowFile = session.get()\nif (!flowFile) return\n\n// ---- Attributes t flow ----\ndef rawPath  = flowFile.getAttribute('stateCurrent.fullPath') // ng dn JSON RAW  lu\ndef dimBcId  = flowFile.getAttribute('stateBc.dimId')         // GUID (DimBusinessCenterId)\ndef bcId     = flowFile.getAttribute('stateBc.id')            // EntityId (string)\ndef entityName = flowFile.getAttribute('stateBc.name')\nif (!entityName?.trim()) entityName = bcId\n\n// ---- Load RAW list (JSON) ----\ndef rawList = []\nif (rawPath) {\n    def f = new File(rawPath)\n    if (f.exists()) {\n        def txt = f.getText(StandardCharsets.UTF_8.name())\n        def parsed = new JsonSlurper().parseText(txt)\n        rawList = (parsed instanceof List) ? parsed : [parsed]\n    }\n}\n\n// ---- Load FACT snapshot  ----\ndef factRows = []\nflowFile = session.write(flowFile, { inp, out ->\n    def content = inp.getText(StandardCharsets.UTF_8.name())\n    if (content?.trim()) {\n        def parsed = new JsonSlurper().parseText(content)\n        factRows = (parsed instanceof List) ? parsed : [parsed]\n        out.write(content.getBytes(StandardCharsets.UTF_8))\n    } else {\n        out.write(\"[]\".getBytes(StandardCharsets.UTF_8))\n    }\n} as StreamCallback)\n\n// ---- factMap: KEY = BcId|PaymentPortfolioId|TransactionId|Date(ISO7) ----\ndef factMap = [:]\nfactRows.each { f ->\n    def isoDate = normalizeIso(f?.Date)\n    def key = [\n        (bcId ?: (f?.EntityId ?: \"\")).toString().trim(),\n        (f?.PaymentPortfolioId ?: \"__NULL__\").toString(),\n        (f?.TransactionId ?: \"\").toString(),\n        (isoDate ?: \"\")\n    ].join(\"|\")\n    factMap[key] = f\n}\n\n// ---- Lc RAW ch ly transaction BC (AccountId trng) ----\nrawList = rawList.findAll { (it?.AccountId ?: \"\").toString().trim() == \"\" }\n\n// ---- DEDUP RAW theo cng KEY, chn bn mi hn ----\ndef newer = { a, b ->\n    def da = a?.CreateTime ? normalizeIso(a.CreateTime) : null\n    def db = b?.CreateTime ? normalizeIso(b.CreateTime) : null\n    if (da && db && da != db) return da > db\n    (a?.Id?.toString() ?: \"\") > (b?.Id?.toString() ?: \"\")\n}\ndef dedup = [:]\nrawList.each { r ->\n    def isoDate = normalizeIso(r?.CreateTime)\n    def key = [\n        (bcId ?: r?.BcId ?: \"\").toString().trim(),\n        (r?.PaymentPortfolioId ?: \"__NULL__\").toString(),\n        (r?.TransactionId ?: \"\").toString(),\n        (isoDate ?: \"\")\n    ].join(\"|\")\n    def cur = dedup[key]\n    if (cur == null || newer(r, cur)) dedup[key] = r\n}\nrawList = dedup.values().toList()\n\n// ---- Phn loi INSERT / UPDATE da vo KEY trong factMap ----\ndef inserts = []; def updates = []\nrawList.each { r ->\n    def isoDate = normalizeIso(r?.CreateTime)\n    def key = [\n        (bcId ?: r?.BcId ?: \"\").toString().trim(),\n        (r?.PaymentPortfolioId ?: \"__NULL__\").toString(),\n        (r?.TransactionId ?: \"\").toString(),\n        (isoDate ?: \"\")\n    ].join(\"|\")\n    def existing = factMap[key]\n    if (existing == null) inserts << r else updates << [raw: r, existing: existing]\n}\n\n// ---- Resolve FK DimTransactionPaymentPortId (lookup Dim, fallback all-zero) ----\ndef DEFAULT_GUID = \"00000000-0000-0000-0000-000000000000\"\ndef dimPortExpr = { String pid ->\n    def p = (pid ?: \"\").trim()\n    if (p == \"\") {\n        return \"'${DEFAULT_GUID}'\"\n    } else {\n        return \"\"\"COALESCE(\n    (SELECT TOP 1 [Id] FROM dbo.[Dim_DimTransactionPaymentPort] WITH (NOLOCK)\n     WHERE [PaymentPortfolioId] = N'${esc(p)}'),\n    '${DEFAULT_GUID}'\n)\"\"\"\n    }\n}\n\n// ================= Build SQL =================\n\n// ---- INSERT VALUES ----\ndef insertValues = inserts.collect { r ->\n    def isoDate   = normalizeIso(r?.CreateTime)\n    def dimDateId = toDimDateId(isoDate)\n    def currency  = (r?.Currency ?: null)\n    def isUSD = (currency == 'USD')\n    def isVND = (currency == 'VND')\n    def id = UUID.randomUUID().toString()\n    def dimPort = dimPortExpr(r?.PaymentPortfolioId)\n\n    \"\"\"(\n${qv(id)},\n${dimDateId ?: \"NULL\"},\nNULL,\n${qv(dimBcId)},\nN'BusinessCenter',\n${q(bcId)},\n${dec0(r?.Amount)},\n${q(currency)},\n${q(r?.InvoiceId)},\n${q(r?.SerialNumber)},\n${q(r?.Timezone)},\n${safeIsoToSqlDate(r?.CreateTime)},\n${sqlNow()},\n${qv(r?.CreatorId)},\n${int0(r?.AmountType)},\n${isUSD ? dec0(r?.Amount) : \"0.0\"},\n${isVND ? dec0(r?.Amount) : \"0.0\"},\n${int0(r?.BillingType)},\n${dimPort},\n${q(r?.PaymentPortfolioId)},     -- << i: lu NULL nu thiu, khng p ''\n${dec0(r?.Subtotal)},\n${isUSD ? dec0(r?.Subtotal) : \"0.0\"},\n${isVND ? dec0(r?.Subtotal) : \"0.0\"},\n${dec0(r?.TaxAmount)},\n${isUSD ? dec0(r?.TaxAmount) : \"0.0\"},\n${isVND ? dec0(r?.TaxAmount) : \"0.0\"},\n${q(r?.TransactionId)},\n${int0(r?.TransactionType)}\n)\"\"\"\n}\n\ndef sqlInsert = insertValues.isEmpty() ? \"\" : \"\"\"\nINSERT INTO [dbo].[Fact_FactTransactions]\n([Id],\n [DimDateId],[DimAdAccountId],[DimBusinessCenterId],\n [Type],[EntityId],\n [Amount],[Currency],\n [InvoiceId],[InvoiceSerialNumber],\n [Timezone],[Date],\n [CreationTime],[CreatorId],\n [AmountType],[AmountUSD],[AmountVND],\n [BillingType],\n [DimTransactionPaymentPortId],[PaymentPortfolioId],\n [Subtotal],[SubtotalUSD],[SubtotalVND],\n [TaxAmount],[TaxAmountUSD],[TaxAmountVND],\n [TransactionId],[TransactionType])\nVALUES\n${insertValues.join(\",\\n\")}\n\"\"\".trim()\n\n// ---- UPDATE SET ----\ndef updateStatements = updates.collect { u ->\n    def r = u.raw; def e = u.existing\n    def isoDate   = normalizeIso(r?.CreateTime)\n    def dimDateId = toDimDateId(isoDate)\n    def currency  = (r?.Currency ?: null)\n    def isUSD = (currency == 'USD'); def isVND = (currency == 'VND')\n    def dimPort = dimPortExpr(r?.PaymentPortfolioId)\n\n    // WHERE: so khp chun ho PaymentPortfolioId (coi '' ~ NULL)\n    def whereById = e?.Id ? \"WHERE [Id] = N'${esc(e.Id.toString())}'\" : \"\"\"\nWHERE [Type] = N'BusinessCenter'\n  AND [EntityId] = ${q(bcId)}\n  AND ISNULL(NULLIF([PaymentPortfolioId], N''), N'__NULL__')\n      = ISNULL(${q(r?.PaymentPortfolioId)}, N'__NULL__')\n  AND [TransactionId] = ${q(r?.TransactionId)}\n  AND [Date] = ${safeIsoToSqlDate(r?.CreateTime)}\n\"\"\".trim()\n\n    \"\"\"\nUPDATE [dbo].[Fact_FactTransactions]\nSET DimDateId                   = ${dimDateId ?: \"NULL\"},\n    Currency                    = ${q(currency)},\n    Timezone                    = ${q(r?.Timezone)},\n    Date                        = ${safeIsoToSqlDate(r?.CreateTime)},\n    Amount                      = ${dec0(r?.Amount)},\n    AmountType                  = ${int0(r?.AmountType)},\n    AmountUSD                   = ${isUSD ? dec0(r?.Amount)   : \"0.0\"},\n    AmountVND                   = ${isVND ? dec0(r?.Amount)   : \"0.0\"},\n    BillingType                 = ${int0(r?.BillingType)},\n    DimTransactionPaymentPortId = ${dimPort},\n    PaymentPortfolioId          = ${q(r?.PaymentPortfolioId)},   -- << i: lu NULL nu thiu\n    Subtotal                    = ${dec0(r?.Subtotal)},\n    SubtotalUSD                 = ${isUSD ? dec0(r?.Subtotal) : \"0.0\"},\n    SubtotalVND                 = ${isVND ? dec0(r?.Subtotal) : \"0.0\"},\n    TaxAmount                   = ${dec0(r?.TaxAmount)},\n    TaxAmountUSD                = ${isUSD ? dec0(r?.TaxAmount): \"0.0\"},\n    TaxAmountVND                = ${isVND ? dec0(r?.TaxAmount): \"0.0\"},\n    InvoiceId                   = ${q(r?.InvoiceId)},\n    InvoiceSerialNumber         = ${q(r?.SerialNumber)},\n    TransactionId               = ${q(r?.TransactionId)},\n    TransactionType             = ${int0(r?.TransactionType)}\n${whereById}\n\"\"\".trim()\n}\ndef sqlUpdate = updateStatements.join(\";\\n\")\n\n// ---- Ghi SQL ra flow content ----\ndef finalSql = new StringBuilder()\nif (sqlInsert) finalSql.append(sqlInsert).append(\";\\n\")\nif (sqlUpdate) finalSql.append(sqlUpdate).append(\";\\n\")\n\nflowFile = session.write(flowFile, { _, out ->\n    out.write(finalSql.toString().getBytes(StandardCharsets.UTF_8))\n} as StreamCallback)\n\nsession.transfer(flowFile, REL_SUCCESS)",
            "groovyx-failure-strategy" : "rollback"
          },
          "propertyDescriptors" : {
            "groovyx-script-body" : {
              "displayName" : "Script Body",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-body",
              "sensitive" : false
            },
            "groovyx-failure-strategy" : {
              "displayName" : "Failure strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-failure-strategy",
              "sensitive" : false
            },
            "groovyx-additional-classpath" : {
              "displayName" : "Additional classpath",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-additional-classpath",
              "sensitive" : false
            },
            "groovyx-script-file" : {
              "displayName" : "Script File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-file",
              "resourceDefinition" : {
                "cardinality" : "SINGLE",
                "resourceTypes" : [ "FILE" ]
              },
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.groovyx.ExecuteGroovyScript",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "9a9c0cf9-fd29-3701-9017-3dac634384e1",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CleanupTempFile",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1392.0,
            "y" : 432.0
          },
          "properties" : {
            "Filename" : "${stateCurrent.filename}",
            "Directory Path" : "${stateCurrent.directory}"
          },
          "propertyDescriptors" : {
            "Filename" : {
              "displayName" : "Filename",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Filename",
              "sensitive" : false
            },
            "Directory Path" : {
              "displayName" : "Directory Path",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory Path",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.DeleteFile",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "a566dc09-9845-33b5-84a3-04a36826839f",
          "maxBackoffPeriod" : "10 mins",
          "name" : "SaveRawTemp",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2448.0,
            "y" : -208.0
          },
          "properties" : {
            "Create Missing Directories" : "true",
            "Directory" : "${stateCurrent.directory}",
            "Conflict Resolution Strategy" : "replace"
          },
          "propertyDescriptors" : {
            "Group" : {
              "displayName" : "Group",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Group",
              "sensitive" : false
            },
            "Owner" : {
              "displayName" : "Owner",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Owner",
              "sensitive" : false
            },
            "Create Missing Directories" : {
              "displayName" : "Create Missing Directories",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Create Missing Directories",
              "sensitive" : false
            },
            "Permissions" : {
              "displayName" : "Permissions",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Permissions",
              "sensitive" : false
            },
            "Maximum File Count" : {
              "displayName" : "Maximum File Count",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum File Count",
              "sensitive" : false
            },
            "Last Modified Time" : {
              "displayName" : "Last Modified Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Last Modified Time",
              "sensitive" : false
            },
            "Directory" : {
              "displayName" : "Directory",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory",
              "sensitive" : false
            },
            "Conflict Resolution Strategy" : {
              "displayName" : "Conflict Resolution Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Conflict Resolution Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.PutFile",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "a83dd1d5-9600-33b1-9b39-c8cba0bb28ea",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LayDanhSachDuLieuETLCu",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2944.0,
            "y" : 96.0
          },
          "properties" : {
            "esql-max-rows" : "0",
            "dbf-default-precision" : "10",
            "Max Wait Time" : "0 seconds",
            "SQL Query" : "SELECT\n    f.[Id],\n    f.[Type],\n    f.[EntityId],\n    f.[DimDateId],\n    f.[DimBusinessCenterId],\n    f.[DimTransactionPaymentPortId],\n    CONVERT(varchar(27), f.[Date], 126) AS [Date]\nFROM dbo.[Fact_FactTransactions] f\nWHERE f.[Type]     = 'BusinessCenter'\n  AND f.[EntityId] = '${stateBc.id}'\n  AND f.[Date]    >= '${stateCurrent.minDate}'\n  AND f.[Date]    <= '${stateCurrent.maxDate}'\nORDER BY f.[Date] DESC, f.[Id] DESC;",
            "Database Connection Pooling Service" : "7d601288-eb00-3fcc-934d-d5e3c37f2cfc",
            "esql-auto-commit" : "true",
            "dbf-user-logical-types" : "false",
            "dbf-default-scale" : "0",
            "compression-format" : "NONE",
            "esql-output-batch-size" : "0",
            "esql-fetch-size" : "0",
            "dbf-normalize" : "false",
            "Content Output Strategy" : "EMPTY"
          },
          "propertyDescriptors" : {
            "esql-max-rows" : {
              "displayName" : "Max Rows Per Flow File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-max-rows",
              "sensitive" : false
            },
            "dbf-default-precision" : {
              "displayName" : "Default Decimal Precision",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-precision",
              "sensitive" : false
            },
            "Max Wait Time" : {
              "displayName" : "Max Wait Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Max Wait Time",
              "sensitive" : false
            },
            "SQL Query" : {
              "displayName" : "SQL Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "SQL Query",
              "sensitive" : false
            },
            "Database Connection Pooling Service" : {
              "displayName" : "Database Connection Pooling Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Database Connection Pooling Service",
              "sensitive" : false
            },
            "sql-post-query" : {
              "displayName" : "SQL Post-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-post-query",
              "sensitive" : false
            },
            "esql-auto-commit" : {
              "displayName" : "Set Auto Commit",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-auto-commit",
              "sensitive" : false
            },
            "dbf-user-logical-types" : {
              "displayName" : "Use Avro Logical Types",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-user-logical-types",
              "sensitive" : false
            },
            "dbf-default-scale" : {
              "displayName" : "Default Decimal Scale",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-scale",
              "sensitive" : false
            },
            "sql-pre-query" : {
              "displayName" : "SQL Pre-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-pre-query",
              "sensitive" : false
            },
            "compression-format" : {
              "displayName" : "Compression Format",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "compression-format",
              "sensitive" : false
            },
            "esql-output-batch-size" : {
              "displayName" : "Output Batch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-output-batch-size",
              "sensitive" : false
            },
            "esql-fetch-size" : {
              "displayName" : "Fetch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-fetch-size",
              "sensitive" : false
            },
            "dbf-normalize" : {
              "displayName" : "Normalize Table/Column Names",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-normalize",
              "sensitive" : false
            },
            "Content Output Strategy" : {
              "displayName" : "Content Output Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Content Output Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "232b5208-4771-3492-bc7e-3c51e1e6064a",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CheckHasData",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1952.0,
            "y" : -200.0
          },
          "properties" : {
            "Routing Strategy" : "Route to Property name",
            "hasData" : "${hasData:equals('true')}"
          },
          "propertyDescriptors" : {
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "hasData" : {
              "displayName" : "hasData",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "hasData",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "e06bdef4-d0ea-3282-8505-4d8b953857b2",
          "identifier" : "728615ac-4aeb-3fbe-b95c-758ab6b103e5",
          "maxBackoffPeriod" : "10 mins",
          "name" : "KhoiTao",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 232.0,
            "y" : -208.0
          },
          "properties" : {
            "stateCurrent.filename" : "${state.name}-bc-${stateBc.id}-trasaction-page${state.page}.json",
            "filename" : "${state.name}-bc-${stateBc.id}-transaction-page${state.page}.json",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100",
            "stateCurrent.fullPath" : "#{TempPath}${Path.Separator}${state.name}${Path.Separator}${state.name}-bc-${stateBc.id}-transaction-page${state.page}.json",
            "skip" : "${state.page:toNumber():minus(1):multiply(${state.pageSize:toNumber()})}",
            "stateCurrent.directory" : "#{TempPath}${Path.Separator}${state.name}"
          },
          "propertyDescriptors" : {
            "stateCurrent.filename" : {
              "displayName" : "stateCurrent.filename",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateCurrent.filename",
              "sensitive" : false
            },
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "filename" : {
              "displayName" : "filename",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "filename",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "stateCurrent.fullPath" : {
              "displayName" : "stateCurrent.fullPath",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateCurrent.fullPath",
              "sensitive" : false
            },
            "skip" : {
              "displayName" : "skip",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "skip",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            },
            "stateCurrent.directory" : {
              "displayName" : "stateCurrent.directory",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateCurrent.directory",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        } ],
        "remoteProcessGroups" : [ ],
        "scheduledState" : "ENABLED",
        "statelessFlowTimeout" : "1 min"
      } ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
        "identifier" : "72677135-944c-3ff0-9990-11189aef8b1f",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KhoiTao",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 24.0,
          "y" : -72.0
        },
        "properties" : {
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.page" : "1",
          "state.pageSize" : "#{PageSizeMax}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.page" : {
            "displayName" : "state.page",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.page",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.pageSize" : {
            "displayName" : "state.pageSize",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.pageSize",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
        "identifier" : "4bf949b3-e880-32aa-9b8d-b956e25f1131",
        "maxBackoffPeriod" : "10 mins",
        "name" : "TrangTiepTheo",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 808.0,
          "y" : 352.0
        },
        "properties" : {
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.page" : "${state.page:toNumber():plus(1)}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.page" : {
            "displayName" : "state.page",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.page",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "3240020b-a0cf-3609-9ba9-3d4215a74e04",
        "identifier" : "f145692b-e82e-379c-960a-4a34f1fe069a",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KiemTraCoTrangTiepTheo",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : 544.0
        },
        "properties" : {
          "Routing Strategy" : "Route to Property name",
          "nextPage" : "${state.continue:equals(1)}"
        },
        "propertyDescriptors" : {
          "Routing Strategy" : {
            "displayName" : "Routing Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Routing Strategy",
            "sensitive" : false
          },
          "nextPage" : {
            "displayName" : "nextPage",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "nextPage",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "cace042c-b708-35a0-8489-73da4aa62c2b",
          "name" : "MapNoiDungLenAttribute",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "7b7f924e-5f5f-367d-99f1-1121a8d7bcca",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "aceef8e1-59be-3f2e-ae16-e29a0725f6db",
          "name" : "Data to JSON",
          "type" : "PROCESSOR"
        },
        "zIndex" : 21
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "0d56e98f-f896-3625-8b78-e2cc3cd72341",
          "name" : "CheckHasData",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "6fcd7e08-113e-3e74-8fc0-e0d858e28e2a",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "matched", "unmatched" ],
        "source" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "cace042c-b708-35a0-8489-73da4aa62c2b",
          "name" : "MapNoiDungLenAttribute",
          "type" : "PROCESSOR"
        },
        "zIndex" : 15
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "e210b913-aed0-3825-848f-0abd06ce8573",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "e9c3b456-84c5-3475-a8ae-808b2daf9afa",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "cace042c-b708-35a0-8489-73da4aa62c2b",
          "name" : "MapNoiDungLenAttribute",
          "type" : "PROCESSOR"
        },
        "zIndex" : 12
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "e210b913-aed0-3825-848f-0abd06ce8573",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "ccbb21c3-fb59-343d-92c2-6c43f80c5cd9",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "4a6e3ac7-9815-3d13-9fc1-56bcf1c283b9",
          "name" : "GetDimAdAccount",
          "type" : "PROCESSOR"
        },
        "zIndex" : 4
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "aceef8e1-59be-3f2e-ae16-e29a0725f6db",
          "name" : "Data to JSON",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "a7658e73-1b7e-397f-91df-f55108cce659",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "4a6e3ac7-9815-3d13-9fc1-56bcf1c283b9",
          "name" : "GetDimAdAccount",
          "type" : "PROCESSOR"
        },
        "zIndex" : 20
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "010ffa00-b935-3f9d-bbca-76077e729018",
          "name" : "ChuanHoaIdsQuerySql",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "d8c43cf0-4b74-3c72-ab3e-96d85d1cc250",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "192e2dc2-ce26-33a3-9efe-80f4b1b39165",
          "name" : "PutFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 13
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "4a6e3ac7-9815-3d13-9fc1-56bcf1c283b9",
          "name" : "GetDimAdAccount",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "8555458f-8bce-3ffa-9a4d-29dd10d05ab9",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "28bdcd3b-968c-3fd0-a88c-09390daccb28",
          "name" : "KhoiTaoLayDanhSach",
          "type" : "PROCESSOR"
        },
        "zIndex" : 2
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "28bdcd3b-968c-3fd0-a88c-09390daccb28",
          "name" : "KhoiTaoLayDanhSach",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "8299da9a-d03b-33d6-9c09-3900e4cc1e1e",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "471deeda-0feb-32e0-ae98-c70d72192379",
          "name" : "stateBc",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 10
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "e210b913-aed0-3825-848f-0abd06ce8573",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "225d48aa-227f-3cb0-97bf-af0635680f72",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "unmatched" ],
        "source" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "0d56e98f-f896-3625-8b78-e2cc3cd72341",
          "name" : "CheckHasData",
          "type" : "PROCESSOR"
        },
        "zIndex" : 17
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "e210b913-aed0-3825-848f-0abd06ce8573",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "4ade52de-f671-32a4-9054-b38ac46b3a2b",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "aceef8e1-59be-3f2e-ae16-e29a0725f6db",
          "name" : "Data to JSON",
          "type" : "PROCESSOR"
        },
        "zIndex" : 22
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "e210b913-aed0-3825-848f-0abd06ce8573",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "91a0cf1a-7fe4-3983-8d30-c4cb58fd7583",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "192e2dc2-ce26-33a3-9efe-80f4b1b39165",
          "name" : "PutFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 8
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "192e2dc2-ce26-33a3-9efe-80f4b1b39165",
          "name" : "PutFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "de812618-4dfb-3ecc-921e-02cf500feaf0",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "hasAdAccounts" ],
        "source" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "0d56e98f-f896-3625-8b78-e2cc3cd72341",
          "name" : "CheckHasData",
          "type" : "PROCESSOR"
        },
        "zIndex" : 19
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "7e957881-b2bd-3f28-ac26-35f18c3b933d",
          "name" : "stateAdAccount",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "b9e35c80-4590-3990-880a-fe555299ad26",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
          "id" : "010ffa00-b935-3f9d-bbca-76077e729018",
          "name" : "ChuanHoaIdsQuerySql",
          "type" : "PROCESSOR"
        },
        "zIndex" : 14
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "471deeda-0feb-32e0-ae98-c70d72192379",
        "name" : "stateBc",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -528.0,
          "y" : -72.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LayDanhSachTaiKhoanQuangCao",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "7e957881-b2bd-3f28-ac26-35f18c3b933d",
        "name" : "stateAdAccount",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 2448.0,
          "y" : 456.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -224.0,
        "y" : 3040.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "4a6e3ac7-9815-3d13-9fc1-56bcf1c283b9",
        "maxBackoffPeriod" : "10 mins",
        "name" : "GetDimAdAccount",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 384.0,
          "y" : -112.0
        },
        "properties" : {
          "esql-max-rows" : "0",
          "dbf-default-precision" : "10",
          "Max Wait Time" : "0 seconds",
          "SQL Query" : "SELECT [Id]\n      ,[AdvertiserId]\n      ,[AdvertiserName]\n      ,[Currency]\n      ,[Timezone]\n      ,[Country]\n      ,[Status]\n      ,[Company]\n      ,[OwnerBcId]\n      ,[IsActive]\n      ,[EffectiveDate]\n      ,[ExpiryDate]\n      ,[IsCurrent]\n      ,[RowVersion]\n      ,[CreationTime]\n      ,[CreatorId]\n      ,[LastModificationTime]\n      ,[LastModifierId]\n  FROM Dim_DimAdAccounts d where d.OwnerBcId = '${stateBc.id}' and IsCurrent = 1",
          "Database Connection Pooling Service" : "7d601288-eb00-3fcc-934d-d5e3c37f2cfc",
          "esql-auto-commit" : "true",
          "dbf-user-logical-types" : "false",
          "dbf-default-scale" : "0",
          "compression-format" : "NONE",
          "esql-output-batch-size" : "0",
          "esql-fetch-size" : "0",
          "dbf-normalize" : "false",
          "Content Output Strategy" : "EMPTY"
        },
        "propertyDescriptors" : {
          "esql-max-rows" : {
            "displayName" : "Max Rows Per Flow File",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-max-rows",
            "sensitive" : false
          },
          "dbf-default-precision" : {
            "displayName" : "Default Decimal Precision",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-default-precision",
            "sensitive" : false
          },
          "Max Wait Time" : {
            "displayName" : "Max Wait Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Max Wait Time",
            "sensitive" : false
          },
          "SQL Query" : {
            "displayName" : "SQL Query",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "SQL Query",
            "sensitive" : false
          },
          "Database Connection Pooling Service" : {
            "displayName" : "Database Connection Pooling Service",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Database Connection Pooling Service",
            "sensitive" : false
          },
          "sql-post-query" : {
            "displayName" : "SQL Post-Query",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "sql-post-query",
            "sensitive" : false
          },
          "esql-auto-commit" : {
            "displayName" : "Set Auto Commit",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-auto-commit",
            "sensitive" : false
          },
          "dbf-user-logical-types" : {
            "displayName" : "Use Avro Logical Types",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-user-logical-types",
            "sensitive" : false
          },
          "dbf-default-scale" : {
            "displayName" : "Default Decimal Scale",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-default-scale",
            "sensitive" : false
          },
          "sql-pre-query" : {
            "displayName" : "SQL Pre-Query",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "sql-pre-query",
            "sensitive" : false
          },
          "compression-format" : {
            "displayName" : "Compression Format",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "compression-format",
            "sensitive" : false
          },
          "esql-output-batch-size" : {
            "displayName" : "Output Batch Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-output-batch-size",
            "sensitive" : false
          },
          "esql-fetch-size" : {
            "displayName" : "Fetch Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-fetch-size",
            "sensitive" : false
          },
          "dbf-normalize" : {
            "displayName" : "Normalize Table/Column Names",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-normalize",
            "sensitive" : false
          },
          "Content Output Strategy" : {
            "displayName" : "Content Output Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Content Output Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "010ffa00-b935-3f9d-bbca-76077e729018",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoaIdsQuerySql",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 2400.0,
          "y" : 224.0
        },
        "properties" : {
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateAdAccounts.advertiserIds.inClause" : "${stateAdAccounts.advertiserIds\n  :replaceAll('^\\\\[|\\\\]$', '')\n  :replaceAll('\"', '\\'')\n  :prepend('(')\n  :append(')')}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateAdAccounts.advertiserIds.inClause" : {
            "displayName" : "stateAdAccounts.advertiserIds.inClause",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.advertiserIds.inClause",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "cace042c-b708-35a0-8489-73da4aa62c2b",
        "maxBackoffPeriod" : "10 mins",
        "name" : "MapNoiDungLenAttribute",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 1304.0,
          "y" : -104.0
        },
        "properties" : {
          "Destination" : "flowfile-attribute",
          "Max String Length" : "200 MB",
          "Return Type" : "json",
          "stateAdAccounts.advertiserIds" : "$[*].AdvertiserId",
          "Null Value Representation" : "empty string",
          "Path Not Found Behavior" : "ignore"
        },
        "propertyDescriptors" : {
          "Destination" : {
            "displayName" : "Destination",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Destination",
            "sensitive" : false
          },
          "Max String Length" : {
            "displayName" : "Max String Length",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Max String Length",
            "sensitive" : false
          },
          "Return Type" : {
            "displayName" : "Return Type",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Return Type",
            "sensitive" : false
          },
          "stateAdAccounts.advertiserIds" : {
            "displayName" : "stateAdAccounts.advertiserIds",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.advertiserIds",
            "sensitive" : false
          },
          "Null Value Representation" : {
            "displayName" : "Null Value Representation",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Null Value Representation",
            "sensitive" : false
          },
          "Path Not Found Behavior" : {
            "displayName" : "Path Not Found Behavior",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Path Not Found Behavior",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.EvaluateJsonPath",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "aceef8e1-59be-3f2e-ae16-e29a0725f6db",
        "maxBackoffPeriod" : "10 mins",
        "name" : "Data to JSON",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 848.0,
          "y" : -104.0
        },
        "properties" : {
          "Include Zero Record FlowFiles" : "true",
          "Record Writer" : "422d4040-1ece-3a3f-b19c-f301d2c4bdce",
          "Record Reader" : "e99b4c7b-99a5-3c61-a9fb-3523c60d9b83"
        },
        "propertyDescriptors" : {
          "Include Zero Record FlowFiles" : {
            "displayName" : "Include Zero Record FlowFiles",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Include Zero Record FlowFiles",
            "sensitive" : false
          },
          "Record Writer" : {
            "displayName" : "Record Writer",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Record Writer",
            "sensitive" : false
          },
          "Record Reader" : {
            "displayName" : "Record Reader",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Record Reader",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ConvertRecord",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "192e2dc2-ce26-33a3-9efe-80f4b1b39165",
        "maxBackoffPeriod" : "10 mins",
        "name" : "PutFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 2408.0,
          "y" : -8.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${stateAdAccounts.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "0d56e98f-f896-3625-8b78-e2cc3cd72341",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CheckHasData",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 1840.0,
          "y" : -104.0
        },
        "properties" : {
          "Routing Strategy" : "Route to Property name",
          "hasAdAccounts" : "${stateAdAccounts.advertiserIds:trim():length():gt(2)}"
        },
        "propertyDescriptors" : {
          "Routing Strategy" : {
            "displayName" : "Routing Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Routing Strategy",
            "sensitive" : false
          },
          "hasAdAccounts" : {
            "displayName" : "hasAdAccounts",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "hasAdAccounts",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "e210b913-aed0-3825-848f-0abd06ce8573",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 1144.0,
          "y" : 392.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9ee8b9d1-44e4-3e6b-be1d-4e3d5ac9fef2",
        "identifier" : "28bdcd3b-968c-3fd0-a88c-09390daccb28",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KhoiTaoLayDanhSach",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : -128.0,
          "y" : -112.0
        },
        "properties" : {
          "filename" : "state_${stateBc.id}_addAccount.json",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateAdAccounts.path" : "#{TempPath}${Path.Separator}${state.name}",
          "stateAdAccounts.fullpath" : "#{TempPath}${Path.Separator}${state.name}${Path.Separator}state_${stateBc.id}_addAccount.json",
          "stateAdAccounts.filename" : "state_${stateBc.id}_addAccount.json",
          "stateAdAccounts.name" : "state_${stateBc.id}_addAccount"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateAdAccounts.path" : {
            "displayName" : "stateAdAccounts.path",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.path",
            "sensitive" : false
          },
          "stateAdAccounts.fullpath" : {
            "displayName" : "stateAdAccounts.fullpath",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.fullpath",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "stateAdAccounts.filename" : {
            "displayName" : "stateAdAccounts.filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.filename",
            "sensitive" : false
          },
          "stateAdAccounts.name" : {
            "displayName" : "stateAdAccounts.name",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.name",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
          "id" : "b5efeee8-8a81-3f90-8dd8-1c15ee33d866",
          "name" : "LaythongtinTelegramCauHinh",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
        "identifier" : "716f3ce9-458f-31c9-818a-5346a8618297",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
          "id" : "c382b638-baf1-385c-aa45-bda59cb71aeb",
          "name" : "input",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 1
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
          "id" : "47621594-810f-3e57-b934-3fd72e2d7757",
          "name" : "ReplaceText",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
        "identifier" : "3652eaae-9da9-3871-a5c5-25149e3c3f86",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "send" ],
        "source" : {
          "comments" : "",
          "groupId" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
          "id" : "962b5816-178e-3755-9c4d-5f1e061cefa4",
          "name" : "RouteOnAttribute",
          "type" : "PROCESSOR"
        },
        "zIndex" : 8
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
          "id" : "cc7d9202-3e90-3ce5-8867-9057bbf114fb",
          "name" : "GuiTinNhanTelegram",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
        "identifier" : "8dcbfe56-6625-311f-8b06-334410279791",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
          "id" : "47621594-810f-3e57-b934-3fd72e2d7757",
          "name" : "ReplaceText",
          "type" : "PROCESSOR"
        },
        "zIndex" : 7
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
          "id" : "13eacb18-22eb-3f9f-ab28-9f6ff12f388a",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
        "identifier" : "145e37a2-a9e0-3443-8c0a-c1779fd5d430",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
          "id" : "47621594-810f-3e57-b934-3fd72e2d7757",
          "name" : "ReplaceText",
          "type" : "PROCESSOR"
        },
        "zIndex" : 9
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
          "id" : "962b5816-178e-3755-9c4d-5f1e061cefa4",
          "name" : "RouteOnAttribute",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
        "identifier" : "617ca79c-ec87-3734-8348-33093e86f2c0",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
          "id" : "b5efeee8-8a81-3f90-8dd8-1c15ee33d866",
          "name" : "LaythongtinTelegramCauHinh",
          "type" : "PROCESSOR"
        },
        "zIndex" : 6
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
          "id" : "13eacb18-22eb-3f9f-ab28-9f6ff12f388a",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
        "identifier" : "f9207a2f-fbec-3057-bb83-f9ba68379422",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "Response", "Failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
          "id" : "cc7d9202-3e90-3ce5-8867-9057bbf114fb",
          "name" : "GuiTinNhanTelegram",
          "type" : "PROCESSOR"
        },
        "zIndex" : 5
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
        "identifier" : "c382b638-baf1-385c-aa45-bda59cb71aeb",
        "name" : "input",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -1056.0,
          "y" : -248.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "GuiThongBaoTelegram",
      "outputPorts" : [ ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -216.0,
        "y" : 4776.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ "No Retry", "Retry", "Original" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
        "identifier" : "cc7d9202-3e90-3ce5-8867-9057bbf114fb",
        "maxBackoffPeriod" : "10 mins",
        "name" : "GuiTinNhanTelegram",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 656.0,
          "y" : -296.0
        },
        "properties" : {
          "Request Content-Encoding" : "DISABLED",
          "Request Multipart Form-Data Filename Enabled" : "true",
          "Request Chunked Transfer-Encoding Enabled" : "false",
          "HTTP/2 Disabled" : "False",
          "Connection Timeout" : "30 secs",
          "Response Cookie Strategy" : "DISABLED",
          "Socket Read Timeout" : "15 secs",
          "Socket Idle Connections" : "5",
          "Request Body Enabled" : "true",
          "OAuth2 Access Token Refresh Strategy" : "ON_TOKEN_EXPIRATION",
          "HTTP URL" : "https://api.telegram.org/bot#{BotToken}/sendMessage",
          "Socket Idle Timeout" : "5 mins",
          "Response Redirects Enabled" : "True",
          "Socket Write Timeout" : "15 secs",
          "Response FlowFile Naming Strategy" : "RANDOM",
          "Response Cache Enabled" : "false",
          "Request Date Header Enabled" : "True",
          "Request Failure Penalization Enabled" : "false",
          "Response Body Attribute Size" : "256",
          "Response Generation Required" : "false",
          "Response Header Request Attributes Enabled" : "false",
          "HTTP Method" : "POST",
          "Request Content-Type" : "application/json",
          "Request Digest Authentication Enabled" : "false",
          "Response Cache Size" : "10MB",
          "Response Body Ignored" : "false"
        },
        "propertyDescriptors" : {
          "Request Content-Encoding" : {
            "displayName" : "Request Content-Encoding",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Content-Encoding",
            "sensitive" : false
          },
          "proxy-configuration-service" : {
            "displayName" : "Proxy Configuration Service",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "proxy-configuration-service",
            "sensitive" : false
          },
          "Request Multipart Form-Data Filename Enabled" : {
            "displayName" : "Request Multipart Form-Data Filename Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Multipart Form-Data Filename Enabled",
            "sensitive" : false
          },
          "Request Chunked Transfer-Encoding Enabled" : {
            "displayName" : "Request Chunked Transfer-Encoding Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Chunked Transfer-Encoding Enabled",
            "sensitive" : false
          },
          "Response Header Request Attributes Prefix" : {
            "displayName" : "Response Header Request Attributes Prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Header Request Attributes Prefix",
            "sensitive" : false
          },
          "HTTP/2 Disabled" : {
            "displayName" : "HTTP/2 Disabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "HTTP/2 Disabled",
            "sensitive" : false
          },
          "Connection Timeout" : {
            "displayName" : "Connection Timeout",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Connection Timeout",
            "sensitive" : false
          },
          "Response Cookie Strategy" : {
            "displayName" : "Response Cookie Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Cookie Strategy",
            "sensitive" : false
          },
          "Request Password" : {
            "displayName" : "Request Password",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Password",
            "sensitive" : true
          },
          "Socket Read Timeout" : {
            "displayName" : "Socket Read Timeout",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Socket Read Timeout",
            "sensitive" : false
          },
          "Socket Idle Connections" : {
            "displayName" : "Socket Idle Connections",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Socket Idle Connections",
            "sensitive" : false
          },
          "Request Body Enabled" : {
            "displayName" : "Request Body Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Body Enabled",
            "sensitive" : false
          },
          "OAuth2 Access Token Refresh Strategy" : {
            "displayName" : "OAuth2 Access Token Refresh Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "OAuth2 Access Token Refresh Strategy",
            "sensitive" : false
          },
          "HTTP URL" : {
            "displayName" : "HTTP URL",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "HTTP URL",
            "sensitive" : false
          },
          "Request OAuth2 Access Token Provider" : {
            "displayName" : "Request OAuth2 Access Token Provider",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Request OAuth2 Access Token Provider",
            "sensitive" : false
          },
          "Socket Idle Timeout" : {
            "displayName" : "Socket Idle Timeout",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Socket Idle Timeout",
            "sensitive" : false
          },
          "Response Redirects Enabled" : {
            "displayName" : "Response Redirects Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Redirects Enabled",
            "sensitive" : false
          },
          "Socket Write Timeout" : {
            "displayName" : "Socket Write Timeout",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Socket Write Timeout",
            "sensitive" : false
          },
          "Request Header Attributes Pattern" : {
            "displayName" : "Request Header Attributes Pattern",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Header Attributes Pattern",
            "sensitive" : false
          },
          "Response FlowFile Naming Strategy" : {
            "displayName" : "Response FlowFile Naming Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response FlowFile Naming Strategy",
            "sensitive" : false
          },
          "Response Cache Enabled" : {
            "displayName" : "Response Cache Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Cache Enabled",
            "sensitive" : false
          },
          "Request Date Header Enabled" : {
            "displayName" : "Request Date Header Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Date Header Enabled",
            "sensitive" : false
          },
          "Request Failure Penalization Enabled" : {
            "displayName" : "Request Failure Penalization Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Failure Penalization Enabled",
            "sensitive" : false
          },
          "Response Body Attribute Size" : {
            "displayName" : "Response Body Attribute Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Body Attribute Size",
            "sensitive" : false
          },
          "SSL Context Service" : {
            "displayName" : "SSL Context Service",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "SSL Context Service",
            "sensitive" : false
          },
          "Response Generation Required" : {
            "displayName" : "Response Generation Required",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Generation Required",
            "sensitive" : false
          },
          "Request User-Agent" : {
            "displayName" : "Request User-Agent",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request User-Agent",
            "sensitive" : false
          },
          "Response Header Request Attributes Enabled" : {
            "displayName" : "Response Header Request Attributes Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Header Request Attributes Enabled",
            "sensitive" : false
          },
          "HTTP Method" : {
            "displayName" : "HTTP Method",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "HTTP Method",
            "sensitive" : false
          },
          "Request Username" : {
            "displayName" : "Request Username",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Username",
            "sensitive" : false
          },
          "Request Content-Type" : {
            "displayName" : "Request Content-Type",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Content-Type",
            "sensitive" : false
          },
          "Response Body Attribute Name" : {
            "displayName" : "Response Body Attribute Name",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Body Attribute Name",
            "sensitive" : false
          },
          "Request Digest Authentication Enabled" : {
            "displayName" : "Request Digest Authentication Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Digest Authentication Enabled",
            "sensitive" : false
          },
          "Request Multipart Form-Data Name" : {
            "displayName" : "Request Multipart Form-Data Name",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Multipart Form-Data Name",
            "sensitive" : false
          },
          "Response Cache Size" : {
            "displayName" : "Response Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Cache Size",
            "sensitive" : false
          },
          "Response Body Ignored" : {
            "displayName" : "Response Body Ignored",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Body Ignored",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
        "identifier" : "b5efeee8-8a81-3f90-8dd8-1c15ee33d866",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LaythongtinTelegramCauHinh",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : -656.0,
          "y" : -280.0
        },
        "properties" : {
          "telegram.botToken" : "#{BotToken}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "telegram.chatId" : "#{ChatId}",
          "telegram.enabled" : "#{Enabled}",
          "telegram.text" : " MESSAGE ALERT\n Application: NIFI\n Flow: ${state.name}\n SequenceNumber: ${state.sequenceNumber}\n Message: ${state.message}\n Time Query: ${state.startTime} - ${state.endTime}"
        },
        "propertyDescriptors" : {
          "telegram.botToken" : {
            "displayName" : "telegram.botToken",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "telegram.botToken",
            "sensitive" : false
          },
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "telegram.chatId" : {
            "displayName" : "telegram.chatId",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "telegram.chatId",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "telegram.enabled" : {
            "displayName" : "telegram.enabled",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "telegram.enabled",
            "sensitive" : false
          },
          "telegram.text" : {
            "displayName" : "telegram.text",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "telegram.text",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
        "identifier" : "47621594-810f-3e57-b934-3fd72e2d7757",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ReplaceText",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 200.0,
          "y" : -288.0
        },
        "properties" : {
          "Regular Expression" : "(?s)^(.*)$",
          "Replacement Value" : "{\"chat_id\":\"#{ChatId}\",\"text\":\"${telegram.text}\"}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Regex Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
        "identifier" : "13eacb18-22eb-3f9f-ab28-9f6ff12f388a",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 224.0,
          "y" : 32.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "unmatched" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "0b0d7c1f-41e7-3cea-a025-0ab3549c0189",
        "identifier" : "962b5816-178e-3755-9c4d-5f1e061cefa4",
        "maxBackoffPeriod" : "10 mins",
        "name" : "RouteOnAttribute",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : -184.0,
          "y" : -288.0
        },
        "properties" : {
          "Routing Strategy" : "Route to Property name",
          "send" : "${telegram.enabled:equals('true')}"
        },
        "propertyDescriptors" : {
          "Routing Strategy" : {
            "displayName" : "Routing Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Routing Strategy",
            "sensitive" : false
          },
          "send" : {
            "displayName" : "send",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "send",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    } ],
    "processors" : [ {
      "autoTerminatedRelationships" : [ "success" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "9fc433fd-82c6-3bd1-af39-1e36755d1eaa",
      "maxBackoffPeriod" : "10 mins",
      "name" : "LogMessage",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -712.0,
        "y" : 2040.0
      },
      "properties" : {
        "log-level" : "info"
      },
      "propertyDescriptors" : {
        "log-message" : {
          "displayName" : "Log message",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-message",
          "sensitive" : false
        },
        "log-level" : {
          "displayName" : "Log Level",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-level",
          "sensitive" : false
        },
        "log-prefix" : {
          "displayName" : "Log prefix",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-prefix",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ "success" ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.LogMessage",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "failure" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "d936b40f-364c-35e8-a94e-4d5f23ba5ddf",
      "maxBackoffPeriod" : "10 mins",
      "name" : "Data to JSON",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -208.0,
        "y" : 1144.0
      },
      "properties" : {
        "Include Zero Record FlowFiles" : "true",
        "Record Writer" : "422d4040-1ece-3a3f-b19c-f301d2c4bdce",
        "Record Reader" : "e99b4c7b-99a5-3c61-a9fb-3523c60d9b83"
      },
      "propertyDescriptors" : {
        "Include Zero Record FlowFiles" : {
          "displayName" : "Include Zero Record FlowFiles",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Include Zero Record FlowFiles",
          "sensitive" : false
        },
        "Record Writer" : {
          "displayName" : "Record Writer",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "Record Writer",
          "sensitive" : false
        },
        "Record Reader" : {
          "displayName" : "Record Reader",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "Record Reader",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.ConvertRecord",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-update-attribute-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "9965a42b-6644-329c-bf27-a938fffea6ba",
      "maxBackoffPeriod" : "10 mins",
      "name" : "CapNhatTrangThaiBcHienTaiLaHoanThanh",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -208.0,
        "y" : 3568.0
      },
      "properties" : {
        "Store State" : "Do not store state",
        "canonical-value-lookup-cache-size" : "100",
        "stateBc.isActive" : "false",
        "stateBc.message" : "Hon thnh",
        "stateBc.status" : "2"
      },
      "propertyDescriptors" : {
        "Delete Attributes Expression" : {
          "displayName" : "Delete Attributes Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Delete Attributes Expression",
          "sensitive" : false
        },
        "Store State" : {
          "displayName" : "Store State",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Store State",
          "sensitive" : false
        },
        "canonical-value-lookup-cache-size" : {
          "displayName" : "Cache Value Lookup Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "canonical-value-lookup-cache-size",
          "sensitive" : false
        },
        "stateBc.isActive" : {
          "displayName" : "stateBc.isActive",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.isActive",
          "sensitive" : false
        },
        "Stateful Variables Initial Value" : {
          "displayName" : "Stateful Variables Initial Value",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Stateful Variables Initial Value",
          "sensitive" : false
        },
        "stateBc.message" : {
          "displayName" : "stateBc.message",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.message",
          "sensitive" : false
        },
        "stateBc.status" : {
          "displayName" : "stateBc.status",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.status",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "success" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "08b2ff98-b8bb-32e4-9ce4-5ffd3967374c",
      "maxBackoffPeriod" : "10 mins",
      "name" : "LogMessage",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -656.0,
        "y" : 448.0
      },
      "properties" : {
        "log-level" : "info"
      },
      "propertyDescriptors" : {
        "log-message" : {
          "displayName" : "Log message",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-message",
          "sensitive" : false
        },
        "log-level" : {
          "displayName" : "Log Level",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-level",
          "sensitive" : false
        },
        "log-prefix" : {
          "displayName" : "Log prefix",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-prefix",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.LogMessage",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "unmatched" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "73b43455-88e1-3c66-8934-c80568c00bcd",
      "maxBackoffPeriod" : "10 mins",
      "name" : "KiemTraDanhSachBcTrong",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : 272.0,
        "y" : 1352.0
      },
      "properties" : {
        "Content Buffer Size" : "100 MB",
        "Match Requirement" : "content must match exactly",
        "isEmptyJsonArray " : "^\\[\\s*\\]$",
        "Character Set" : "UTF-8"
      },
      "propertyDescriptors" : {
        "Content Buffer Size" : {
          "displayName" : "Content Buffer Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Content Buffer Size",
          "sensitive" : false
        },
        "Match Requirement" : {
          "displayName" : "Match Requirement",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Match Requirement",
          "sensitive" : false
        },
        "isEmptyJsonArray " : {
          "displayName" : "isEmptyJsonArray ",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "isEmptyJsonArray ",
          "sensitive" : false
        },
        "Character Set" : {
          "displayName" : "Character Set",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Character Set",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.RouteOnContent",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "ad506217-9655-39f1-a210-b0488509a982",
      "maxBackoffPeriod" : "10 mins",
      "name" : "KiemTraLaBcCuoiCung",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -208.0,
        "y" : 4048.0
      },
      "properties" : {
        "Routing Strategy" : "Route to Property name",
        "bcCuoiCung" : "${fragment.index:toNumber():equals(${fragment.count:toNumber():minus(1)}):and(${state.continue:equals('0')})}"
      },
      "propertyDescriptors" : {
        "Routing Strategy" : {
          "displayName" : "Routing Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Routing Strategy",
          "sensitive" : false
        },
        "bcCuoiCung" : {
          "displayName" : "bcCuoiCung",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "bcCuoiCung",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "511b9f42-ba92-33bd-bac1-28f75e5b2940",
      "maxBackoffPeriod" : "10 mins",
      "name" : "DuyetTungBC",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -208.0,
        "y" : 1352.0
      },
      "properties" : {
        "Max String Length" : "100 MB",
        "Null Value Representation" : "empty string",
        "JsonPath Expression" : "$[*]"
      },
      "propertyDescriptors" : {
        "Max String Length" : {
          "displayName" : "Max String Length",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Max String Length",
          "sensitive" : false
        },
        "Null Value Representation" : {
          "displayName" : "Null Value Representation",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Null Value Representation",
          "sensitive" : false
        },
        "JsonPath Expression" : {
          "displayName" : "JsonPath Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "JsonPath Expression",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.SplitJson",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "6613b6f8-074b-32cd-816f-a99c037e9736",
      "maxBackoffPeriod" : "10 mins",
      "name" : "KiemTraBcDaETLChua",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -208.0,
        "y" : 2040.0
      },
      "properties" : {
        "Routing Strategy" : "Route to Property name",
        "HoanThanhETLRoi" : "${stateBc.sequenceNumber:gt(${state.sequenceNumber})}"
      },
      "propertyDescriptors" : {
        "Routing Strategy" : {
          "displayName" : "Routing Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Routing Strategy",
          "sensitive" : false
        },
        "HoanThanhETLRoi" : {
          "displayName" : "HoanThanhETLRoi",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "HoanThanhETLRoi",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-update-attribute-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "079dc687-ae4e-38b1-948e-ac31ba8212c5",
      "maxBackoffPeriod" : "10 mins",
      "name" : "CapNhatETLLaDangXuLy",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -208.0,
        "y" : 448.0
      },
      "properties" : {
        "state.message" : "ang x l",
        "filename" : "${state.filename}",
        "Store State" : "Do not store state",
        "canonical-value-lookup-cache-size" : "100",
        "state.status" : "1",
        "state.isActive" : "true"
      },
      "propertyDescriptors" : {
        "state.message" : {
          "displayName" : "state.message",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.message",
          "sensitive" : false
        },
        "Delete Attributes Expression" : {
          "displayName" : "Delete Attributes Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Delete Attributes Expression",
          "sensitive" : false
        },
        "filename" : {
          "displayName" : "filename",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "filename",
          "sensitive" : false
        },
        "Store State" : {
          "displayName" : "Store State",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Store State",
          "sensitive" : false
        },
        "canonical-value-lookup-cache-size" : {
          "displayName" : "Cache Value Lookup Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "canonical-value-lookup-cache-size",
          "sensitive" : false
        },
        "state.status" : {
          "displayName" : "state.status",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.status",
          "sensitive" : false
        },
        "Stateful Variables Initial Value" : {
          "displayName" : "Stateful Variables Initial Value",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Stateful Variables Initial Value",
          "sensitive" : false
        },
        "state.isActive" : {
          "displayName" : "state.isActive",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.isActive",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "success" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "456a83a2-9a41-303a-97ff-395ba9e03db5",
      "maxBackoffPeriod" : "10 mins",
      "name" : "LogMessage",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -680.0,
        "y" : 4048.0
      },
      "properties" : {
        "log-level" : "info"
      },
      "propertyDescriptors" : {
        "log-message" : {
          "displayName" : "Log message",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-message",
          "sensitive" : false
        },
        "log-level" : {
          "displayName" : "Log Level",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-level",
          "sensitive" : false
        },
        "log-prefix" : {
          "displayName" : "Log prefix",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-prefix",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.LogMessage",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "d7492d21-8ebe-3f37-8547-e046bac14eee",
      "maxBackoffPeriod" : "10 mins",
      "name" : "KiemTraETLDangXuLy",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -208.0,
        "y" : 248.0
      },
      "properties" : {
        "Routing Strategy" : "Route to Property name",
        "isProcessing" : "${state.isActive:equals('true')}"
      },
      "propertyDescriptors" : {
        "Routing Strategy" : {
          "displayName" : "Routing Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Routing Strategy",
          "sensitive" : false
        },
        "isProcessing" : {
          "displayName" : "isProcessing",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "isProcessing",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "ff83edc8-54ad-3453-b8f6-3c1a06a3be07",
      "maxBackoffPeriod" : "10 mins",
      "name" : "KhoiTao",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -208.0,
        "y" : -240.0
      },
      "properties" : {
        "character-set" : "UTF-8",
        "state.name" : "ETL_Transactions",
        "File Size" : "100MB",
        "Path.Separator" : "#{Path.Separator}",
        "Batch Size" : "1",
        "Unique FlowFiles" : "false",
        "Data Format" : "Text"
      },
      "propertyDescriptors" : {
        "character-set" : {
          "displayName" : "Character Set",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "character-set",
          "sensitive" : false
        },
        "state.name" : {
          "displayName" : "state.name",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.name",
          "sensitive" : false
        },
        "File Size" : {
          "displayName" : "File Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "File Size",
          "sensitive" : false
        },
        "mime-type" : {
          "displayName" : "Mime Type",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "mime-type",
          "sensitive" : false
        },
        "generate-ff-custom-text" : {
          "displayName" : "Custom Text",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "generate-ff-custom-text",
          "sensitive" : false
        },
        "Path.Separator" : {
          "displayName" : "Path.Separator",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "Path.Separator",
          "sensitive" : false
        },
        "Batch Size" : {
          "displayName" : "Batch Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Batch Size",
          "sensitive" : false
        },
        "Unique FlowFiles" : {
          "displayName" : "Unique FlowFiles",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Unique FlowFiles",
          "sensitive" : false
        },
        "Data Format" : {
          "displayName" : "Data Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Data Format",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "60 min",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.GenerateFlowFile",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-update-attribute-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "25482f77-dfb0-369b-a31e-fb7c21a7b222",
      "maxBackoffPeriod" : "10 mins",
      "name" : "CapNhatBcHienTaiLaDangXuLy",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -208.0,
        "y" : 2272.0
      },
      "properties" : {
        "stateBc.endTime" : "${state.endTime}",
        "Store State" : "Do not store state",
        "canonical-value-lookup-cache-size" : "100",
        "stateBc.sequenceNumber" : "${state.sequenceNumber}",
        "stateBc.isActive" : "true",
        "stateBc.message" : "ang x l",
        "stateBc.status" : "1"
      },
      "propertyDescriptors" : {
        "stateBc.endTime" : {
          "displayName" : "stateBc.endTime",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.endTime",
          "sensitive" : false
        },
        "Delete Attributes Expression" : {
          "displayName" : "Delete Attributes Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Delete Attributes Expression",
          "sensitive" : false
        },
        "Store State" : {
          "displayName" : "Store State",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Store State",
          "sensitive" : false
        },
        "canonical-value-lookup-cache-size" : {
          "displayName" : "Cache Value Lookup Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "canonical-value-lookup-cache-size",
          "sensitive" : false
        },
        "stateBc.sequenceNumber" : {
          "displayName" : "stateBc.sequenceNumber",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.sequenceNumber",
          "sensitive" : false
        },
        "stateBc.isActive" : {
          "displayName" : "stateBc.isActive",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.isActive",
          "sensitive" : false
        },
        "Stateful Variables Initial Value" : {
          "displayName" : "Stateful Variables Initial Value",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Stateful Variables Initial Value",
          "sensitive" : false
        },
        "stateBc.message" : {
          "displayName" : "stateBc.message",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.message",
          "sensitive" : false
        },
        "stateBc.status" : {
          "displayName" : "stateBc.status",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.status",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-update-attribute-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "fed07305-a57c-33b3-8857-fadd8c49ae3f",
      "maxBackoffPeriod" : "10 mins",
      "name" : "CapNhatTrangThaiETLLaHoanThanh",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -200.0,
        "y" : 4272.0
      },
      "properties" : {
        "state.message" : "Hon thnh",
        "filename" : "${state.filename}",
        "Store State" : "Do not store state",
        "canonical-value-lookup-cache-size" : "100",
        "state.status" : "2",
        "state.isActive" : "false"
      },
      "propertyDescriptors" : {
        "state.message" : {
          "displayName" : "state.message",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.message",
          "sensitive" : false
        },
        "Delete Attributes Expression" : {
          "displayName" : "Delete Attributes Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Delete Attributes Expression",
          "sensitive" : false
        },
        "filename" : {
          "displayName" : "filename",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "filename",
          "sensitive" : false
        },
        "Store State" : {
          "displayName" : "Store State",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Store State",
          "sensitive" : false
        },
        "canonical-value-lookup-cache-size" : {
          "displayName" : "Cache Value Lookup Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "canonical-value-lookup-cache-size",
          "sensitive" : false
        },
        "state.status" : {
          "displayName" : "state.status",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.status",
          "sensitive" : false
        },
        "Stateful Variables Initial Value" : {
          "displayName" : "Stateful Variables Initial Value",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Stateful Variables Initial Value",
          "sensitive" : false
        },
        "state.isActive" : {
          "displayName" : "state.isActive",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.isActive",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-update-attribute-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "8af962a0-c2d9-3426-9400-31fa8103b35d",
      "maxBackoffPeriod" : "10 mins",
      "name" : "CapNhatETLLaHoanThanh",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : 272.0,
        "y" : 1576.0
      },
      "properties" : {
        "state.message" : "Hon thnh - BC Empty",
        "filename" : "${state.filename}",
        "Store State" : "Do not store state",
        "canonical-value-lookup-cache-size" : "100",
        "state.status" : "2",
        "state.isActive" : "false"
      },
      "propertyDescriptors" : {
        "state.message" : {
          "displayName" : "state.message",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.message",
          "sensitive" : false
        },
        "Delete Attributes Expression" : {
          "displayName" : "Delete Attributes Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Delete Attributes Expression",
          "sensitive" : false
        },
        "filename" : {
          "displayName" : "filename",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "filename",
          "sensitive" : false
        },
        "Store State" : {
          "displayName" : "Store State",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Store State",
          "sensitive" : false
        },
        "canonical-value-lookup-cache-size" : {
          "displayName" : "Cache Value Lookup Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "canonical-value-lookup-cache-size",
          "sensitive" : false
        },
        "state.status" : {
          "displayName" : "state.status",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.status",
          "sensitive" : false
        },
        "Stateful Variables Initial Value" : {
          "displayName" : "Stateful Variables Initial Value",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Stateful Variables Initial Value",
          "sensitive" : false
        },
        "state.isActive" : {
          "displayName" : "state.isActive",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.isActive",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "failure", "unmatched" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "4b7be34f-8c2f-3bc0-aefb-72a410e58db6",
      "maxBackoffPeriod" : "10 mins",
      "name" : "ChuyenContentBcLenAttribute",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -208.0,
        "y" : 1576.0
      },
      "properties" : {
        "Destination" : "flowfile-attribute",
        "Max String Length" : "20 MB",
        "stateBc.name" : "$.BcName",
        "stateBc.dimId" : "$.Id",
        "Return Type" : "auto-detect",
        "stateBc.id" : "$.BcId",
        "Null Value Representation" : "empty string",
        "Path Not Found Behavior" : "ignore"
      },
      "propertyDescriptors" : {
        "Destination" : {
          "displayName" : "Destination",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Destination",
          "sensitive" : false
        },
        "Max String Length" : {
          "displayName" : "Max String Length",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Max String Length",
          "sensitive" : false
        },
        "stateBc.name" : {
          "displayName" : "stateBc.name",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.name",
          "sensitive" : false
        },
        "stateBc.dimId" : {
          "displayName" : "stateBc.dimId",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.dimId",
          "sensitive" : false
        },
        "Return Type" : {
          "displayName" : "Return Type",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Return Type",
          "sensitive" : false
        },
        "stateBc.id" : {
          "displayName" : "stateBc.id",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.id",
          "sensitive" : false
        },
        "Null Value Representation" : {
          "displayName" : "Null Value Representation",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Null Value Representation",
          "sensitive" : false
        },
        "Path Not Found Behavior" : {
          "displayName" : "Path Not Found Behavior",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Path Not Found Behavior",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.EvaluateJsonPath",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "1184b385-5627-3cf0-8ad3-4d48098cb10a",
      "maxBackoffPeriod" : "10 mins",
      "name" : "LayDanhSachBC",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -208.0,
        "y" : 928.0
      },
      "properties" : {
        "esql-max-rows" : "0",
        "dbf-default-precision" : "10",
        "Max Wait Time" : "0 seconds",
        "SQL Query" : "SELECT *\n  FROM Dim_DimBusinessCenters where IsCurrent = 1",
        "Database Connection Pooling Service" : "7d601288-eb00-3fcc-934d-d5e3c37f2cfc",
        "esql-auto-commit" : "true",
        "dbf-user-logical-types" : "false",
        "dbf-default-scale" : "0",
        "compression-format" : "NONE",
        "esql-output-batch-size" : "0",
        "esql-fetch-size" : "0",
        "dbf-normalize" : "false",
        "Content Output Strategy" : "EMPTY"
      },
      "propertyDescriptors" : {
        "esql-max-rows" : {
          "displayName" : "Max Rows Per Flow File",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "esql-max-rows",
          "sensitive" : false
        },
        "dbf-default-precision" : {
          "displayName" : "Default Decimal Precision",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbf-default-precision",
          "sensitive" : false
        },
        "Max Wait Time" : {
          "displayName" : "Max Wait Time",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Max Wait Time",
          "sensitive" : false
        },
        "SQL Query" : {
          "displayName" : "SQL Query",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "SQL Query",
          "sensitive" : false
        },
        "Database Connection Pooling Service" : {
          "displayName" : "Database Connection Pooling Service",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "Database Connection Pooling Service",
          "sensitive" : false
        },
        "sql-post-query" : {
          "displayName" : "SQL Post-Query",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "sql-post-query",
          "sensitive" : false
        },
        "esql-auto-commit" : {
          "displayName" : "Set Auto Commit",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "esql-auto-commit",
          "sensitive" : false
        },
        "dbf-user-logical-types" : {
          "displayName" : "Use Avro Logical Types",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbf-user-logical-types",
          "sensitive" : false
        },
        "dbf-default-scale" : {
          "displayName" : "Default Decimal Scale",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbf-default-scale",
          "sensitive" : false
        },
        "sql-pre-query" : {
          "displayName" : "SQL Pre-Query",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "sql-pre-query",
          "sensitive" : false
        },
        "compression-format" : {
          "displayName" : "Compression Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "compression-format",
          "sensitive" : false
        },
        "esql-output-batch-size" : {
          "displayName" : "Output Batch Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "esql-output-batch-size",
          "sensitive" : false
        },
        "esql-fetch-size" : {
          "displayName" : "Fetch Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "esql-fetch-size",
          "sensitive" : false
        },
        "dbf-normalize" : {
          "displayName" : "Normalize Table/Column Names",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbf-normalize",
          "sensitive" : false
        },
        "Content Output Strategy" : {
          "displayName" : "Content Output Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Content Output Strategy",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
      "yieldDuration" : "1 sec"
    } ],
    "remoteProcessGroups" : [ ],
    "scheduledState" : "ENABLED",
    "statelessFlowTimeout" : "1 min"
  },
  "flowEncodingVersion" : "1.0",
  "latest" : false,
  "parameterContexts" : {
    "ETL" : {
      "componentType" : "PARAMETER_CONTEXT",
      "inheritedParameterContexts" : [ ],
      "name" : "ETL",
      "parameters" : [ {
        "description" : "",
        "name" : "TempPath",
        "provided" : false,
        "sensitive" : false,
        "value" : ".\\template\\etl"
      }, {
        "description" : "",
        "name" : "PageSizeMax",
        "provided" : false,
        "sensitive" : false,
        "value" : "500"
      }, {
        "description" : "",
        "name" : "DbAccount",
        "provided" : false,
        "sensitive" : false,
        "value" : "sa"
      }, {
        "description" : "",
        "name" : "Path.Separator",
        "provided" : false,
        "sensitive" : false,
        "value" : "\\"
      }, {
        "description" : "",
        "name" : "DbDriverClassName",
        "provided" : false,
        "sensitive" : false,
        "value" : "com.microsoft.sqlserver.jdbc.SQLServerDriver"
      }, {
        "description" : "",
        "name" : "Enabled",
        "provided" : false,
        "sensitive" : false,
        "value" : "true"
      }, {
        "description" : "",
        "name" : "DbConnectString",
        "provided" : false,
        "sensitive" : false,
        "value" : "jdbc:sqlserver://127.0.0.1:1433;databaseName=TikTokDWH;TrustServerCertificate=true"
      }, {
        "description" : "",
        "name" : "DbDriverLocation",
        "provided" : false,
        "sensitive" : false,
        "value" : ".\\lib\\mssql-jdbc-12.10.1.jre11.jar"
      }, {
        "description" : "",
        "name" : "Directory",
        "provided" : false,
        "sensitive" : false,
        "value" : "${stateCurrent.Directory}"
      } ]
    },
    "TikTokETL" : {
      "componentType" : "PARAMETER_CONTEXT",
      "inheritedParameterContexts" : [ ],
      "name" : "TikTokETL",
      "parameters" : [ {
        "description" : "",
        "name" : "accept",
        "provided" : false,
        "sensitive" : false,
        "value" : "application/json;odata.metadata=minimal;odata.streaming=true"
      }, {
        "description" : "",
        "name" : "api.url",
        "provided" : false,
        "sensitive" : false,
        "value" : "https://app2.southeastasia.cloudapp.azure.com:44383/api/tiktok-video/get-list"
      }, {
        "description" : "",
        "name" : "Cookie",
        "provided" : false,
        "sensitive" : false,
        "value" : ".AspNetCore.Antiforgery=GIATRICOOKIE"
      }, {
        "description" : "",
        "name" : "X-Requested-With",
        "provided" : false,
        "sensitive" : false,
        "value" : "XMLHttpRequest"
      }, {
        "description" : "",
        "name" : "Log Level",
        "provided" : false,
        "sensitive" : false,
        "value" : "info"
      }, {
        "description" : "",
        "name" : "DbFacDimAccount",
        "provided" : false,
        "sensitive" : false,
        "value" : "sa"
      }, {
        "description" : "",
        "name" : "TempPath",
        "provided" : false,
        "sensitive" : false,
        "value" : ".\\tmp\\etl"
      }, {
        "description" : "",
        "name" : "DbDriverClassName",
        "provided" : false,
        "sensitive" : false,
        "value" : "com.microsoft.sqlserver.jdbc.SQLServerDriver"
      }, {
        "description" : "",
        "name" : "DbFactDimPassword",
        "provided" : false,
        "sensitive" : true
      }, {
        "description" : "",
        "name" : "HTTP Method",
        "provided" : false,
        "sensitive" : false,
        "value" : "POST"
      }, {
        "description" : "",
        "name" : "RequestVerificationToken",
        "provided" : false,
        "sensitive" : false,
        "value" : "CfDJ8KO0KjQZsxpOjzNZE7tYUzE6ND9vFRJaIzBoCSzgW535yiP6nE1BEbAmFlcjfNk2EH67bVcPBEWibuish2OMk-DsuFQB20jgBg12j6Q8zutg6CaS3qPDsoSZAP5w6JSAJVpivWol5TfeCBTBDn0gnao"
      }, {
        "description" : "",
        "name" : "api.content-type",
        "provided" : false,
        "sensitive" : false,
        "value" : "application/json;odata.metadata=minimal;odata.streaming=true"
      }, {
        "description" : "",
        "name" : "api.accept",
        "provided" : false,
        "sensitive" : false,
        "value" : "application/json;odata.metadata=minimal;odata.streaming=true"
      }, {
        "description" : "",
        "name" : "DbPassword",
        "provided" : false,
        "sensitive" : true
      }, {
        "description" : "",
        "name" : "DbAccount",
        "provided" : false,
        "sensitive" : false,
        "value" : "sa"
      }, {
        "description" : "",
        "name" : "DbFactDimConnectionString",
        "provided" : false,
        "sensitive" : false,
        "value" : "jdbc:sqlserver://127.0.0.1:1433;databaseName=TikTok;TrustServerCertificate=true"
      }, {
        "description" : "",
        "name" : "DbFactDimDriverClassName",
        "provided" : false,
        "sensitive" : false,
        "value" : "com.microsoft.sqlserver.jdbc.SQLServerDriver"
      }, {
        "description" : "",
        "name" : "api.XRequestedWith",
        "provided" : false,
        "sensitive" : false,
        "value" : "XMLHttpRequest"
      }, {
        "description" : "",
        "name" : "PageSizeMax",
        "provided" : false,
        "sensitive" : false,
        "value" : "500"
      }, {
        "description" : "",
        "name" : "api.token",
        "provided" : false,
        "sensitive" : false,
        "value" : "CfDJ8KO0KjQZsxpOjzNZE7tYUzE6ND9vFRJaIzBoCSzgW535yiP6nE1BEbAmFlcjfNk2EH67bVcPBEWibuish2OMk-DsuFQB20jgBg12j6Q8zutg6CaS3qPDsoSZAP5w6JSAJVpivWol5TfeCBTBDn0gnao"
      }, {
        "description" : "",
        "name" : "Path.Separator",
        "provided" : false,
        "sensitive" : false,
        "value" : "\\"
      }, {
        "description" : "",
        "name" : "DbConnectionString",
        "provided" : false,
        "sensitive" : false,
        "value" : "jdbc:sqlserver://127.0.0.1:1433;databaseName=TikTok;TrustServerCertificate=true"
      }, {
        "description" : "",
        "name" : "DbFactDimDriverLocation",
        "provided" : false,
        "sensitive" : false,
        "value" : ".\\lib\\mssql-jdbc-12.10.1.jre11.jar"
      }, {
        "description" : "",
        "name" : "DbDriverLocation",
        "provided" : false,
        "sensitive" : false,
        "value" : ".\\lib\\mssql-jdbc-12.10.1.jre11.jar"
      }, {
        "description" : "",
        "name" : "Directory",
        "provided" : false,
        "sensitive" : false,
        "value" : "${stateCurrent.Directory}"
      } ]
    }
  },
  "parameterProviders" : { },
  "snapshotMetadata" : {
    "author" : "4df8cad9-d248-48ab-a56c-7d80a4da5f7f",
    "flowIdentifier" : "FACTTRANSACTION",
    "timestamp" : 0
  }
}