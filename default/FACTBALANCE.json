{
  "externalControllerServices" : { },
  "flow" : {
    "createdTimestamp" : 1767794323048,
    "description" : "",
    "identifier" : "FACTBALANCE",
    "lastModifiedTimestamp" : 1767794323048,
    "name" : "FACT_BALANCE",
    "versionCount" : 0
  },
  "flowContents" : {
    "comments" : "",
    "componentType" : "PROCESS_GROUP",
    "connections" : [ {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "1fb0038d-d9d4-364c-880e-692997df6f0f",
        "name" : "LayDanhSachBC",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "e155af48-865a-38a8-a71c-26e29cf531e8",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
        "id" : "cdb82e02-4e6a-3734-8f0e-0ce72fbb0996",
        "name" : "stateOut",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 6
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "03169748-cd9d-32b5-bce4-24e75d2e04f2",
        "name" : "LogMessage",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "867ded09-819a-3bdc-bce0-eaa4282b9cfc",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "isProcessing" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "847ef9b6-d151-3fe8-b263-2c6c40a260ef",
        "name" : "KiemTraETLDangXuLy",
        "type" : "PROCESSOR"
      },
      "zIndex" : 4
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "112b2ee1-09dc-381c-ae20-e68e18f84138",
        "name" : "ChuyenContentBcLenAttribute",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "d281763d-2874-3896-b14e-d404e2efc82e",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "split" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "96b5172e-db84-3891-bfc8-0b96074dab1f",
        "name" : "DuyetTungBC",
        "type" : "PROCESSOR"
      },
      "zIndex" : 12
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "d9912cde-5554-36dc-91e7-ced8c541f581",
        "id" : "b37aa3bb-1c2f-360b-a9eb-fcf20ae0cb3f",
        "name" : "Input",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "fd268f44-45af-3e45-b8d0-0cb83086a2c9",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "id" : "adf3a9f3-ac9e-3b92-8ff5-35ce3d804aed",
        "name" : "Output",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 29
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "0cc77401-8870-37d7-8712-78beeb9966e3",
        "id" : "15ccbd5a-80f0-3608-9759-6b349a8bf6fc",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "5efdff98-a5e9-3013-84d9-cc3357ccb8d8",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "5136f87e-48fb-3f88-b60e-e3a5b1afa93c",
        "name" : "CapNhatTrangThaiETLLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "zIndex" : 27
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "03b52734-040a-3f34-b575-f59d14b848b1",
        "id" : "26c3bc1b-3406-3b07-b77c-bf17911b2822",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "90102746-5f58-3656-aadd-ebe8cd507854",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "failure" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "1fb0038d-d9d4-364c-880e-692997df6f0f",
        "name" : "LayDanhSachBC",
        "type" : "PROCESSOR"
      },
      "zIndex" : 8
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "260cb945-8151-315d-935b-b459b6993414",
        "name" : "LogMessage",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "e086f18b-3fe3-3f9c-8885-f828c5837280",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "unmatched" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "3cc95655-3400-3579-a815-e447ac4e2606",
        "name" : "KiemTraLaBcCuoiCung",
        "type" : "PROCESSOR"
      },
      "zIndex" : 25
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "aa328d51-1131-3b2f-8459-27aad2558afd",
        "id" : "d0cdb4da-eae2-3a31-8efe-d40e7afa7392",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "be718e39-7f01-3252-a3af-63a7ff0dae36",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "dcdb240d-9e54-321c-b0db-d1930fe1c00b",
        "name" : "CapNhatETLLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "zIndex" : 14
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "5da7a001-7348-3b30-91cb-941688015de1",
        "name" : "CapNhatBcHienTaiLaDangXuLy",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "efd04538-aa58-3554-8c5d-012af034b164",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "unmatched" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "0cdf5897-5b6a-30ac-8e52-877fac24bd68",
        "name" : "KiemTraBcDaETLChua",
        "type" : "PROCESSOR"
      },
      "zIndex" : 17
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "5136f87e-48fb-3f88-b60e-e3a5b1afa93c",
        "name" : "CapNhatTrangThaiETLLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "4a875050-04d4-3063-b8bc-b4c27f2a6d2c",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "bcCuoiCung" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "3cc95655-3400-3579-a815-e447ac4e2606",
        "name" : "KiemTraLaBcCuoiCung",
        "type" : "PROCESSOR"
      },
      "zIndex" : 26
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "2aae8068-598e-3d94-96ed-3947cb037938",
        "id" : "393dc900-512e-36e2-baf8-5e4d2f8ea483",
        "name" : "BcId",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "1f701c3f-f637-3966-8638-a23d5351f9e1",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "matched" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "112b2ee1-09dc-381c-ae20-e68e18f84138",
        "name" : "ChuyenContentBcLenAttribute",
        "type" : "PROCESSOR"
      },
      "zIndex" : 15
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
        "id" : "9116237a-68c4-3234-b505-d0d54ed7f0c5",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "7653297c-a640-3e7e-bde9-5c21adf3df3f",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "5da7a001-7348-3b30-91cb-941688015de1",
        "name" : "CapNhatBcHienTaiLaDangXuLy",
        "type" : "PROCESSOR"
      },
      "zIndex" : 19
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "8ec81e63-c217-3444-8eef-242d615f9720",
        "id" : "64068399-e571-37f1-8abe-1c07cc1ea8e5",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "8bd896bd-64a2-3659-be1e-f87769a306fd",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "05476764-c5db-3856-b73c-8ea3a70e570b",
        "name" : "CapNhatTrangThaiBcHienTaiLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "zIndex" : 23
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "dcdb240d-9e54-321c-b0db-d1930fe1c00b",
        "name" : "CapNhatETLLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "4ab058c7-52da-316e-9fc4-1c59729d7206",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "isEmptyJsonArray " ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "1774681b-ca1d-3390-85c0-ee5c4e681d3d",
        "name" : "KiemTraDanhSachBcTrong",
        "type" : "PROCESSOR"
      },
      "zIndex" : 13
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "id" : "1a474885-a9d1-3b27-973c-d7d705c36788",
        "name" : "input",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "f9111e2a-65a1-3f7d-b2b7-a69d4df3b4b1",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
        "id" : "decc5801-0f29-3c7d-aaa1-f97a98f83520",
        "name" : "Output",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 21
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
        "id" : "572276bb-3237-390d-8b67-d7ddd77fc65d",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "878305c8-31fd-310a-bcea-4029919bc4da",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "99b444bd-5d1b-3389-bfcf-f8243cd5b15b",
        "name" : "CapNhatETLLaDangXuLy",
        "type" : "PROCESSOR"
      },
      "zIndex" : 5
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
        "id" : "87ea46eb-f99b-32b8-9dbd-3f9056c74995",
        "name" : "Input",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "ceb0aa3f-6fff-38c6-9df8-0c365e22a6fc",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
        "id" : "a229f77a-bdcf-3c40-9d47-ae3d8dd390bb",
        "name" : "stateBcOut",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 20
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "1774681b-ca1d-3390-85c0-ee5c4e681d3d",
        "name" : "KiemTraDanhSachBcTrong",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "5d73e291-b170-3dbb-bd8b-6b30e9006418",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "original" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "96b5172e-db84-3891-bfc8-0b96074dab1f",
        "name" : "DuyetTungBC",
        "type" : "PROCESSOR"
      },
      "zIndex" : 11
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "847ef9b6-d151-3fe8-b263-2c6c40a260ef",
        "name" : "KiemTraETLDangXuLy",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "19cfa4ac-377e-3341-88fe-f5ceea993d86",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "9f06666e-e1f4-302e-a791-0026d5babad7",
        "id" : "84cf6815-29a2-36a9-901b-e9171858a236",
        "name" : "ouput",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 2
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "99b444bd-5d1b-3389-bfcf-f8243cd5b15b",
        "name" : "CapNhatETLLaDangXuLy",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "46a051b1-80a5-3eb8-b4eb-feb20d9289a3",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "unmatched" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "847ef9b6-d151-3fe8-b263-2c6c40a260ef",
        "name" : "KiemTraETLDangXuLy",
        "type" : "PROCESSOR"
      },
      "zIndex" : 3
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
        "id" : "f38a92a2-4ba5-3cc6-a1d1-c045cdc021a2",
        "name" : "TrangThai",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "f3e8b811-4090-3358-b76e-2f20b57724e7",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "failure" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "96b5172e-db84-3891-bfc8-0b96074dab1f",
        "name" : "DuyetTungBC",
        "type" : "PROCESSOR"
      },
      "zIndex" : 10
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "0cdf5897-5b6a-30ac-8e52-877fac24bd68",
        "name" : "KiemTraBcDaETLChua",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "4c89d3ad-2baa-30d0-a2c2-0ef1423a4445",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "2aae8068-598e-3d94-96ed-3947cb037938",
        "id" : "ef74e471-1d43-3797-9c48-c50684130ef6",
        "name" : "stateBcOut",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 16
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "ba8699c9-8e46-3393-996f-d6a353e45afa",
        "name" : "Data to JSON",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "d2d988d5-ab4a-3cee-9583-0a2650ba4720",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "1fb0038d-d9d4-364c-880e-692997df6f0f",
        "name" : "LayDanhSachBC",
        "type" : "PROCESSOR"
      },
      "zIndex" : 7
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
        "id" : "aafdf295-844d-3fdd-89fd-264c80ad23aa",
        "name" : "input",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "a8bddef9-e936-37ee-b646-f0d0a09c8ee7",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "0cc77401-8870-37d7-8712-78beeb9966e3",
        "id" : "fd40fa60-1844-3fa0-84a0-472760fd140f",
        "name" : "stateOut",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 28
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "c960b738-713f-38d6-9cb0-c356c4f3a1a4",
        "name" : "LogMessage",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "e4604106-6177-3407-aa59-fe0134e5e0f0",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "HoanThanhETLRoi" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "0cdf5897-5b6a-30ac-8e52-877fac24bd68",
        "name" : "KiemTraBcDaETLChua",
        "type" : "PROCESSOR"
      },
      "zIndex" : 18
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "3cc95655-3400-3579-a815-e447ac4e2606",
        "name" : "KiemTraLaBcCuoiCung",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "a2f7bf9c-136e-35a4-a301-e0b7d049a479",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "8ec81e63-c217-3444-8eef-242d615f9720",
        "id" : "3d792e6a-4062-3a81-8e56-1e9fc76193d7",
        "name" : "stateBcOut",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 24
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "96b5172e-db84-3891-bfc8-0b96074dab1f",
        "name" : "DuyetTungBC",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "71a94fe0-d24b-3e82-bf85-f16a2a00e3ed",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "ba8699c9-8e46-3393-996f-d6a353e45afa",
        "name" : "Data to JSON",
        "type" : "PROCESSOR"
      },
      "zIndex" : 9
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "groupId" : "9f06666e-e1f4-302e-a791-0026d5babad7",
        "id" : "2dfa71a3-f9b7-3e46-a0a3-0f3bb9e3beb2",
        "name" : "input",
        "type" : "INPUT_PORT"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "71455809-cc02-3a98-8fa9-c8f6198f4b40",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "success" ],
      "source" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "a4fb998c-7538-3cee-ac9a-234f9bf5fc6e",
        "name" : "KhoiTao",
        "type" : "PROCESSOR"
      },
      "zIndex" : 1
    }, {
      "backPressureDataSizeThreshold" : "1 GB",
      "backPressureObjectThreshold" : 10000,
      "bends" : [ ],
      "componentType" : "CONNECTION",
      "destination" : {
        "comments" : "",
        "groupId" : "flow-contents-group",
        "id" : "05476764-c5db-3856-b73c-8ea3a70e570b",
        "name" : "CapNhatTrangThaiBcHienTaiLaHoanThanh",
        "type" : "PROCESSOR"
      },
      "flowFileExpiration" : "0 sec",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "a9c2acd5-38f1-32db-ab0e-fc3bc862db28",
      "labelIndex" : 0,
      "loadBalanceCompression" : "DO_NOT_COMPRESS",
      "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
      "name" : "",
      "partitioningAttribute" : "",
      "prioritizers" : [ ],
      "selectedRelationships" : [ "" ],
      "source" : {
        "groupId" : "d9912cde-5554-36dc-91e7-ced8c541f581",
        "id" : "7d9ca90f-e320-3084-9583-3a2906c4aec5",
        "name" : "Output",
        "type" : "OUTPUT_PORT"
      },
      "zIndex" : 30
    } ],
    "controllerServices" : [ {
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-dbcp-service-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "CONTROLLER_SERVICE",
      "controllerServiceApis" : [ {
        "bundle" : {
          "artifact" : "nifi-standard-services-api-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "type" : "org.apache.nifi.dbcp.DBCPService"
      } ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "f726dee7-cfcd-3a23-94d5-cb27ac10cbdb",
      "name" : "DBCPConnectionPool",
      "properties" : {
        "dbcp-min-idle-conns" : "0",
        "Max Wait Time" : "500 millis",
        "Database Driver Class Name" : "#{DbDriverClassName}",
        "dbcp-min-evictable-idle-time" : "30 mins",
        "Max Total Connections" : "8",
        "dbcp-max-conn-lifetime" : "-1",
        "Database Connection URL" : "#{DbConnectString}",
        "dbcp-time-between-eviction-runs" : "-1",
        "Database User" : "#{DbAccount}",
        "dbcp-soft-min-evictable-idle-time" : "-1",
        "database-driver-locations" : "#{DbDriverLocation}",
        "dbcp-max-idle-conns" : "8"
      },
      "propertyDescriptors" : {
        "dbcp-min-idle-conns" : {
          "displayName" : "Minimum Idle Connections",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-min-idle-conns",
          "sensitive" : false
        },
        "Max Wait Time" : {
          "displayName" : "Max Wait Time",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Max Wait Time",
          "sensitive" : false
        },
        "Database Driver Class Name" : {
          "displayName" : "Database Driver Class Name",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Database Driver Class Name",
          "sensitive" : false
        },
        "dbcp-min-evictable-idle-time" : {
          "displayName" : "Minimum Evictable Idle Time",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-min-evictable-idle-time",
          "sensitive" : false
        },
        "Max Total Connections" : {
          "displayName" : "Max Total Connections",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Max Total Connections",
          "sensitive" : false
        },
        "dbcp-max-conn-lifetime" : {
          "displayName" : "Max Connection Lifetime",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-max-conn-lifetime",
          "sensitive" : false
        },
        "Validation-query" : {
          "displayName" : "Validation query",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Validation-query",
          "sensitive" : false
        },
        "Database Connection URL" : {
          "displayName" : "Database Connection URL",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Database Connection URL",
          "sensitive" : false
        },
        "dbcp-time-between-eviction-runs" : {
          "displayName" : "Time Between Eviction Runs",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-time-between-eviction-runs",
          "sensitive" : false
        },
        "Database User" : {
          "displayName" : "Database User",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Database User",
          "sensitive" : false
        },
        "kerberos-user-service" : {
          "displayName" : "Kerberos User Service",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "kerberos-user-service",
          "sensitive" : false
        },
        "dbcp-soft-min-evictable-idle-time" : {
          "displayName" : "Soft Minimum Evictable Idle Time",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-soft-min-evictable-idle-time",
          "sensitive" : false
        },
        "database-driver-locations" : {
          "displayName" : "Database Driver Location(s)",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "database-driver-locations",
          "resourceDefinition" : {
            "cardinality" : "MULTIPLE",
            "resourceTypes" : [ "FILE", "URL", "DIRECTORY" ]
          },
          "sensitive" : false
        },
        "dbcp-max-idle-conns" : {
          "displayName" : "Max Idle Connections",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbcp-max-idle-conns",
          "sensitive" : false
        },
        "Password" : {
          "displayName" : "Password",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Password",
          "sensitive" : true
        }
      },
      "scheduledState" : "DISABLED",
      "type" : "org.apache.nifi.dbcp.DBCPConnectionPool"
    }, {
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-record-serialization-services-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "CONTROLLER_SERVICE",
      "controllerServiceApis" : [ {
        "bundle" : {
          "artifact" : "nifi-standard-services-api-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "type" : "org.apache.nifi.serialization.RecordReaderFactory"
      } ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "d1900214-a631-39c7-b7fb-00da2780645e",
      "name" : "AvroReader",
      "properties" : {
        "schema-name" : "${schema.name}",
        "cache-size" : "1000",
        "schema-access-strategy" : "embedded-avro-schema",
        "schema-text" : "${avro.schema}"
      },
      "propertyDescriptors" : {
        "schema-reference-reader" : {
          "displayName" : "Schema Reference Reader",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "schema-reference-reader",
          "sensitive" : false
        },
        "schema-branch" : {
          "displayName" : "Schema Branch",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-branch",
          "sensitive" : false
        },
        "schema-name" : {
          "displayName" : "Schema Name",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-name",
          "sensitive" : false
        },
        "cache-size" : {
          "displayName" : "Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "cache-size",
          "sensitive" : false
        },
        "schema-registry" : {
          "displayName" : "Schema Registry",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "schema-registry",
          "sensitive" : false
        },
        "schema-access-strategy" : {
          "displayName" : "Schema Access Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-access-strategy",
          "sensitive" : false
        },
        "schema-version" : {
          "displayName" : "Schema Version",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-version",
          "sensitive" : false
        },
        "schema-text" : {
          "displayName" : "Schema Text",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-text",
          "sensitive" : false
        }
      },
      "scheduledState" : "DISABLED",
      "type" : "org.apache.nifi.avro.AvroReader"
    }, {
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-record-serialization-services-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "CONTROLLER_SERVICE",
      "controllerServiceApis" : [ {
        "bundle" : {
          "artifact" : "nifi-standard-services-api-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "type" : "org.apache.nifi.serialization.RecordSetWriterFactory"
      } ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "2d17ef4c-c0cc-3b2f-840a-19ea05a3f87a",
      "name" : "JsonRecordSetWriter",
      "properties" : {
        "Allow Scientific Notation" : "false",
        "compression-level" : "1",
        "Pretty Print JSON" : "false",
        "compression-format" : "none",
        "Schema Write Strategy" : "no-schema",
        "suppress-nulls" : "never-suppress",
        "output-grouping" : "output-array",
        "schema-name" : "${schema.name}",
        "schema-access-strategy" : "inherit-record-schema",
        "schema-text" : "${avro.schema}"
      },
      "propertyDescriptors" : {
        "schema-reference-reader" : {
          "displayName" : "Schema Reference Reader",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "schema-reference-reader",
          "sensitive" : false
        },
        "schema-branch" : {
          "displayName" : "Schema Branch",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-branch",
          "sensitive" : false
        },
        "Allow Scientific Notation" : {
          "displayName" : "Allow Scientific Notation",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Allow Scientific Notation",
          "sensitive" : false
        },
        "compression-level" : {
          "displayName" : "Compression Level",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "compression-level",
          "sensitive" : false
        },
        "schema-cache" : {
          "displayName" : "Schema Cache",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "schema-cache",
          "sensitive" : false
        },
        "Timestamp Format" : {
          "displayName" : "Timestamp Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Timestamp Format",
          "sensitive" : false
        },
        "Date Format" : {
          "displayName" : "Date Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Date Format",
          "sensitive" : false
        },
        "Pretty Print JSON" : {
          "displayName" : "Pretty Print JSON",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Pretty Print JSON",
          "sensitive" : false
        },
        "compression-format" : {
          "displayName" : "Compression Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "compression-format",
          "sensitive" : false
        },
        "Schema Write Strategy" : {
          "displayName" : "Schema Write Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Schema Write Strategy",
          "sensitive" : false
        },
        "suppress-nulls" : {
          "displayName" : "Suppress Null Values",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "suppress-nulls",
          "sensitive" : false
        },
        "output-grouping" : {
          "displayName" : "Output Grouping",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "output-grouping",
          "sensitive" : false
        },
        "schema-name" : {
          "displayName" : "Schema Name",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-name",
          "sensitive" : false
        },
        "schema-registry" : {
          "displayName" : "Schema Registry",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "schema-registry",
          "sensitive" : false
        },
        "Time Format" : {
          "displayName" : "Time Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Time Format",
          "sensitive" : false
        },
        "schema-access-strategy" : {
          "displayName" : "Schema Access Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-access-strategy",
          "sensitive" : false
        },
        "schema-version" : {
          "displayName" : "Schema Version",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-version",
          "sensitive" : false
        },
        "schema-text" : {
          "displayName" : "Schema Text",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "schema-text",
          "sensitive" : false
        },
        "Schema Reference Writer" : {
          "displayName" : "Schema Reference Writer",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "Schema Reference Writer",
          "sensitive" : false
        }
      },
      "scheduledState" : "DISABLED",
      "type" : "org.apache.nifi.json.JsonRecordSetWriter"
    } ],
    "defaultBackPressureDataSizeThreshold" : "1 GB",
    "defaultBackPressureObjectThreshold" : 10000,
    "defaultFlowFileExpiration" : "0 sec",
    "executionEngine" : "INHERITED",
    "externalControllerServiceReferences" : { },
    "flowFileConcurrency" : "UNBOUNDED",
    "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
    "funnels" : [ ],
    "identifier" : "flow-contents-group",
    "inputPorts" : [ ],
    "labels" : [ ],
    "maxConcurrentTasks" : 1,
    "name" : "FACT_BALANCE",
    "outputPorts" : [ ],
    "parameterContextName" : "ETL",
    "position" : {
      "x" : 0.0,
      "y" : 0.0
    },
    "processGroups" : [ {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8ec81e63-c217-3444-8eef-242d615f9720",
          "id" : "23cc0862-5b2b-38cc-b884-00db91f20636",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8ec81e63-c217-3444-8eef-242d615f9720",
        "identifier" : "5f96ab90-a4e8-3d9a-a1b6-6447266097b8",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "8ec81e63-c217-3444-8eef-242d615f9720",
          "id" : "40bdf9ec-058e-3a28-8ca3-ed94de2d03ca",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8ec81e63-c217-3444-8eef-242d615f9720",
          "id" : "40bdf9ec-058e-3a28-8ca3-ed94de2d03ca",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8ec81e63-c217-3444-8eef-242d615f9720",
        "identifier" : "e47c7902-e562-3b20-8bb9-e5bf659260ed",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "8ec81e63-c217-3444-8eef-242d615f9720",
          "id" : "f008e529-8cb7-3b86-86b1-556bfa83c5de",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8ec81e63-c217-3444-8eef-242d615f9720",
          "id" : "10f20d6d-95ad-30d7-83eb-1fd1c3ff5705",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8ec81e63-c217-3444-8eef-242d615f9720",
        "identifier" : "01326bc1-64b8-37f7-94f9-c52019a69992",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "8ec81e63-c217-3444-8eef-242d615f9720",
          "id" : "40bdf9ec-058e-3a28-8ca3-ed94de2d03ca",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8ec81e63-c217-3444-8eef-242d615f9720",
          "id" : "f008e529-8cb7-3b86-86b1-556bfa83c5de",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8ec81e63-c217-3444-8eef-242d615f9720",
        "identifier" : "26f7aed8-9cf6-3b98-87c7-df6c42a5a8a0",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "8ec81e63-c217-3444-8eef-242d615f9720",
          "id" : "64068399-e571-37f1-8abe-1c07cc1ea8e5",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "8ec81e63-c217-3444-8eef-242d615f9720",
          "id" : "3d792e6a-4062-3a81-8e56-1e9fc76193d7",
          "name" : "stateBcOut",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8ec81e63-c217-3444-8eef-242d615f9720",
        "identifier" : "d2e05706-d81c-3d2d-9dc8-d2e2e12f8ac1",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "8ec81e63-c217-3444-8eef-242d615f9720",
          "id" : "23cc0862-5b2b-38cc-b884-00db91f20636",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8ec81e63-c217-3444-8eef-242d615f9720",
          "id" : "10f20d6d-95ad-30d7-83eb-1fd1c3ff5705",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8ec81e63-c217-3444-8eef-242d615f9720",
        "identifier" : "9da4149f-89e1-39cd-a3d6-b921741df9ca",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "8ec81e63-c217-3444-8eef-242d615f9720",
          "id" : "23cc0862-5b2b-38cc-b884-00db91f20636",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "8ec81e63-c217-3444-8eef-242d615f9720",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "8ec81e63-c217-3444-8eef-242d615f9720",
        "identifier" : "64068399-e571-37f1-8abe-1c07cc1ea8e5",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LuuTrangThaiBCHienTai",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "8ec81e63-c217-3444-8eef-242d615f9720",
        "identifier" : "3d792e6a-4062-3a81-8e56-1e9fc76193d7",
        "name" : "stateBcOut",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 1552.0,
          "y" : -154.5
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -248.0,
        "y" : 3888.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "8ec81e63-c217-3444-8eef-242d615f9720",
        "identifier" : "f008e529-8cb7-3b86-86b1-556bfa83c5de",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "filename" : "${stateBc.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateBc.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateBc.lastExecutionTime" : {
            "displayName" : "stateBc.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateBc.lastExecutionTime",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "8ec81e63-c217-3444-8eef-242d615f9720",
        "identifier" : "23cc0862-5b2b-38cc-b884-00db91f20636",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${stateBc.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "8ec81e63-c217-3444-8eef-242d615f9720",
        "identifier" : "40bdf9ec-058e-3a28-8ca3-ed94de2d03ca",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${stateBc.name}\",\n  \"isActive\": ${stateBc.isActive},\n  \"lastExecutionTime\": \"${stateBc.lastExecutionTime}\",\n  \"startTime\": \"${stateBc.startTime}\",\n  \"endTime\": \"${stateBc.endTime}\",\n  \"status\": \"${stateBc.status}\",\n  \"sequenceNumber\": \"${stateBc.sequenceNumber}\",\n  \"message\": \"${stateBc.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "8ec81e63-c217-3444-8eef-242d615f9720",
        "identifier" : "10f20d6d-95ad-30d7-83eb-1fd1c3ff5705",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "d9912cde-5554-36dc-91e7-ced8c541f581",
          "id" : "e8399ce3-f7df-3cfd-a2d5-4bfacddbf663",
          "name" : "TrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "d9912cde-5554-36dc-91e7-ced8c541f581",
        "identifier" : "15fe9708-7672-3600-99b2-2df9eafd11a7",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "TrangTiep",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "nextPage" ],
        "source" : {
          "comments" : "",
          "groupId" : "d9912cde-5554-36dc-91e7-ced8c541f581",
          "id" : "485077ed-e867-3e9f-aacc-96c938a52c56",
          "name" : "KiemTraCoTrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "zIndex" : 6
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "d9912cde-5554-36dc-91e7-ced8c541f581",
          "id" : "de725e4e-f8d5-387b-955c-73c344a1bbcd",
          "name" : "KhoiTao",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "d9912cde-5554-36dc-91e7-ced8c541f581",
        "identifier" : "5901d1b2-a668-3071-99d4-203c7c746040",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "d9912cde-5554-36dc-91e7-ced8c541f581",
          "id" : "b37aa3bb-1c2f-360b-a9eb-fcf20ae0cb3f",
          "name" : "Input",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 11
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "id" : "80ce6d32-f1cc-3d4f-8ce3-0a27bdf4d6fe",
          "name" : "Input",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "d9912cde-5554-36dc-91e7-ced8c541f581",
        "identifier" : "93d10396-842b-32ef-a00a-2fa439b46143",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "d9912cde-5554-36dc-91e7-ced8c541f581",
          "id" : "de725e4e-f8d5-387b-955c-73c344a1bbcd",
          "name" : "KhoiTao",
          "type" : "PROCESSOR"
        },
        "zIndex" : 2
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "id" : "80ce6d32-f1cc-3d4f-8ce3-0a27bdf4d6fe",
          "name" : "Input",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "d9912cde-5554-36dc-91e7-ced8c541f581",
        "identifier" : "9c1b0351-0a98-3361-95d4-396d7754059d",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "d9912cde-5554-36dc-91e7-ced8c541f581",
          "id" : "e8399ce3-f7df-3cfd-a2d5-4bfacddbf663",
          "name" : "TrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "zIndex" : 7
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "d9912cde-5554-36dc-91e7-ced8c541f581",
          "id" : "485077ed-e867-3e9f-aacc-96c938a52c56",
          "name" : "KiemTraCoTrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "d9912cde-5554-36dc-91e7-ced8c541f581",
        "identifier" : "c4d94623-01e2-3341-b1fe-c2de1638d188",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "id" : "aebcc4d5-8a80-3e78-ac06-c27908924e7c",
          "name" : "Ouput",
          "type" : "OUTPUT_PORT"
        },
        "zIndex" : 3
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "d9912cde-5554-36dc-91e7-ced8c541f581",
          "id" : "7d9ca90f-e320-3084-9583-3a2906c4aec5",
          "name" : "Output",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "d9912cde-5554-36dc-91e7-ced8c541f581",
        "identifier" : "6c93a4dd-f472-3d80-90db-4f9b7b523c57",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "unmatched" ],
        "source" : {
          "comments" : "",
          "groupId" : "d9912cde-5554-36dc-91e7-ced8c541f581",
          "id" : "485077ed-e867-3e9f-aacc-96c938a52c56",
          "name" : "KiemTraCoTrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "zIndex" : 10
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "d9912cde-5554-36dc-91e7-ced8c541f581",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "d9912cde-5554-36dc-91e7-ced8c541f581",
        "identifier" : "b37aa3bb-1c2f-360b-a9eb-fcf20ae0cb3f",
        "name" : "Input",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -344.0,
          "y" : -256.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "ETLAdAccountBalanceBatch",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "d9912cde-5554-36dc-91e7-ced8c541f581",
        "identifier" : "7d9ca90f-e320-3084-9583-3a2906c4aec5",
        "name" : "Output",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 72.0,
          "y" : 856.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "TikTokETL",
      "position" : {
        "x" : -248.0,
        "y" : 3408.0
      },
      "processGroups" : [ {
        "comments" : "",
        "componentType" : "PROCESS_GROUP",
        "connections" : [ {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "7cfcc4b9-ee69-308d-9a64-cf00147fcdb2",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "d576b8d3-0d66-3581-92a0-9fb368e1685d",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "NoNewData",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "unmatched" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "d4da998f-2929-3bfb-bd27-9f88f6701e34",
            "name" : "CheckHasData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 10
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "c63756ec-4d08-31d1-b206-b8fd50c38777",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "dac5e2e5-05fb-37ed-9725-3e92176743fc",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "c709ab9a-37bb-33a6-b234-ab20c41f5a36",
            "name" : "LayDanhSachAdAccountBalanceChuaETL",
            "type" : "PROCESSOR"
          },
          "zIndex" : 3
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "be5ea881-7031-3334-a19a-6173ee3c53c5",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "5370117b-9905-3be7-9941-b359c6b00d77",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "7736828c-5862-34b5-87fb-5f1c64d55d0a",
            "name" : "InsertAndUpdateToDataBase",
            "type" : "PROCESSOR"
          },
          "zIndex" : 25
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "aebcc4d5-8a80-3e78-ac06-c27908924e7c",
            "name" : "Ouput",
            "type" : "OUTPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "81ce472f-d813-3a11-9f37-4f6ed58ea18d",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "7cfcc4b9-ee69-308d-9a64-cf00147fcdb2",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "zIndex" : 7
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "be5ea881-7031-3334-a19a-6173ee3c53c5",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "df4a9058-c5a2-309a-9b80-fd8ea59ab403",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "0ca5a373-5cd6-38ba-a1d7-eea73c195dbf",
            "name" : "LayDanhSachDuLieuETLCu",
            "type" : "PROCESSOR"
          },
          "zIndex" : 19
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "ae8857e2-f73f-3a5b-9bcc-abe3d613804a",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "41f817af-b1d3-3d24-9eeb-1834d3218019",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "0ca5a373-5cd6-38ba-a1d7-eea73c195dbf",
            "name" : "LayDanhSachDuLieuETLCu",
            "type" : "PROCESSOR"
          },
          "zIndex" : 18
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "7cfcc4b9-ee69-308d-9a64-cf00147fcdb2",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "8cd7452c-7dd1-3b5e-95eb-ff0a72225a18",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "801a086e-c410-3701-8c9b-21ee739fff62",
            "name" : "SaveRawTemp",
            "type" : "PROCESSOR"
          },
          "zIndex" : 14
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "253176ab-4234-3660-8986-8154e8809297",
            "name" : "KhoiTao",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "f366e96b-eb32-3592-a3e9-5e2a20fba177",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "80ce6d32-f1cc-3d4f-8ce3-0a27bdf4d6fe",
            "name" : "Input",
            "type" : "INPUT_PORT"
          },
          "zIndex" : 1
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "ab821d96-d0b7-3878-9186-0f3ca8f50a66",
            "name" : "RouteOnAttributeCheckLastPage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "f951cff0-8bb6-3c6b-b9a8-992c76c69bb1",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "7736828c-5862-34b5-87fb-5f1c64d55d0a",
            "name" : "InsertAndUpdateToDataBase",
            "type" : "PROCESSOR"
          },
          "zIndex" : 23
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "801a086e-c410-3701-8c9b-21ee739fff62",
            "name" : "SaveRawTemp",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "38a1eb01-ae27-350d-bdea-52df496a24c8",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "hasData" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "d4da998f-2929-3bfb-bd27-9f88f6701e34",
            "name" : "CheckHasData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 17
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "709a9dd5-48fc-3f9d-a649-929cccdb8802",
            "name" : "ChuanHoaDuLieuRaw",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "06a5415c-741b-346a-9e37-9afe203dcc09",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "c63756ec-4d08-31d1-b206-b8fd50c38777",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "zIndex" : 5
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "0ca5a373-5cd6-38ba-a1d7-eea73c195dbf",
            "name" : "LayDanhSachDuLieuETLCu",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "852dc66c-32af-3839-877a-f11883b1e1bb",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "801a086e-c410-3701-8c9b-21ee739fff62",
            "name" : "SaveRawTemp",
            "type" : "PROCESSOR"
          },
          "zIndex" : 29
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "7cfcc4b9-ee69-308d-9a64-cf00147fcdb2",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "2badefbf-b0c4-351d-b1e6-23a75c2ff531",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "709a9dd5-48fc-3f9d-a649-929cccdb8802",
            "name" : "ChuanHoaDuLieuRaw",
            "type" : "PROCESSOR"
          },
          "zIndex" : 9
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "7cfcc4b9-ee69-308d-9a64-cf00147fcdb2",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "44d6f6fe-d3c1-38f6-ab7f-5feddd6d875d",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "c63756ec-4d08-31d1-b206-b8fd50c38777",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "zIndex" : 6
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "be5ea881-7031-3334-a19a-6173ee3c53c5",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "43209322-4ab6-3914-b2c5-6a1c40e3c067",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "isLastPage" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "ab821d96-d0b7-3878-9186-0f3ca8f50a66",
            "name" : "RouteOnAttributeCheckLastPage",
            "type" : "PROCESSOR"
          },
          "zIndex" : 26
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "d4da998f-2929-3bfb-bd27-9f88f6701e34",
            "name" : "CheckHasData",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "a2c86b52-c4ee-3062-af0d-1015b76973be",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "709a9dd5-48fc-3f9d-a649-929cccdb8802",
            "name" : "ChuanHoaDuLieuRaw",
            "type" : "PROCESSOR"
          },
          "zIndex" : 8
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "7736828c-5862-34b5-87fb-5f1c64d55d0a",
            "name" : "InsertAndUpdateToDataBase",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "61ecb8aa-a076-32cc-bf72-044362dc9c27",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "bda6033b-e5c2-35d1-ab73-f53e44c80c24",
            "name" : "TransformData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 21
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "2fbdb3d9-f3aa-3227-b598-eb575cae76aa",
            "name" : "CleanupTemp",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "c93fcadd-b479-3135-be7a-68390ae21a2f",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "3c6cc1be-731c-3052-aad0-df32e3607a60",
            "name" : "UpdateAttributeContinueTrue",
            "type" : "PROCESSOR"
          },
          "zIndex" : 24
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "7cfcc4b9-ee69-308d-9a64-cf00147fcdb2",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "26d51c06-ed2d-3213-b550-04ef0064bc7c",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success", "failure", "not found" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "be5ea881-7031-3334-a19a-6173ee3c53c5",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "zIndex" : 28
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "c709ab9a-37bb-33a6-b234-ab20c41f5a36",
            "name" : "LayDanhSachAdAccountBalanceChuaETL",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "2b992ed9-a51b-3e5f-a75e-bf2de0ede6a4",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "253176ab-4234-3660-8986-8154e8809297",
            "name" : "KhoiTao",
            "type" : "PROCESSOR"
          },
          "zIndex" : 2
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "7cfcc4b9-ee69-308d-9a64-cf00147fcdb2",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "35a62585-9329-32e4-92d2-a3c995ac1929",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "c709ab9a-37bb-33a6-b234-ab20c41f5a36",
            "name" : "LayDanhSachAdAccountBalanceChuaETL",
            "type" : "PROCESSOR"
          },
          "zIndex" : 4
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "aebcc4d5-8a80-3e78-ac06-c27908924e7c",
            "name" : "Ouput",
            "type" : "OUTPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "e7e3a94a-0c00-3ba5-8e31-2ada25ae6755",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success", "failure", "not found" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "2fbdb3d9-f3aa-3227-b598-eb575cae76aa",
            "name" : "CleanupTemp",
            "type" : "PROCESSOR"
          },
          "zIndex" : 15
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "3c6cc1be-731c-3052-aad0-df32e3607a60",
            "name" : "UpdateAttributeContinueTrue",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "5d4a64f3-938c-3c0b-b026-0503d81ad711",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "unmatched" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "ab821d96-d0b7-3878-9186-0f3ca8f50a66",
            "name" : "RouteOnAttributeCheckLastPage",
            "type" : "PROCESSOR"
          },
          "zIndex" : 27
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "be5ea881-7031-3334-a19a-6173ee3c53c5",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "03a25fa2-d753-3451-af92-b8bfce71de3e",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "bda6033b-e5c2-35d1-ab73-f53e44c80c24",
            "name" : "TransformData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 22
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "bda6033b-e5c2-35d1-ab73-f53e44c80c24",
            "name" : "TransformData",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "53504df4-a3ce-35a3-8857-596d4f597222",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "f481975a-e07d-34ff-a321-26a18fabefa9",
            "id" : "ae8857e2-f73f-3a5b-9bcc-abe3d613804a",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "zIndex" : 20
        } ],
        "controllerServices" : [ ],
        "defaultBackPressureDataSizeThreshold" : "1 GB",
        "defaultBackPressureObjectThreshold" : 10000,
        "defaultFlowFileExpiration" : "0 sec",
        "executionEngine" : "INHERITED",
        "flowFileConcurrency" : "UNBOUNDED",
        "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
        "funnels" : [ ],
        "groupIdentifier" : "d9912cde-5554-36dc-91e7-ced8c541f581",
        "identifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
        "inputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "INPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "80ce6d32-f1cc-3d4f-8ce3-0a27bdf4d6fe",
          "name" : "Input",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : -134.344482421875,
            "y" : -193.37796020507812
          },
          "scheduledState" : "ENABLED",
          "type" : "INPUT_PORT"
        } ],
        "labels" : [ ],
        "maxConcurrentTasks" : 1,
        "name" : "ETLAdAccountBalanceBatch",
        "outputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "OUTPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "aebcc4d5-8a80-3e78-ac06-c27908924e7c",
          "name" : "Ouput",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : 472.0,
            "y" : 1008.0
          },
          "scheduledState" : "ENABLED",
          "type" : "OUTPUT_PORT"
        } ],
        "parameterContextName" : "TikTokETL",
        "position" : {
          "x" : 8.0,
          "y" : 184.0
        },
        "processGroups" : [ ],
        "processors" : [ {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "c63756ec-4d08-31d1-b206-b8fd50c38777",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ConvertRecord",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1012.966552734375,
            "y" : -208.0
          },
          "properties" : {
            "Include Zero Record FlowFiles" : "true",
            "Record Writer" : "2d17ef4c-c0cc-3b2f-840a-19ea05a3f87a",
            "Record Reader" : "d1900214-a631-39c7-b7fb-00da2780645e"
          },
          "propertyDescriptors" : {
            "Include Zero Record FlowFiles" : {
              "displayName" : "Include Zero Record FlowFiles",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Include Zero Record FlowFiles",
              "sensitive" : false
            },
            "Record Writer" : {
              "displayName" : "Record Writer",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Writer",
              "sensitive" : false
            },
            "Record Reader" : {
              "displayName" : "Record Reader",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Reader",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ConvertRecord",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "retry" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "7736828c-5862-34b5-87fb-5f1c64d55d0a",
          "maxBackoffPeriod" : "10 mins",
          "name" : "InsertAndUpdateToDataBase",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2944.0,
            "y" : 944.0
          },
          "properties" : {
            "Support Fragmented Transactions" : "false",
            "Batch Size" : "#{PageSizeMax}",
            "Obtain Generated Keys" : "false",
            "JDBC Connection Pool" : "f726dee7-cfcd-3a23-94d5-cb27ac10cbdb",
            "database-session-autocommit" : "true",
            "rollback-on-failure" : "false"
          },
          "propertyDescriptors" : {
            "Support Fragmented Transactions" : {
              "displayName" : "Support Fragmented Transactions",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Support Fragmented Transactions",
              "sensitive" : false
            },
            "putsql-sql-statement" : {
              "displayName" : "SQL Statement",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "putsql-sql-statement",
              "sensitive" : false
            },
            "Transaction Timeout" : {
              "displayName" : "Transaction Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Transaction Timeout",
              "sensitive" : false
            },
            "Batch Size" : {
              "displayName" : "Batch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Batch Size",
              "sensitive" : false
            },
            "Obtain Generated Keys" : {
              "displayName" : "Obtain Generated Keys",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Obtain Generated Keys",
              "sensitive" : false
            },
            "JDBC Connection Pool" : {
              "displayName" : "JDBC Connection Pool",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "JDBC Connection Pool",
              "sensitive" : false
            },
            "database-session-autocommit" : {
              "displayName" : "Database Session AutoCommit",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "database-session-autocommit",
              "sensitive" : false
            },
            "rollback-on-failure" : {
              "displayName" : "Rollback On Failure",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "rollback-on-failure",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.PutSQL",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "801a086e-c410-3701-8c9b-21ee739fff62",
          "maxBackoffPeriod" : "10 mins",
          "name" : "SaveRawTemp",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2448.0,
            "y" : -208.0
          },
          "properties" : {
            "Create Missing Directories" : "true",
            "Directory" : "${stateCurrent.directory}",
            "Conflict Resolution Strategy" : "replace"
          },
          "propertyDescriptors" : {
            "Group" : {
              "displayName" : "Group",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Group",
              "sensitive" : false
            },
            "Owner" : {
              "displayName" : "Owner",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Owner",
              "sensitive" : false
            },
            "Create Missing Directories" : {
              "displayName" : "Create Missing Directories",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Create Missing Directories",
              "sensitive" : false
            },
            "Permissions" : {
              "displayName" : "Permissions",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Permissions",
              "sensitive" : false
            },
            "Maximum File Count" : {
              "displayName" : "Maximum File Count",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum File Count",
              "sensitive" : false
            },
            "Last Modified Time" : {
              "displayName" : "Last Modified Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Last Modified Time",
              "sensitive" : false
            },
            "Directory" : {
              "displayName" : "Directory",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory",
              "sensitive" : false
            },
            "Conflict Resolution Strategy" : {
              "displayName" : "Conflict Resolution Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Conflict Resolution Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.PutFile",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "7cfcc4b9-ee69-308d-9a64-cf00147fcdb2",
          "maxBackoffPeriod" : "10 mins",
          "name" : "UpdateAttributeContinueFalse",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 432.0,
            "y" : 480.0
          },
          "properties" : {
            "state.continue" : "0",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100"
          },
          "propertyDescriptors" : {
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "state.continue" : {
              "displayName" : "state.continue",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.continue",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "3c6cc1be-731c-3052-aad0-df32e3607a60",
          "maxBackoffPeriod" : "10 mins",
          "name" : "UpdateAttributeContinueTrue",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1504.0,
            "y" : 928.0
          },
          "properties" : {
            "state.continue" : "1",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100"
          },
          "propertyDescriptors" : {
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "state.continue" : {
              "displayName" : "state.continue",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.continue",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "253176ab-4234-3660-8986-8154e8809297",
          "maxBackoffPeriod" : "10 mins",
          "name" : "KhoiTao",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 233.655517578125,
            "y" : -201.37796020507812
          },
          "properties" : {
            "stateCurrent.filename" : "${state.name}-bc-${stateBc.id}-ad-page${state.page}.json",
            "filename" : "${state.name}-bc-${stateBc.id}-ad-page${state.page}.json",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100",
            "stateCurrent.fullPath" : "#{TempPath}${Path.Separator}${state.name}${Path.Separator}${state.name}-bc-${stateBc.id}-ad-page${state.page}.json",
            "skip" : "${state.page:toNumber():minus(1):multiply(${state.pageSize:toNumber()})}",
            "stateCurrent.directory" : "#{TempPath}${Path.Separator}${state.name}"
          },
          "propertyDescriptors" : {
            "stateCurrent.filename" : {
              "displayName" : "stateCurrent.filename",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateCurrent.filename",
              "sensitive" : false
            },
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "filename" : {
              "displayName" : "filename",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "filename",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "stateCurrent.fullPath" : {
              "displayName" : "stateCurrent.fullPath",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateCurrent.fullPath",
              "sensitive" : false
            },
            "skip" : {
              "displayName" : "skip",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "skip",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            },
            "stateCurrent.directory" : {
              "displayName" : "stateCurrent.directory",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateCurrent.directory",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "c709ab9a-37bb-33a6-b234-ab20c41f5a36",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LayDanhSachAdAccountBalanceChuaETL",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 608.0,
            "y" : -208.0
          },
          "properties" : {
            "esql-max-rows" : "0",
            "dbf-default-precision" : "10",
            "Max Wait Time" : "0 seconds",
            "SQL Query" : "SELECT TOP (${state.pageSize})\n       r.[Id],\n       r.[BcId],\n       r.[AdvertiserId], \n       r.[Date],\n       r.[Currency],\n       r.[Timezone],\n       r.[AccountBalance],\n       r.[ValidAccountBalance],\n       r.[FrozenBalance],\n       r.[Tax],\n       r.[CashBalance],\n       r.[ValidCashBalance],\n       r.[GrantBalance],\n       r.[ValidGrantBalance],\n       r.[TransferableAmount],\n       r.[Budget],\n       r.[BudgetCost],\n       r.[BudgetRemaining],\n       r.[CreationTime],\n       r.[CreatorId],\n       r.[LastModificationTime],\n       r.[LastModifierId]\nFROM dbo.[Raw_RawBalanceAdAccounts] r\nWHERE r.[BcId] = '${stateBc.id}'\n  AND r.[AdvertiserId] IN ${stateAdAccounts.advertiserIds.inClause}\n  AND NOT EXISTS (\n      SELECT 1\n      FROM dbo.[Fact_FactBalances] f\n      WHERE f.[Type] = 'AdAccount'\n        AND f.[DimBusinessCenterId] = '${stateBc.dimId}'\n        AND f.[EntityId] = r.[AdvertiserId]      \n        AND f.[Date]     = r.[Date]      -- datetime2(7) khp tuyt i\n  )\nORDER BY r.[Date] DESC, r.[Id] DESC;",
            "Database Connection Pooling Service" : "f726dee7-cfcd-3a23-94d5-cb27ac10cbdb",
            "esql-auto-commit" : "true",
            "dbf-user-logical-types" : "false",
            "dbf-default-scale" : "0",
            "compression-format" : "NONE",
            "esql-output-batch-size" : "0",
            "esql-fetch-size" : "0",
            "dbf-normalize" : "false",
            "Content Output Strategy" : "EMPTY"
          },
          "propertyDescriptors" : {
            "esql-max-rows" : {
              "displayName" : "Max Rows Per Flow File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-max-rows",
              "sensitive" : false
            },
            "dbf-default-precision" : {
              "displayName" : "Default Decimal Precision",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-precision",
              "sensitive" : false
            },
            "Max Wait Time" : {
              "displayName" : "Max Wait Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Max Wait Time",
              "sensitive" : false
            },
            "SQL Query" : {
              "displayName" : "SQL Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "SQL Query",
              "sensitive" : false
            },
            "Database Connection Pooling Service" : {
              "displayName" : "Database Connection Pooling Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Database Connection Pooling Service",
              "sensitive" : false
            },
            "sql-post-query" : {
              "displayName" : "SQL Post-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-post-query",
              "sensitive" : false
            },
            "esql-auto-commit" : {
              "displayName" : "Set Auto Commit",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-auto-commit",
              "sensitive" : false
            },
            "dbf-user-logical-types" : {
              "displayName" : "Use Avro Logical Types",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-user-logical-types",
              "sensitive" : false
            },
            "dbf-default-scale" : {
              "displayName" : "Default Decimal Scale",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-scale",
              "sensitive" : false
            },
            "sql-pre-query" : {
              "displayName" : "SQL Pre-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-pre-query",
              "sensitive" : false
            },
            "compression-format" : {
              "displayName" : "Compression Format",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "compression-format",
              "sensitive" : false
            },
            "esql-output-batch-size" : {
              "displayName" : "Output Batch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-output-batch-size",
              "sensitive" : false
            },
            "esql-fetch-size" : {
              "displayName" : "Fetch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-fetch-size",
              "sensitive" : false
            },
            "dbf-normalize" : {
              "displayName" : "Normalize Table/Column Names",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-normalize",
              "sensitive" : false
            },
            "Content Output Strategy" : {
              "displayName" : "Content Output Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Content Output Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "d4da998f-2929-3bfb-bd27-9f88f6701e34",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CheckHasData",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1956.966552734375,
            "y" : -200.0
          },
          "properties" : {
            "Routing Strategy" : "Route to Property name",
            "hasData" : "${hasData:equals('true')}"
          },
          "propertyDescriptors" : {
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "hasData" : {
              "displayName" : "hasData",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "hasData",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-groovyx-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "bda6033b-e5c2-35d1-ab73-f53e44c80c24",
          "maxBackoffPeriod" : "10 mins",
          "name" : "TransformData",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2944.0,
            "y" : 656.0
          },
          "properties" : {
            "groovyx-script-body" : "import org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport java.time.LocalDateTime\nimport java.time.format.DateTimeFormatter\nimport java.time.format.DateTimeFormatterBuilder\nimport java.time.temporal.ChronoField\nimport java.util.UUID\nimport java.io.File\n\n// ================= Utils =================\ndef toDimDateId(String isoDateTime) {\n    def d = (isoDateTime ?: \"\").trim()\n    if (!d) return null\n    def day = d.substring(0, 10) // yyyy-MM-dd\n    return day.replace(\"-\", \"\").toInteger() // yyyyMMdd\n}\n\ndef normalizeIso(String dateStr) {\n    def t = (dateStr ?: \"\").trim().replace(' ', 'T')\n    if (!t) return null\n    def parser = new DateTimeFormatterBuilder()\n        .appendPattern(\"yyyy-MM-dd'T'HH:mm:ss\")\n        .optionalStart().appendFraction(ChronoField.NANO_OF_SECOND, 1, 7, true).optionalEnd()\n        .toFormatter()\n    def dt = LocalDateTime.parse(t, parser)\n    return dt.format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss.SSSSSSS\"))\n}\n\n// Escape 1 du nhy n\ndef esc(String s) { (s == null) ? null : s.replace(\"'\", \"''\") }\n\n// NVARCHAR/VARCHAR\ndef q(Object v)  { v == null ? \"NULL\" : \"N'${esc(v.toString())}'\" }\ndef qv(Object v) { v == null ? \"NULL\" : \"'${esc(v.toString())}'\" }\n\n// Numeric -> gi nguyn chui s / NULL\ndef dec(Object v) {\n    if (v == null) return \"NULL\"\n    def s = v.toString().trim()\n    return s == \"\" ? \"NULL\" : s\n}\n\n// now UTC\ndef sqlNow() { \"SYSUTCDATETIME()\" }\n\n// string ISO -> datetime2(7)\ndef safeIsoToSqlDate(Object v) {\n    def iso = normalizeIso(v?.toString())\n    return iso ? \"CONVERT(datetime2(7), ${qv(iso)}, 126)\" : \"NULL\"\n}\n\n// --- helper tra DimAdAccountId CH theo AdvertiserId\ndef dimAdIdExpr = { String advId ->\n    def a = (advId ?: \"\").trim()\n    if (!a) return \"NULL\"\n    return \"\"\"(\n        SELECT TOP (1) d.[Id]\n        FROM [dbo].[Dim_DimAdAccounts] d\n        WHERE d.[AdvertiserId] = ${q(a)}\n        ORDER BY ISNULL(d.[IsActive],1) DESC,\n                 ISNULL(d.[LastModificationTime],'1900-01-01') DESC,\n                 d.[Id] DESC\n    )\"\"\"\n}\n// =============== End Utils ===============\n\ndef flowFile = session.get()\nif (!flowFile) return\n\n// ---------- Attributes ----------\ndef rawPath  = flowFile.getAttribute('stateCurrent.fullPath')\ndef dimBcId  = flowFile.getAttribute('stateBc.dimId')\ndef bcId     = flowFile.getAttribute('stateBc.id')\n\n// ---------- Load RAW ----------\ndef rawList = []\nif (rawPath) {\n    def f = new File(rawPath)\n    if (f.exists()) {\n        def txt = f.getText(StandardCharsets.UTF_8.name())\n        def parsed = new JsonSlurper().parseText(txt)\n        rawList = (parsed instanceof List) ? parsed : [parsed]\n    }\n}\n\n// ---------- Load FACT current from flow content ----------\ndef factRows = []\nflowFile = session.write(flowFile, { inp, out ->\n    def content = inp.getText(StandardCharsets.UTF_8.name())\n    if (content?.trim()) {\n        def parsed = new JsonSlurper().parseText(content)\n        factRows = (parsed instanceof List) ? parsed : [parsed]\n        out.write(content.getBytes(StandardCharsets.UTF_8))\n    } else {\n        out.write(\"[]\".getBytes(StandardCharsets.UTF_8))\n    }\n} as StreamCallback)\n\n// Build fact map: key = (BcId, AdvertiserId, DateISO7)\ndef factMap = [:]\nfactRows.each { f ->\n    def isoDate = normalizeIso(f?.Date)\n    def advId   = (f?.EntityId ?: \"\").toString().trim()\n    if (bcId && advId && isoDate) {\n        factMap[\"${bcId}|${advId}|${isoDate}\"] = f\n    }\n}\n\n// ---------- DEDUP RAW ----------\ndef chooseNewer = { a, b ->\n    def da = a?.Date ? normalizeIso(a.Date) : null\n    def db = b?.Date ? normalizeIso(b.Date) : null\n    if (da && db && da != db) return da > db\n    return (a?.Id?.toString() ?: \"\") > (b?.Id?.toString() ?: \"\")\n}\n\ndef dedup = [:]\nrawList.each { r ->\n    def isoDate = normalizeIso(r?.Date)\n    def bc     = (r?.BcId ?: bcId ?: \"\").toString().trim()\n    def advId  = (r?.AdvertiserId ?: r?.EntityId ?: \"\").toString().trim()\n    if (!bc || !advId || !isoDate) return\n    def key = \"${bc}|${advId}|${isoDate}\"\n    def cur = dedup[key]\n    if (cur == null) dedup[key] = r\n    else if (chooseNewer(r, cur)) dedup[key] = r\n}\nrawList = dedup.values().toList()\n\n// ---------- Stage INSERT / UPDATE ----------\ndef inserts = []\ndef updates = []\n\nrawList.each { r ->\n    def isoDate = normalizeIso(r?.Date)\n    def bc     = (r?.BcId ?: bcId ?: \"\").toString().trim()\n    def advId  = (r?.AdvertiserId ?: r?.EntityId ?: \"\").toString().trim()\n    if (!bc || !advId || !isoDate) return\n\n    def key = \"${bc}|${advId}|${isoDate}\"\n    def existing = factMap[key]\n    if (existing == null) inserts << r else updates << [raw: r, existing: existing]\n}\n\n// ---------- Build SQL (INSERT) ----------\ndef insertValues = inserts.collect { r ->\n    def isoDate   = normalizeIso(r?.Date)\n    def dimDateId = toDimDateId(isoDate)\n    def currency  = (r?.Currency ?: null)\n    def isUSD = (currency == 'USD')\n    def isVND = (currency == 'VND')\n    def advId = (r?.AdvertiserId ?: r?.EntityId ?: \"\").toString().trim()\n    def id = UUID.randomUUID().toString()\n\n    \"\"\"(\n${qv(id)},                          -- Id\n'AdAccount',                        -- Type\n${q(advId)},                        -- EntityId (AdvertiserId)\n${q(advId)},                        -- EntityName\n${dec(r?.AccountBalance)},          -- AccountBalance\n${dec(r?.ValidAccountBalance)},     -- ValidAccountBalance\n${dec(r?.FrozenBalance)},           -- FrozenBalance\n${dec(r?.Tax)},                     -- Tax\n${dec(r?.CashBalance)},             -- CashBalance\n${dec(r?.ValidCashBalance)},        -- ValidCashBalance\n${dec(r?.GrantBalance)},            -- GrantBalance\n${dec(r?.ValidGrantBalance)},       -- ValidGrantBalance\n${dec(r?.TransferableAmount)},      -- TransferableAmount\n${dec(r?.Budget)},                  -- Budget\n${dec(r?.BudgetCost)},              -- BudgetCost\n${dec(r?.BudgetRemaining)},         -- BudgetRemaining\n${q(currency)},                     -- Currency\n${q(r?.Timezone)},                  -- Timezone\n${safeIsoToSqlDate(r?.Date)},       -- Date\n${dimDateId ?: \"NULL\"},             -- DimDateId\n${dimAdIdExpr(advId)},              -- DimAdAccountId\n${qv(dimBcId)},                     -- DimBusinessCenterId\n${sqlNow()},                        -- CreationTime\nNULL,                               -- CreatorId\nNULL,                               -- LastModificationTime\nNULL,                               -- LastModifierId\n${isUSD ? dec(r?.AccountBalance)   : \"NULL\"},  -- AccountBalanceUSD\n${isVND ? dec(r?.AccountBalance)   : \"NULL\"},  -- AccountBalanceVND\n${isUSD ? dec(r?.BudgetCost)       : \"NULL\"},  -- BudgetCostUSD\n${isVND ? dec(r?.BudgetCost)       : \"NULL\"},  -- BudgetCostVND\n${isUSD ? dec(r?.BudgetRemaining)  : \"NULL\"},  -- BudgetRemainingUSD\n${isVND ? dec(r?.BudgetRemaining)  : \"NULL\"},  -- BudgetRemainingVND\n${isUSD ? dec(r?.Budget)           : \"NULL\"},  -- BudgetUSD\n${isVND ? dec(r?.Budget)           : \"NULL\"},  -- BudgetVND\n${isUSD ? dec(r?.CashBalance)      : \"NULL\"},  -- CashBalanceUSD\n${isVND ? dec(r?.CashBalance)      : \"NULL\"},  -- CashBalanceVND\n${isUSD ? dec(r?.FrozenBalance)    : \"NULL\"},  -- FrozenBalanceUSD\n${isVND ? dec(r?.FrozenBalance)    : \"NULL\"},  -- FrozenBalanceVND\n${isUSD ? dec(r?.GrantBalance)     : \"NULL\"},  -- GrantBalanceUSD\n${isVND ? dec(r?.GrantBalance)     : \"NULL\"},  -- GrantBalanceVND\n${isUSD ? dec(r?.Tax)              : \"NULL\"},  -- TaxUSD\n${isVND ? dec(r?.Tax)              : \"NULL\"},  -- TaxVND\n${isUSD ? dec(r?.TransferableAmount) : \"NULL\"},-- TransferableAmountUSD\n${isVND ? dec(r?.TransferableAmount) : \"NULL\"},-- TransferableAmountVND\n${isUSD ? dec(r?.ValidAccountBalance) : \"NULL\"},  -- ValidAccountBalanceUSD\n${isVND ? dec(r?.ValidAccountBalance) : \"NULL\"},  -- ValidAccountBalanceVND\n${isUSD ? dec(r?.ValidCashBalance)    : \"NULL\"},  -- ValidCashBalanceUSD\n${isVND ? dec(r?.ValidCashBalance)    : \"NULL\"},  -- ValidCashBalanceVND\n${isUSD ? dec(r?.ValidGrantBalance)   : \"NULL\"},  -- ValidGrantBalanceUSD\n${isVND ? dec(r?.ValidGrantBalance)   : \"NULL\"}   -- ValidGrantBalanceVND\n)\"\"\"\n}\n\ndef sqlInsert = insertValues.isEmpty() ? \"\" : \"\"\"\nINSERT INTO [dbo].[Fact_FactBalances]\n([Id],\n [Type],[EntityId],[EntityName],\n [AccountBalance],[ValidAccountBalance],[FrozenBalance],[Tax],\n [CashBalance],[ValidCashBalance],[GrantBalance],[ValidGrantBalance],\n [TransferableAmount],[Budget],[BudgetCost],[BudgetRemaining],\n [Currency],[Timezone],[Date],\n [DimDateId],[DimAdAccountId],[DimBusinessCenterId],\n [CreationTime],[CreatorId],[LastModificationTime],[LastModifierId],\n [AccountBalanceUSD],[AccountBalanceVND],\n [BudgetCostUSD],[BudgetCostVND],[BudgetRemainingUSD],[BudgetRemainingVND],\n [BudgetUSD],[BudgetVND],\n [CashBalanceUSD],[CashBalanceVND],\n [FrozenBalanceUSD],[FrozenBalanceVND],\n [GrantBalanceUSD],[GrantBalanceVND],\n [TaxUSD],[TaxVND],\n [TransferableAmountUSD],[TransferableAmountVND],\n [ValidAccountBalanceUSD],[ValidAccountBalanceVND],\n [ValidCashBalanceUSD],[ValidCashBalanceVND],\n [ValidGrantBalanceUSD],[ValidGrantBalanceVND])\nVALUES\n${insertValues.join(\",\\n\")}\n\"\"\".trim()\n\n// ---------- Build SQL (UPDATE) ----------\ndef updateStatements = updates.collect { u ->\n    def r = u.raw\n    def existing = u.existing\n    def isoDate   = normalizeIso(r?.Date)\n    def dimDateId = toDimDateId(isoDate)\n    def currency  = (r?.Currency ?: null)\n    def isUSD = (currency == 'USD')\n    def isVND = (currency == 'VND')\n    def advId = (r?.AdvertiserId ?: r?.EntityId ?: \"\").toString().trim()\n\n    def whereById = existing?.Id ? \"WHERE [Id] = ${qv(existing.Id)}\" : \"\"\"\nWHERE [Type]               = 'AdAccount'\n  AND [EntityId]           = ${q(advId)}\n  AND [DimBusinessCenterId]= ${qv(dimBcId)}\n  AND [Date]               = ${safeIsoToSqlDate(r?.Date)}\n\"\"\".trim()\n\n    \"\"\"\nUPDATE [dbo].[Fact_FactBalances]\nSET EntityName             = ${q(advId)},\n    Currency               = ${q(currency)},\n    Timezone               = ${q(r?.Timezone)},\n    Date                   = ${safeIsoToSqlDate(r?.Date)},\n    DimDateId              = ${dimDateId ?: \"NULL\"},\n    DimAdAccountId         = ${dimAdIdExpr(advId)},\n    AccountBalance         = ${dec(r?.AccountBalance)},\n    ValidAccountBalance    = ${dec(r?.ValidAccountBalance)},\n    FrozenBalance          = ${dec(r?.FrozenBalance)},\n    Tax                    = ${dec(r?.Tax)},\n    CashBalance            = ${dec(r?.CashBalance)},\n    ValidCashBalance       = ${dec(r?.ValidCashBalance)},\n    GrantBalance           = ${dec(r?.GrantBalance)},\n    ValidGrantBalance      = ${dec(r?.ValidGrantBalance)},\n    TransferableAmount     = ${dec(r?.TransferableAmount)},\n    Budget                 = ${dec(r?.Budget)},\n    BudgetCost             = ${dec(r?.BudgetCost)},\n    BudgetRemaining        = ${dec(r?.BudgetRemaining)},\n    AccountBalanceUSD      = ${isUSD ? dec(r?.AccountBalance)      : \"NULL\"},\n    AccountBalanceVND      = ${isVND ? dec(r?.AccountBalance)      : \"NULL\"},\n    BudgetCostUSD          = ${isUSD ? dec(r?.BudgetCost)          : \"NULL\"},\n    BudgetCostVND          = ${isVND ? dec(r?.BudgetCost)          : \"NULL\"},\n    BudgetRemainingUSD     = ${isUSD ? dec(r?.BudgetRemaining)     : \"NULL\"},\n    BudgetRemainingVND     = ${isVND ? dec(r?.BudgetRemaining)     : \"NULL\"},\n    BudgetUSD              = ${isUSD ? dec(r?.Budget)              : \"NULL\"},\n    BudgetVND              = ${isVND ? dec(r?.Budget)              : \"NULL\"},\n    CashBalanceUSD         = ${isUSD ? dec(r?.CashBalance)         : \"NULL\"},\n    CashBalanceVND         = ${isVND ? dec(r?.CashBalance)         : \"NULL\"},\n    FrozenBalanceUSD       = ${isUSD ? dec(r?.FrozenBalance)       : \"NULL\"},\n    FrozenBalanceVND       = ${isVND ? dec(r?.FrozenBalance)       : \"NULL\"},\n    GrantBalanceUSD        = ${isUSD ? dec(r?.GrantBalance)        : \"NULL\"},\n    GrantBalanceVND        = ${isVND ? dec(r?.GrantBalance)        : \"NULL\"},\n    TaxUSD                 = ${isUSD ? dec(r?.Tax)                 : \"NULL\"},\n    TaxVND                 = ${isVND ? dec(r?.Tax)                 : \"NULL\"},\n    TransferableAmountUSD  = ${isUSD ? dec(r?.TransferableAmount)  : \"NULL\"},\n    TransferableAmountVND  = ${isVND ? dec(r?.TransferableAmount)  : \"NULL\"},\n    ValidAccountBalanceUSD = ${isUSD ? dec(r?.ValidAccountBalance) : \"NULL\"},\n    ValidAccountBalanceVND = ${isVND ? dec(r?.ValidAccountBalance) : \"NULL\"},\n    ValidCashBalanceUSD    = ${isUSD ? dec(r?.ValidCashBalance)    : \"NULL\"},\n    ValidCashBalanceVND    = ${isVND ? dec(r?.ValidCashBalance)    : \"NULL\"},\n    ValidGrantBalanceUSD   = ${isUSD ? dec(r?.ValidGrantBalance)   : \"NULL\"},\n    ValidGrantBalanceVND   = ${isVND ? dec(r?.ValidGrantBalance)   : \"NULL\"},\n    LastModificationTime   = ${sqlNow()}\n${whereById}\n\"\"\".trim()\n}\n\ndef sqlUpdate = updateStatements.join(\";\\n\")\n\n// ---------- Final SQL to flow content ----------\ndef finalSql = new StringBuilder()\nif (sqlInsert?.trim()) { finalSql.append(sqlInsert.trim()); finalSql.append(\";\\n\") }\nif (sqlUpdate?.trim()) { finalSql.append(sqlUpdate.trim()); finalSql.append(\";\\n\") }\n\nflowFile = session.write(flowFile, { _, out ->\n    out.write((finalSql.toString()).getBytes(StandardCharsets.UTF_8))\n} as StreamCallback)\n\nsession.transfer(flowFile, REL_SUCCESS)",
            "groovyx-failure-strategy" : "rollback"
          },
          "propertyDescriptors" : {
            "groovyx-script-body" : {
              "displayName" : "Script Body",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-body",
              "sensitive" : false
            },
            "groovyx-failure-strategy" : {
              "displayName" : "Failure strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-failure-strategy",
              "sensitive" : false
            },
            "groovyx-additional-classpath" : {
              "displayName" : "Additional classpath",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-additional-classpath",
              "sensitive" : false
            },
            "groovyx-script-file" : {
              "displayName" : "Script File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-file",
              "resourceDefinition" : {
                "cardinality" : "SINGLE",
                "resourceTypes" : [ "FILE" ]
              },
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.groovyx.ExecuteGroovyScript",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "0ca5a373-5cd6-38ba-a1d7-eea73c195dbf",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LayDanhSachDuLieuETLCu",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2744.0,
            "y" : 112.0
          },
          "properties" : {
            "esql-max-rows" : "0",
            "dbf-default-precision" : "10",
            "Max Wait Time" : "0 seconds",
            "SQL Query" : "SELECT \n    f.[Id],\n    f.[Type],\n    f.[EntityId],\n    CONVERT(varchar(27), f.[Date], 126) AS [Date]\nFROM dbo.[Fact_FactBalances] f\nWHERE f.[DimBusinessCenterId] = '${stateBc.dimId}'\n  AND f.[EntityId] IN ${stateCurrent.advertiserIds.inClause}\n  AND f.[Type] = 'AdAccount'\n  AND f.[Date] >= '${stateCurrent.minDate}'\n  AND f.[Date] <= '${stateCurrent.maxDate}'\nORDER BY f.[Date] DESC;",
            "Database Connection Pooling Service" : "f726dee7-cfcd-3a23-94d5-cb27ac10cbdb",
            "esql-auto-commit" : "true",
            "dbf-user-logical-types" : "false",
            "dbf-default-scale" : "0",
            "compression-format" : "NONE",
            "esql-output-batch-size" : "0",
            "esql-fetch-size" : "0",
            "dbf-normalize" : "false",
            "Content Output Strategy" : "EMPTY"
          },
          "propertyDescriptors" : {
            "esql-max-rows" : {
              "displayName" : "Max Rows Per Flow File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-max-rows",
              "sensitive" : false
            },
            "dbf-default-precision" : {
              "displayName" : "Default Decimal Precision",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-precision",
              "sensitive" : false
            },
            "Max Wait Time" : {
              "displayName" : "Max Wait Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Max Wait Time",
              "sensitive" : false
            },
            "SQL Query" : {
              "displayName" : "SQL Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "SQL Query",
              "sensitive" : false
            },
            "Database Connection Pooling Service" : {
              "displayName" : "Database Connection Pooling Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Database Connection Pooling Service",
              "sensitive" : false
            },
            "sql-post-query" : {
              "displayName" : "SQL Post-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-post-query",
              "sensitive" : false
            },
            "esql-auto-commit" : {
              "displayName" : "Set Auto Commit",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-auto-commit",
              "sensitive" : false
            },
            "dbf-user-logical-types" : {
              "displayName" : "Use Avro Logical Types",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-user-logical-types",
              "sensitive" : false
            },
            "dbf-default-scale" : {
              "displayName" : "Default Decimal Scale",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-scale",
              "sensitive" : false
            },
            "sql-pre-query" : {
              "displayName" : "SQL Pre-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-pre-query",
              "sensitive" : false
            },
            "compression-format" : {
              "displayName" : "Compression Format",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "compression-format",
              "sensitive" : false
            },
            "esql-output-batch-size" : {
              "displayName" : "Output Batch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-output-batch-size",
              "sensitive" : false
            },
            "esql-fetch-size" : {
              "displayName" : "Fetch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-fetch-size",
              "sensitive" : false
            },
            "dbf-normalize" : {
              "displayName" : "Normalize Table/Column Names",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-normalize",
              "sensitive" : false
            },
            "Content Output Strategy" : {
              "displayName" : "Content Output Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Content Output Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "be5ea881-7031-3334-a19a-6173ee3c53c5",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CleanupTempFile",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1392.0,
            "y" : 432.0
          },
          "properties" : {
            "Filename" : "${stateCurrent.filename}",
            "Directory Path" : "${stateCurrent.directory}"
          },
          "propertyDescriptors" : {
            "Filename" : {
              "displayName" : "Filename",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Filename",
              "sensitive" : false
            },
            "Directory Path" : {
              "displayName" : "Directory Path",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory Path",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.DeleteFile",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "ab821d96-d0b7-3878-9186-0f3ca8f50a66",
          "maxBackoffPeriod" : "10 mins",
          "name" : "RouteOnAttributeCheckLastPage",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2008.0,
            "y" : 944.0
          },
          "properties" : {
            "Routing Strategy" : "Route to Property name",
            "isLastPage" : "${lastPage:equals('1')}"
          },
          "propertyDescriptors" : {
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "isLastPage" : {
              "displayName" : "isLastPage",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "isLastPage",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-groovyx-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "709a9dd5-48fc-3f9d-a649-929cccdb8802",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ChuanHoaDuLieuRaw",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1420.966552734375,
            "y" : -192.0
          },
          "properties" : {
            "groovyx-script-body" : "import org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport groovy.json.JsonOutput\nimport java.time.LocalDate\nimport java.time.LocalDateTime\nimport java.time.format.DateTimeFormatter\nimport java.time.format.DateTimeFormatterBuilder\nimport java.time.temporal.ChronoField\n\ndef flowFile = session.get()\nif (!flowFile) return\n\ndef hasData = false\ndef minDate = ''\ndef maxDate = ''\ndef lastPage = '0' // mc nh\n\n// Helper: chun ho list -> unique, trim, b rng + sort (u tin s)\ndef uniqList = { List raw ->\n    (raw ?: [])\n        .findAll { it != null }\n        .collect { it.toString().trim() }\n        .findAll { it.length() > 0 }\n        .toSet()\n        .toList()\n        .sort { a, b ->\n            try { (new BigDecimal(a) <=> new BigDecimal(b)) } catch (ignored) { a <=> b }\n        }\n}\n\n// Helper: IN clause c nhy n (an ton chui/s). Rng -> (NULL)\ndef toInClauseQuoted = { List lst ->\n    if (!lst || lst.isEmpty()) return \"(NULL)\"\n    '(' + lst.collect { v ->\n        def s = v.toString().replace(\"'\", \"''\")\n        \"'${s}'\"\n    }.join(',') + ')'\n}\n\n// Helper parse Date linh hot -> LocalDate\ndef parseToLocalDate = { String s ->\n    if (s == null) return null\n    def t = s.trim()\n    try { return LocalDate.parse(t, DateTimeFormatter.ISO_LOCAL_DATE) } catch (ignored) {}\n    def s2 = t.replace(' ', 'T').replaceAll('[Zz]$', '')\n    try {\n        def dtf = new DateTimeFormatterBuilder()\n            .appendPattern(\"yyyy-MM-dd'T'HH:mm:ss\")\n            .optionalStart().appendFraction(ChronoField.NANO_OF_SECOND, 1, 9, true).optionalEnd()\n            .toFormatter()\n        return LocalDateTime.parse(s2, dtf).toLocalDate()\n    } catch (ignored) {}\n    return null\n}\n\n// Parse JSON array an ton t attribute\ndef safeParseJsonArray = { String jsonText ->\n    try {\n        def v = new JsonSlurper().parseText(jsonText ?: '[]')\n        (v instanceof List) ? v : []\n    } catch (ignored) { [] }\n}\n\n// Ly pageSize t attribute (an ton)\ndef pageSize = 0\ntry { pageSize = (flowFile.getAttribute(\"state.pageSize\") ?: \"0\").toInteger() } catch (ignored) { pageSize = 0 }\n\n// B cha ID t body\nList advertiserIdsFromBody = []\n\nflowFile = session.write(flowFile, { inputStream, outputStream ->\n    def content = inputStream.getText(StandardCharsets.UTF_8.name())\n    outputStream.write(content.getBytes(StandardCharsets.UTF_8))\n\n    def json = new JsonSlurper().parseText(content)\n    if (!(json instanceof List)) json = [json]\n\n    hasData = !json.isEmpty()\n\n    if (hasData) {\n        // === TNH MIN/MAX THEO TRNG Date (a v yyyy-MM-dd) ===\n        def dates = json*.Date\n            .findAll { it != null }\n            .collect { parseToLocalDate(it.toString()) }\n            .findAll { it != null }\n\n        if (!dates.isEmpty()) {\n            minDate = dates.min().toString()  // yyyy-MM-dd\n            maxDate = dates.max().toString()  // yyyy-MM-dd\n        }\n\n        // === LY DANH SCH AdvertiserId DUY NHT T BODY ===\n        advertiserIdsFromBody = uniqList(json*.AdvertiserId)\n\n        // === NH DU TRANG CUI ===\n        if (pageSize > 0 && json.size() < pageSize) lastPage = '1'\n    }\n} as StreamCallback)\n\n// ---------- Canonicalize: Body -> stateCurrent -> stateAdAccounts ----------\nList canonicalIds = advertiserIdsFromBody\nif (canonicalIds.isEmpty()) {\n    canonicalIds = uniqList( safeParseJsonArray(flowFile.getAttribute('stateCurrent.advertiserIds')) )\n}\nif (canonicalIds.isEmpty()) {\n    canonicalIds = uniqList( safeParseJsonArray(flowFile.getAttribute('stateAdAccounts.advertiserIds')) )\n}\n\n// T GI: MI TH SINH T canonicalIds\ndef canonicalJson     = JsonOutput.toJson(canonicalIds)\ndef canonicalInClause = toInClauseQuoted(canonicalIds)\n\n// Chun b attributes a ra\ndef attrs = [\n    'hasData' : hasData.toString(),\n    'minDate' : minDate, // gi cp tng qut\n    'maxDate' : maxDate,\n    'lastPage': lastPage,\n\n    // stateCurrent.* (LUN set t canonical)\n    'stateCurrent.advertiserIds'          : canonicalJson,\n    'stateCurrent.advertiserIds.inClause' : canonicalInClause,\n\n    // Min/Max date theo prefix stateCurrent.* (fallback nh nu lt ny khng tnh c)\n    'stateCurrent.minDate' : (minDate ?: (flowFile.getAttribute('stateCurrent.minDate') ?: (flowFile.getAttribute('minDate') ?: ''))),\n    'stateCurrent.maxDate' : (maxDate ?: (flowFile.getAttribute('stateCurrent.maxDate') ?: (flowFile.getAttribute('maxDate') ?: '')))\n]\n\n// Ghi attributes\nflowFile = session.putAllAttributes(flowFile, attrs)\nsession.transfer(flowFile, REL_SUCCESS)",
            "groovyx-failure-strategy" : "rollback"
          },
          "propertyDescriptors" : {
            "groovyx-script-body" : {
              "displayName" : "Script Body",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-body",
              "sensitive" : false
            },
            "groovyx-failure-strategy" : {
              "displayName" : "Failure strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-failure-strategy",
              "sensitive" : false
            },
            "groovyx-additional-classpath" : {
              "displayName" : "Additional classpath",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-additional-classpath",
              "sensitive" : false
            },
            "groovyx-script-file" : {
              "displayName" : "Script File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-file",
              "resourceDefinition" : {
                "cardinality" : "SINGLE",
                "resourceTypes" : [ "FILE" ]
              },
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.groovyx.ExecuteGroovyScript",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "2fbdb3d9-f3aa-3227-b598-eb575cae76aa",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CleanupTemp",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 992.0,
            "y" : 952.0
          },
          "properties" : {
            "Filename" : "${stateCurrent.filename}",
            "Directory Path" : "${stateCurrent.directory}"
          },
          "propertyDescriptors" : {
            "Filename" : {
              "displayName" : "Filename",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Filename",
              "sensitive" : false
            },
            "Directory Path" : {
              "displayName" : "Directory Path",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory Path",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.DeleteFile",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "failure" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "f481975a-e07d-34ff-a321-26a18fabefa9",
          "identifier" : "ae8857e2-f73f-3a5b-9bcc-abe3d613804a",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ConvertRecord",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2936.0,
            "y" : 360.0
          },
          "properties" : {
            "Include Zero Record FlowFiles" : "true",
            "Record Writer" : "2d17ef4c-c0cc-3b2f-840a-19ea05a3f87a",
            "Record Reader" : "d1900214-a631-39c7-b7fb-00da2780645e"
          },
          "propertyDescriptors" : {
            "Include Zero Record FlowFiles" : {
              "displayName" : "Include Zero Record FlowFiles",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Include Zero Record FlowFiles",
              "sensitive" : false
            },
            "Record Writer" : {
              "displayName" : "Record Writer",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Writer",
              "sensitive" : false
            },
            "Record Reader" : {
              "displayName" : "Record Reader",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Reader",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ConvertRecord",
          "yieldDuration" : "1 sec"
        } ],
        "remoteProcessGroups" : [ ],
        "scheduledState" : "ENABLED",
        "statelessFlowTimeout" : "1 min"
      } ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "d9912cde-5554-36dc-91e7-ced8c541f581",
        "identifier" : "de725e4e-f8d5-387b-955c-73c344a1bbcd",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KhoiTao",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 24.0,
          "y" : -72.0
        },
        "properties" : {
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.page" : "1",
          "stateAdAccounts.advertiserIds.inClause" : "${stateAdAccounts.advertiserIds\n  :replaceAll('^\\\\[|\\\\]$', '')\n  :replaceAll('\"', '\\'')\n  :prepend('(')\n  :append(')')}",
          "state.pageSize" : "#{PageSizeMax}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.page" : {
            "displayName" : "state.page",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.page",
            "sensitive" : false
          },
          "stateAdAccounts.advertiserIds.inClause" : {
            "displayName" : "stateAdAccounts.advertiserIds.inClause",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.advertiserIds.inClause",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.pageSize" : {
            "displayName" : "state.pageSize",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.pageSize",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "d9912cde-5554-36dc-91e7-ced8c541f581",
        "identifier" : "485077ed-e867-3e9f-aacc-96c938a52c56",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KiemTraCoTrangTiepTheo",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : 544.0
        },
        "properties" : {
          "Routing Strategy" : "Route to Property name",
          "nextPage" : "${state.continue:equals(1)}"
        },
        "propertyDescriptors" : {
          "Routing Strategy" : {
            "displayName" : "Routing Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Routing Strategy",
            "sensitive" : false
          },
          "nextPage" : {
            "displayName" : "nextPage",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "nextPage",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "d9912cde-5554-36dc-91e7-ced8c541f581",
        "identifier" : "e8399ce3-f7df-3cfd-a2d5-4bfacddbf663",
        "maxBackoffPeriod" : "10 mins",
        "name" : "TrangTiepTheo",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 808.0,
          "y" : 352.0
        },
        "properties" : {
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.page" : "${state.page:toNumber():plus(1)}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.page" : {
            "displayName" : "state.page",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.page",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "aa328d51-1131-3b2f-8459-27aad2558afd",
          "id" : "beec807d-6b2f-389b-b469-e0d939254902",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "aa328d51-1131-3b2f-8459-27aad2558afd",
        "identifier" : "37190611-2b69-3613-b7e3-4c8099cef721",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "aa328d51-1131-3b2f-8459-27aad2558afd",
          "id" : "75df67f5-1981-39a8-a08e-8900feae75ca",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "aa328d51-1131-3b2f-8459-27aad2558afd",
          "id" : "2067f154-e84f-3190-adc5-64cd5c24b5f0",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "aa328d51-1131-3b2f-8459-27aad2558afd",
        "identifier" : "d929e3c0-279d-3a41-9d54-4b5520fd636c",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "aa328d51-1131-3b2f-8459-27aad2558afd",
          "id" : "75df67f5-1981-39a8-a08e-8900feae75ca",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "aa328d51-1131-3b2f-8459-27aad2558afd",
          "id" : "2067f154-e84f-3190-adc5-64cd5c24b5f0",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "aa328d51-1131-3b2f-8459-27aad2558afd",
        "identifier" : "32abba8f-0aeb-3033-82e1-d0829b4344f9",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "aa328d51-1131-3b2f-8459-27aad2558afd",
          "id" : "beec807d-6b2f-389b-b469-e0d939254902",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "aa328d51-1131-3b2f-8459-27aad2558afd",
          "id" : "75df67f5-1981-39a8-a08e-8900feae75ca",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "aa328d51-1131-3b2f-8459-27aad2558afd",
        "identifier" : "472df70b-c6f1-3945-aa05-77d66a9a808f",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "aa328d51-1131-3b2f-8459-27aad2558afd",
          "id" : "fe7037ea-b567-3b9a-ad42-114648b58736",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "aa328d51-1131-3b2f-8459-27aad2558afd",
          "id" : "fe7037ea-b567-3b9a-ad42-114648b58736",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "aa328d51-1131-3b2f-8459-27aad2558afd",
        "identifier" : "77085364-a839-34b8-8677-778d5bf4cc0e",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "aa328d51-1131-3b2f-8459-27aad2558afd",
          "id" : "d0cdb4da-eae2-3a31-8efe-d40e7afa7392",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "aa328d51-1131-3b2f-8459-27aad2558afd",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "aa328d51-1131-3b2f-8459-27aad2558afd",
        "identifier" : "d0cdb4da-eae2-3a31-8efe-d40e7afa7392",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LuuTrangThaiETL",
      "outputPorts" : [ ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : 224.0,
        "y" : 1880.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "aa328d51-1131-3b2f-8459-27aad2558afd",
        "identifier" : "2067f154-e84f-3190-adc5-64cd5c24b5f0",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "aa328d51-1131-3b2f-8459-27aad2558afd",
        "identifier" : "fe7037ea-b567-3b9a-ad42-114648b58736",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "filename" : "${state.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.lastExecutionTime" : {
            "displayName" : "state.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.lastExecutionTime",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "aa328d51-1131-3b2f-8459-27aad2558afd",
        "identifier" : "beec807d-6b2f-389b-b469-e0d939254902",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${state.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "aa328d51-1131-3b2f-8459-27aad2558afd",
        "identifier" : "75df67f5-1981-39a8-a08e-8900feae75ca",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${state.name}\",\n  \"isActive\": ${state.isActive},\n  \"lastExecutionTime\": \"${state.lastExecutionTime}\",\n  \"startTime\": \"${state.startTime}\",\n  \"endTime\": \"${state.endTime}\",\n  \"status\": \"${state.status}\",\n  \"sequenceNumber\": \"${state.sequenceNumber}\",\n  \"message\": \"${state.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "3112e9d2-5c30-3224-9e2a-24ec8d2e07ed",
          "name" : "MapNoiDungLenAttribute",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "600b9c1a-8e80-303b-932d-9cb3ab937439",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "75369db6-1c4c-3cb4-84a5-13e8b4a7bfb9",
          "name" : "Data to JSON",
          "type" : "PROCESSOR"
        },
        "zIndex" : 9
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "51065ed7-020a-31ad-8306-7434c0f00da1",
          "name" : "KhoiTaoLayDanhSach",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "a66c1d64-8d14-33db-a3de-15d4dcdd88b4",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "1a474885-a9d1-3b27-973c-d7d705c36788",
          "name" : "input",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 6
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "adf3a9f3-ac9e-3b92-8ff5-35ce3d804aed",
          "name" : "Output",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "568d3e43-12da-3807-9e2f-db8761365a8d",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "4d85a8d2-b65a-3b0b-91b8-0805a99764d3",
          "name" : "ChuanHoaIdsQuerySql",
          "type" : "PROCESSOR"
        },
        "zIndex" : 12
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "4d85a8d2-b65a-3b0b-91b8-0805a99764d3",
          "name" : "ChuanHoaIdsQuerySql",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "50eca9d0-3bb3-3f2b-b186-480a4c54f339",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "e36d06d5-0fc3-3c50-b032-c613275a02d9",
          "name" : "PutFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 11
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "fdf2b078-1c2e-31fd-a52e-88a1c48ea46e",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "ba993c63-e931-3a87-a890-c0e8e7f08f76",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "afd5f4a5-0013-32b1-890c-4f7b55afa3fa",
          "name" : "LayDsAdAccount",
          "type" : "PROCESSOR"
        },
        "zIndex" : 2
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "fdf2b078-1c2e-31fd-a52e-88a1c48ea46e",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "e38493e1-74fe-3fa0-9a10-69461a6cd182",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "e36d06d5-0fc3-3c50-b032-c613275a02d9",
          "name" : "PutFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 5
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "afd5f4a5-0013-32b1-890c-4f7b55afa3fa",
          "name" : "LayDsAdAccount",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "12a9983e-67d9-38a4-b8d8-43c5ca2e49ca",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "51065ed7-020a-31ad-8306-7434c0f00da1",
          "name" : "KhoiTaoLayDanhSach",
          "type" : "PROCESSOR"
        },
        "zIndex" : 7
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "e36d06d5-0fc3-3c50-b032-c613275a02d9",
          "name" : "PutFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "ce0a63ec-9bc4-3e62-8242-480458c88dc8",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "matched", "unmatched" ],
        "source" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "3112e9d2-5c30-3224-9e2a-24ec8d2e07ed",
          "name" : "MapNoiDungLenAttribute",
          "type" : "PROCESSOR"
        },
        "zIndex" : 10
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "75369db6-1c4c-3cb4-84a5-13e8b4a7bfb9",
          "name" : "Data to JSON",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "5407f153-4423-3a8d-9d35-4718242c590b",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "afd5f4a5-0013-32b1-890c-4f7b55afa3fa",
          "name" : "LayDsAdAccount",
          "type" : "PROCESSOR"
        },
        "zIndex" : 8
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "fdf2b078-1c2e-31fd-a52e-88a1c48ea46e",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "24b97db3-de21-3f01-906f-5a92d3c46f34",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "75369db6-1c4c-3cb4-84a5-13e8b4a7bfb9",
          "name" : "Data to JSON",
          "type" : "PROCESSOR"
        },
        "zIndex" : 3
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "fdf2b078-1c2e-31fd-a52e-88a1c48ea46e",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "638d10ac-b21e-36fd-b51f-9503cf270c38",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "650fba67-7008-3c55-92a0-782c61200cf4",
          "id" : "3112e9d2-5c30-3224-9e2a-24ec8d2e07ed",
          "name" : "MapNoiDungLenAttribute",
          "type" : "PROCESSOR"
        },
        "zIndex" : 4
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "1a474885-a9d1-3b27-973c-d7d705c36788",
        "name" : "input",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -197.99999300009608,
          "y" : -140.22743665980602
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LayDanhSachAdAccountTheoBC",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "adf3a9f3-ac9e-3b92-8ff5-35ce3d804aed",
        "name" : "Output",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 1384.0,
          "y" : 448.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -248.0,
        "y" : 3160.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "fdf2b078-1c2e-31fd-a52e-88a1c48ea46e",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 696.0,
          "y" : 112.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "51065ed7-020a-31ad-8306-7434c0f00da1",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KhoiTaoLayDanhSach",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 200.0,
          "y" : -176.0
        },
        "properties" : {
          "filename" : "state_${stateBc.id}_AdAccounts.json",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateAdAccounts.path" : "#{TempPath}${Path.Separator}${state.name}",
          "stateAdAccounts.fullpath" : "#{TempPath}${Path.Separator}${state.name}${Path.Separator}state_${stateBc.id}_AdAccounts.json",
          "stateAdAccounts.filename" : "state_${stateBc.id}_AdAccounts.json",
          "stateAdAccounts.name" : "state_${stateBc.id}_AdAccounts"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateAdAccounts.path" : {
            "displayName" : "stateAdAccounts.path",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.path",
            "sensitive" : false
          },
          "stateAdAccounts.fullpath" : {
            "displayName" : "stateAdAccounts.fullpath",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.fullpath",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "stateAdAccounts.filename" : {
            "displayName" : "stateAdAccounts.filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.filename",
            "sensitive" : false
          },
          "stateAdAccounts.name" : {
            "displayName" : "stateAdAccounts.name",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.name",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "75369db6-1c4c-3cb4-84a5-13e8b4a7bfb9",
        "maxBackoffPeriod" : "10 mins",
        "name" : "Data to JSON",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 960.0,
          "y" : -176.0
        },
        "properties" : {
          "Include Zero Record FlowFiles" : "true",
          "Record Writer" : "2d17ef4c-c0cc-3b2f-840a-19ea05a3f87a",
          "Record Reader" : "d1900214-a631-39c7-b7fb-00da2780645e"
        },
        "propertyDescriptors" : {
          "Include Zero Record FlowFiles" : {
            "displayName" : "Include Zero Record FlowFiles",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Include Zero Record FlowFiles",
            "sensitive" : false
          },
          "Record Writer" : {
            "displayName" : "Record Writer",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Record Writer",
            "sensitive" : false
          },
          "Record Reader" : {
            "displayName" : "Record Reader",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Record Reader",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ConvertRecord",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "Ly danh sch AddAccount ca BC hin ti  tin hnh ETL",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "afd5f4a5-0013-32b1-890c-4f7b55afa3fa",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LayDsAdAccount",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 584.0,
          "y" : -176.0
        },
        "properties" : {
          "esql-max-rows" : "0",
          "dbf-default-precision" : "10",
          "Max Wait Time" : "0 seconds",
          "SQL Query" : "SELECT [Id]\n      ,[AdvertiserId]\n      ,[AdvertiserName]\n      ,[Currency]\n      ,[Timezone]\n      ,[Country]\n      ,[Status]\n      ,[Company]\n      ,[OwnerBcId]\n      ,[IsActive]\n      ,[EffectiveDate]\n      ,[ExpiryDate]\n      ,[IsCurrent]\n      ,[RowVersion]\n      ,[CreationTime]\n      ,[CreatorId]\n      ,[LastModificationTime]\n      ,[LastModifierId]\n  FROM Dim_DimAdAccounts d where d.OwnerBcId = '${stateBc.id}' and IsCurrent = 1",
          "Database Connection Pooling Service" : "f726dee7-cfcd-3a23-94d5-cb27ac10cbdb",
          "esql-auto-commit" : "true",
          "dbf-user-logical-types" : "false",
          "dbf-default-scale" : "0",
          "compression-format" : "NONE",
          "esql-output-batch-size" : "0",
          "esql-fetch-size" : "0",
          "dbf-normalize" : "false",
          "Content Output Strategy" : "EMPTY"
        },
        "propertyDescriptors" : {
          "esql-max-rows" : {
            "displayName" : "Max Rows Per Flow File",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-max-rows",
            "sensitive" : false
          },
          "dbf-default-precision" : {
            "displayName" : "Default Decimal Precision",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-default-precision",
            "sensitive" : false
          },
          "Max Wait Time" : {
            "displayName" : "Max Wait Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Max Wait Time",
            "sensitive" : false
          },
          "SQL Query" : {
            "displayName" : "SQL Query",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "SQL Query",
            "sensitive" : false
          },
          "Database Connection Pooling Service" : {
            "displayName" : "Database Connection Pooling Service",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Database Connection Pooling Service",
            "sensitive" : false
          },
          "sql-post-query" : {
            "displayName" : "SQL Post-Query",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "sql-post-query",
            "sensitive" : false
          },
          "esql-auto-commit" : {
            "displayName" : "Set Auto Commit",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-auto-commit",
            "sensitive" : false
          },
          "dbf-user-logical-types" : {
            "displayName" : "Use Avro Logical Types",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-user-logical-types",
            "sensitive" : false
          },
          "dbf-default-scale" : {
            "displayName" : "Default Decimal Scale",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-default-scale",
            "sensitive" : false
          },
          "sql-pre-query" : {
            "displayName" : "SQL Pre-Query",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "sql-pre-query",
            "sensitive" : false
          },
          "compression-format" : {
            "displayName" : "Compression Format",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "compression-format",
            "sensitive" : false
          },
          "esql-output-batch-size" : {
            "displayName" : "Output Batch Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-output-batch-size",
            "sensitive" : false
          },
          "esql-fetch-size" : {
            "displayName" : "Fetch Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "esql-fetch-size",
            "sensitive" : false
          },
          "dbf-normalize" : {
            "displayName" : "Normalize Table/Column Names",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "dbf-normalize",
            "sensitive" : false
          },
          "Content Output Strategy" : {
            "displayName" : "Content Output Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Content Output Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "3112e9d2-5c30-3224-9e2a-24ec8d2e07ed",
        "maxBackoffPeriod" : "10 mins",
        "name" : "MapNoiDungLenAttribute",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 1328.0,
          "y" : -176.0
        },
        "properties" : {
          "Destination" : "flowfile-attribute",
          "Max String Length" : "200 MB",
          "Return Type" : "json",
          "stateAdAccounts.advertiserIds" : "$[*].AdvertiserId",
          "Null Value Representation" : "empty string",
          "Path Not Found Behavior" : "ignore"
        },
        "propertyDescriptors" : {
          "Destination" : {
            "displayName" : "Destination",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Destination",
            "sensitive" : false
          },
          "Max String Length" : {
            "displayName" : "Max String Length",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Max String Length",
            "sensitive" : false
          },
          "Return Type" : {
            "displayName" : "Return Type",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Return Type",
            "sensitive" : false
          },
          "stateAdAccounts.advertiserIds" : {
            "displayName" : "stateAdAccounts.advertiserIds",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.advertiserIds",
            "sensitive" : false
          },
          "Null Value Representation" : {
            "displayName" : "Null Value Representation",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Null Value Representation",
            "sensitive" : false
          },
          "Path Not Found Behavior" : {
            "displayName" : "Path Not Found Behavior",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Path Not Found Behavior",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.EvaluateJsonPath",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "e36d06d5-0fc3-3c50-b032-c613275a02d9",
        "maxBackoffPeriod" : "10 mins",
        "name" : "PutFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 1344.0,
          "y" : 40.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${stateAdAccounts.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "650fba67-7008-3c55-92a0-782c61200cf4",
        "identifier" : "4d85a8d2-b65a-3b0b-91b8-0805a99764d3",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoaIdsQuerySql",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 1336.0,
          "y" : 232.0
        },
        "properties" : {
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateAdAccounts.advertiserIds.inClause" : "${stateAdAccounts.advertiserIds\n  :replaceAll('^\\\\[|\\\\]$', '')\n  :replaceAll('\"', '\\'')\n  :prepend('(')\n  :append(')')}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateAdAccounts.advertiserIds.inClause" : {
            "displayName" : "stateAdAccounts.advertiserIds.inClause",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateAdAccounts.advertiserIds.inClause",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9f06666e-e1f4-302e-a791-0026d5babad7",
          "id" : "d2902634-eb9b-3638-9d11-ccf282544b07",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9f06666e-e1f4-302e-a791-0026d5babad7",
        "identifier" : "048cb89b-3377-3dab-b008-147c2035f8d9",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "9f06666e-e1f4-302e-a791-0026d5babad7",
          "id" : "45ed64b1-6a59-34bb-ad8a-fdb205b37cf2",
          "name" : "KhoiTao",
          "type" : "PROCESSOR"
        },
        "zIndex" : 34
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9f06666e-e1f4-302e-a791-0026d5babad7",
          "id" : "45ed64b1-6a59-34bb-ad8a-fdb205b37cf2",
          "name" : "KhoiTao",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9f06666e-e1f4-302e-a791-0026d5babad7",
        "identifier" : "165206e1-625c-388e-9d81-7f4a3265aa71",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "9f06666e-e1f4-302e-a791-0026d5babad7",
          "id" : "2dfa71a3-f9b7-3e46-a0a3-0f3bb9e3beb2",
          "name" : "input",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "9f06666e-e1f4-302e-a791-0026d5babad7",
          "id" : "84cf6815-29a2-36a9-901b-e9171858a236",
          "name" : "ouput",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9f06666e-e1f4-302e-a791-0026d5babad7",
        "identifier" : "3f7f29fe-83b7-3ccf-97f6-2b768f3dd987",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "9f06666e-e1f4-302e-a791-0026d5babad7",
          "id" : "d2902634-eb9b-3638-9d11-ccf282544b07",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "9f06666e-e1f4-302e-a791-0026d5babad7",
          "id" : "680788dc-d561-3912-b848-de155e42bb17",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "9f06666e-e1f4-302e-a791-0026d5babad7",
        "identifier" : "e1726f1e-e1ec-34fb-98fb-e5bc7f11c122",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "9f06666e-e1f4-302e-a791-0026d5babad7",
          "id" : "d2902634-eb9b-3638-9d11-ccf282544b07",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "zIndex" : 36
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "9f06666e-e1f4-302e-a791-0026d5babad7",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "9f06666e-e1f4-302e-a791-0026d5babad7",
        "identifier" : "2dfa71a3-f9b7-3e46-a0a3-0f3bb9e3beb2",
        "name" : "input",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 160.0,
          "y" : -704.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LayTrangThaiETL",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "9f06666e-e1f4-302e-a791-0026d5babad7",
        "identifier" : "84cf6815-29a2-36a9-901b-e9171858a236",
        "name" : "ouput",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 160.0,
          "y" : 112.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -248.0,
        "y" : -8.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-scripting-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9f06666e-e1f4-302e-a791-0026d5babad7",
        "identifier" : "d2902634-eb9b-3638-9d11-ccf282544b07",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LayTrangThai",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 104.0,
          "y" : -192.0
        },
        "properties" : {
          "Script Engine" : "Groovy",
          "Script Body" : "import groovy.json.JsonSlurper\nimport groovy.json.JsonBuilder\nimport java.nio.file.*\nimport java.time.Instant\nimport java.time.ZoneOffset\nimport java.time.format.DateTimeFormatter\nimport java.time.LocalDateTime\nimport java.time.LocalDate\nimport org.apache.nifi.processor.io.OutputStreamCallback\n\ndef flowFile = session.get()\nif (!flowFile) return\n\n// Ly parameters t attributes\ndef etlName   = flowFile.getAttribute('state.name')\ndef statePath = flowFile.getAttribute('state.path')\ndef filename  = flowFile.getAttribute('state.filename')\n\nif (!etlName || !statePath || !filename) {\n    log.error(\"Missing required attributes: state.name, state.path, or state.filename\")\n    flowFile = session.putAttribute(flowFile, 'error.message', 'Missing state.name, state.path, or state.filename attributes')\n    session.transfer(flowFile, REL_FAILURE)\n    return\n}\n\n// To ng dn y \ndef stateFilePath = Paths.get(statePath, filename).toString()\n\ntry {\n    def stateContent = \"\"\n    def stateExists = false\n\n    // nh dng thi gian UTC\n    def formatter = DateTimeFormatter.ofPattern(\"yyyy/MM/dd HH:mm:ss\")\n    def currentTimeUTC = Instant.now().atZone(ZoneOffset.UTC).format(formatter)\n    def defaultStartTime = \"2025/01/01 00:00:00\"\n\n    // Gi tr mc nh cho state\n    def defaultState = [\n        name: etlName,\n        isActive: false,\n        lastExecutionTime: currentTimeUTC,\n        startTime: defaultStartTime,\n        endTime: currentTimeUTC,\n        sequenceNumber: 1, // ln chy u tin\n        status: 0,         // 0: khi to\n        message: \"\"        // trng\n    ]\n\n    // c file trng thi nu c\n    def path = Paths.get(stateFilePath)\n    if (Files.exists(path)) {\n        stateContent = new String(Files.readAllBytes(path), \"UTF-8\")\n        stateExists = true\n        log.info(\"State file found for ETL '${etlName}' at '${stateFilePath}': \" + stateContent)\n    } else {\n        stateContent = new JsonBuilder(defaultState).toString()\n        stateExists = false\n        log.info(\"State file not found for ETL '${etlName}' at '${stateFilePath}', creating default state\")\n    }\n\n    // Parse JSON, li th fallback default\n    def jsonSlurper = new JsonSlurper()\n    Map state\n    try {\n        state = (Map) jsonSlurper.parseText(stateContent)\n    } catch (Throwable ex) {\n        log.warn(\"Invalid state content, fallback to default. Error: ${ex.message}\")\n        state = new LinkedHashMap(defaultState)\n        stateExists = false\n    }\n\n    // Chun ho cc trng c bn\n    state.name = etlName\n    state.isActive = (state.containsKey('isActive') && state.isActive != null) ? state.isActive as Boolean : false\n    state.lastExecutionTime = (state.lastExecutionTime ?: currentTimeUTC)\n    state.startTime = (state.startTime ?: defaultStartTime)\n    state.endTime = (state.endTime ?: currentTimeUTC)\n\n    // Gi tr hin hu  dng cho logic ca s mi\n    def oldEndTime = (state.endTime && state.endTime.toString().trim()) ? state.endTime.toString() : defaultStartTime\n\n    // 3 trng b sung\n    Integer seq = 1\n    if (state.containsKey('sequenceNumber') && state.sequenceNumber != null && \"${state.sequenceNumber}\".isInteger()) {\n        seq = (state.sequenceNumber as Integer)\n        if (seq <= 0) seq = 1\n    }\n    Integer prevStatus = 0\n    if (state.containsKey('status') && state.status != null && \"${state.status}\".isInteger()) {\n        prevStatus = (state.status as Integer)\n    }\n    String msg = (state.containsKey('message') && state.message != null) ? (state.message as String) : \"\"\n\n    // --- LOGIC MI: to ca s ETL mi nu status = 0 hoc 2 ---\n    // Gii thch:\n    //  - 0 (khi to) hoc 2 (hon thnh) => ln ETL trc  kt thc bnh thng.\n    //  - startTime = endTime (c) vi gi pht giy 00:00:00 ; endTime = currentTimeUTC ; lastExecutionTime = endTime (c)\n    boolean shouldCreateNewWindow = stateExists && (prevStatus == 0 || prevStatus == 2)\n    if (shouldCreateNewWindow) {\n        // Parse oldEndTime v t li gi pht giy thnh 00:00:00\n        def newStartTime = oldEndTime\n        try {\n            def oldEndTimeParsed = LocalDateTime.parse(oldEndTime, formatter)\n            def dateOnly = oldEndTimeParsed.toLocalDate()\n            def startOfDay = dateOnly.atStartOfDay()\n            newStartTime = startOfDay.format(formatter)\n            log.info(\"Parsed oldEndTime '${oldEndTime}' to start of day: '${newStartTime}'\")\n        } catch (Exception ex) {\n            log.warn(\"Could not parse oldEndTime '${oldEndTime}', using as-is. Error: ${ex.message}\")\n            newStartTime = oldEndTime\n        }\n        \n        state.startTime = newStartTime\n        state.endTime = currentTimeUTC\n        log.info(\"Create new ETL window: startTime=${state.startTime} (reset to 00:00:00), endTime=${state.endTime}, lastExecutionTime=${state.lastExecutionTime}\")\n    }\n\n    // Nu file  tn ti:\n    //  - Nu prevStatus == 2 (hon thnh) -> tng sequenceNumber\n    //  - t status = 0 (khi to), message = \"\"\n    if (stateExists) {\n        if (prevStatus == 2) {\n            seq = seq + 1\n            log.info(\"Previous status=2 (completed). Increase sequenceNumber to ${seq}\")\n        }\n        prevStatus = 0\n        msg = \"\"\n    } else {\n        // state mi\n        prevStatus = 0\n        msg = \"\"\n        seq = 1\n    }\n\n    // Gn li vo state\n    state.sequenceNumber = seq\n    state.status = prevStatus\n    state.message = msg\n\n    // Ghi attributes ra flowfile\n    flowFile = session.putAttribute(flowFile, 'state.exists', stateExists.toString())\n    flowFile = session.putAttribute(flowFile, 'state.name', state.name.toString())\n    flowFile = session.putAttribute(flowFile, 'state.isActive', state.isActive.toString())\n    flowFile = session.putAttribute(flowFile, 'state.lastExecutionTime', state.lastExecutionTime.toString())\n    flowFile = session.putAttribute(flowFile, 'state.startTime', state.startTime.toString())\n    flowFile = session.putAttribute(flowFile, 'state.endTime', state.endTime.toString())\n    flowFile = session.putAttribute(flowFile, 'state.sequenceNumber', state.sequenceNumber.toString())\n    flowFile = session.putAttribute(flowFile, 'state.status', state.status.toString())\n    flowFile = session.putAttribute(flowFile, 'state.message', state.message.toString())\n    flowFile = session.putAttribute(flowFile, 'state.fullPath', stateFilePath)\n\n    // To JSON content chun ho\n    def stateContentForFlowFile = [\n        name: state.name,\n        isActive: state.isActive,\n        lastExecutionTime: state.lastExecutionTime,\n        startTime: state.startTime,\n        endTime: state.endTime,\n        sequenceNumber: state.sequenceNumber,\n        status: state.status,\n        message: state.message\n    ]\n\n    // Ghi JSON vo content\n    def contentJson = new JsonBuilder(stateContentForFlowFile).toString()\n    flowFile = session.write(flowFile, { outputStream ->\n        outputStream.write(contentJson.getBytes(\"UTF-8\"))\n    } as OutputStreamCallback)\n\n    // Lu ton b JSON sau chun ho vo attribute\n    flowFile = session.putAttribute(flowFile, 'state.content', contentJson)\n\n    session.transfer(flowFile, REL_SUCCESS)\n\n} catch (Exception e) {\n    log.error(\"Error reading state file for ETL '${etlName}' at '${stateFilePath}': \" + e.getMessage(), e)\n    flowFile = session.putAttribute(flowFile, 'error.message', e.getMessage())\n    session.transfer(flowFile, REL_FAILURE)\n}"
        },
        "propertyDescriptors" : {
          "Script File" : {
            "displayName" : "Script File",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script File",
            "resourceDefinition" : {
              "cardinality" : "SINGLE",
              "resourceTypes" : [ "FILE" ]
            },
            "sensitive" : false
          },
          "Script Engine" : {
            "displayName" : "Script Engine",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script Engine",
            "sensitive" : false
          },
          "Script Body" : {
            "displayName" : "Script Body",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script Body",
            "sensitive" : false
          },
          "Module Directory" : {
            "displayName" : "Module Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Module Directory",
            "resourceDefinition" : {
              "cardinality" : "MULTIPLE",
              "resourceTypes" : [ "FILE", "DIRECTORY" ]
            },
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.script.ExecuteScript",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9f06666e-e1f4-302e-a791-0026d5babad7",
        "identifier" : "680788dc-d561-3912-b848-de155e42bb17",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : -528.0,
          "y" : -192.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "9f06666e-e1f4-302e-a791-0026d5babad7",
        "identifier" : "45ed64b1-6a59-34bb-ad8a-fdb205b37cf2",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KhoiTao",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 104.0,
          "y" : -480.0
        },
        "properties" : {
          "filename" : "state.json",
          "state.startTime" : "${now():format(\"yyyy-MM-dd 00:00:00\", \"UTC\")}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.endTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}",
          "state.path" : "#{TempPath}#{Path.Separator}${state.name}",
          "state.isActive" : "false",
          "state.filename" : "state.json"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "state.startTime" : {
            "displayName" : "state.startTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.startTime",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.endTime" : {
            "displayName" : "state.endTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.endTime",
            "sensitive" : false
          },
          "state.path" : {
            "displayName" : "state.path",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.path",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.isActive" : {
            "displayName" : "state.isActive",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.isActive",
            "sensitive" : false
          },
          "state.filename" : {
            "displayName" : "state.filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.filename",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "03b52734-040a-3f34-b575-f59d14b848b1",
          "id" : "1a8650dc-a29f-3e6f-b215-dc0010a19613",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "03b52734-040a-3f34-b575-f59d14b848b1",
        "identifier" : "54f5e81a-f54d-364d-ab09-4085320c6b73",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "03b52734-040a-3f34-b575-f59d14b848b1",
          "id" : "7d84895f-ae98-3f52-b474-64b508a3a212",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "03b52734-040a-3f34-b575-f59d14b848b1",
          "id" : "1a8650dc-a29f-3e6f-b215-dc0010a19613",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "03b52734-040a-3f34-b575-f59d14b848b1",
        "identifier" : "e5c517e0-e912-3ace-a841-ea8a85b7d660",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "03b52734-040a-3f34-b575-f59d14b848b1",
          "id" : "e3875b68-4b2f-367d-aeed-ad66578f8ffe",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "03b52734-040a-3f34-b575-f59d14b848b1",
          "id" : "e143cae0-8db4-3930-b90d-f4c85cd02210",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "03b52734-040a-3f34-b575-f59d14b848b1",
        "identifier" : "accc3290-4fbd-3334-a338-8911d117bbf0",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "03b52734-040a-3f34-b575-f59d14b848b1",
          "id" : "26c3bc1b-3406-3b07-b77c-bf17911b2822",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
          "id" : "70242409-e8a2-3245-bbe9-b966070a4ccb",
          "name" : "input",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "03b52734-040a-3f34-b575-f59d14b848b1",
        "identifier" : "7630c23d-1520-3184-a1d1-6e6e44181b0d",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "03b52734-040a-3f34-b575-f59d14b848b1",
          "id" : "7d84895f-ae98-3f52-b474-64b508a3a212",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "03b52734-040a-3f34-b575-f59d14b848b1",
          "id" : "7d84895f-ae98-3f52-b474-64b508a3a212",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "03b52734-040a-3f34-b575-f59d14b848b1",
        "identifier" : "2a720f0d-4b62-346a-851a-a36ca3372d10",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "03b52734-040a-3f34-b575-f59d14b848b1",
          "id" : "e3875b68-4b2f-367d-aeed-ad66578f8ffe",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "03b52734-040a-3f34-b575-f59d14b848b1",
          "id" : "e3875b68-4b2f-367d-aeed-ad66578f8ffe",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "03b52734-040a-3f34-b575-f59d14b848b1",
        "identifier" : "c3ddbd08-f8ea-3358-8d1e-979f70ad0d7a",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "03b52734-040a-3f34-b575-f59d14b848b1",
          "id" : "e143cae0-8db4-3930-b90d-f4c85cd02210",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "03b52734-040a-3f34-b575-f59d14b848b1",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "03b52734-040a-3f34-b575-f59d14b848b1",
        "identifier" : "26c3bc1b-3406-3b07-b77c-bf17911b2822",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "ETL_Error",
      "outputPorts" : [ ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -768.0,
        "y" : 992.0
      },
      "processGroups" : [ {
        "comments" : "",
        "componentType" : "PROCESS_GROUP",
        "connections" : [ {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
            "id" : "8cf476cf-3599-3359-bf1c-c2d16abecb5e",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
          "identifier" : "0f7e3a1d-de84-32e0-915b-86c5b8a95ec3",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
            "id" : "8f13c7b8-bbe9-3e66-b06e-5b83b56a6175",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "zIndex" : 9
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
            "id" : "8f13c7b8-bbe9-3e66-b06e-5b83b56a6175",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
          "identifier" : "21554b3c-7e6a-3c9a-a392-df941a51a9d8",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "send" ],
          "source" : {
            "comments" : "",
            "groupId" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
            "id" : "65b451be-f4cc-3301-8da2-9a3e2199746d",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "zIndex" : 8
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
            "id" : "7c54d7ac-d7a2-3263-ab46-242b95a50abd",
            "name" : "GuiTinNhanTelegram",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
          "identifier" : "d3f4a8ec-4bf3-344d-92ef-25920c125a73",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
            "id" : "8f13c7b8-bbe9-3e66-b06e-5b83b56a6175",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "zIndex" : 7
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
            "id" : "65b451be-f4cc-3301-8da2-9a3e2199746d",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
          "identifier" : "329332a2-66d0-3cba-a327-7043dc89d5b3",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
            "id" : "e1aa7994-6435-3324-b395-769af0fd73ff",
            "name" : "LaythongtinTelegramCauHinh",
            "type" : "PROCESSOR"
          },
          "zIndex" : 6
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
            "id" : "8cf476cf-3599-3359-bf1c-c2d16abecb5e",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
          "identifier" : "3786cf9a-0c49-342a-8f59-09c14d20ec0b",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "Response", "Failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
            "id" : "7c54d7ac-d7a2-3263-ab46-242b95a50abd",
            "name" : "GuiTinNhanTelegram",
            "type" : "PROCESSOR"
          },
          "zIndex" : 5
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
            "id" : "e1aa7994-6435-3324-b395-769af0fd73ff",
            "name" : "LaythongtinTelegramCauHinh",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
          "identifier" : "5f1b6787-a688-3635-a3e1-8d38133c52ca",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
            "id" : "70242409-e8a2-3245-bbe9-b966070a4ccb",
            "name" : "input",
            "type" : "INPUT_PORT"
          },
          "zIndex" : 1
        } ],
        "controllerServices" : [ ],
        "defaultBackPressureDataSizeThreshold" : "1 GB",
        "defaultBackPressureObjectThreshold" : 10000,
        "defaultFlowFileExpiration" : "0 sec",
        "executionEngine" : "INHERITED",
        "flowFileConcurrency" : "UNBOUNDED",
        "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
        "funnels" : [ ],
        "groupIdentifier" : "03b52734-040a-3f34-b575-f59d14b848b1",
        "identifier" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
        "inputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "INPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
          "identifier" : "70242409-e8a2-3245-bbe9-b966070a4ccb",
          "name" : "input",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : -1056.0,
            "y" : -248.0
          },
          "scheduledState" : "ENABLED",
          "type" : "INPUT_PORT"
        } ],
        "labels" : [ ],
        "maxConcurrentTasks" : 1,
        "name" : "GuiThongBaoTelegram",
        "outputPorts" : [ ],
        "parameterContextName" : "ETL",
        "position" : {
          "x" : 1424.0,
          "y" : -264.0
        },
        "processGroups" : [ ],
        "processors" : [ {
          "autoTerminatedRelationships" : [ "success" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
          "identifier" : "8cf476cf-3599-3359-bf1c-c2d16abecb5e",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LogMessage",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 224.0,
            "y" : 32.0
          },
          "properties" : {
            "log-level" : "info"
          },
          "propertyDescriptors" : {
            "log-message" : {
              "displayName" : "Log message",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-message",
              "sensitive" : false
            },
            "log-level" : {
              "displayName" : "Log Level",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-level",
              "sensitive" : false
            },
            "log-prefix" : {
              "displayName" : "Log prefix",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-prefix",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.LogMessage",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "No Retry", "Retry", "Original" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
          "identifier" : "7c54d7ac-d7a2-3263-ab46-242b95a50abd",
          "maxBackoffPeriod" : "10 mins",
          "name" : "GuiTinNhanTelegram",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 656.0,
            "y" : -296.0
          },
          "properties" : {
            "Request Content-Encoding" : "DISABLED",
            "Request Multipart Form-Data Filename Enabled" : "true",
            "Request Chunked Transfer-Encoding Enabled" : "false",
            "HTTP/2 Disabled" : "False",
            "Connection Timeout" : "30 secs",
            "Response Cookie Strategy" : "DISABLED",
            "Socket Read Timeout" : "15 secs",
            "Socket Idle Connections" : "5",
            "Request Body Enabled" : "true",
            "OAuth2 Access Token Refresh Strategy" : "ON_TOKEN_EXPIRATION",
            "HTTP URL" : "https://api.telegram.org/bot#{BotToken}/sendMessage",
            "Socket Idle Timeout" : "5 mins",
            "Response Redirects Enabled" : "True",
            "Socket Write Timeout" : "15 secs",
            "Response FlowFile Naming Strategy" : "RANDOM",
            "Response Cache Enabled" : "false",
            "Request Date Header Enabled" : "True",
            "Request Failure Penalization Enabled" : "false",
            "Response Body Attribute Size" : "256",
            "Response Generation Required" : "false",
            "Response Header Request Attributes Enabled" : "false",
            "HTTP Method" : "POST",
            "Request Content-Type" : "application/json",
            "Request Digest Authentication Enabled" : "false",
            "Response Cache Size" : "10MB",
            "Response Body Ignored" : "false"
          },
          "propertyDescriptors" : {
            "Request Content-Encoding" : {
              "displayName" : "Request Content-Encoding",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Content-Encoding",
              "sensitive" : false
            },
            "proxy-configuration-service" : {
              "displayName" : "Proxy Configuration Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "proxy-configuration-service",
              "sensitive" : false
            },
            "Request Multipart Form-Data Filename Enabled" : {
              "displayName" : "Request Multipart Form-Data Filename Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Multipart Form-Data Filename Enabled",
              "sensitive" : false
            },
            "Request Chunked Transfer-Encoding Enabled" : {
              "displayName" : "Request Chunked Transfer-Encoding Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Chunked Transfer-Encoding Enabled",
              "sensitive" : false
            },
            "Response Header Request Attributes Prefix" : {
              "displayName" : "Response Header Request Attributes Prefix",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Header Request Attributes Prefix",
              "sensitive" : false
            },
            "HTTP/2 Disabled" : {
              "displayName" : "HTTP/2 Disabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP/2 Disabled",
              "sensitive" : false
            },
            "Connection Timeout" : {
              "displayName" : "Connection Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Connection Timeout",
              "sensitive" : false
            },
            "Response Cookie Strategy" : {
              "displayName" : "Response Cookie Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cookie Strategy",
              "sensitive" : false
            },
            "Request Password" : {
              "displayName" : "Request Password",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Password",
              "sensitive" : true
            },
            "Socket Read Timeout" : {
              "displayName" : "Socket Read Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Read Timeout",
              "sensitive" : false
            },
            "Socket Idle Connections" : {
              "displayName" : "Socket Idle Connections",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Idle Connections",
              "sensitive" : false
            },
            "Request Body Enabled" : {
              "displayName" : "Request Body Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Body Enabled",
              "sensitive" : false
            },
            "OAuth2 Access Token Refresh Strategy" : {
              "displayName" : "OAuth2 Access Token Refresh Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "OAuth2 Access Token Refresh Strategy",
              "sensitive" : false
            },
            "HTTP URL" : {
              "displayName" : "HTTP URL",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP URL",
              "sensitive" : false
            },
            "Request OAuth2 Access Token Provider" : {
              "displayName" : "Request OAuth2 Access Token Provider",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Request OAuth2 Access Token Provider",
              "sensitive" : false
            },
            "Socket Idle Timeout" : {
              "displayName" : "Socket Idle Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Idle Timeout",
              "sensitive" : false
            },
            "Response Redirects Enabled" : {
              "displayName" : "Response Redirects Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Redirects Enabled",
              "sensitive" : false
            },
            "Socket Write Timeout" : {
              "displayName" : "Socket Write Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Write Timeout",
              "sensitive" : false
            },
            "Request Header Attributes Pattern" : {
              "displayName" : "Request Header Attributes Pattern",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Header Attributes Pattern",
              "sensitive" : false
            },
            "Response FlowFile Naming Strategy" : {
              "displayName" : "Response FlowFile Naming Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response FlowFile Naming Strategy",
              "sensitive" : false
            },
            "Response Cache Enabled" : {
              "displayName" : "Response Cache Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cache Enabled",
              "sensitive" : false
            },
            "Request Date Header Enabled" : {
              "displayName" : "Request Date Header Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Date Header Enabled",
              "sensitive" : false
            },
            "Request Failure Penalization Enabled" : {
              "displayName" : "Request Failure Penalization Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Failure Penalization Enabled",
              "sensitive" : false
            },
            "Response Body Attribute Size" : {
              "displayName" : "Response Body Attribute Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Attribute Size",
              "sensitive" : false
            },
            "SSL Context Service" : {
              "displayName" : "SSL Context Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "SSL Context Service",
              "sensitive" : false
            },
            "Response Generation Required" : {
              "displayName" : "Response Generation Required",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Generation Required",
              "sensitive" : false
            },
            "Request User-Agent" : {
              "displayName" : "Request User-Agent",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request User-Agent",
              "sensitive" : false
            },
            "Response Header Request Attributes Enabled" : {
              "displayName" : "Response Header Request Attributes Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Header Request Attributes Enabled",
              "sensitive" : false
            },
            "HTTP Method" : {
              "displayName" : "HTTP Method",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP Method",
              "sensitive" : false
            },
            "Request Username" : {
              "displayName" : "Request Username",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Username",
              "sensitive" : false
            },
            "Request Content-Type" : {
              "displayName" : "Request Content-Type",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Content-Type",
              "sensitive" : false
            },
            "Response Body Attribute Name" : {
              "displayName" : "Response Body Attribute Name",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Attribute Name",
              "sensitive" : false
            },
            "Request Digest Authentication Enabled" : {
              "displayName" : "Request Digest Authentication Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Digest Authentication Enabled",
              "sensitive" : false
            },
            "Request Multipart Form-Data Name" : {
              "displayName" : "Request Multipart Form-Data Name",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Multipart Form-Data Name",
              "sensitive" : false
            },
            "Response Cache Size" : {
              "displayName" : "Response Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cache Size",
              "sensitive" : false
            },
            "Response Body Ignored" : {
              "displayName" : "Response Body Ignored",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Ignored",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
          "identifier" : "e1aa7994-6435-3324-b395-769af0fd73ff",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LaythongtinTelegramCauHinh",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : -656.0,
            "y" : -280.0
          },
          "properties" : {
            "telegram.botToken" : "#{BotToken}",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100",
            "telegram.chatId" : "#{ChatId}",
            "telegram.enabled" : "#{Enabled}",
            "telegram.text" : " MESSAGE ALERT\n Application: NIFI\n Flow: ${state.name}\n Message: ${state.message}"
          },
          "propertyDescriptors" : {
            "telegram.botToken" : {
              "displayName" : "telegram.botToken",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.botToken",
              "sensitive" : false
            },
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "telegram.chatId" : {
              "displayName" : "telegram.chatId",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.chatId",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            },
            "telegram.enabled" : {
              "displayName" : "telegram.enabled",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.enabled",
              "sensitive" : false
            },
            "telegram.text" : {
              "displayName" : "telegram.text",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.text",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
          "identifier" : "8f13c7b8-bbe9-3e66-b06e-5b83b56a6175",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ReplaceText",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 200.0,
            "y" : -288.0
          },
          "properties" : {
            "Regular Expression" : "(?s)^(.*)$",
            "Replacement Value" : "{\"chat_id\":\"#{ChatId}\",\"text\":\"${telegram.text}\"}",
            "Evaluation Mode" : "Entire text",
            "Line-by-Line Evaluation Mode" : "All",
            "Character Set" : "UTF-8",
            "Maximum Buffer Size" : "1 MB",
            "Replacement Strategy" : "Regex Replace"
          },
          "propertyDescriptors" : {
            "Regular Expression" : {
              "displayName" : "Search Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Regular Expression",
              "sensitive" : false
            },
            "Replacement Value" : {
              "displayName" : "Replacement Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Value",
              "sensitive" : false
            },
            "Evaluation Mode" : {
              "displayName" : "Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Evaluation Mode",
              "sensitive" : false
            },
            "Text to Prepend" : {
              "displayName" : "Text to Prepend",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Prepend",
              "sensitive" : false
            },
            "Line-by-Line Evaluation Mode" : {
              "displayName" : "Line-by-Line Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Line-by-Line Evaluation Mode",
              "sensitive" : false
            },
            "Character Set" : {
              "displayName" : "Character Set",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Character Set",
              "sensitive" : false
            },
            "Maximum Buffer Size" : {
              "displayName" : "Maximum Buffer Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum Buffer Size",
              "sensitive" : false
            },
            "Replacement Strategy" : {
              "displayName" : "Replacement Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Strategy",
              "sensitive" : false
            },
            "Text to Append" : {
              "displayName" : "Text to Append",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Append",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ReplaceText",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "unmatched" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "eeffdb5a-f583-3f84-b0e8-5625fcd3f48e",
          "identifier" : "65b451be-f4cc-3301-8da2-9a3e2199746d",
          "maxBackoffPeriod" : "10 mins",
          "name" : "RouteOnAttribute",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : -184.0,
            "y" : -288.0
          },
          "properties" : {
            "Routing Strategy" : "Route to Property name",
            "send" : "${telegram.enabled:equals('true')}"
          },
          "propertyDescriptors" : {
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "send" : {
              "displayName" : "send",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "send",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        } ],
        "remoteProcessGroups" : [ ],
        "scheduledState" : "ENABLED",
        "statelessFlowTimeout" : "1 min"
      } ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "03b52734-040a-3f34-b575-f59d14b848b1",
        "identifier" : "1a8650dc-a29f-3e6f-b215-dc0010a19613",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "03b52734-040a-3f34-b575-f59d14b848b1",
        "identifier" : "7d84895f-ae98-3f52-b474-64b508a3a212",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${state.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "03b52734-040a-3f34-b575-f59d14b848b1",
        "identifier" : "e3875b68-4b2f-367d-aeed-ad66578f8ffe",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${state.name}\",\n  \"isActive\": ${state.isActive},\n  \"lastExecutionTime\": \"${state.lastExecutionTime}\",\n  \"startTime\": \"${state.startTime}\",\n  \"endTime\": \"${state.endTime}\",\n  \"status\": \"${state.status}\",\n  \"sequenceNumber\": \"${state.sequenceNumber}\",\n  \"message\": \"${state.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "03b52734-040a-3f34-b575-f59d14b848b1",
        "identifier" : "e143cae0-8db4-3930-b90d-f4c85cd02210",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "state.message" : "Li khi ly danh sch BC",
          "filename" : "${state.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.status" : "3",
          "state.isActive" : "false",
          "state.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "state.message" : {
            "displayName" : "state.message",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.message",
            "sensitive" : false
          },
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.status" : {
            "displayName" : "state.status",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.status",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.isActive" : {
            "displayName" : "state.isActive",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.isActive",
            "sensitive" : false
          },
          "state.lastExecutionTime" : {
            "displayName" : "state.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.lastExecutionTime",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
          "id" : "149a2ff1-8c23-371a-8308-8fb8072807db",
          "name" : "RouteOnAttribute",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
        "identifier" : "4343d6ec-a246-392e-aad8-f19b836765e9",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
          "id" : "d78add70-d5ed-3768-80b1-8e3ae86335b5",
          "name" : "LaythongtinTelegramCauHinh",
          "type" : "PROCESSOR"
        },
        "zIndex" : 6
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
          "id" : "d78add70-d5ed-3768-80b1-8e3ae86335b5",
          "name" : "LaythongtinTelegramCauHinh",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
        "identifier" : "9dbd9184-835b-33e7-9006-ca082a98537e",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
          "id" : "aafdf295-844d-3fdd-89fd-264c80ad23aa",
          "name" : "input",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 1
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
          "id" : "b4f72db4-6d6d-3620-a85c-159ed6047f70",
          "name" : "GuiTinNhanTelegram",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
        "identifier" : "eeaae035-1aee-3e96-9eac-d520f7a9da5b",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
          "id" : "929dbf0d-81f5-358f-845b-18b72c0d2b46",
          "name" : "ReplaceText",
          "type" : "PROCESSOR"
        },
        "zIndex" : 7
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
          "id" : "faa7d4bc-015d-3614-889e-1ee867c52386",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
        "identifier" : "bb94c87c-b5d1-3150-8e4b-5712a93fd44e",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "Response", "Failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
          "id" : "b4f72db4-6d6d-3620-a85c-159ed6047f70",
          "name" : "GuiTinNhanTelegram",
          "type" : "PROCESSOR"
        },
        "zIndex" : 5
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
          "id" : "faa7d4bc-015d-3614-889e-1ee867c52386",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
        "identifier" : "55dfb529-4c0c-3860-9a53-d2dd071b4c87",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
          "id" : "929dbf0d-81f5-358f-845b-18b72c0d2b46",
          "name" : "ReplaceText",
          "type" : "PROCESSOR"
        },
        "zIndex" : 9
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
          "id" : "929dbf0d-81f5-358f-845b-18b72c0d2b46",
          "name" : "ReplaceText",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
        "identifier" : "0ac9bab0-113e-36b9-9f5b-337dee501af2",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "send" ],
        "source" : {
          "comments" : "",
          "groupId" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
          "id" : "149a2ff1-8c23-371a-8308-8fb8072807db",
          "name" : "RouteOnAttribute",
          "type" : "PROCESSOR"
        },
        "zIndex" : 8
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
        "identifier" : "aafdf295-844d-3fdd-89fd-264c80ad23aa",
        "name" : "input",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -1056.0,
          "y" : -248.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "GuiThongBaoTelegram",
      "outputPorts" : [ ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -256.0,
        "y" : 4904.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
        "identifier" : "929dbf0d-81f5-358f-845b-18b72c0d2b46",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ReplaceText",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 200.0,
          "y" : -288.0
        },
        "properties" : {
          "Regular Expression" : "(?s)^(.*)$",
          "Replacement Value" : "{\"chat_id\":\"#{ChatId}\",\"text\":\"${telegram.text}\"}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Regex Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "unmatched" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
        "identifier" : "149a2ff1-8c23-371a-8308-8fb8072807db",
        "maxBackoffPeriod" : "10 mins",
        "name" : "RouteOnAttribute",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : -184.0,
          "y" : -288.0
        },
        "properties" : {
          "Routing Strategy" : "Route to Property name",
          "send" : "${telegram.enabled:equals('true')}"
        },
        "propertyDescriptors" : {
          "Routing Strategy" : {
            "displayName" : "Routing Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Routing Strategy",
            "sensitive" : false
          },
          "send" : {
            "displayName" : "send",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "send",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
        "identifier" : "d78add70-d5ed-3768-80b1-8e3ae86335b5",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LaythongtinTelegramCauHinh",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : -656.0,
          "y" : -280.0
        },
        "properties" : {
          "telegram.botToken" : "#{BotToken}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "telegram.chatId" : "#{ChatId}",
          "telegram.enabled" : "#{Enabled}",
          "telegram.text" : " MESSAGE ALERT\n Application: NIFI\n Flow: ${state.name}\n SequenceNumber: ${state.sequenceNumber}\n Message: ${state.message}\n Time Query: ${state.startTime} - ${state.endTime}"
        },
        "propertyDescriptors" : {
          "telegram.botToken" : {
            "displayName" : "telegram.botToken",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "telegram.botToken",
            "sensitive" : false
          },
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "telegram.chatId" : {
            "displayName" : "telegram.chatId",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "telegram.chatId",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "telegram.enabled" : {
            "displayName" : "telegram.enabled",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "telegram.enabled",
            "sensitive" : false
          },
          "telegram.text" : {
            "displayName" : "telegram.text",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "telegram.text",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "No Retry", "Retry", "Original" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
        "identifier" : "b4f72db4-6d6d-3620-a85c-159ed6047f70",
        "maxBackoffPeriod" : "10 mins",
        "name" : "GuiTinNhanTelegram",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 656.0,
          "y" : -296.0
        },
        "properties" : {
          "Request Content-Encoding" : "DISABLED",
          "Request Multipart Form-Data Filename Enabled" : "true",
          "Request Chunked Transfer-Encoding Enabled" : "false",
          "HTTP/2 Disabled" : "False",
          "Connection Timeout" : "30 secs",
          "Response Cookie Strategy" : "DISABLED",
          "Socket Read Timeout" : "15 secs",
          "Socket Idle Connections" : "5",
          "Request Body Enabled" : "true",
          "OAuth2 Access Token Refresh Strategy" : "ON_TOKEN_EXPIRATION",
          "HTTP URL" : "https://api.telegram.org/bot#{BotToken}/sendMessage",
          "Socket Idle Timeout" : "5 mins",
          "Response Redirects Enabled" : "True",
          "Socket Write Timeout" : "15 secs",
          "Response FlowFile Naming Strategy" : "RANDOM",
          "Response Cache Enabled" : "false",
          "Request Date Header Enabled" : "True",
          "Request Failure Penalization Enabled" : "false",
          "Response Body Attribute Size" : "256",
          "Response Generation Required" : "false",
          "Response Header Request Attributes Enabled" : "false",
          "HTTP Method" : "POST",
          "Request Content-Type" : "application/json",
          "Request Digest Authentication Enabled" : "false",
          "Response Cache Size" : "10MB",
          "Response Body Ignored" : "false"
        },
        "propertyDescriptors" : {
          "Request Content-Encoding" : {
            "displayName" : "Request Content-Encoding",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Content-Encoding",
            "sensitive" : false
          },
          "proxy-configuration-service" : {
            "displayName" : "Proxy Configuration Service",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "proxy-configuration-service",
            "sensitive" : false
          },
          "Request Multipart Form-Data Filename Enabled" : {
            "displayName" : "Request Multipart Form-Data Filename Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Multipart Form-Data Filename Enabled",
            "sensitive" : false
          },
          "Request Chunked Transfer-Encoding Enabled" : {
            "displayName" : "Request Chunked Transfer-Encoding Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Chunked Transfer-Encoding Enabled",
            "sensitive" : false
          },
          "Response Header Request Attributes Prefix" : {
            "displayName" : "Response Header Request Attributes Prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Header Request Attributes Prefix",
            "sensitive" : false
          },
          "HTTP/2 Disabled" : {
            "displayName" : "HTTP/2 Disabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "HTTP/2 Disabled",
            "sensitive" : false
          },
          "Connection Timeout" : {
            "displayName" : "Connection Timeout",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Connection Timeout",
            "sensitive" : false
          },
          "Response Cookie Strategy" : {
            "displayName" : "Response Cookie Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Cookie Strategy",
            "sensitive" : false
          },
          "Request Password" : {
            "displayName" : "Request Password",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Password",
            "sensitive" : true
          },
          "Socket Read Timeout" : {
            "displayName" : "Socket Read Timeout",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Socket Read Timeout",
            "sensitive" : false
          },
          "Socket Idle Connections" : {
            "displayName" : "Socket Idle Connections",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Socket Idle Connections",
            "sensitive" : false
          },
          "Request Body Enabled" : {
            "displayName" : "Request Body Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Body Enabled",
            "sensitive" : false
          },
          "OAuth2 Access Token Refresh Strategy" : {
            "displayName" : "OAuth2 Access Token Refresh Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "OAuth2 Access Token Refresh Strategy",
            "sensitive" : false
          },
          "HTTP URL" : {
            "displayName" : "HTTP URL",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "HTTP URL",
            "sensitive" : false
          },
          "Request OAuth2 Access Token Provider" : {
            "displayName" : "Request OAuth2 Access Token Provider",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "Request OAuth2 Access Token Provider",
            "sensitive" : false
          },
          "Socket Idle Timeout" : {
            "displayName" : "Socket Idle Timeout",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Socket Idle Timeout",
            "sensitive" : false
          },
          "Response Redirects Enabled" : {
            "displayName" : "Response Redirects Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Redirects Enabled",
            "sensitive" : false
          },
          "Socket Write Timeout" : {
            "displayName" : "Socket Write Timeout",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Socket Write Timeout",
            "sensitive" : false
          },
          "Request Header Attributes Pattern" : {
            "displayName" : "Request Header Attributes Pattern",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Header Attributes Pattern",
            "sensitive" : false
          },
          "Response FlowFile Naming Strategy" : {
            "displayName" : "Response FlowFile Naming Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response FlowFile Naming Strategy",
            "sensitive" : false
          },
          "Response Cache Enabled" : {
            "displayName" : "Response Cache Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Cache Enabled",
            "sensitive" : false
          },
          "Request Date Header Enabled" : {
            "displayName" : "Request Date Header Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Date Header Enabled",
            "sensitive" : false
          },
          "Request Failure Penalization Enabled" : {
            "displayName" : "Request Failure Penalization Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Failure Penalization Enabled",
            "sensitive" : false
          },
          "Response Body Attribute Size" : {
            "displayName" : "Response Body Attribute Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Body Attribute Size",
            "sensitive" : false
          },
          "SSL Context Service" : {
            "displayName" : "SSL Context Service",
            "dynamic" : false,
            "identifiesControllerService" : true,
            "name" : "SSL Context Service",
            "sensitive" : false
          },
          "Response Generation Required" : {
            "displayName" : "Response Generation Required",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Generation Required",
            "sensitive" : false
          },
          "Request User-Agent" : {
            "displayName" : "Request User-Agent",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request User-Agent",
            "sensitive" : false
          },
          "Response Header Request Attributes Enabled" : {
            "displayName" : "Response Header Request Attributes Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Header Request Attributes Enabled",
            "sensitive" : false
          },
          "HTTP Method" : {
            "displayName" : "HTTP Method",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "HTTP Method",
            "sensitive" : false
          },
          "Request Username" : {
            "displayName" : "Request Username",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Username",
            "sensitive" : false
          },
          "Request Content-Type" : {
            "displayName" : "Request Content-Type",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Content-Type",
            "sensitive" : false
          },
          "Response Body Attribute Name" : {
            "displayName" : "Response Body Attribute Name",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Body Attribute Name",
            "sensitive" : false
          },
          "Request Digest Authentication Enabled" : {
            "displayName" : "Request Digest Authentication Enabled",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Digest Authentication Enabled",
            "sensitive" : false
          },
          "Request Multipart Form-Data Name" : {
            "displayName" : "Request Multipart Form-Data Name",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Request Multipart Form-Data Name",
            "sensitive" : false
          },
          "Response Cache Size" : {
            "displayName" : "Response Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Cache Size",
            "sensitive" : false
          },
          "Response Body Ignored" : {
            "displayName" : "Response Body Ignored",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Response Body Ignored",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "7a87d25f-de5a-3cf9-878f-46f0a78f1a7b",
        "identifier" : "faa7d4bc-015d-3614-889e-1ee867c52386",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 224.0,
          "y" : 32.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "0cc77401-8870-37d7-8712-78beeb9966e3",
          "id" : "8f9d8318-35a4-38e3-8f36-ce77c7edba96",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "0cc77401-8870-37d7-8712-78beeb9966e3",
        "identifier" : "85512f77-9790-3f21-9c29-7609382caec4",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "0cc77401-8870-37d7-8712-78beeb9966e3",
          "id" : "458762ea-6922-360a-a1e6-ff1989e140d8",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "0cc77401-8870-37d7-8712-78beeb9966e3",
          "id" : "fd40fa60-1844-3fa0-84a0-472760fd140f",
          "name" : "stateOut",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "0cc77401-8870-37d7-8712-78beeb9966e3",
        "identifier" : "b4e79c48-fdb1-36c3-afd7-81f685901984",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "0cc77401-8870-37d7-8712-78beeb9966e3",
          "id" : "77ccba19-17cf-3a34-a9cc-fadf1685b81f",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "0cc77401-8870-37d7-8712-78beeb9966e3",
          "id" : "2a9be562-04ea-33bd-af12-78685cf014b0",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "0cc77401-8870-37d7-8712-78beeb9966e3",
        "identifier" : "af8d004d-d9b4-375b-b9c2-67b3b0860115",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "0cc77401-8870-37d7-8712-78beeb9966e3",
          "id" : "77ccba19-17cf-3a34-a9cc-fadf1685b81f",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "0cc77401-8870-37d7-8712-78beeb9966e3",
          "id" : "2a9be562-04ea-33bd-af12-78685cf014b0",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "0cc77401-8870-37d7-8712-78beeb9966e3",
        "identifier" : "441d5d4f-8cb7-38df-bb42-67c3d77ceb27",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "0cc77401-8870-37d7-8712-78beeb9966e3",
          "id" : "8f9d8318-35a4-38e3-8f36-ce77c7edba96",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "0cc77401-8870-37d7-8712-78beeb9966e3",
          "id" : "458762ea-6922-360a-a1e6-ff1989e140d8",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "0cc77401-8870-37d7-8712-78beeb9966e3",
        "identifier" : "05e77918-6472-341d-82c6-16bbc2141006",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "0cc77401-8870-37d7-8712-78beeb9966e3",
          "id" : "15ccbd5a-80f0-3608-9759-6b349a8bf6fc",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "0cc77401-8870-37d7-8712-78beeb9966e3",
          "id" : "77ccba19-17cf-3a34-a9cc-fadf1685b81f",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "0cc77401-8870-37d7-8712-78beeb9966e3",
        "identifier" : "47bf908a-7e58-364a-9254-38c6451de1ea",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "0cc77401-8870-37d7-8712-78beeb9966e3",
          "id" : "8f9d8318-35a4-38e3-8f36-ce77c7edba96",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "0cc77401-8870-37d7-8712-78beeb9966e3",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "0cc77401-8870-37d7-8712-78beeb9966e3",
        "identifier" : "15ccbd5a-80f0-3608-9759-6b349a8bf6fc",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LuuTrangThaiETL",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "0cc77401-8870-37d7-8712-78beeb9966e3",
        "identifier" : "fd40fa60-1844-3fa0-84a0-472760fd140f",
        "name" : "stateOut",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 1464.0,
          "y" : -200.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -256.0,
        "y" : 4616.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "0cc77401-8870-37d7-8712-78beeb9966e3",
        "identifier" : "8f9d8318-35a4-38e3-8f36-ce77c7edba96",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${state.name}\",\n  \"isActive\": ${state.isActive},\n  \"lastExecutionTime\": \"${state.lastExecutionTime}\",\n  \"startTime\": \"${state.startTime}\",\n  \"endTime\": \"${state.endTime}\",\n  \"status\": \"${state.status}\",\n  \"sequenceNumber\": \"${state.sequenceNumber}\",\n  \"message\": \"${state.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "0cc77401-8870-37d7-8712-78beeb9966e3",
        "identifier" : "2a9be562-04ea-33bd-af12-78685cf014b0",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "0cc77401-8870-37d7-8712-78beeb9966e3",
        "identifier" : "458762ea-6922-360a-a1e6-ff1989e140d8",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "filename" : "${state.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.lastExecutionTime" : {
            "displayName" : "state.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.lastExecutionTime",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "0cc77401-8870-37d7-8712-78beeb9966e3",
        "identifier" : "77ccba19-17cf-3a34-a9cc-fadf1685b81f",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${state.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
          "id" : "bf4e9f37-9152-3f7f-baf3-0442192f90cb",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "2aae8068-598e-3d94-96ed-3947cb037938",
        "identifier" : "098905c5-89e0-3ef5-a5d8-6a8d04387fa1",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "2aae8068-598e-3d94-96ed-3947cb037938",
          "id" : "c241f3b6-71ac-373b-a854-d2ecfabbc001",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "zIndex" : 45
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "2aae8068-598e-3d94-96ed-3947cb037938",
          "id" : "c241f3b6-71ac-373b-a854-d2ecfabbc001",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "2aae8068-598e-3d94-96ed-3947cb037938",
        "identifier" : "4fc43f71-cc1a-3972-b7ce-a394e424749e",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "2aae8068-598e-3d94-96ed-3947cb037938",
          "id" : "26b627a4-3ab2-3429-8f95-a2852133a1c2",
          "name" : "KhoiTaoBc",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "2aae8068-598e-3d94-96ed-3947cb037938",
          "id" : "ef74e471-1d43-3797-9c48-c50684130ef6",
          "name" : "stateBcOut",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "2aae8068-598e-3d94-96ed-3947cb037938",
        "identifier" : "fad83b83-addc-3bd6-a4d9-5552bd37eab9",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "2aae8068-598e-3d94-96ed-3947cb037938",
          "id" : "c241f3b6-71ac-373b-a854-d2ecfabbc001",
          "name" : "LayTrangThai",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "2aae8068-598e-3d94-96ed-3947cb037938",
          "id" : "26b627a4-3ab2-3429-8f95-a2852133a1c2",
          "name" : "KhoiTaoBc",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "2aae8068-598e-3d94-96ed-3947cb037938",
        "identifier" : "f93135b4-67cd-31c7-9143-8822e225f393",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "2aae8068-598e-3d94-96ed-3947cb037938",
          "id" : "393dc900-512e-36e2-baf8-5e4d2f8ea483",
          "name" : "BcId",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 43
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "2aae8068-598e-3d94-96ed-3947cb037938",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "2aae8068-598e-3d94-96ed-3947cb037938",
        "identifier" : "393dc900-512e-36e2-baf8-5e4d2f8ea483",
        "name" : "BcId",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LayTrangThaiBCHienTai",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "2aae8068-598e-3d94-96ed-3947cb037938",
        "identifier" : "ef74e471-1d43-3797-9c48-c50684130ef6",
        "name" : "stateBcOut",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 1280.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -248.0,
        "y" : 1880.0
      },
      "processGroups" : [ {
        "comments" : "",
        "componentType" : "PROCESS_GROUP",
        "connections" : [ {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
            "id" : "1f8a6ce4-9361-39af-b9d8-397d245c8b33",
            "name" : "CapNhatToContent",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
          "identifier" : "ac8922f3-37a5-3270-9257-358e66d22275",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
            "id" : "a281e7f9-4217-3371-aeb9-5e2d46bab878",
            "name" : "ChuanHoa",
            "type" : "PROCESSOR"
          },
          "zIndex" : 42
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
            "id" : "2935e420-ec84-3c7d-a31b-2d2246d8edb4",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
          "identifier" : "23c70f5a-2aab-334f-97d2-fc4f86a02eab",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
            "id" : "a891d12e-2f0c-36a9-be6b-4fea1d0029cc",
            "name" : "LuuFile",
            "type" : "PROCESSOR"
          },
          "zIndex" : 46
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
            "id" : "2935e420-ec84-3c7d-a31b-2d2246d8edb4",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
          "identifier" : "c9bc4b54-7eae-3779-a7bb-84458a829d74",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
            "id" : "1f8a6ce4-9361-39af-b9d8-397d245c8b33",
            "name" : "CapNhatToContent",
            "type" : "PROCESSOR"
          },
          "zIndex" : 44
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
            "id" : "a891d12e-2f0c-36a9-be6b-4fea1d0029cc",
            "name" : "LuuFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
          "identifier" : "dbd30994-bbfb-37a6-803a-85711f86e0fe",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
            "id" : "1f8a6ce4-9361-39af-b9d8-397d245c8b33",
            "name" : "CapNhatToContent",
            "type" : "PROCESSOR"
          },
          "zIndex" : 43
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
            "id" : "a281e7f9-4217-3371-aeb9-5e2d46bab878",
            "name" : "ChuanHoa",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
          "identifier" : "7890fd63-3677-3246-aec1-0d000abe8ca2",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
            "id" : "bf4e9f37-9152-3f7f-baf3-0442192f90cb",
            "name" : "TrangThai",
            "type" : "INPUT_PORT"
          },
          "zIndex" : 41
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
            "id" : "60079125-0d6e-304e-a191-0e4afba1cfb8",
            "name" : "input",
            "type" : "INPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
          "identifier" : "b0fde683-e180-39fe-9a4c-3445229841c1",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
            "id" : "a891d12e-2f0c-36a9-be6b-4fea1d0029cc",
            "name" : "LuuFile",
            "type" : "PROCESSOR"
          },
          "zIndex" : 47
        } ],
        "controllerServices" : [ ],
        "defaultBackPressureDataSizeThreshold" : "1 GB",
        "defaultBackPressureObjectThreshold" : 10000,
        "defaultFlowFileExpiration" : "0 sec",
        "executionEngine" : "INHERITED",
        "flowFileConcurrency" : "UNBOUNDED",
        "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
        "funnels" : [ ],
        "groupIdentifier" : "2aae8068-598e-3d94-96ed-3947cb037938",
        "identifier" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
        "inputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "INPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
          "identifier" : "bf4e9f37-9152-3f7f-baf3-0442192f90cb",
          "name" : "TrangThai",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : -488.0,
            "y" : -176.0
          },
          "scheduledState" : "ENABLED",
          "type" : "INPUT_PORT"
        } ],
        "labels" : [ ],
        "maxConcurrentTasks" : 1,
        "name" : "LuuTrangThaiBCHienTaiVoiLoi",
        "outputPorts" : [ ],
        "parameterContextName" : "TikTokETL",
        "position" : {
          "x" : 600.0,
          "y" : 72.0
        },
        "processGroups" : [ {
          "comments" : "",
          "componentType" : "PROCESS_GROUP",
          "connections" : [ {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
              "id" : "2af51748-8e79-34b5-82bf-dce6b1e26d49",
              "name" : "LaythongtinTelegramCauHinh",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
            "identifier" : "763eee06-6322-37f4-b4f5-7d37261fa491",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "" ],
            "source" : {
              "groupId" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
              "id" : "60079125-0d6e-304e-a191-0e4afba1cfb8",
              "name" : "input",
              "type" : "INPUT_PORT"
            },
            "zIndex" : 1
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
              "id" : "731071a0-74b9-301f-b24c-237b1463d957",
              "name" : "ReplaceText",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
            "identifier" : "2e8851a5-7d15-347f-ae0a-034fddee8cb9",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "send" ],
            "source" : {
              "comments" : "",
              "groupId" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
              "id" : "ed18ac74-2a5e-33e6-88dd-10f471b2ce3e",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "zIndex" : 8
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
              "id" : "dce4d5c4-91a8-39ef-bb30-d8572296407f",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
            "identifier" : "525722b6-3408-3fad-83ba-07046f86d62c",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
              "id" : "731071a0-74b9-301f-b24c-237b1463d957",
              "name" : "ReplaceText",
              "type" : "PROCESSOR"
            },
            "zIndex" : 9
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
              "id" : "dce4d5c4-91a8-39ef-bb30-d8572296407f",
              "name" : "LogMessage",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
            "identifier" : "156f4f37-de35-3e7b-9143-cc1f805ac5b1",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "Response", "Failure" ],
            "source" : {
              "comments" : "",
              "groupId" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
              "id" : "ee8560fa-4ec8-39a0-bb3e-72a0f098eb42",
              "name" : "GuiTinNhanTelegram",
              "type" : "PROCESSOR"
            },
            "zIndex" : 5
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
              "id" : "ed18ac74-2a5e-33e6-88dd-10f471b2ce3e",
              "name" : "RouteOnAttribute",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
            "identifier" : "ef10d049-d39e-3639-971d-03cf15a507de",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
              "id" : "2af51748-8e79-34b5-82bf-dce6b1e26d49",
              "name" : "LaythongtinTelegramCauHinh",
              "type" : "PROCESSOR"
            },
            "zIndex" : 6
          }, {
            "backPressureDataSizeThreshold" : "1 GB",
            "backPressureObjectThreshold" : 10000,
            "bends" : [ ],
            "componentType" : "CONNECTION",
            "destination" : {
              "comments" : "",
              "groupId" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
              "id" : "ee8560fa-4ec8-39a0-bb3e-72a0f098eb42",
              "name" : "GuiTinNhanTelegram",
              "type" : "PROCESSOR"
            },
            "flowFileExpiration" : "0 sec",
            "groupIdentifier" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
            "identifier" : "4802dc5d-aef1-33fa-9087-67e6bf351b9a",
            "labelIndex" : 0,
            "loadBalanceCompression" : "DO_NOT_COMPRESS",
            "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
            "name" : "",
            "partitioningAttribute" : "",
            "prioritizers" : [ ],
            "selectedRelationships" : [ "success" ],
            "source" : {
              "comments" : "",
              "groupId" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
              "id" : "731071a0-74b9-301f-b24c-237b1463d957",
              "name" : "ReplaceText",
              "type" : "PROCESSOR"
            },
            "zIndex" : 7
          } ],
          "controllerServices" : [ ],
          "defaultBackPressureDataSizeThreshold" : "1 GB",
          "defaultBackPressureObjectThreshold" : 10000,
          "defaultFlowFileExpiration" : "0 sec",
          "executionEngine" : "INHERITED",
          "flowFileConcurrency" : "UNBOUNDED",
          "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
          "funnels" : [ ],
          "groupIdentifier" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
          "identifier" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
          "inputPorts" : [ {
            "allowRemoteAccess" : false,
            "componentType" : "INPUT_PORT",
            "concurrentlySchedulableTaskCount" : 1,
            "groupIdentifier" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
            "identifier" : "60079125-0d6e-304e-a191-0e4afba1cfb8",
            "name" : "input",
            "portFunction" : "STANDARD",
            "position" : {
              "x" : -1056.0,
              "y" : -248.0
            },
            "scheduledState" : "ENABLED",
            "type" : "INPUT_PORT"
          } ],
          "labels" : [ ],
          "maxConcurrentTasks" : 1,
          "name" : "GuiThongBaoTelegram",
          "outputPorts" : [ ],
          "parameterContextName" : "ETL",
          "position" : {
            "x" : 1376.0,
            "y" : -256.0
          },
          "processGroups" : [ ],
          "processors" : [ {
            "autoTerminatedRelationships" : [ "success" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
            "identifier" : "dce4d5c4-91a8-39ef-bb30-d8572296407f",
            "maxBackoffPeriod" : "10 mins",
            "name" : "LogMessage",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 224.0,
              "y" : 32.0
            },
            "properties" : {
              "log-level" : "info"
            },
            "propertyDescriptors" : {
              "log-message" : {
                "displayName" : "Log message",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-message",
                "sensitive" : false
              },
              "log-level" : {
                "displayName" : "Log Level",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-level",
                "sensitive" : false
              },
              "log-prefix" : {
                "displayName" : "Log prefix",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "log-prefix",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.LogMessage",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "No Retry", "Retry", "Original" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
            "identifier" : "ee8560fa-4ec8-39a0-bb3e-72a0f098eb42",
            "maxBackoffPeriod" : "10 mins",
            "name" : "GuiTinNhanTelegram",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 656.0,
              "y" : -296.0
            },
            "properties" : {
              "Request Content-Encoding" : "DISABLED",
              "Request Multipart Form-Data Filename Enabled" : "true",
              "Request Chunked Transfer-Encoding Enabled" : "false",
              "HTTP/2 Disabled" : "False",
              "Connection Timeout" : "30 secs",
              "Response Cookie Strategy" : "DISABLED",
              "Socket Read Timeout" : "15 secs",
              "Socket Idle Connections" : "5",
              "Request Body Enabled" : "true",
              "OAuth2 Access Token Refresh Strategy" : "ON_TOKEN_EXPIRATION",
              "HTTP URL" : "https://api.telegram.org/bot#{BotToken}/sendMessage",
              "Socket Idle Timeout" : "5 mins",
              "Response Redirects Enabled" : "True",
              "Socket Write Timeout" : "15 secs",
              "Response FlowFile Naming Strategy" : "RANDOM",
              "Response Cache Enabled" : "false",
              "Request Date Header Enabled" : "True",
              "Request Failure Penalization Enabled" : "false",
              "Response Body Attribute Size" : "256",
              "Response Generation Required" : "false",
              "Response Header Request Attributes Enabled" : "false",
              "HTTP Method" : "POST",
              "Request Content-Type" : "application/json",
              "Request Digest Authentication Enabled" : "false",
              "Response Cache Size" : "10MB",
              "Response Body Ignored" : "false"
            },
            "propertyDescriptors" : {
              "Request Content-Encoding" : {
                "displayName" : "Request Content-Encoding",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Content-Encoding",
                "sensitive" : false
              },
              "proxy-configuration-service" : {
                "displayName" : "Proxy Configuration Service",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "proxy-configuration-service",
                "sensitive" : false
              },
              "Request Multipart Form-Data Filename Enabled" : {
                "displayName" : "Request Multipart Form-Data Filename Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Multipart Form-Data Filename Enabled",
                "sensitive" : false
              },
              "Request Chunked Transfer-Encoding Enabled" : {
                "displayName" : "Request Chunked Transfer-Encoding Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Chunked Transfer-Encoding Enabled",
                "sensitive" : false
              },
              "Response Header Request Attributes Prefix" : {
                "displayName" : "Response Header Request Attributes Prefix",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Header Request Attributes Prefix",
                "sensitive" : false
              },
              "HTTP/2 Disabled" : {
                "displayName" : "HTTP/2 Disabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "HTTP/2 Disabled",
                "sensitive" : false
              },
              "Connection Timeout" : {
                "displayName" : "Connection Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Connection Timeout",
                "sensitive" : false
              },
              "Response Cookie Strategy" : {
                "displayName" : "Response Cookie Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Cookie Strategy",
                "sensitive" : false
              },
              "Request Password" : {
                "displayName" : "Request Password",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Password",
                "sensitive" : true
              },
              "Socket Read Timeout" : {
                "displayName" : "Socket Read Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Socket Read Timeout",
                "sensitive" : false
              },
              "Socket Idle Connections" : {
                "displayName" : "Socket Idle Connections",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Socket Idle Connections",
                "sensitive" : false
              },
              "Request Body Enabled" : {
                "displayName" : "Request Body Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Body Enabled",
                "sensitive" : false
              },
              "OAuth2 Access Token Refresh Strategy" : {
                "displayName" : "OAuth2 Access Token Refresh Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "OAuth2 Access Token Refresh Strategy",
                "sensitive" : false
              },
              "HTTP URL" : {
                "displayName" : "HTTP URL",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "HTTP URL",
                "sensitive" : false
              },
              "Request OAuth2 Access Token Provider" : {
                "displayName" : "Request OAuth2 Access Token Provider",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "Request OAuth2 Access Token Provider",
                "sensitive" : false
              },
              "Socket Idle Timeout" : {
                "displayName" : "Socket Idle Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Socket Idle Timeout",
                "sensitive" : false
              },
              "Response Redirects Enabled" : {
                "displayName" : "Response Redirects Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Redirects Enabled",
                "sensitive" : false
              },
              "Socket Write Timeout" : {
                "displayName" : "Socket Write Timeout",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Socket Write Timeout",
                "sensitive" : false
              },
              "Request Header Attributes Pattern" : {
                "displayName" : "Request Header Attributes Pattern",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Header Attributes Pattern",
                "sensitive" : false
              },
              "Response FlowFile Naming Strategy" : {
                "displayName" : "Response FlowFile Naming Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response FlowFile Naming Strategy",
                "sensitive" : false
              },
              "Response Cache Enabled" : {
                "displayName" : "Response Cache Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Cache Enabled",
                "sensitive" : false
              },
              "Request Date Header Enabled" : {
                "displayName" : "Request Date Header Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Date Header Enabled",
                "sensitive" : false
              },
              "Request Failure Penalization Enabled" : {
                "displayName" : "Request Failure Penalization Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Failure Penalization Enabled",
                "sensitive" : false
              },
              "Response Body Attribute Size" : {
                "displayName" : "Response Body Attribute Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Body Attribute Size",
                "sensitive" : false
              },
              "SSL Context Service" : {
                "displayName" : "SSL Context Service",
                "dynamic" : false,
                "identifiesControllerService" : true,
                "name" : "SSL Context Service",
                "sensitive" : false
              },
              "Response Generation Required" : {
                "displayName" : "Response Generation Required",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Generation Required",
                "sensitive" : false
              },
              "Request User-Agent" : {
                "displayName" : "Request User-Agent",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request User-Agent",
                "sensitive" : false
              },
              "Response Header Request Attributes Enabled" : {
                "displayName" : "Response Header Request Attributes Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Header Request Attributes Enabled",
                "sensitive" : false
              },
              "HTTP Method" : {
                "displayName" : "HTTP Method",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "HTTP Method",
                "sensitive" : false
              },
              "Request Username" : {
                "displayName" : "Request Username",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Username",
                "sensitive" : false
              },
              "Request Content-Type" : {
                "displayName" : "Request Content-Type",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Content-Type",
                "sensitive" : false
              },
              "Response Body Attribute Name" : {
                "displayName" : "Response Body Attribute Name",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Body Attribute Name",
                "sensitive" : false
              },
              "Request Digest Authentication Enabled" : {
                "displayName" : "Request Digest Authentication Enabled",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Digest Authentication Enabled",
                "sensitive" : false
              },
              "Request Multipart Form-Data Name" : {
                "displayName" : "Request Multipart Form-Data Name",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Request Multipart Form-Data Name",
                "sensitive" : false
              },
              "Response Cache Size" : {
                "displayName" : "Response Cache Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Cache Size",
                "sensitive" : false
              },
              "Response Body Ignored" : {
                "displayName" : "Response Body Ignored",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Response Body Ignored",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 0,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-update-attribute-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
            "identifier" : "2af51748-8e79-34b5-82bf-dce6b1e26d49",
            "maxBackoffPeriod" : "10 mins",
            "name" : "LaythongtinTelegramCauHinh",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : -656.0,
              "y" : -280.0
            },
            "properties" : {
              "telegram.botToken" : "#{BotToken}",
              "Store State" : "Do not store state",
              "canonical-value-lookup-cache-size" : "100",
              "telegram.chatId" : "#{ChatId}",
              "telegram.enabled" : "#{Enabled}",
              "telegram.text" : " MESSAGE ALERT\n Application: NIFI\n Flow: ${state.name}\n Message: ${state.message}"
            },
            "propertyDescriptors" : {
              "telegram.botToken" : {
                "displayName" : "telegram.botToken",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "telegram.botToken",
                "sensitive" : false
              },
              "Delete Attributes Expression" : {
                "displayName" : "Delete Attributes Expression",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Delete Attributes Expression",
                "sensitive" : false
              },
              "Store State" : {
                "displayName" : "Store State",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Store State",
                "sensitive" : false
              },
              "canonical-value-lookup-cache-size" : {
                "displayName" : "Cache Value Lookup Cache Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "canonical-value-lookup-cache-size",
                "sensitive" : false
              },
              "telegram.chatId" : {
                "displayName" : "telegram.chatId",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "telegram.chatId",
                "sensitive" : false
              },
              "Stateful Variables Initial Value" : {
                "displayName" : "Stateful Variables Initial Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Stateful Variables Initial Value",
                "sensitive" : false
              },
              "telegram.enabled" : {
                "displayName" : "telegram.enabled",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "telegram.enabled",
                "sensitive" : false
              },
              "telegram.text" : {
                "displayName" : "telegram.text",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "telegram.text",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ "unmatched" ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
            "identifier" : "ed18ac74-2a5e-33e6-88dd-10f471b2ce3e",
            "maxBackoffPeriod" : "10 mins",
            "name" : "RouteOnAttribute",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : -184.0,
              "y" : -288.0
            },
            "properties" : {
              "Routing Strategy" : "Route to Property name",
              "send" : "${telegram.enabled:equals('true')}"
            },
            "propertyDescriptors" : {
              "Routing Strategy" : {
                "displayName" : "Routing Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Routing Strategy",
                "sensitive" : false
              },
              "send" : {
                "displayName" : "send",
                "dynamic" : true,
                "identifiesControllerService" : false,
                "name" : "send",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
            "yieldDuration" : "1 sec"
          }, {
            "autoTerminatedRelationships" : [ ],
            "backoffMechanism" : "PENALIZE_FLOWFILE",
            "bulletinLevel" : "WARN",
            "bundle" : {
              "artifact" : "nifi-standard-nar",
              "group" : "org.apache.nifi",
              "version" : "2.4.0"
            },
            "comments" : "",
            "componentType" : "PROCESSOR",
            "concurrentlySchedulableTaskCount" : 1,
            "executionNode" : "ALL",
            "groupIdentifier" : "b7e7e16e-858c-382e-9205-b2c4c5f9acdd",
            "identifier" : "731071a0-74b9-301f-b24c-237b1463d957",
            "maxBackoffPeriod" : "10 mins",
            "name" : "ReplaceText",
            "penaltyDuration" : "30 sec",
            "position" : {
              "x" : 200.0,
              "y" : -288.0
            },
            "properties" : {
              "Regular Expression" : "(?s)^(.*)$",
              "Replacement Value" : "{\"chat_id\":\"#{ChatId}\",\"text\":\"${telegram.text}\"}",
              "Evaluation Mode" : "Entire text",
              "Line-by-Line Evaluation Mode" : "All",
              "Character Set" : "UTF-8",
              "Maximum Buffer Size" : "1 MB",
              "Replacement Strategy" : "Regex Replace"
            },
            "propertyDescriptors" : {
              "Regular Expression" : {
                "displayName" : "Search Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Regular Expression",
                "sensitive" : false
              },
              "Replacement Value" : {
                "displayName" : "Replacement Value",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Replacement Value",
                "sensitive" : false
              },
              "Evaluation Mode" : {
                "displayName" : "Evaluation Mode",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Evaluation Mode",
                "sensitive" : false
              },
              "Text to Prepend" : {
                "displayName" : "Text to Prepend",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Text to Prepend",
                "sensitive" : false
              },
              "Line-by-Line Evaluation Mode" : {
                "displayName" : "Line-by-Line Evaluation Mode",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Line-by-Line Evaluation Mode",
                "sensitive" : false
              },
              "Character Set" : {
                "displayName" : "Character Set",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Character Set",
                "sensitive" : false
              },
              "Maximum Buffer Size" : {
                "displayName" : "Maximum Buffer Size",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Maximum Buffer Size",
                "sensitive" : false
              },
              "Replacement Strategy" : {
                "displayName" : "Replacement Strategy",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Replacement Strategy",
                "sensitive" : false
              },
              "Text to Append" : {
                "displayName" : "Text to Append",
                "dynamic" : false,
                "identifiesControllerService" : false,
                "name" : "Text to Append",
                "sensitive" : false
              }
            },
            "retriedRelationships" : [ ],
            "retryCount" : 10,
            "runDurationMillis" : 25,
            "scheduledState" : "ENABLED",
            "schedulingPeriod" : "0 sec",
            "schedulingStrategy" : "TIMER_DRIVEN",
            "style" : { },
            "type" : "org.apache.nifi.processors.standard.ReplaceText",
            "yieldDuration" : "1 sec"
          } ],
          "remoteProcessGroups" : [ ],
          "scheduledState" : "ENABLED",
          "statelessFlowTimeout" : "1 min"
        } ],
        "processors" : [ {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
          "identifier" : "a281e7f9-4217-3371-aeb9-5e2d46bab878",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ChuanHoa",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 16.0,
            "y" : -224.0
          },
          "properties" : {
            "state.message" : "Ly trng thi Bc ${stateBc.name} li",
            "filename" : "${stateBc.filename}",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100",
            "stateBc.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}",
            "stateBc.isActive" : "false",
            "stateBc.message" : "Ly trng thi Bc ${stateBc.name} li",
            "stateBc.status" : "3"
          },
          "propertyDescriptors" : {
            "state.message" : {
              "displayName" : "state.message",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.message",
              "sensitive" : false
            },
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "filename" : {
              "displayName" : "filename",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "filename",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "stateBc.lastExecutionTime" : {
              "displayName" : "stateBc.lastExecutionTime",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateBc.lastExecutionTime",
              "sensitive" : false
            },
            "stateBc.isActive" : {
              "displayName" : "stateBc.isActive",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateBc.isActive",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            },
            "stateBc.message" : {
              "displayName" : "stateBc.message",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateBc.message",
              "sensitive" : false
            },
            "stateBc.status" : {
              "displayName" : "stateBc.status",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateBc.status",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
          "identifier" : "a891d12e-2f0c-36a9-be6b-4fea1d0029cc",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LuuFile",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 944.0,
            "y" : -232.0
          },
          "properties" : {
            "Create Missing Directories" : "true",
            "Directory" : "${stateBc.path}",
            "Conflict Resolution Strategy" : "replace"
          },
          "propertyDescriptors" : {
            "Group" : {
              "displayName" : "Group",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Group",
              "sensitive" : false
            },
            "Owner" : {
              "displayName" : "Owner",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Owner",
              "sensitive" : false
            },
            "Create Missing Directories" : {
              "displayName" : "Create Missing Directories",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Create Missing Directories",
              "sensitive" : false
            },
            "Permissions" : {
              "displayName" : "Permissions",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Permissions",
              "sensitive" : false
            },
            "Maximum File Count" : {
              "displayName" : "Maximum File Count",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum File Count",
              "sensitive" : false
            },
            "Last Modified Time" : {
              "displayName" : "Last Modified Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Last Modified Time",
              "sensitive" : false
            },
            "Directory" : {
              "displayName" : "Directory",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory",
              "sensitive" : false
            },
            "Conflict Resolution Strategy" : {
              "displayName" : "Conflict Resolution Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Conflict Resolution Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.PutFile",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
          "identifier" : "1f8a6ce4-9361-39af-b9d8-397d245c8b33",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CapNhatToContent",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 424.0,
            "y" : -232.0
          },
          "properties" : {
            "Regular Expression" : "(?s)(^.*$)",
            "Replacement Value" : "{\n  \"name\": \"${stateBc.name}\",\n  \"isActive\": ${stateBc.isActive},\n  \"lastExecutionTime\": \"${stateBc.lastExecutionTime}\",\n  \"startTime\": \"${stateBc.startTime}\",\n  \"endTime\": \"${stateBc.endTime}\",\n  \"status\": \"${stateBc.status}\",\n  \"sequenceNumber\": \"${stateBc.sequenceNumber}\",\n  \"message\": \"${stateBc.message}\"\n}",
            "Evaluation Mode" : "Entire text",
            "Line-by-Line Evaluation Mode" : "All",
            "Character Set" : "UTF-8",
            "Maximum Buffer Size" : "1 MB",
            "Replacement Strategy" : "Always Replace"
          },
          "propertyDescriptors" : {
            "Regular Expression" : {
              "displayName" : "Search Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Regular Expression",
              "sensitive" : false
            },
            "Replacement Value" : {
              "displayName" : "Replacement Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Value",
              "sensitive" : false
            },
            "Evaluation Mode" : {
              "displayName" : "Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Evaluation Mode",
              "sensitive" : false
            },
            "Text to Prepend" : {
              "displayName" : "Text to Prepend",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Prepend",
              "sensitive" : false
            },
            "Line-by-Line Evaluation Mode" : {
              "displayName" : "Line-by-Line Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Line-by-Line Evaluation Mode",
              "sensitive" : false
            },
            "Character Set" : {
              "displayName" : "Character Set",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Character Set",
              "sensitive" : false
            },
            "Maximum Buffer Size" : {
              "displayName" : "Maximum Buffer Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum Buffer Size",
              "sensitive" : false
            },
            "Replacement Strategy" : {
              "displayName" : "Replacement Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Strategy",
              "sensitive" : false
            },
            "Text to Append" : {
              "displayName" : "Text to Append",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Append",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ReplaceText",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "success" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "3f8fbe9c-202e-3912-8536-7148cb0661d3",
          "identifier" : "2935e420-ec84-3c7d-a31b-2d2246d8edb4",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LogMessage",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 616.0,
            "y" : 64.0
          },
          "properties" : {
            "log-level" : "info"
          },
          "propertyDescriptors" : {
            "log-message" : {
              "displayName" : "Log message",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-message",
              "sensitive" : false
            },
            "log-level" : {
              "displayName" : "Log Level",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-level",
              "sensitive" : false
            },
            "log-prefix" : {
              "displayName" : "Log prefix",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-prefix",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ "success" ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.LogMessage",
          "yieldDuration" : "1 sec"
        } ],
        "remoteProcessGroups" : [ ],
        "scheduledState" : "ENABLED",
        "statelessFlowTimeout" : "1 min"
      } ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "2aae8068-598e-3d94-96ed-3947cb037938",
        "identifier" : "26b627a4-3ab2-3429-8f95-a2852133a1c2",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KhoiTaoBc",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : -98.10848017609499,
          "y" : -206.47323369608057
        },
        "properties" : {
          "stateBc.path" : "#{TempPath}${Path.Separator}${state.name}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateBc.name" : "${stateBc.id}",
          "stateBc.filename" : "state_${stateBc.id}.json"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "stateBc.path" : {
            "displayName" : "stateBc.path",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateBc.path",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateBc.name" : {
            "displayName" : "stateBc.name",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateBc.name",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "stateBc.filename" : {
            "displayName" : "stateBc.filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateBc.filename",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-scripting-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "2aae8068-598e-3d94-96ed-3947cb037938",
        "identifier" : "c241f3b6-71ac-373b-a854-d2ecfabbc001",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LayTrangThai",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : -208.0
        },
        "properties" : {
          "Script Engine" : "Groovy",
          "Script Body" : "// Ly trng thi ca BC hin ti\nimport groovy.json.JsonSlurper\nimport groovy.json.JsonBuilder\nimport java.nio.file.*\nimport java.time.Instant\nimport java.time.ZoneOffset\nimport java.time.format.DateTimeFormatter\nimport java.time.LocalDateTime\nimport java.time.LocalDate\nimport org.apache.nifi.processor.io.OutputStreamCallback\n\ndef flowFile = session.get()\nif (!flowFile) return\n\n// --- Helpers ---\nboolean isIntSafe(def v) {\n    if (v == null) return false\n    try { Integer.parseInt(v.toString()); return true } catch (ignored) { return false }\n}\n\n// Ly parameters t attributes (stateBc.*)\ndef etlName   = flowFile.getAttribute('stateBc.name')\ndef statePath = flowFile.getAttribute('stateBc.path')\ndef filename  = flowFile.getAttribute('stateBc.filename')\n\nif (!etlName || !statePath || !filename) {\n    log.error(\"Missing required attributes: stateBc.name, stateBc.path, or stateBc.filename\")\n    flowFile = session.putAttribute(flowFile, 'error.message', 'Missing stateBc.name, stateBc.path, or stateBc.filename attributes')\n    session.transfer(flowFile, REL_FAILURE)\n    return\n}\n\n// To ng dn y \ndef stateFilePath = Paths.get(statePath, filename).toString()\n\ntry {\n    def stateContent = \"\"\n    def stateExists = false\n\n    // Thi gian UTC & mc nh\n    def formatter = DateTimeFormatter.ofPattern(\"yyyy/MM/dd HH:mm:ss\")\n    def currentTimeUTC = Instant.now().atZone(ZoneOffset.UTC).format(formatter)\n    def defaultStartTime = \"2025/01/01 00:00:00\"\n\n    // State mc nh\n    def defaultState = [\n        name: etlName,\n        isActive: false,\n        lastExecutionTime: currentTimeUTC,\n        startTime: defaultStartTime,\n        endTime: currentTimeUTC,\n        sequenceNumber: 1, // ln chy u tin\n        status: 0,         // 0: khi to\n        message: \"\"        // trng\n    ]\n\n    // c file nu c\n    def path = Paths.get(stateFilePath)\n    if (Files.exists(path)) {\n        stateContent = new String(Files.readAllBytes(path), \"UTF-8\")\n        stateExists = true\n        log.info(\"stateBc file found for ETL '${etlName}' at '${stateFilePath}': ${stateContent}\")\n    } else {\n        stateContent = new JsonBuilder(defaultState).toString()\n        stateExists = false\n        log.info(\"stateBc file not found for ETL '${etlName}' at '${stateFilePath}', creating default content\")\n    }\n\n    // Parse JSON (fallback default nu li)\n    def jsonSlurper = new JsonSlurper()\n    Map state\n    try {\n        state = (Map) jsonSlurper.parseText(stateContent)\n    } catch (Throwable ex) {\n        log.warn(\"Invalid stateBc content, fallback to default. Error: ${ex.message}\")\n        state = new LinkedHashMap(defaultState)\n        stateExists = false\n    }\n\n    // Chun ho trng\n    state.name = etlName\n    state.isActive = (state.containsKey('isActive') && state.isActive != null) ? state.isActive as Boolean : false\n    state.lastExecutionTime = (state.lastExecutionTime ?: currentTimeUTC)\n    state.startTime = (state.startTime ?: defaultStartTime)\n    state.endTime = (state.endTime ?: currentTimeUTC)\n\n    // Gi tr hin hu  dng cho logic ca s mi\n    def oldEndTime = (state.endTime && state.endTime.toString().trim()) ? state.endTime.toString() : defaultStartTime\n\n    // sequenceNumber / status / message\n    Integer seq = 1\n    if (state.containsKey('sequenceNumber') && isIntSafe(state.sequenceNumber)) {\n        seq = (state.sequenceNumber as Integer)\n        if (seq <= 0) seq = 1\n    }\n    Integer prevStatus = 0\n    if (state.containsKey('status') && isIntSafe(state.status)) {\n        prevStatus = (state.status as Integer)\n    }\n    String msg = (state.containsKey('message') && state.message != null) ? (state.message as String) : \"\"\n\n    // --- LOGIC MI: to ca s ETL mi nu status = 0 hoc 2 ---\n    // Gii thch:\n    //  - 0 (khi to) hoc 2 (hon thnh) => ln ETL trc  kt thc bnh thng.\n    //  - startTime = endTime (c) vi gi pht giy 00:00:00 ; endTime = currentTimeUTC ; lastExecutionTime = endTime (c)\n    boolean shouldCreateNewWindow = stateExists && (prevStatus == 0 || prevStatus == 2)\n    if (shouldCreateNewWindow) {\n        // Parse oldEndTime v t li gi pht giy thnh 00:00:00\n        def newStartTime = oldEndTime\n        try {\n            def oldEndTimeParsed = LocalDateTime.parse(oldEndTime, formatter)\n            def dateOnly = oldEndTimeParsed.toLocalDate()\n            def startOfDay = dateOnly.atStartOfDay()\n            newStartTime = startOfDay.format(formatter)\n            log.info(\"stateBc: Parsed oldEndTime '${oldEndTime}' to start of day: '${newStartTime}'\")\n        } catch (Exception ex) {\n            log.warn(\"stateBc: Could not parse oldEndTime '${oldEndTime}', using as-is. Error: ${ex.message}\")\n            newStartTime = oldEndTime\n        }\n        \n        state.startTime = newStartTime\n        state.endTime = currentTimeUTC\n        log.info(\"stateBc: Create new ETL window: startTime=${state.startTime} (reset to 00:00:00), endTime=${state.endTime}, lastExecutionTime=${state.lastExecutionTime}\")\n    }\n\n    // Logic khi c t file c sn:\n    // - t status = 0\n    // - nu status c == 2 => tng sequenceNumber\n    // - message = \"\"\n    if (stateExists) {\n        if (prevStatus == 2) {\n            seq = seq + 1\n            log.info(\"stateBc: Previous status=2 (completed). Increase sequenceNumber to ${seq}\")\n        }\n        prevStatus = 0\n        msg = \"\"\n    } else {\n        // state mi\n        prevStatus = 0\n        msg = \"\"\n        seq = 1\n    }\n\n    // Gn li vo state\n    state.sequenceNumber = seq\n    state.status = prevStatus\n    state.message = msg\n\n    // Ghi attributes ra flowfile (prefix stateBc.*)\n    flowFile = session.putAttribute(flowFile, 'stateBc.exists', stateExists.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.name', state.name.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.isActive', state.isActive.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.lastExecutionTime', state.lastExecutionTime.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.startTime', state.startTime.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.endTime', state.endTime.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.sequenceNumber', state.sequenceNumber.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.status', state.status.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.message', state.message.toString())\n    flowFile = session.putAttribute(flowFile, 'stateBc.fullPath', stateFilePath)\n\n    // JSON content chun ho\n    def stateContentForFlowFile = [\n        name: state.name,\n        isActive: state.isActive,\n        lastExecutionTime: state.lastExecutionTime,\n        startTime: state.startTime,\n        endTime: state.endTime,\n        sequenceNumber: state.sequenceNumber,\n        status: state.status,\n        message: state.message\n    ]\n\n    // Ghi JSON stateBc vo flowFile content\n    def contentJson = new JsonBuilder(stateContentForFlowFile).toString()\n    flowFile = session.write(flowFile, { outputStream ->\n        outputStream.write(contentJson.getBytes(\"UTF-8\"))\n    } as OutputStreamCallback)\n\n    // Lu li JSON vo attribute\n    flowFile = session.putAttribute(flowFile, 'stateBc.content', contentJson)\n\n    session.transfer(flowFile, REL_SUCCESS)\n\n} catch (Exception e) {\n    log.error(\"Error reading stateBc file for ETL '${etlName}' at '${stateFilePath}': ${e.message}\", e)\n    flowFile = session.putAttribute(flowFile, 'error.message', e.getMessage())\n    session.transfer(flowFile, REL_FAILURE)\n}"
        },
        "propertyDescriptors" : {
          "Script File" : {
            "displayName" : "Script File",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script File",
            "resourceDefinition" : {
              "cardinality" : "SINGLE",
              "resourceTypes" : [ "FILE" ]
            },
            "sensitive" : false
          },
          "Script Engine" : {
            "displayName" : "Script Engine",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script Engine",
            "sensitive" : false
          },
          "Script Body" : {
            "displayName" : "Script Body",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Script Body",
            "sensitive" : false
          },
          "Module Directory" : {
            "displayName" : "Module Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Module Directory",
            "resourceDefinition" : {
              "cardinality" : "MULTIPLE",
              "resourceTypes" : [ "FILE", "DIRECTORY" ]
            },
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.script.ExecuteScript",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "id" : "04cfa562-6a40-3890-b50e-4b62d7bd9b6b",
          "name" : "Input",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
        "identifier" : "56694502-d846-3f64-a926-f8f0d16b8472",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
          "id" : "9175f17c-2ea9-3dbb-ae8a-a26c104e3627",
          "name" : "TrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "zIndex" : 7
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
          "id" : "a9bf6940-48b4-3266-9ad2-eb322d7ed40e",
          "name" : "KiemTraCoTrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
        "identifier" : "d236fbd7-828f-3e62-819f-28751d9ffcd3",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "id" : "f30c2590-c118-3caa-95fa-b7fba6473a21",
          "name" : "Ouput",
          "type" : "OUTPUT_PORT"
        },
        "zIndex" : 3
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
          "id" : "decc5801-0f29-3c7d-aaa1-f97a98f83520",
          "name" : "Output",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
        "identifier" : "a46cc7c2-b7ba-3799-b66b-9af4d63ede47",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "unmatched" ],
        "source" : {
          "comments" : "",
          "groupId" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
          "id" : "a9bf6940-48b4-3266-9ad2-eb322d7ed40e",
          "name" : "KiemTraCoTrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "zIndex" : 10
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
          "id" : "ca9ce68e-3640-3bec-80f0-5f6fcfad19b0",
          "name" : "KhoiTao",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
        "identifier" : "574f3ffa-a5c3-3e41-b8e7-507b12f714c3",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
          "id" : "87ea46eb-f99b-32b8-9dbd-3f9056c74995",
          "name" : "Input",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 11
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
          "id" : "9175f17c-2ea9-3dbb-ae8a-a26c104e3627",
          "name" : "TrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
        "identifier" : "e2acdf65-473a-344e-9e84-fbcc8a20dafc",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "TrangTiep",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "nextPage" ],
        "source" : {
          "comments" : "",
          "groupId" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
          "id" : "a9bf6940-48b4-3266-9ad2-eb322d7ed40e",
          "name" : "KiemTraCoTrangTiepTheo",
          "type" : "PROCESSOR"
        },
        "zIndex" : 6
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "id" : "04cfa562-6a40-3890-b50e-4b62d7bd9b6b",
          "name" : "Input",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
        "identifier" : "648299bd-c195-34f8-9240-504eec8cf42a",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
          "id" : "ca9ce68e-3640-3bec-80f0-5f6fcfad19b0",
          "name" : "KhoiTao",
          "type" : "PROCESSOR"
        },
        "zIndex" : 2
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
        "identifier" : "87ea46eb-f99b-32b8-9dbd-3f9056c74995",
        "name" : "Input",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -344.0,
          "y" : -256.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "ETLBcBalanceBatch",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
        "identifier" : "decc5801-0f29-3c7d-aaa1-f97a98f83520",
        "name" : "Output",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 72.0,
          "y" : 856.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -248.0,
        "y" : 2880.0
      },
      "processGroups" : [ {
        "comments" : "",
        "componentType" : "PROCESS_GROUP",
        "connections" : [ {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "7ab2eb92-360e-3f40-8d25-959a9f0a95de",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "a92c2e45-5f5b-3929-b868-dd08effd53f1",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "4658f787-7656-36af-b9f7-04a79b92af18",
            "name" : "LayDanhSachBcBalanceChuaETL",
            "type" : "PROCESSOR"
          },
          "zIndex" : 4
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "e9392fc2-2c2b-3c94-a07d-8216e0ce9fc7",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "e8715b88-b5f1-3e8c-98ed-f4fae1157378",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "870ca5a0-63cd-3d07-9563-d14d3a19c4ae",
            "name" : "TransformData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 22
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "e9392fc2-2c2b-3c94-a07d-8216e0ce9fc7",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "00665b17-e9ff-3db6-91f7-4c1667e45317",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "e580d5a5-6063-3a1e-80fd-3c1a1a40a8b2",
            "name" : "InsertAndUpdateToDataBase",
            "type" : "PROCESSOR"
          },
          "zIndex" : 25
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "7ab2eb92-360e-3f40-8d25-959a9f0a95de",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "9977bff9-93ab-377c-823a-77941455cc3b",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "2e84508b-4489-347e-aa36-38bd2cb0895b",
            "name" : "ChuanHoaDuLieuRaw",
            "type" : "PROCESSOR"
          },
          "zIndex" : 9
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "abdb5430-5d9d-329b-b074-55e3e1b7cf4d",
            "name" : "KhoiTao",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "4022e1a8-27f5-330c-8a36-050a47131f7d",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "04cfa562-6a40-3890-b50e-4b62d7bd9b6b",
            "name" : "Input",
            "type" : "INPUT_PORT"
          },
          "zIndex" : 1
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "e9392fc2-2c2b-3c94-a07d-8216e0ce9fc7",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "ffe69f0e-79dd-32e4-a9dc-63cd28a33e77",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "isLastPage" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "272e0502-ebb8-3425-aa3c-a2632acd6ae4",
            "name" : "RouteOnAttributeCheckLastPage",
            "type" : "PROCESSOR"
          },
          "zIndex" : 26
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "7ab2eb92-360e-3f40-8d25-959a9f0a95de",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "e2faeddf-d6ec-3287-8ab5-8408a57f1375",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success", "failure", "not found" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "e9392fc2-2c2b-3c94-a07d-8216e0ce9fc7",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "zIndex" : 28
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "73ac406e-da70-326e-ac38-df9b25ef0abc",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "513ac7fc-8451-36a9-b391-61cebf10be88",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "4658f787-7656-36af-b9f7-04a79b92af18",
            "name" : "LayDanhSachBcBalanceChuaETL",
            "type" : "PROCESSOR"
          },
          "zIndex" : 3
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "f4503a9f-3f83-3a70-9f7b-060bd3a4902a",
            "name" : "CheckHasData",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "c43b124d-8c12-3099-9ef7-e4ba6a94177c",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "2e84508b-4489-347e-aa36-38bd2cb0895b",
            "name" : "ChuanHoaDuLieuRaw",
            "type" : "PROCESSOR"
          },
          "zIndex" : 8
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "4658f787-7656-36af-b9f7-04a79b92af18",
            "name" : "LayDanhSachBcBalanceChuaETL",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "ae7f6db7-618d-3c98-96ec-d81c15330d3f",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "abdb5430-5d9d-329b-b074-55e3e1b7cf4d",
            "name" : "KhoiTao",
            "type" : "PROCESSOR"
          },
          "zIndex" : 2
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "7ab2eb92-360e-3f40-8d25-959a9f0a95de",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "12bf0559-9ba6-324d-868f-e4af019a1450",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "NoNewData",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "unmatched" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "f4503a9f-3f83-3a70-9f7b-060bd3a4902a",
            "name" : "CheckHasData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 10
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "2e84508b-4489-347e-aa36-38bd2cb0895b",
            "name" : "ChuanHoaDuLieuRaw",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "ec0a6466-1169-317b-8c61-2e947b68fe17",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "73ac406e-da70-326e-ac38-df9b25ef0abc",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "zIndex" : 5
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "e12097b4-8b94-30a5-80d3-8a520558c2e7",
            "name" : "LayDanhSachDuLieuETLCu",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "4f34f2e8-08f9-3e54-ac0e-4d1194b4f27e",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "2e40d03a-8023-3821-bfde-6ae35cd0d057",
            "name" : "SaveRawTemp",
            "type" : "PROCESSOR"
          },
          "zIndex" : 29
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "cb6f752d-4812-3e4e-a6d5-ba4788ba09dc",
            "name" : "UpdateAttributeContinueTrue",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "453e11b5-a3b0-363e-b3ed-040e1d521a65",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "unmatched" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "272e0502-ebb8-3425-aa3c-a2632acd6ae4",
            "name" : "RouteOnAttributeCheckLastPage",
            "type" : "PROCESSOR"
          },
          "zIndex" : 27
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "f30c2590-c118-3caa-95fa-b7fba6473a21",
            "name" : "Ouput",
            "type" : "OUTPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "de86d85d-20e8-3674-83a2-85948229f503",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success", "failure", "not found" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "4b9d236e-3f7f-3537-82cd-67e2f1da8fe0",
            "name" : "CleanupTemp",
            "type" : "PROCESSOR"
          },
          "zIndex" : 15
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "4b9d236e-3f7f-3537-82cd-67e2f1da8fe0",
            "name" : "CleanupTemp",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "579b39ed-9a8b-3040-beae-6a38c6138dae",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "cb6f752d-4812-3e4e-a6d5-ba4788ba09dc",
            "name" : "UpdateAttributeContinueTrue",
            "type" : "PROCESSOR"
          },
          "zIndex" : 24
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "7ab2eb92-360e-3f40-8d25-959a9f0a95de",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "03a83755-f2a7-39be-b9b1-bb6d8e5b7c8b",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "73ac406e-da70-326e-ac38-df9b25ef0abc",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "zIndex" : 6
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "e580d5a5-6063-3a1e-80fd-3c1a1a40a8b2",
            "name" : "InsertAndUpdateToDataBase",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "cbe5afb6-0beb-3cdd-9149-7c87b0d93862",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "870ca5a0-63cd-3d07-9563-d14d3a19c4ae",
            "name" : "TransformData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 21
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "f30c2590-c118-3caa-95fa-b7fba6473a21",
            "name" : "Ouput",
            "type" : "OUTPUT_PORT"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "5453878f-0862-3da5-a508-123874e73b9c",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "7ab2eb92-360e-3f40-8d25-959a9f0a95de",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "zIndex" : 7
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "870ca5a0-63cd-3d07-9563-d14d3a19c4ae",
            "name" : "TransformData",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "f089fec0-1845-30e6-9eca-cd3b98617b6a",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "efa3c0b2-4f63-35c9-bbf4-ddcf2179bf66",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "zIndex" : 20
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "e9392fc2-2c2b-3c94-a07d-8216e0ce9fc7",
            "name" : "CleanupTempFile",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "6da7a5c7-ca7f-382a-95cf-daee6ee5bf6e",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "e12097b4-8b94-30a5-80d3-8a520558c2e7",
            "name" : "LayDanhSachDuLieuETLCu",
            "type" : "PROCESSOR"
          },
          "zIndex" : 19
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "efa3c0b2-4f63-35c9-bbf4-ddcf2179bf66",
            "name" : "ConvertRecord",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "2efbb749-d751-3277-93fd-3626ed76e4aa",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "e12097b4-8b94-30a5-80d3-8a520558c2e7",
            "name" : "LayDanhSachDuLieuETLCu",
            "type" : "PROCESSOR"
          },
          "zIndex" : 18
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "272e0502-ebb8-3425-aa3c-a2632acd6ae4",
            "name" : "RouteOnAttributeCheckLastPage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "41f190aa-df0f-3fc5-8d45-f47f6ddb052f",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "e580d5a5-6063-3a1e-80fd-3c1a1a40a8b2",
            "name" : "InsertAndUpdateToDataBase",
            "type" : "PROCESSOR"
          },
          "zIndex" : 23
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "2e40d03a-8023-3821-bfde-6ae35cd0d057",
            "name" : "SaveRawTemp",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "a6a018eb-468f-3760-b597-2d163df83245",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "hasData" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "f4503a9f-3f83-3a70-9f7b-060bd3a4902a",
            "name" : "CheckHasData",
            "type" : "PROCESSOR"
          },
          "zIndex" : 17
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "7ab2eb92-360e-3f40-8d25-959a9f0a95de",
            "name" : "UpdateAttributeContinueFalse",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "d945f910-5a07-367e-bb75-da6906a34016",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
            "id" : "2e40d03a-8023-3821-bfde-6ae35cd0d057",
            "name" : "SaveRawTemp",
            "type" : "PROCESSOR"
          },
          "zIndex" : 14
        } ],
        "controllerServices" : [ ],
        "defaultBackPressureDataSizeThreshold" : "1 GB",
        "defaultBackPressureObjectThreshold" : 10000,
        "defaultFlowFileExpiration" : "0 sec",
        "executionEngine" : "INHERITED",
        "flowFileConcurrency" : "UNBOUNDED",
        "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
        "funnels" : [ ],
        "groupIdentifier" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
        "identifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
        "inputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "INPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "04cfa562-6a40-3890-b50e-4b62d7bd9b6b",
          "name" : "Input",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : -136.0,
            "y" : -200.0
          },
          "scheduledState" : "ENABLED",
          "type" : "INPUT_PORT"
        } ],
        "labels" : [ ],
        "maxConcurrentTasks" : 1,
        "name" : "ETLBcBalanceBatch",
        "outputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "OUTPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "f30c2590-c118-3caa-95fa-b7fba6473a21",
          "name" : "Ouput",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : 472.0,
            "y" : 1008.0
          },
          "scheduledState" : "ENABLED",
          "type" : "OUTPUT_PORT"
        } ],
        "parameterContextName" : "TikTokETL",
        "position" : {
          "x" : 8.0,
          "y" : 184.0
        },
        "processGroups" : [ ],
        "processors" : [ {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "e9392fc2-2c2b-3c94-a07d-8216e0ce9fc7",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CleanupTempFile",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1392.0,
            "y" : 432.0
          },
          "properties" : {
            "Filename" : "${stateCurrent.filename}",
            "Directory Path" : "${stateCurrent.directory}"
          },
          "propertyDescriptors" : {
            "Filename" : {
              "displayName" : "Filename",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Filename",
              "sensitive" : false
            },
            "Directory Path" : {
              "displayName" : "Directory Path",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory Path",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.DeleteFile",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "4b9d236e-3f7f-3537-82cd-67e2f1da8fe0",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CleanupTemp",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 992.0,
            "y" : 952.0
          },
          "properties" : {
            "Filename" : "${stateCurrent.filename}",
            "Directory Path" : "${stateCurrent.directory}"
          },
          "propertyDescriptors" : {
            "Filename" : {
              "displayName" : "Filename",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Filename",
              "sensitive" : false
            },
            "Directory Path" : {
              "displayName" : "Directory Path",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory Path",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.DeleteFile",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "e12097b4-8b94-30a5-80d3-8a520558c2e7",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LayDanhSachDuLieuETLCu",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2744.0,
            "y" : 112.0
          },
          "properties" : {
            "esql-max-rows" : "0",
            "dbf-default-precision" : "10",
            "Max Wait Time" : "0 seconds",
            "SQL Query" : "SELECT\n    f.[Id],    \n    f.[Type],\n    f.[EntityId],\n    f.[DimDateId],\n    f.[DimBusinessCenterId],\n    CONVERT(varchar(27), f.[Date], 126) AS [Date]\nFROM dbo.[Fact_FactBalances] f\nWHERE f.[Type]      = 'BusinessCenter'\n  AND f.[EntityId]  = '${stateBc.id}'\n  AND f.[Date] >= '${stateCurrent.minDate}'\n  AND f.[Date] <= '${stateCurrent.maxDate}'\nORDER BY f.[Date] DESC;",
            "Database Connection Pooling Service" : "f726dee7-cfcd-3a23-94d5-cb27ac10cbdb",
            "esql-auto-commit" : "true",
            "dbf-user-logical-types" : "false",
            "dbf-default-scale" : "0",
            "compression-format" : "NONE",
            "esql-output-batch-size" : "0",
            "esql-fetch-size" : "0",
            "dbf-normalize" : "false",
            "Content Output Strategy" : "EMPTY"
          },
          "propertyDescriptors" : {
            "esql-max-rows" : {
              "displayName" : "Max Rows Per Flow File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-max-rows",
              "sensitive" : false
            },
            "dbf-default-precision" : {
              "displayName" : "Default Decimal Precision",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-precision",
              "sensitive" : false
            },
            "Max Wait Time" : {
              "displayName" : "Max Wait Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Max Wait Time",
              "sensitive" : false
            },
            "SQL Query" : {
              "displayName" : "SQL Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "SQL Query",
              "sensitive" : false
            },
            "Database Connection Pooling Service" : {
              "displayName" : "Database Connection Pooling Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Database Connection Pooling Service",
              "sensitive" : false
            },
            "sql-post-query" : {
              "displayName" : "SQL Post-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-post-query",
              "sensitive" : false
            },
            "esql-auto-commit" : {
              "displayName" : "Set Auto Commit",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-auto-commit",
              "sensitive" : false
            },
            "dbf-user-logical-types" : {
              "displayName" : "Use Avro Logical Types",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-user-logical-types",
              "sensitive" : false
            },
            "dbf-default-scale" : {
              "displayName" : "Default Decimal Scale",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-scale",
              "sensitive" : false
            },
            "sql-pre-query" : {
              "displayName" : "SQL Pre-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-pre-query",
              "sensitive" : false
            },
            "compression-format" : {
              "displayName" : "Compression Format",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "compression-format",
              "sensitive" : false
            },
            "esql-output-batch-size" : {
              "displayName" : "Output Batch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-output-batch-size",
              "sensitive" : false
            },
            "esql-fetch-size" : {
              "displayName" : "Fetch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-fetch-size",
              "sensitive" : false
            },
            "dbf-normalize" : {
              "displayName" : "Normalize Table/Column Names",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-normalize",
              "sensitive" : false
            },
            "Content Output Strategy" : {
              "displayName" : "Content Output Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Content Output Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "73ac406e-da70-326e-ac38-df9b25ef0abc",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ConvertRecord",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1008.0,
            "y" : -208.0
          },
          "properties" : {
            "Include Zero Record FlowFiles" : "true",
            "Record Writer" : "2d17ef4c-c0cc-3b2f-840a-19ea05a3f87a",
            "Record Reader" : "d1900214-a631-39c7-b7fb-00da2780645e"
          },
          "propertyDescriptors" : {
            "Include Zero Record FlowFiles" : {
              "displayName" : "Include Zero Record FlowFiles",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Include Zero Record FlowFiles",
              "sensitive" : false
            },
            "Record Writer" : {
              "displayName" : "Record Writer",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Writer",
              "sensitive" : false
            },
            "Record Reader" : {
              "displayName" : "Record Reader",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Reader",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ConvertRecord",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-groovyx-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "2e84508b-4489-347e-aa36-38bd2cb0895b",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ChuanHoaDuLieuRaw",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1416.0,
            "y" : -192.0
          },
          "properties" : {
            "groovyx-script-body" : "import org.apache.nifi.flowfile.FlowFile\nimport org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport java.time.LocalDate\nimport java.time.LocalDateTime\nimport java.time.format.DateTimeFormatter\nimport java.time.format.DateTimeFormatterBuilder\nimport java.time.temporal.ChronoField\n\ndef flowFile = session.get()\nif (!flowFile) return\n\ndef hasData = false\ndef minDate = ''\ndef maxDate = ''\ndef lastPage = '0' // mc nh\n\n// Helper parse Date linh hot -> LocalDate\ndef parseToLocalDate = { String s ->\n    if (s == null) return null\n    def t = s.trim()\n    // yyyy-MM-dd\n    try { return LocalDate.parse(t, DateTimeFormatter.ISO_LOCAL_DATE) } catch (ignored) {}\n    // yyyy-MM-dd HH:mm:ss[.fraction] hoc ISO vi 'T'\n    def s2 = t.replace('T', 'T').replaceAll('[Zz]$', '')\n    try {\n        def dtf = new DateTimeFormatterBuilder()\n            .appendPattern(\"yyyy-MM-dd['T'][' ']HH:mm:ss\")\n            .optionalStart().appendLiteral('.').optionalEnd()\n            .optionalStart().appendFraction(ChronoField.NANO_OF_SECOND, 1, 9, false).optionalEnd()\n            .toFormatter()\n        return LocalDateTime.parse(t.replace(' ', 'T').replaceAll('[Zz]$', ''), dtf).toLocalDate()\n    } catch (ignored) {}\n    return null\n}\n\n// Ly pageSize t attribute\ndef pageSizeAttr = flowFile.getAttribute(\"state.pageSize\") ?: \"0\"\ndef pageSize = 0\ntry { pageSize = pageSizeAttr.toInteger() } catch (ignored) { pageSize = 0 }\n\nflowFile = session.write(flowFile, { inputStream, outputStream ->\n    def content = inputStream.getText(StandardCharsets.UTF_8.name())\n    // gi nguyn content\n    outputStream.write(content.getBytes(StandardCharsets.UTF_8))\n\n    def json = new JsonSlurper().parseText(content)\n    if (!(json instanceof List)) json = [json]\n\n    hasData = !json.isEmpty()\n\n    if (hasData) {\n        // === TNH MIN/MAX THEO TRNG Date (a v yyyy-MM-dd) ===\n        def dates = json*.Date\n            .findAll { it != null }\n            .collect { parseToLocalDate(it.toString()) }\n            .findAll { it != null }\n\n        if (!dates.isEmpty()) {\n            minDate = dates.min().toString()  // yyyy-MM-dd\n            maxDate = dates.max().toString()  // yyyy-MM-dd\n        }\n\n        // === NH DU TRANG CUI ===\n        if (pageSize > 0 && json.size() < pageSize) lastPage = '1'\n    }\n} as StreamCallback)\n\n// Chun b attributes a ra (ti gin)\ndef attrs = [\n    'hasData' : hasData.toString(),\n    'minDate' : minDate,\n    'maxDate' : maxDate,\n    'lastPage': lastPage\n]\n\n// Gn thm cc thuc tnh stateCurrent.* nu c d liu\nif (hasData) {\n    attrs['stateCurrent.minDate'] = (minDate ?: '')\n    attrs['stateCurrent.maxDate'] = (maxDate ?: '')\n}\n\nflowFile = session.putAllAttributes(flowFile, attrs)\nsession.transfer(flowFile, REL_SUCCESS)",
            "groovyx-failure-strategy" : "rollback"
          },
          "propertyDescriptors" : {
            "groovyx-script-body" : {
              "displayName" : "Script Body",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-body",
              "sensitive" : false
            },
            "groovyx-failure-strategy" : {
              "displayName" : "Failure strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-failure-strategy",
              "sensitive" : false
            },
            "groovyx-additional-classpath" : {
              "displayName" : "Additional classpath",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-additional-classpath",
              "sensitive" : false
            },
            "groovyx-script-file" : {
              "displayName" : "Script File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-file",
              "resourceDefinition" : {
                "cardinality" : "SINGLE",
                "resourceTypes" : [ "FILE" ]
              },
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.groovyx.ExecuteGroovyScript",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "7ab2eb92-360e-3f40-8d25-959a9f0a95de",
          "maxBackoffPeriod" : "10 mins",
          "name" : "UpdateAttributeContinueFalse",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 432.0,
            "y" : 480.0
          },
          "properties" : {
            "state.continue" : "0",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100"
          },
          "propertyDescriptors" : {
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "state.continue" : {
              "displayName" : "state.continue",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.continue",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "4658f787-7656-36af-b9f7-04a79b92af18",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LayDanhSachBcBalanceChuaETL",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 608.0,
            "y" : -208.0
          },
          "properties" : {
            "esql-max-rows" : "0",
            "dbf-default-precision" : "10",
            "Max Wait Time" : "0 seconds",
            "SQL Query" : "SELECT TOP (${state.pageSize})\n       r.[Id],\n       r.[BcId],\n       r.[Date],\n       r.[Currency],\n       r.[Timezone],\n       r.[AccountBalance],\n       r.[ValidAccountBalance],\n       r.[FrozenBalance],\n       r.[Tax],\n       r.[CashBalance],\n       r.[ValidCashBalance],\n       r.[GrantBalance],\n       r.[ValidGrantBalance],\n       r.[CreationTime],\n       r.[CreatorId],\n       r.[LastModificationTime],\n       r.[LastModifierId]\nFROM dbo.[Raw_RawBalanceBusinessCenters] r\nWHERE r.[BcId] = '${stateBc.id}'\n  AND NOT EXISTS (\n      SELECT 1\n      FROM dbo.[Fact_FactBalances] f\n      WHERE f.[Type] = 'BusinessCenter'\n        AND f.[EntityId] = r.[BcId]      \n        AND f.[Date]     = r.[Date]      -- datetime2(7) khp tuyt i\n  )\nORDER BY r.[Date] DESC, r.[Id] DESC;",
            "Database Connection Pooling Service" : "f726dee7-cfcd-3a23-94d5-cb27ac10cbdb",
            "esql-auto-commit" : "true",
            "dbf-user-logical-types" : "false",
            "dbf-default-scale" : "0",
            "compression-format" : "NONE",
            "esql-output-batch-size" : "0",
            "esql-fetch-size" : "0",
            "dbf-normalize" : "false",
            "Content Output Strategy" : "EMPTY"
          },
          "propertyDescriptors" : {
            "esql-max-rows" : {
              "displayName" : "Max Rows Per Flow File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-max-rows",
              "sensitive" : false
            },
            "dbf-default-precision" : {
              "displayName" : "Default Decimal Precision",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-precision",
              "sensitive" : false
            },
            "Max Wait Time" : {
              "displayName" : "Max Wait Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Max Wait Time",
              "sensitive" : false
            },
            "SQL Query" : {
              "displayName" : "SQL Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "SQL Query",
              "sensitive" : false
            },
            "Database Connection Pooling Service" : {
              "displayName" : "Database Connection Pooling Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Database Connection Pooling Service",
              "sensitive" : false
            },
            "sql-post-query" : {
              "displayName" : "SQL Post-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-post-query",
              "sensitive" : false
            },
            "esql-auto-commit" : {
              "displayName" : "Set Auto Commit",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-auto-commit",
              "sensitive" : false
            },
            "dbf-user-logical-types" : {
              "displayName" : "Use Avro Logical Types",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-user-logical-types",
              "sensitive" : false
            },
            "dbf-default-scale" : {
              "displayName" : "Default Decimal Scale",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-default-scale",
              "sensitive" : false
            },
            "sql-pre-query" : {
              "displayName" : "SQL Pre-Query",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "sql-pre-query",
              "sensitive" : false
            },
            "compression-format" : {
              "displayName" : "Compression Format",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "compression-format",
              "sensitive" : false
            },
            "esql-output-batch-size" : {
              "displayName" : "Output Batch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-output-batch-size",
              "sensitive" : false
            },
            "esql-fetch-size" : {
              "displayName" : "Fetch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "esql-fetch-size",
              "sensitive" : false
            },
            "dbf-normalize" : {
              "displayName" : "Normalize Table/Column Names",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "dbf-normalize",
              "sensitive" : false
            },
            "Content Output Strategy" : {
              "displayName" : "Content Output Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Content Output Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "retry" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "e580d5a5-6063-3a1e-80fd-3c1a1a40a8b2",
          "maxBackoffPeriod" : "10 mins",
          "name" : "InsertAndUpdateToDataBase",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2944.0,
            "y" : 944.0
          },
          "properties" : {
            "Support Fragmented Transactions" : "false",
            "Batch Size" : "#{PageSizeMax}",
            "Obtain Generated Keys" : "false",
            "JDBC Connection Pool" : "f726dee7-cfcd-3a23-94d5-cb27ac10cbdb",
            "database-session-autocommit" : "true",
            "rollback-on-failure" : "false"
          },
          "propertyDescriptors" : {
            "Support Fragmented Transactions" : {
              "displayName" : "Support Fragmented Transactions",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Support Fragmented Transactions",
              "sensitive" : false
            },
            "putsql-sql-statement" : {
              "displayName" : "SQL Statement",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "putsql-sql-statement",
              "sensitive" : false
            },
            "Transaction Timeout" : {
              "displayName" : "Transaction Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Transaction Timeout",
              "sensitive" : false
            },
            "Batch Size" : {
              "displayName" : "Batch Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Batch Size",
              "sensitive" : false
            },
            "Obtain Generated Keys" : {
              "displayName" : "Obtain Generated Keys",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Obtain Generated Keys",
              "sensitive" : false
            },
            "JDBC Connection Pool" : {
              "displayName" : "JDBC Connection Pool",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "JDBC Connection Pool",
              "sensitive" : false
            },
            "database-session-autocommit" : {
              "displayName" : "Database Session AutoCommit",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "database-session-autocommit",
              "sensitive" : false
            },
            "rollback-on-failure" : {
              "displayName" : "Rollback On Failure",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "rollback-on-failure",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.PutSQL",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "abdb5430-5d9d-329b-b074-55e3e1b7cf4d",
          "maxBackoffPeriod" : "10 mins",
          "name" : "KhoiTao",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 232.0,
            "y" : -208.0
          },
          "properties" : {
            "stateCurrent.filename" : "${state.name}-bc-${stateBc.id}-balance-page${state.page}.json",
            "filename" : "${state.name}-bc-${stateBc.id}-balance-page${state.page}.json",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100",
            "stateCurrent.fullPath" : "#{TempPath}${Path.Separator}${state.name}${Path.Separator}${state.name}-bc-${stateBc.id}-balance-page${state.page}.json",
            "skip" : "${state.page:toNumber():minus(1):multiply(${state.pageSize:toNumber()})}",
            "stateCurrent.directory" : "#{TempPath}${Path.Separator}${state.name}"
          },
          "propertyDescriptors" : {
            "stateCurrent.filename" : {
              "displayName" : "stateCurrent.filename",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateCurrent.filename",
              "sensitive" : false
            },
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "filename" : {
              "displayName" : "filename",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "filename",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "stateCurrent.fullPath" : {
              "displayName" : "stateCurrent.fullPath",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateCurrent.fullPath",
              "sensitive" : false
            },
            "skip" : {
              "displayName" : "skip",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "skip",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            },
            "stateCurrent.directory" : {
              "displayName" : "stateCurrent.directory",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "stateCurrent.directory",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "cb6f752d-4812-3e4e-a6d5-ba4788ba09dc",
          "maxBackoffPeriod" : "10 mins",
          "name" : "UpdateAttributeContinueTrue",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1504.0,
            "y" : 928.0
          },
          "properties" : {
            "state.continue" : "1",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100"
          },
          "propertyDescriptors" : {
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "state.continue" : {
              "displayName" : "state.continue",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "state.continue",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-groovyx-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "870ca5a0-63cd-3d07-9563-d14d3a19c4ae",
          "maxBackoffPeriod" : "10 mins",
          "name" : "TransformData",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2944.0,
            "y" : 664.0
          },
          "properties" : {
            "groovyx-script-body" : "import org.apache.nifi.processor.io.StreamCallback\nimport java.nio.charset.StandardCharsets\nimport groovy.json.JsonSlurper\nimport java.time.LocalDateTime\nimport java.time.format.DateTimeFormatter\nimport java.time.format.DateTimeFormatterBuilder\nimport java.time.temporal.ChronoField\nimport java.util.UUID\nimport java.io.File\n\n// ================= Utils =================\ndef toDimDateId(String isoDateTime) {\n    def d = (isoDateTime ?: \"\").trim()\n    if (!d) return null\n    def day = d.substring(0, 10) // yyyy-MM-dd\n    return day.replace(\"-\", \"\").toInteger() // yyyyMMdd\n}\n\ndef normalizeIso(String dateStr) {\n    def t = (dateStr ?: \"\").trim().replace(' ', 'T')\n    if (!t) return null\n    def parser = new DateTimeFormatterBuilder()\n        .appendPattern(\"yyyy-MM-dd'T'HH:mm:ss\")\n        .optionalStart().appendFraction(ChronoField.NANO_OF_SECOND, 1, 7, true).optionalEnd()\n        .toFormatter()\n    def dt = LocalDateTime.parse(t, parser)\n    return dt.format(DateTimeFormatter.ofPattern(\"yyyy-MM-dd'T'HH:mm:ss.SSSSSSS\"))\n}\n\n// Escape 1 du nhy n\ndef esc(String s) { (s == null) ? null : s.replace(\"'\", \"''\") }\n\n// NVARCHAR/VARCHAR\ndef q(Object v)  { v == null ? \"NULL\" : \"N'${esc(v.toString())}'\" }\ndef qv(Object v) { v == null ? \"NULL\" : \"'${esc(v.toString())}'\" }\n\ndef dec(Object v) {\n    if (v == null) return \"NULL\"\n    def s = v.toString().trim()\n    return s == \"\" ? \"NULL\" : s\n}\n\n// Tr v biu thc SQL cho \"by gi\" (UTC)\ndef sqlNow() { \"SYSUTCDATETIME()\" }\n\n// Chuyn string Date -> biu thc SQL datetime2(7)\ndef safeIsoToSqlDate(Object v) {\n    def iso = normalizeIso(v?.toString())\n    return iso ? \"CONVERT(datetime2(7), ${qv(iso)}, 126)\" : \"NULL\"\n}\n// =============== End Utils ===============\n\ndef flowFile = session.get()\nif (!flowFile) return\n\n// ---------- Attributes ----------\ndef rawPath  = flowFile.getAttribute('stateCurrent.fullPath')  // RAW list (saved JSON file)\ndef dimBcId  = flowFile.getAttribute('stateBc.dimId')          // GUID (DimBusinessCenterId)\ndef bcId     = flowFile.getAttribute('stateBc.id')             // EntityId (string)\n\n// EntityName: ly t stateBc.name; fallback bcId  trnh NULL\ndef entityName = flowFile.getAttribute('stateBc.name')\nif (!entityName?.trim()) entityName = bcId\n\n// ---------- Load RAW ----------\ndef rawList = []\nif (rawPath) {\n    def f = new File(rawPath)\n    if (f.exists()) {\n        def txt = f.getText(StandardCharsets.UTF_8.name())\n        def parsed = new JsonSlurper().parseText(txt)\n        rawList = (parsed instanceof List) ? parsed : [parsed]\n    }\n}\n\n// ---------- Load FACT current from flow content ----------\ndef factRows = []\nflowFile = session.write(flowFile, { inp, out ->\n    def content = inp.getText(StandardCharsets.UTF_8.name())\n    if (content?.trim()) {\n        def parsed = new JsonSlurper().parseText(content)\n        factRows = (parsed instanceof List) ? parsed : [parsed]\n        out.write(content.getBytes(StandardCharsets.UTF_8))\n    } else {\n        out.write(\"[]\".getBytes(StandardCharsets.UTF_8))\n    }\n} as StreamCallback)\n\n// Build fact map: key = (BcId, DateISO7)\ndef factMap = [:]\nfactRows.each { f ->\n    def isoDate = normalizeIso(f?.Date)\n    def key = [ (bcId ?: (f?.EntityId ?: \"\")).toString().trim(),\n                (isoDate ?: \"\") ].join(\"|\")\n    factMap[key] = f\n}\n\n// ---------- DEDUP RAW: latest-wins theo (BcId, DateISO7) ----------\ndef chooseNewer = { a, b ->\n    def da = a?.Date ? normalizeIso(a.Date) : null\n    def db = b?.Date ? normalizeIso(b.Date) : null\n    if (da && db && da != db) return da > db\n    return (a?.Id?.toString() ?: \"\") > (b?.Id?.toString() ?: \"\")\n}\n\ndef dedup = [:]\nrawList.each { r ->\n    def isoDate = normalizeIso(r?.Date)\n    def key = [ (bcId ?: r?.BcId ?: \"\").toString().trim(), (isoDate ?: \"\") ].join(\"|\")\n    def cur = dedup[key]\n    if (cur == null) dedup[key] = r\n    else if (chooseNewer(r, cur)) dedup[key] = r\n}\nrawList = dedup.values().toList()\n\n// ---------- Stage INSERT / UPDATE ----------\ndef inserts = []\ndef updates = []\n\nrawList.each { r ->\n    def isoDate = normalizeIso(r?.Date)\n    def key = [ (bcId ?: r?.BcId ?: \"\").toString().trim(),\n                (isoDate ?: \"\") ].join(\"|\")\n    def existing = factMap[key]\n    if (existing == null) inserts << r else updates << [raw: r, existing: existing]\n}\n\n// ---------- Build SQL ----------\ndef insertValues = inserts.collect { r ->\n    def isoDate   = normalizeIso(r?.Date)\n    def dimDateId = toDimDateId(isoDate)\n    def currency  = (r?.Currency ?: null)\n    def isUSD = (currency == 'USD')\n    def isVND = (currency == 'VND')\n    def id = UUID.randomUUID().toString()   // <<< sinh Id nh Fact Daily Spend\n\n    \"\"\"(\n${qv(id)},                          -- Id\n'BusinessCenter',                   -- Type\n${q(bcId)},                         -- EntityId (BcId)\n${q(entityName)},                   -- EntityName (NOT NULL)\n${dec(r?.AccountBalance)},          -- AccountBalance\n${dec(r?.ValidAccountBalance)},     -- ValidAccountBalance\n${dec(r?.FrozenBalance)},           -- FrozenBalance\n${dec(r?.Tax)},                     -- Tax\n${dec(r?.CashBalance)},             -- CashBalance\n${dec(r?.ValidCashBalance)},        -- ValidCashBalance\n${dec(r?.GrantBalance)},            -- GrantBalance\n${dec(r?.ValidGrantBalance)},       -- ValidGrantBalance\nNULL,                               -- TransferableAmount\nNULL, NULL, NULL,                   -- Budget, BudgetCost, BudgetRemaining\n${q(currency)},                     -- Currency\n${q(r?.Timezone)},                  -- Timezone\n${safeIsoToSqlDate(r?.Date)},       -- Date\n${dimDateId ?: \"NULL\"},             -- DimDateId\nNULL,                               -- DimAdAccountId\n${qv(dimBcId)},                     -- DimBusinessCenterId\n${sqlNow()},                        -- CreationTime (NOT NULL)\nNULL,                               -- CreatorId\nNULL,                               -- LastModificationTime\nNULL,                               -- LastModifierId\n${isUSD ? dec(r?.AccountBalance)   : \"NULL\"},  -- AccountBalanceUSD\n${isVND ? dec(r?.AccountBalance)   : \"NULL\"},  -- AccountBalanceVND\nNULL, NULL,                                   -- BudgetCostUSD, BudgetCostVND\nNULL, NULL,                                   -- BudgetRemainingUSD, BudgetRemainingVND\nNULL, NULL,                                   -- BudgetUSD, BudgetVND\n${isUSD ? dec(r?.CashBalance)      : \"NULL\"},  -- CashBalanceUSD\n${isVND ? dec(r?.CashBalance)      : \"NULL\"},  -- CashBalanceVND\n${isUSD ? dec(r?.FrozenBalance)    : \"NULL\"},  -- FrozenBalanceUSD\n${isVND ? dec(r?.FrozenBalance)    : \"NULL\"},  -- FrozenBalanceVND\n${isUSD ? dec(r?.GrantBalance)     : \"NULL\"},  -- GrantBalanceUSD\n${isVND ? dec(r?.GrantBalance)     : \"NULL\"},  -- GrantBalanceVND\n${isUSD ? dec(r?.Tax)              : \"NULL\"},  -- TaxUSD\n${isVND ? dec(r?.Tax)              : \"NULL\"},  -- TaxVND\nNULL, NULL,                                   -- TransferableAmountUSD, TransferableAmountVND\n${isUSD ? dec(r?.ValidAccountBalance) : \"NULL\"},  -- ValidAccountBalanceUSD\n${isVND ? dec(r?.ValidAccountBalance) : \"NULL\"},  -- ValidAccountBalanceVND\n${isUSD ? dec(r?.ValidCashBalance)    : \"NULL\"},  -- ValidCashBalanceUSD\n${isVND ? dec(r?.ValidCashBalance)    : \"NULL\"},  -- ValidCashBalanceVND\n${isUSD ? dec(r?.ValidGrantBalance)   : \"NULL\"},  -- ValidGrantBalanceUSD\n${isVND ? dec(r?.ValidGrantBalance)   : \"NULL\"}   -- ValidGrantBalanceVND\n)\"\"\"\n}\n\ndef sqlInsert = insertValues.isEmpty() ? \"\" : \"\"\"\nINSERT INTO [dbo].[Fact_FactBalances]\n([Id],\n [Type],[EntityId],[EntityName],\n [AccountBalance],[ValidAccountBalance],[FrozenBalance],[Tax],\n [CashBalance],[ValidCashBalance],[GrantBalance],[ValidGrantBalance],\n [TransferableAmount],[Budget],[BudgetCost],[BudgetRemaining],\n [Currency],[Timezone],[Date],\n [DimDateId],[DimAdAccountId],[DimBusinessCenterId],\n [CreationTime],[CreatorId],[LastModificationTime],[LastModifierId],\n [AccountBalanceUSD],[AccountBalanceVND],\n [BudgetCostUSD],[BudgetCostVND],[BudgetRemainingUSD],[BudgetRemainingVND],\n [BudgetUSD],[BudgetVND],\n [CashBalanceUSD],[CashBalanceVND],\n [FrozenBalanceUSD],[FrozenBalanceVND],\n [GrantBalanceUSD],[GrantBalanceVND],\n [TaxUSD],[TaxVND],\n [TransferableAmountUSD],[TransferableAmountVND],\n [ValidAccountBalanceUSD],[ValidAccountBalanceVND],\n [ValidCashBalanceUSD],[ValidCashBalanceVND],\n [ValidGrantBalanceUSD],[ValidGrantBalanceVND])\nVALUES\n${insertValues.join(\",\\n\")}\n\"\"\".trim()\n\n// UPDATEs\ndef updateStatements = updates.collect { u ->\n    def r = u.raw\n    def existing = u.existing\n    def isoDate   = normalizeIso(r?.Date)\n    def dimDateId = toDimDateId(isoDate)\n    def currency  = (r?.Currency ?: null)\n    def isUSD = (currency == 'USD')\n    def isVND = (currency == 'VND')\n\n    def whereById = existing?.Id ? \"WHERE [Id] = ${qv(existing.Id)}\" : \"\"\"\nWHERE [Type]     = 'BusinessCenter'\n  AND [EntityId] = ${q(bcId)}\n  AND [Date]     = ${safeIsoToSqlDate(r?.Date)}\n\"\"\".trim()\n\n    \"\"\"\nUPDATE [dbo].[Fact_FactBalances]\nSET EntityName             = ${q(entityName)},\n    Currency               = ${q(currency)},\n    Timezone               = ${q(r?.Timezone)},\n    Date                   = ${safeIsoToSqlDate(r?.Date)},\n    DimDateId              = ${dimDateId ?: \"NULL\"},\n    AccountBalance         = ${dec(r?.AccountBalance)},\n    ValidAccountBalance    = ${dec(r?.ValidAccountBalance)},\n    FrozenBalance          = ${dec(r?.FrozenBalance)},\n    Tax                    = ${dec(r?.Tax)},\n    CashBalance            = ${dec(r?.CashBalance)},\n    ValidCashBalance       = ${dec(r?.ValidCashBalance)},\n    GrantBalance           = ${dec(r?.GrantBalance)},\n    ValidGrantBalance      = ${dec(r?.ValidGrantBalance)},\n    TransferableAmount     = NULL,\n    Budget                 = NULL,\n    BudgetCost             = NULL,\n    BudgetRemaining        = NULL,\n    AccountBalanceUSD      = ${isUSD ? dec(r?.AccountBalance)      : \"NULL\"},\n    AccountBalanceVND      = ${isVND ? dec(r?.AccountBalance)      : \"NULL\"},\n    BudgetCostUSD          = NULL,\n    BudgetCostVND          = NULL,\n    BudgetRemainingUSD     = NULL,\n    BudgetRemainingVND     = NULL,\n    BudgetUSD              = NULL,\n    BudgetVND              = NULL,\n    CashBalanceUSD         = ${isUSD ? dec(r?.CashBalance)         : \"NULL\"},\n    CashBalanceVND         = ${isVND ? dec(r?.CashBalance)         : \"NULL\"},\n    FrozenBalanceUSD       = ${isUSD ? dec(r?.FrozenBalance)       : \"NULL\"},\n    FrozenBalanceVND       = ${isVND ? dec(r?.FrozenBalance)       : \"NULL\"},\n    GrantBalanceUSD        = ${isUSD ? dec(r?.GrantBalance)        : \"NULL\"},\n    GrantBalanceVND        = ${isVND ? dec(r?.GrantBalance)        : \"NULL\"},\n    TaxUSD                 = ${isUSD ? dec(r?.Tax)                 : \"NULL\"},\n    TaxVND                 = ${isVND ? dec(r?.Tax)                 : \"NULL\"},\n    TransferableAmountUSD  = NULL,\n    TransferableAmountVND  = NULL,\n    ValidAccountBalanceUSD = ${isUSD ? dec(r?.ValidAccountBalance) : \"NULL\"},\n    ValidAccountBalanceVND = ${isVND ? dec(r?.ValidAccountBalance) : \"NULL\"},\n    ValidCashBalanceUSD    = ${isUSD ? dec(r?.ValidCashBalance)    : \"NULL\"},\n    ValidCashBalanceVND    = ${isVND ? dec(r?.ValidCashBalance)    : \"NULL\"},\n    ValidGrantBalanceUSD   = ${isUSD ? dec(r?.ValidGrantBalance)   : \"NULL\"},\n    ValidGrantBalanceVND   = ${isVND ? dec(r?.ValidGrantBalance)   : \"NULL\"},\n    LastModificationTime   = ${sqlNow()}\n${whereById}\n\"\"\".trim()\n}\n\ndef sqlUpdate = updateStatements.join(\";\\n\")\n\n// ---------- Final SQL to flow content ----------\ndef finalSql = new StringBuilder()\nif (sqlInsert?.trim()) { finalSql.append(sqlInsert.trim()); finalSql.append(\";\\n\") }\nif (sqlUpdate?.trim()) { finalSql.append(sqlUpdate.trim()); finalSql.append(\";\\n\") }\n\nflowFile = session.write(flowFile, { _, out ->\n    out.write((finalSql.toString()).getBytes(StandardCharsets.UTF_8))\n} as StreamCallback)\n\nsession.transfer(flowFile, REL_SUCCESS)",
            "groovyx-failure-strategy" : "rollback"
          },
          "propertyDescriptors" : {
            "groovyx-script-body" : {
              "displayName" : "Script Body",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-body",
              "sensitive" : false
            },
            "groovyx-failure-strategy" : {
              "displayName" : "Failure strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-failure-strategy",
              "sensitive" : false
            },
            "groovyx-additional-classpath" : {
              "displayName" : "Additional classpath",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-additional-classpath",
              "sensitive" : false
            },
            "groovyx-script-file" : {
              "displayName" : "Script File",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "groovyx-script-file",
              "resourceDefinition" : {
                "cardinality" : "SINGLE",
                "resourceTypes" : [ "FILE" ]
              },
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.groovyx.ExecuteGroovyScript",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "272e0502-ebb8-3425-aa3c-a2632acd6ae4",
          "maxBackoffPeriod" : "10 mins",
          "name" : "RouteOnAttributeCheckLastPage",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1928.0,
            "y" : 936.0
          },
          "properties" : {
            "Routing Strategy" : "Route to Property name",
            "isLastPage" : "${lastPage:equals('1')}"
          },
          "propertyDescriptors" : {
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "isLastPage" : {
              "displayName" : "isLastPage",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "isLastPage",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "f4503a9f-3f83-3a70-9f7b-060bd3a4902a",
          "maxBackoffPeriod" : "10 mins",
          "name" : "CheckHasData",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 1952.0,
            "y" : -200.0
          },
          "properties" : {
            "Routing Strategy" : "Route to Property name",
            "hasData" : "${hasData:equals('true')}"
          },
          "propertyDescriptors" : {
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "hasData" : {
              "displayName" : "hasData",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "hasData",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "failure" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "efa3c0b2-4f63-35c9-bbf4-ddcf2179bf66",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ConvertRecord",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2936.0,
            "y" : 360.0
          },
          "properties" : {
            "Include Zero Record FlowFiles" : "true",
            "Record Writer" : "2d17ef4c-c0cc-3b2f-840a-19ea05a3f87a",
            "Record Reader" : "d1900214-a631-39c7-b7fb-00da2780645e"
          },
          "propertyDescriptors" : {
            "Include Zero Record FlowFiles" : {
              "displayName" : "Include Zero Record FlowFiles",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Include Zero Record FlowFiles",
              "sensitive" : false
            },
            "Record Writer" : {
              "displayName" : "Record Writer",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Writer",
              "sensitive" : false
            },
            "Record Reader" : {
              "displayName" : "Record Reader",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Record Reader",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ConvertRecord",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "4bb37496-6c31-332a-ad74-f1c0221e85d7",
          "identifier" : "2e40d03a-8023-3821-bfde-6ae35cd0d057",
          "maxBackoffPeriod" : "10 mins",
          "name" : "SaveRawTemp",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 2448.0,
            "y" : -208.0
          },
          "properties" : {
            "Create Missing Directories" : "true",
            "Directory" : "${stateCurrent.directory}",
            "Conflict Resolution Strategy" : "replace"
          },
          "propertyDescriptors" : {
            "Group" : {
              "displayName" : "Group",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Group",
              "sensitive" : false
            },
            "Owner" : {
              "displayName" : "Owner",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Owner",
              "sensitive" : false
            },
            "Create Missing Directories" : {
              "displayName" : "Create Missing Directories",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Create Missing Directories",
              "sensitive" : false
            },
            "Permissions" : {
              "displayName" : "Permissions",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Permissions",
              "sensitive" : false
            },
            "Maximum File Count" : {
              "displayName" : "Maximum File Count",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum File Count",
              "sensitive" : false
            },
            "Last Modified Time" : {
              "displayName" : "Last Modified Time",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Last Modified Time",
              "sensitive" : false
            },
            "Directory" : {
              "displayName" : "Directory",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Directory",
              "sensitive" : false
            },
            "Conflict Resolution Strategy" : {
              "displayName" : "Conflict Resolution Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Conflict Resolution Strategy",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.PutFile",
          "yieldDuration" : "1 sec"
        } ],
        "remoteProcessGroups" : [ ],
        "scheduledState" : "ENABLED",
        "statelessFlowTimeout" : "1 min"
      } ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
        "identifier" : "9175f17c-2ea9-3dbb-ae8a-a26c104e3627",
        "maxBackoffPeriod" : "10 mins",
        "name" : "TrangTiepTheo",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 808.0,
          "y" : 352.0
        },
        "properties" : {
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.page" : "${state.page:toNumber():plus(1)}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.page" : {
            "displayName" : "state.page",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.page",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
        "identifier" : "ca9ce68e-3640-3bec-80f0-5f6fcfad19b0",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KhoiTao",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 24.0,
          "y" : -72.0
        },
        "properties" : {
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.page" : "1",
          "state.pageSize" : "#{PageSizeMax}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.page" : {
            "displayName" : "state.page",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.page",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.pageSize" : {
            "displayName" : "state.pageSize",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.pageSize",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "7969deba-ec7b-349d-9df8-1b39a124e0df",
        "identifier" : "a9bf6940-48b4-3266-9ad2-eb322d7ed40e",
        "maxBackoffPeriod" : "10 mins",
        "name" : "KiemTraCoTrangTiepTheo",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : 544.0
        },
        "properties" : {
          "Routing Strategy" : "Route to Property name",
          "nextPage" : "${state.continue:equals(1)}"
        },
        "propertyDescriptors" : {
          "Routing Strategy" : {
            "displayName" : "Routing Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Routing Strategy",
            "sensitive" : false
          },
          "nextPage" : {
            "displayName" : "nextPage",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "nextPage",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
          "id" : "a229f77a-bdcf-3c40-9d47-ae3d8dd390bb",
          "name" : "stateBcOut",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
        "identifier" : "e387fd05-2d58-3145-a548-1c26b4a166c4",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
          "id" : "012d928c-f226-341e-82d9-b1330c001b1b",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
          "id" : "401b6391-763c-33d9-8791-1f8ee314f395",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
        "identifier" : "4b16223f-ccfa-3ede-ac2e-d4409115a167",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
          "id" : "8b6e8bbd-a37e-30f4-b920-1b2fdada1ea5",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
          "id" : "fd7491ef-0839-3c34-8152-399b3fce3d2a",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
        "identifier" : "37a6d62f-f551-359d-a473-cbe8192b1960",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
          "id" : "401b6391-763c-33d9-8791-1f8ee314f395",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
          "id" : "fd7491ef-0839-3c34-8152-399b3fce3d2a",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
        "identifier" : "7b62bb79-21b2-3f5a-945f-68bd017f0138",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
          "id" : "012d928c-f226-341e-82d9-b1330c001b1b",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
          "id" : "012d928c-f226-341e-82d9-b1330c001b1b",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
        "identifier" : "31407a31-074a-3e1b-82d4-fb77b8092e20",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
          "id" : "401b6391-763c-33d9-8791-1f8ee314f395",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
          "id" : "8b6e8bbd-a37e-30f4-b920-1b2fdada1ea5",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
        "identifier" : "386427ae-07cd-383f-8ad7-72b67d0ee03b",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
          "id" : "9116237a-68c4-3234-b505-d0d54ed7f0c5",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
        "identifier" : "9116237a-68c4-3234-b505-d0d54ed7f0c5",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LuuTrangThaiBCHienTai",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
        "identifier" : "a229f77a-bdcf-3c40-9d47-ae3d8dd390bb",
        "name" : "stateBcOut",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 1552.0,
          "y" : -154.5
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -248.0,
        "y" : 2592.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
        "identifier" : "401b6391-763c-33d9-8791-1f8ee314f395",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${stateBc.name}\",\n  \"isActive\": ${stateBc.isActive},\n  \"lastExecutionTime\": \"${stateBc.lastExecutionTime}\",\n  \"startTime\": \"${stateBc.startTime}\",\n  \"endTime\": \"${stateBc.endTime}\",\n  \"status\": \"${stateBc.status}\",\n  \"sequenceNumber\": \"${stateBc.sequenceNumber}\",\n  \"message\": \"${stateBc.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
        "identifier" : "8b6e8bbd-a37e-30f4-b920-1b2fdada1ea5",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "filename" : "${stateBc.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "stateBc.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "stateBc.lastExecutionTime" : {
            "displayName" : "stateBc.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "stateBc.lastExecutionTime",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
        "identifier" : "fd7491ef-0839-3c34-8152-399b3fce3d2a",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "8b3913a3-ed9d-3a62-8c7a-4b76eaf802d1",
        "identifier" : "012d928c-f226-341e-82d9-b1330c001b1b",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${stateBc.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
          "id" : "eb2733a4-65d1-3ba9-8f9a-241dda9e5e2c",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
        "identifier" : "3e3ab78c-441f-39b6-882f-4a5fc476dff8",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
          "id" : "7b096743-ed7a-375b-b724-5ad63c62ff60",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
          "id" : "8a3c99ee-2e65-31ce-b4bb-1df4ff9c5435",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
        "identifier" : "80432706-6a41-3dfc-8ee5-0406c9d22ac1",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
          "id" : "7b096743-ed7a-375b-b724-5ad63c62ff60",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
          "id" : "7b096743-ed7a-375b-b724-5ad63c62ff60",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
        "identifier" : "544e07e3-f3ad-3ef5-9fbd-b8606f5eec4e",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
          "id" : "64ef7041-9864-32e7-895a-06df857811a1",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
          "id" : "cdb82e02-4e6a-3734-8f0e-0ce72fbb0996",
          "name" : "stateOut",
          "type" : "OUTPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
        "identifier" : "654b11b9-189a-3a0f-ad59-59b115e0325b",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
          "id" : "eb2733a4-65d1-3ba9-8f9a-241dda9e5e2c",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
          "id" : "64ef7041-9864-32e7-895a-06df857811a1",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
        "identifier" : "9685577c-70a1-3af0-aae9-45a44ba26b80",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
          "id" : "572276bb-3237-390d-8b67-d7ddd77fc65d",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
          "id" : "8a3c99ee-2e65-31ce-b4bb-1df4ff9c5435",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
        "identifier" : "23e59a9a-6813-35b5-8b7f-7ab0a38c7414",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
          "id" : "eb2733a4-65d1-3ba9-8f9a-241dda9e5e2c",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
        "identifier" : "572276bb-3237-390d-8b67-d7ddd77fc65d",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "LuuTrangThaiETL",
      "outputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "OUTPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
        "identifier" : "cdb82e02-4e6a-3734-8f0e-0ce72fbb0996",
        "name" : "stateOut",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : 1464.0,
          "y" : -200.0
        },
        "scheduledState" : "ENABLED",
        "type" : "OUTPUT_PORT"
      } ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -248.0,
        "y" : 712.0
      },
      "processGroups" : [ ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
        "identifier" : "8a3c99ee-2e65-31ce-b4bb-1df4ff9c5435",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
        "identifier" : "7b096743-ed7a-375b-b724-5ad63c62ff60",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${state.name}\",\n  \"isActive\": ${state.isActive},\n  \"lastExecutionTime\": \"${state.lastExecutionTime}\",\n  \"startTime\": \"${state.startTime}\",\n  \"endTime\": \"${state.endTime}\",\n  \"status\": \"${state.status}\",\n  \"sequenceNumber\": \"${state.sequenceNumber}\",\n  \"message\": \"${state.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
        "identifier" : "eb2733a4-65d1-3ba9-8f9a-241dda9e5e2c",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 944.0,
          "y" : -232.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${state.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "d9609542-59a1-380f-b98f-bd7a36b1fee3",
        "identifier" : "64ef7041-9864-32e7-895a-06df857811a1",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "filename" : "${state.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.lastExecutionTime" : {
            "displayName" : "state.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.lastExecutionTime",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    }, {
      "comments" : "",
      "componentType" : "PROCESS_GROUP",
      "connections" : [ {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
          "id" : "7e0afdd3-a0b5-32a6-9870-c3d5c41d45d8",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
        "identifier" : "35beb613-62c5-327d-a23a-2cecc52f0e10",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
          "id" : "5d3a0bde-7109-3bc6-9584-85153be550d7",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "zIndex" : 42
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
          "id" : "a407561c-15ca-3933-9fa6-3ccbca09eaa3",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
        "identifier" : "4591de48-71d3-3f52-8e89-3e5cd4035711",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
          "id" : "e6445664-61ca-3b2f-8b29-559dc937ad32",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 46
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
          "id" : "a407561c-15ca-3933-9fa6-3ccbca09eaa3",
          "name" : "LogMessage",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
        "identifier" : "8900275d-c266-31b8-bd2d-1bb68d5324a5",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "failure" ],
        "source" : {
          "comments" : "",
          "groupId" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
          "id" : "7e0afdd3-a0b5-32a6-9870-c3d5c41d45d8",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 44
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
          "id" : "e6445664-61ca-3b2f-8b29-559dc937ad32",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
        "identifier" : "7995dbee-a980-30f3-ba05-e86080909287",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
          "id" : "7e0afdd3-a0b5-32a6-9870-c3d5c41d45d8",
          "name" : "CapNhatToContent",
          "type" : "PROCESSOR"
        },
        "zIndex" : 43
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "comments" : "",
          "groupId" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
          "id" : "5d3a0bde-7109-3bc6-9584-85153be550d7",
          "name" : "ChuanHoa",
          "type" : "PROCESSOR"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
        "identifier" : "88c8f55c-751e-3a0a-94fe-15b4bf778650",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "" ],
        "source" : {
          "groupId" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
          "id" : "f38a92a2-4ba5-3cc6-a1d1-c045cdc021a2",
          "name" : "TrangThai",
          "type" : "INPUT_PORT"
        },
        "zIndex" : 41
      }, {
        "backPressureDataSizeThreshold" : "1 GB",
        "backPressureObjectThreshold" : 10000,
        "bends" : [ ],
        "componentType" : "CONNECTION",
        "destination" : {
          "groupId" : "5e1501db-8be6-36f4-8373-385afbf52aba",
          "id" : "04e7b8a7-cde0-33a1-a2cc-b9555ebfb8af",
          "name" : "input",
          "type" : "INPUT_PORT"
        },
        "flowFileExpiration" : "0 sec",
        "groupIdentifier" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
        "identifier" : "d3f153a1-1711-379a-b00c-bea4c06e0bdd",
        "labelIndex" : 0,
        "loadBalanceCompression" : "DO_NOT_COMPRESS",
        "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
        "name" : "",
        "partitioningAttribute" : "",
        "prioritizers" : [ ],
        "selectedRelationships" : [ "success" ],
        "source" : {
          "comments" : "",
          "groupId" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
          "id" : "e6445664-61ca-3b2f-8b29-559dc937ad32",
          "name" : "LuuFile",
          "type" : "PROCESSOR"
        },
        "zIndex" : 47
      } ],
      "controllerServices" : [ ],
      "defaultBackPressureDataSizeThreshold" : "1 GB",
      "defaultBackPressureObjectThreshold" : 10000,
      "defaultFlowFileExpiration" : "0 sec",
      "executionEngine" : "INHERITED",
      "flowFileConcurrency" : "UNBOUNDED",
      "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
      "funnels" : [ ],
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
      "inputPorts" : [ {
        "allowRemoteAccess" : false,
        "componentType" : "INPUT_PORT",
        "concurrentlySchedulableTaskCount" : 1,
        "groupIdentifier" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
        "identifier" : "f38a92a2-4ba5-3cc6-a1d1-c045cdc021a2",
        "name" : "TrangThai",
        "portFunction" : "STANDARD",
        "position" : {
          "x" : -488.0,
          "y" : -176.0
        },
        "scheduledState" : "ENABLED",
        "type" : "INPUT_PORT"
      } ],
      "labels" : [ ],
      "maxConcurrentTasks" : 1,
      "name" : "ETL_Error",
      "outputPorts" : [ ],
      "parameterContextName" : "ETL",
      "position" : {
        "x" : -768.0,
        "y" : 1432.0
      },
      "processGroups" : [ {
        "comments" : "",
        "componentType" : "PROCESS_GROUP",
        "connections" : [ {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "5e1501db-8be6-36f4-8373-385afbf52aba",
            "id" : "724170fc-20ac-3e49-9dcc-74526cb2fc8a",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "5e1501db-8be6-36f4-8373-385afbf52aba",
          "identifier" : "eac40917-6ab1-3791-a13a-3fddfdbd63a1",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "Response", "Failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "5e1501db-8be6-36f4-8373-385afbf52aba",
            "id" : "ab97f61b-0983-381a-b3b2-54488a9db14b",
            "name" : "GuiTinNhanTelegram",
            "type" : "PROCESSOR"
          },
          "zIndex" : 5
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "5e1501db-8be6-36f4-8373-385afbf52aba",
            "id" : "724170fc-20ac-3e49-9dcc-74526cb2fc8a",
            "name" : "LogMessage",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "5e1501db-8be6-36f4-8373-385afbf52aba",
          "identifier" : "e2a3d54b-407f-3aad-b829-b9f1af1d41b4",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "failure" ],
          "source" : {
            "comments" : "",
            "groupId" : "5e1501db-8be6-36f4-8373-385afbf52aba",
            "id" : "1d2d6122-862c-35a1-92a9-343c49b44cd7",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "zIndex" : 9
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "5e1501db-8be6-36f4-8373-385afbf52aba",
            "id" : "51a30bd9-cef6-3227-acb9-e6eccd4b4e90",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "5e1501db-8be6-36f4-8373-385afbf52aba",
          "identifier" : "72e03019-d645-3bcb-aec9-279d0875b218",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "5e1501db-8be6-36f4-8373-385afbf52aba",
            "id" : "424d4c6e-8e21-3b51-a417-9f521046d699",
            "name" : "LaythongtinTelegramCauHinh",
            "type" : "PROCESSOR"
          },
          "zIndex" : 6
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "5e1501db-8be6-36f4-8373-385afbf52aba",
            "id" : "424d4c6e-8e21-3b51-a417-9f521046d699",
            "name" : "LaythongtinTelegramCauHinh",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "5e1501db-8be6-36f4-8373-385afbf52aba",
          "identifier" : "2854459d-f08d-3c8a-8be7-108690afe2d3",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "" ],
          "source" : {
            "groupId" : "5e1501db-8be6-36f4-8373-385afbf52aba",
            "id" : "04e7b8a7-cde0-33a1-a2cc-b9555ebfb8af",
            "name" : "input",
            "type" : "INPUT_PORT"
          },
          "zIndex" : 1
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "5e1501db-8be6-36f4-8373-385afbf52aba",
            "id" : "ab97f61b-0983-381a-b3b2-54488a9db14b",
            "name" : "GuiTinNhanTelegram",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "5e1501db-8be6-36f4-8373-385afbf52aba",
          "identifier" : "d61eb532-a2ac-3779-b337-0150729d7ceb",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "success" ],
          "source" : {
            "comments" : "",
            "groupId" : "5e1501db-8be6-36f4-8373-385afbf52aba",
            "id" : "1d2d6122-862c-35a1-92a9-343c49b44cd7",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "zIndex" : 7
        }, {
          "backPressureDataSizeThreshold" : "1 GB",
          "backPressureObjectThreshold" : 10000,
          "bends" : [ ],
          "componentType" : "CONNECTION",
          "destination" : {
            "comments" : "",
            "groupId" : "5e1501db-8be6-36f4-8373-385afbf52aba",
            "id" : "1d2d6122-862c-35a1-92a9-343c49b44cd7",
            "name" : "ReplaceText",
            "type" : "PROCESSOR"
          },
          "flowFileExpiration" : "0 sec",
          "groupIdentifier" : "5e1501db-8be6-36f4-8373-385afbf52aba",
          "identifier" : "278de485-6579-3530-a9a4-10547d695638",
          "labelIndex" : 0,
          "loadBalanceCompression" : "DO_NOT_COMPRESS",
          "loadBalanceStrategy" : "DO_NOT_LOAD_BALANCE",
          "name" : "",
          "partitioningAttribute" : "",
          "prioritizers" : [ ],
          "selectedRelationships" : [ "send" ],
          "source" : {
            "comments" : "",
            "groupId" : "5e1501db-8be6-36f4-8373-385afbf52aba",
            "id" : "51a30bd9-cef6-3227-acb9-e6eccd4b4e90",
            "name" : "RouteOnAttribute",
            "type" : "PROCESSOR"
          },
          "zIndex" : 8
        } ],
        "controllerServices" : [ ],
        "defaultBackPressureDataSizeThreshold" : "1 GB",
        "defaultBackPressureObjectThreshold" : 10000,
        "defaultFlowFileExpiration" : "0 sec",
        "executionEngine" : "INHERITED",
        "flowFileConcurrency" : "UNBOUNDED",
        "flowFileOutboundPolicy" : "STREAM_WHEN_AVAILABLE",
        "funnels" : [ ],
        "groupIdentifier" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
        "identifier" : "5e1501db-8be6-36f4-8373-385afbf52aba",
        "inputPorts" : [ {
          "allowRemoteAccess" : false,
          "componentType" : "INPUT_PORT",
          "concurrentlySchedulableTaskCount" : 1,
          "groupIdentifier" : "5e1501db-8be6-36f4-8373-385afbf52aba",
          "identifier" : "04e7b8a7-cde0-33a1-a2cc-b9555ebfb8af",
          "name" : "input",
          "portFunction" : "STANDARD",
          "position" : {
            "x" : -1056.0,
            "y" : -248.0
          },
          "scheduledState" : "ENABLED",
          "type" : "INPUT_PORT"
        } ],
        "labels" : [ ],
        "maxConcurrentTasks" : 1,
        "name" : "GuiThongBaoTelegram",
        "outputPorts" : [ ],
        "parameterContextName" : "ETL",
        "position" : {
          "x" : 1432.0,
          "y" : -272.0
        },
        "processGroups" : [ ],
        "processors" : [ {
          "autoTerminatedRelationships" : [ "No Retry", "Retry", "Original" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "5e1501db-8be6-36f4-8373-385afbf52aba",
          "identifier" : "ab97f61b-0983-381a-b3b2-54488a9db14b",
          "maxBackoffPeriod" : "10 mins",
          "name" : "GuiTinNhanTelegram",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 656.0,
            "y" : -296.0
          },
          "properties" : {
            "Request Content-Encoding" : "DISABLED",
            "Request Multipart Form-Data Filename Enabled" : "true",
            "Request Chunked Transfer-Encoding Enabled" : "false",
            "HTTP/2 Disabled" : "False",
            "Connection Timeout" : "30 secs",
            "Response Cookie Strategy" : "DISABLED",
            "Socket Read Timeout" : "15 secs",
            "Socket Idle Connections" : "5",
            "Request Body Enabled" : "true",
            "OAuth2 Access Token Refresh Strategy" : "ON_TOKEN_EXPIRATION",
            "HTTP URL" : "https://api.telegram.org/bot#{BotToken}/sendMessage",
            "Socket Idle Timeout" : "5 mins",
            "Response Redirects Enabled" : "True",
            "Socket Write Timeout" : "15 secs",
            "Response FlowFile Naming Strategy" : "RANDOM",
            "Response Cache Enabled" : "false",
            "Request Date Header Enabled" : "True",
            "Request Failure Penalization Enabled" : "false",
            "Response Body Attribute Size" : "256",
            "Response Generation Required" : "false",
            "Response Header Request Attributes Enabled" : "false",
            "HTTP Method" : "POST",
            "Request Content-Type" : "application/json",
            "Request Digest Authentication Enabled" : "false",
            "Response Cache Size" : "10MB",
            "Response Body Ignored" : "false"
          },
          "propertyDescriptors" : {
            "Request Content-Encoding" : {
              "displayName" : "Request Content-Encoding",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Content-Encoding",
              "sensitive" : false
            },
            "proxy-configuration-service" : {
              "displayName" : "Proxy Configuration Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "proxy-configuration-service",
              "sensitive" : false
            },
            "Request Multipart Form-Data Filename Enabled" : {
              "displayName" : "Request Multipart Form-Data Filename Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Multipart Form-Data Filename Enabled",
              "sensitive" : false
            },
            "Request Chunked Transfer-Encoding Enabled" : {
              "displayName" : "Request Chunked Transfer-Encoding Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Chunked Transfer-Encoding Enabled",
              "sensitive" : false
            },
            "Response Header Request Attributes Prefix" : {
              "displayName" : "Response Header Request Attributes Prefix",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Header Request Attributes Prefix",
              "sensitive" : false
            },
            "HTTP/2 Disabled" : {
              "displayName" : "HTTP/2 Disabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP/2 Disabled",
              "sensitive" : false
            },
            "Connection Timeout" : {
              "displayName" : "Connection Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Connection Timeout",
              "sensitive" : false
            },
            "Response Cookie Strategy" : {
              "displayName" : "Response Cookie Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cookie Strategy",
              "sensitive" : false
            },
            "Request Password" : {
              "displayName" : "Request Password",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Password",
              "sensitive" : true
            },
            "Socket Read Timeout" : {
              "displayName" : "Socket Read Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Read Timeout",
              "sensitive" : false
            },
            "Socket Idle Connections" : {
              "displayName" : "Socket Idle Connections",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Idle Connections",
              "sensitive" : false
            },
            "Request Body Enabled" : {
              "displayName" : "Request Body Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Body Enabled",
              "sensitive" : false
            },
            "OAuth2 Access Token Refresh Strategy" : {
              "displayName" : "OAuth2 Access Token Refresh Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "OAuth2 Access Token Refresh Strategy",
              "sensitive" : false
            },
            "HTTP URL" : {
              "displayName" : "HTTP URL",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP URL",
              "sensitive" : false
            },
            "Request OAuth2 Access Token Provider" : {
              "displayName" : "Request OAuth2 Access Token Provider",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "Request OAuth2 Access Token Provider",
              "sensitive" : false
            },
            "Socket Idle Timeout" : {
              "displayName" : "Socket Idle Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Idle Timeout",
              "sensitive" : false
            },
            "Response Redirects Enabled" : {
              "displayName" : "Response Redirects Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Redirects Enabled",
              "sensitive" : false
            },
            "Socket Write Timeout" : {
              "displayName" : "Socket Write Timeout",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Socket Write Timeout",
              "sensitive" : false
            },
            "Request Header Attributes Pattern" : {
              "displayName" : "Request Header Attributes Pattern",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Header Attributes Pattern",
              "sensitive" : false
            },
            "Response FlowFile Naming Strategy" : {
              "displayName" : "Response FlowFile Naming Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response FlowFile Naming Strategy",
              "sensitive" : false
            },
            "Response Cache Enabled" : {
              "displayName" : "Response Cache Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cache Enabled",
              "sensitive" : false
            },
            "Request Date Header Enabled" : {
              "displayName" : "Request Date Header Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Date Header Enabled",
              "sensitive" : false
            },
            "Request Failure Penalization Enabled" : {
              "displayName" : "Request Failure Penalization Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Failure Penalization Enabled",
              "sensitive" : false
            },
            "Response Body Attribute Size" : {
              "displayName" : "Response Body Attribute Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Attribute Size",
              "sensitive" : false
            },
            "SSL Context Service" : {
              "displayName" : "SSL Context Service",
              "dynamic" : false,
              "identifiesControllerService" : true,
              "name" : "SSL Context Service",
              "sensitive" : false
            },
            "Response Generation Required" : {
              "displayName" : "Response Generation Required",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Generation Required",
              "sensitive" : false
            },
            "Request User-Agent" : {
              "displayName" : "Request User-Agent",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request User-Agent",
              "sensitive" : false
            },
            "Response Header Request Attributes Enabled" : {
              "displayName" : "Response Header Request Attributes Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Header Request Attributes Enabled",
              "sensitive" : false
            },
            "HTTP Method" : {
              "displayName" : "HTTP Method",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "HTTP Method",
              "sensitive" : false
            },
            "Request Username" : {
              "displayName" : "Request Username",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Username",
              "sensitive" : false
            },
            "Request Content-Type" : {
              "displayName" : "Request Content-Type",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Content-Type",
              "sensitive" : false
            },
            "Response Body Attribute Name" : {
              "displayName" : "Response Body Attribute Name",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Attribute Name",
              "sensitive" : false
            },
            "Request Digest Authentication Enabled" : {
              "displayName" : "Request Digest Authentication Enabled",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Digest Authentication Enabled",
              "sensitive" : false
            },
            "Request Multipart Form-Data Name" : {
              "displayName" : "Request Multipart Form-Data Name",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Request Multipart Form-Data Name",
              "sensitive" : false
            },
            "Response Cache Size" : {
              "displayName" : "Response Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Cache Size",
              "sensitive" : false
            },
            "Response Body Ignored" : {
              "displayName" : "Response Body Ignored",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Response Body Ignored",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 0,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.InvokeHTTP",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-update-attribute-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "5e1501db-8be6-36f4-8373-385afbf52aba",
          "identifier" : "424d4c6e-8e21-3b51-a417-9f521046d699",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LaythongtinTelegramCauHinh",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : -656.0,
            "y" : -280.0
          },
          "properties" : {
            "telegram.botToken" : "#{BotToken}",
            "Store State" : "Do not store state",
            "canonical-value-lookup-cache-size" : "100",
            "telegram.chatId" : "#{ChatId}",
            "telegram.enabled" : "#{Enabled}",
            "telegram.text" : " MESSAGE ALERT\n Application: NIFI\n Flow: ${state.name}\n Message: ${state.message}"
          },
          "propertyDescriptors" : {
            "telegram.botToken" : {
              "displayName" : "telegram.botToken",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.botToken",
              "sensitive" : false
            },
            "Delete Attributes Expression" : {
              "displayName" : "Delete Attributes Expression",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Delete Attributes Expression",
              "sensitive" : false
            },
            "Store State" : {
              "displayName" : "Store State",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Store State",
              "sensitive" : false
            },
            "canonical-value-lookup-cache-size" : {
              "displayName" : "Cache Value Lookup Cache Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "canonical-value-lookup-cache-size",
              "sensitive" : false
            },
            "telegram.chatId" : {
              "displayName" : "telegram.chatId",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.chatId",
              "sensitive" : false
            },
            "Stateful Variables Initial Value" : {
              "displayName" : "Stateful Variables Initial Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Stateful Variables Initial Value",
              "sensitive" : false
            },
            "telegram.enabled" : {
              "displayName" : "telegram.enabled",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.enabled",
              "sensitive" : false
            },
            "telegram.text" : {
              "displayName" : "telegram.text",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "telegram.text",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "5e1501db-8be6-36f4-8373-385afbf52aba",
          "identifier" : "1d2d6122-862c-35a1-92a9-343c49b44cd7",
          "maxBackoffPeriod" : "10 mins",
          "name" : "ReplaceText",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 200.0,
            "y" : -288.0
          },
          "properties" : {
            "Regular Expression" : "(?s)^(.*)$",
            "Replacement Value" : "{\"chat_id\":\"#{ChatId}\",\"text\":\"${telegram.text}\"}",
            "Evaluation Mode" : "Entire text",
            "Line-by-Line Evaluation Mode" : "All",
            "Character Set" : "UTF-8",
            "Maximum Buffer Size" : "1 MB",
            "Replacement Strategy" : "Regex Replace"
          },
          "propertyDescriptors" : {
            "Regular Expression" : {
              "displayName" : "Search Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Regular Expression",
              "sensitive" : false
            },
            "Replacement Value" : {
              "displayName" : "Replacement Value",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Value",
              "sensitive" : false
            },
            "Evaluation Mode" : {
              "displayName" : "Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Evaluation Mode",
              "sensitive" : false
            },
            "Text to Prepend" : {
              "displayName" : "Text to Prepend",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Prepend",
              "sensitive" : false
            },
            "Line-by-Line Evaluation Mode" : {
              "displayName" : "Line-by-Line Evaluation Mode",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Line-by-Line Evaluation Mode",
              "sensitive" : false
            },
            "Character Set" : {
              "displayName" : "Character Set",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Character Set",
              "sensitive" : false
            },
            "Maximum Buffer Size" : {
              "displayName" : "Maximum Buffer Size",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Maximum Buffer Size",
              "sensitive" : false
            },
            "Replacement Strategy" : {
              "displayName" : "Replacement Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Replacement Strategy",
              "sensitive" : false
            },
            "Text to Append" : {
              "displayName" : "Text to Append",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Text to Append",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.ReplaceText",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "success" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "5e1501db-8be6-36f4-8373-385afbf52aba",
          "identifier" : "724170fc-20ac-3e49-9dcc-74526cb2fc8a",
          "maxBackoffPeriod" : "10 mins",
          "name" : "LogMessage",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : 224.0,
            "y" : 32.0
          },
          "properties" : {
            "log-level" : "info"
          },
          "propertyDescriptors" : {
            "log-message" : {
              "displayName" : "Log message",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-message",
              "sensitive" : false
            },
            "log-level" : {
              "displayName" : "Log Level",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-level",
              "sensitive" : false
            },
            "log-prefix" : {
              "displayName" : "Log prefix",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "log-prefix",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.LogMessage",
          "yieldDuration" : "1 sec"
        }, {
          "autoTerminatedRelationships" : [ "unmatched" ],
          "backoffMechanism" : "PENALIZE_FLOWFILE",
          "bulletinLevel" : "WARN",
          "bundle" : {
            "artifact" : "nifi-standard-nar",
            "group" : "org.apache.nifi",
            "version" : "2.4.0"
          },
          "comments" : "",
          "componentType" : "PROCESSOR",
          "concurrentlySchedulableTaskCount" : 1,
          "executionNode" : "ALL",
          "groupIdentifier" : "5e1501db-8be6-36f4-8373-385afbf52aba",
          "identifier" : "51a30bd9-cef6-3227-acb9-e6eccd4b4e90",
          "maxBackoffPeriod" : "10 mins",
          "name" : "RouteOnAttribute",
          "penaltyDuration" : "30 sec",
          "position" : {
            "x" : -184.0,
            "y" : -288.0
          },
          "properties" : {
            "Routing Strategy" : "Route to Property name",
            "send" : "${telegram.enabled:equals('true')}"
          },
          "propertyDescriptors" : {
            "Routing Strategy" : {
              "displayName" : "Routing Strategy",
              "dynamic" : false,
              "identifiesControllerService" : false,
              "name" : "Routing Strategy",
              "sensitive" : false
            },
            "send" : {
              "displayName" : "send",
              "dynamic" : true,
              "identifiesControllerService" : false,
              "name" : "send",
              "sensitive" : false
            }
          },
          "retriedRelationships" : [ ],
          "retryCount" : 10,
          "runDurationMillis" : 25,
          "scheduledState" : "ENABLED",
          "schedulingPeriod" : "0 sec",
          "schedulingStrategy" : "TIMER_DRIVEN",
          "style" : { },
          "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
          "yieldDuration" : "1 sec"
        } ],
        "remoteProcessGroups" : [ ],
        "scheduledState" : "ENABLED",
        "statelessFlowTimeout" : "1 min"
      } ],
      "processors" : [ {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
        "identifier" : "e6445664-61ca-3b2f-8b29-559dc937ad32",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LuuFile",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 904.0,
          "y" : -240.0
        },
        "properties" : {
          "Create Missing Directories" : "true",
          "Directory" : "${state.path}",
          "Conflict Resolution Strategy" : "replace"
        },
        "propertyDescriptors" : {
          "Group" : {
            "displayName" : "Group",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Group",
            "sensitive" : false
          },
          "Owner" : {
            "displayName" : "Owner",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Owner",
            "sensitive" : false
          },
          "Create Missing Directories" : {
            "displayName" : "Create Missing Directories",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Create Missing Directories",
            "sensitive" : false
          },
          "Permissions" : {
            "displayName" : "Permissions",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Permissions",
            "sensitive" : false
          },
          "Maximum File Count" : {
            "displayName" : "Maximum File Count",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum File Count",
            "sensitive" : false
          },
          "Last Modified Time" : {
            "displayName" : "Last Modified Time",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Last Modified Time",
            "sensitive" : false
          },
          "Directory" : {
            "displayName" : "Directory",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Directory",
            "sensitive" : false
          },
          "Conflict Resolution Strategy" : {
            "displayName" : "Conflict Resolution Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Conflict Resolution Strategy",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 0,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.PutFile",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-update-attribute-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
        "identifier" : "5d3a0bde-7109-3bc6-9584-85153be550d7",
        "maxBackoffPeriod" : "10 mins",
        "name" : "ChuanHoa",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 16.0,
          "y" : -224.0
        },
        "properties" : {
          "state.message" : "Li khi duyt tng BC",
          "filename" : "${state.filename}",
          "Store State" : "Do not store state",
          "canonical-value-lookup-cache-size" : "100",
          "state.status" : "3",
          "state.isActive" : "false",
          "state.lastExecutionTime" : "${now():format(\"yyyy-MM-dd HH:mm:ss\", \"UTC\")}"
        },
        "propertyDescriptors" : {
          "state.message" : {
            "displayName" : "state.message",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.message",
            "sensitive" : false
          },
          "Delete Attributes Expression" : {
            "displayName" : "Delete Attributes Expression",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Delete Attributes Expression",
            "sensitive" : false
          },
          "filename" : {
            "displayName" : "filename",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "filename",
            "sensitive" : false
          },
          "Store State" : {
            "displayName" : "Store State",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Store State",
            "sensitive" : false
          },
          "canonical-value-lookup-cache-size" : {
            "displayName" : "Cache Value Lookup Cache Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "canonical-value-lookup-cache-size",
            "sensitive" : false
          },
          "state.status" : {
            "displayName" : "state.status",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.status",
            "sensitive" : false
          },
          "Stateful Variables Initial Value" : {
            "displayName" : "Stateful Variables Initial Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Stateful Variables Initial Value",
            "sensitive" : false
          },
          "state.isActive" : {
            "displayName" : "state.isActive",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.isActive",
            "sensitive" : false
          },
          "state.lastExecutionTime" : {
            "displayName" : "state.lastExecutionTime",
            "dynamic" : true,
            "identifiesControllerService" : false,
            "name" : "state.lastExecutionTime",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ "success" ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
        "identifier" : "a407561c-15ca-3933-9fa6-3ccbca09eaa3",
        "maxBackoffPeriod" : "10 mins",
        "name" : "LogMessage",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 616.0,
          "y" : 64.0
        },
        "properties" : {
          "log-level" : "info"
        },
        "propertyDescriptors" : {
          "log-message" : {
            "displayName" : "Log message",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-message",
            "sensitive" : false
          },
          "log-level" : {
            "displayName" : "Log Level",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-level",
            "sensitive" : false
          },
          "log-prefix" : {
            "displayName" : "Log prefix",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "log-prefix",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ "success" ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.LogMessage",
        "yieldDuration" : "1 sec"
      }, {
        "autoTerminatedRelationships" : [ ],
        "backoffMechanism" : "PENALIZE_FLOWFILE",
        "bulletinLevel" : "WARN",
        "bundle" : {
          "artifact" : "nifi-standard-nar",
          "group" : "org.apache.nifi",
          "version" : "2.4.0"
        },
        "comments" : "",
        "componentType" : "PROCESSOR",
        "concurrentlySchedulableTaskCount" : 1,
        "executionNode" : "ALL",
        "groupIdentifier" : "5f767217-2eb7-3fc7-8831-8247acc9323c",
        "identifier" : "7e0afdd3-a0b5-32a6-9870-c3d5c41d45d8",
        "maxBackoffPeriod" : "10 mins",
        "name" : "CapNhatToContent",
        "penaltyDuration" : "30 sec",
        "position" : {
          "x" : 424.0,
          "y" : -232.0
        },
        "properties" : {
          "Regular Expression" : "(?s)(^.*$)",
          "Replacement Value" : "{\n  \"name\": \"${state.name}\",\n  \"isActive\": ${state.isActive},\n  \"lastExecutionTime\": \"${state.lastExecutionTime}\",\n  \"startTime\": \"${state.startTime}\",\n  \"endTime\": \"${state.endTime}\",\n  \"status\": \"${state.status}\",\n  \"sequenceNumber\": \"${state.sequenceNumber}\",\n  \"message\": \"${state.message}\"\n}",
          "Evaluation Mode" : "Entire text",
          "Line-by-Line Evaluation Mode" : "All",
          "Character Set" : "UTF-8",
          "Maximum Buffer Size" : "1 MB",
          "Replacement Strategy" : "Always Replace"
        },
        "propertyDescriptors" : {
          "Regular Expression" : {
            "displayName" : "Search Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Regular Expression",
            "sensitive" : false
          },
          "Replacement Value" : {
            "displayName" : "Replacement Value",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Value",
            "sensitive" : false
          },
          "Evaluation Mode" : {
            "displayName" : "Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Evaluation Mode",
            "sensitive" : false
          },
          "Text to Prepend" : {
            "displayName" : "Text to Prepend",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Prepend",
            "sensitive" : false
          },
          "Line-by-Line Evaluation Mode" : {
            "displayName" : "Line-by-Line Evaluation Mode",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Line-by-Line Evaluation Mode",
            "sensitive" : false
          },
          "Character Set" : {
            "displayName" : "Character Set",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Character Set",
            "sensitive" : false
          },
          "Maximum Buffer Size" : {
            "displayName" : "Maximum Buffer Size",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Maximum Buffer Size",
            "sensitive" : false
          },
          "Replacement Strategy" : {
            "displayName" : "Replacement Strategy",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Replacement Strategy",
            "sensitive" : false
          },
          "Text to Append" : {
            "displayName" : "Text to Append",
            "dynamic" : false,
            "identifiesControllerService" : false,
            "name" : "Text to Append",
            "sensitive" : false
          }
        },
        "retriedRelationships" : [ ],
        "retryCount" : 10,
        "runDurationMillis" : 25,
        "scheduledState" : "ENABLED",
        "schedulingPeriod" : "0 sec",
        "schedulingStrategy" : "TIMER_DRIVEN",
        "style" : { },
        "type" : "org.apache.nifi.processors.standard.ReplaceText",
        "yieldDuration" : "1 sec"
      } ],
      "remoteProcessGroups" : [ ],
      "scheduledState" : "ENABLED",
      "statelessFlowTimeout" : "1 min"
    } ],
    "processors" : [ {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-update-attribute-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "99b444bd-5d1b-3389-bfcf-f8243cd5b15b",
      "maxBackoffPeriod" : "10 mins",
      "name" : "CapNhatETLLaDangXuLy",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -232.0,
        "y" : 480.0
      },
      "properties" : {
        "state.message" : "ang x l",
        "filename" : "${state.filename}",
        "Store State" : "Do not store state",
        "canonical-value-lookup-cache-size" : "100",
        "state.status" : "1",
        "state.isActive" : "true"
      },
      "propertyDescriptors" : {
        "state.message" : {
          "displayName" : "state.message",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.message",
          "sensitive" : false
        },
        "Delete Attributes Expression" : {
          "displayName" : "Delete Attributes Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Delete Attributes Expression",
          "sensitive" : false
        },
        "filename" : {
          "displayName" : "filename",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "filename",
          "sensitive" : false
        },
        "Store State" : {
          "displayName" : "Store State",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Store State",
          "sensitive" : false
        },
        "canonical-value-lookup-cache-size" : {
          "displayName" : "Cache Value Lookup Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "canonical-value-lookup-cache-size",
          "sensitive" : false
        },
        "state.status" : {
          "displayName" : "state.status",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.status",
          "sensitive" : false
        },
        "Stateful Variables Initial Value" : {
          "displayName" : "Stateful Variables Initial Value",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Stateful Variables Initial Value",
          "sensitive" : false
        },
        "state.isActive" : {
          "displayName" : "state.isActive",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.isActive",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "3cc95655-3400-3579-a815-e447ac4e2606",
      "maxBackoffPeriod" : "10 mins",
      "name" : "KiemTraLaBcCuoiCung",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -240.0,
        "y" : 4168.0
      },
      "properties" : {
        "Routing Strategy" : "Route to Property name",
        "bcCuoiCung" : "${fragment.index:toNumber():equals(${fragment.count:toNumber():minus(1)}):and(${state.continue:equals('0')})}"
      },
      "propertyDescriptors" : {
        "Routing Strategy" : {
          "displayName" : "Routing Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Routing Strategy",
          "sensitive" : false
        },
        "bcCuoiCung" : {
          "displayName" : "bcCuoiCung",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "bcCuoiCung",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "96b5172e-db84-3891-bfc8-0b96074dab1f",
      "maxBackoffPeriod" : "10 mins",
      "name" : "DuyetTungBC",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -232.0,
        "y" : 1432.0
      },
      "properties" : {
        "Max String Length" : "100 MB",
        "Null Value Representation" : "empty string",
        "JsonPath Expression" : "$[*]"
      },
      "propertyDescriptors" : {
        "Max String Length" : {
          "displayName" : "Max String Length",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Max String Length",
          "sensitive" : false
        },
        "Null Value Representation" : {
          "displayName" : "Null Value Representation",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Null Value Representation",
          "sensitive" : false
        },
        "JsonPath Expression" : {
          "displayName" : "JsonPath Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "JsonPath Expression",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.SplitJson",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-update-attribute-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "05476764-c5db-3856-b73c-8ea3a70e570b",
      "maxBackoffPeriod" : "10 mins",
      "name" : "CapNhatTrangThaiBcHienTaiLaHoanThanh",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -232.0,
        "y" : 3664.0
      },
      "properties" : {
        "Store State" : "Do not store state",
        "canonical-value-lookup-cache-size" : "100",
        "stateBc.isActive" : "false",
        "stateBc.message" : "Hon thnh",
        "stateBc.status" : "2"
      },
      "propertyDescriptors" : {
        "Delete Attributes Expression" : {
          "displayName" : "Delete Attributes Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Delete Attributes Expression",
          "sensitive" : false
        },
        "Store State" : {
          "displayName" : "Store State",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Store State",
          "sensitive" : false
        },
        "canonical-value-lookup-cache-size" : {
          "displayName" : "Cache Value Lookup Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "canonical-value-lookup-cache-size",
          "sensitive" : false
        },
        "stateBc.isActive" : {
          "displayName" : "stateBc.isActive",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.isActive",
          "sensitive" : false
        },
        "Stateful Variables Initial Value" : {
          "displayName" : "Stateful Variables Initial Value",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Stateful Variables Initial Value",
          "sensitive" : false
        },
        "stateBc.message" : {
          "displayName" : "stateBc.message",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.message",
          "sensitive" : false
        },
        "stateBc.status" : {
          "displayName" : "stateBc.status",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.status",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "1fb0038d-d9d4-364c-880e-692997df6f0f",
      "maxBackoffPeriod" : "10 mins",
      "name" : "LayDanhSachBC",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -232.0,
        "y" : 992.0
      },
      "properties" : {
        "esql-max-rows" : "0",
        "dbf-default-precision" : "10",
        "Max Wait Time" : "0 seconds",
        "SQL Query" : "SELECT *\nFROM dbo.Dim_DimBusinessCenters\nWHERE IsCurrent = 1;",
        "Database Connection Pooling Service" : "f726dee7-cfcd-3a23-94d5-cb27ac10cbdb",
        "esql-auto-commit" : "true",
        "dbf-user-logical-types" : "false",
        "dbf-default-scale" : "0",
        "compression-format" : "NONE",
        "esql-output-batch-size" : "0",
        "esql-fetch-size" : "0",
        "dbf-normalize" : "false",
        "Content Output Strategy" : "EMPTY"
      },
      "propertyDescriptors" : {
        "esql-max-rows" : {
          "displayName" : "Max Rows Per Flow File",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "esql-max-rows",
          "sensitive" : false
        },
        "dbf-default-precision" : {
          "displayName" : "Default Decimal Precision",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbf-default-precision",
          "sensitive" : false
        },
        "Max Wait Time" : {
          "displayName" : "Max Wait Time",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Max Wait Time",
          "sensitive" : false
        },
        "SQL Query" : {
          "displayName" : "SQL Query",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "SQL Query",
          "sensitive" : false
        },
        "Database Connection Pooling Service" : {
          "displayName" : "Database Connection Pooling Service",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "Database Connection Pooling Service",
          "sensitive" : false
        },
        "sql-post-query" : {
          "displayName" : "SQL Post-Query",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "sql-post-query",
          "sensitive" : false
        },
        "esql-auto-commit" : {
          "displayName" : "Set Auto Commit",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "esql-auto-commit",
          "sensitive" : false
        },
        "dbf-user-logical-types" : {
          "displayName" : "Use Avro Logical Types",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbf-user-logical-types",
          "sensitive" : false
        },
        "dbf-default-scale" : {
          "displayName" : "Default Decimal Scale",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbf-default-scale",
          "sensitive" : false
        },
        "sql-pre-query" : {
          "displayName" : "SQL Pre-Query",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "sql-pre-query",
          "sensitive" : false
        },
        "compression-format" : {
          "displayName" : "Compression Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "compression-format",
          "sensitive" : false
        },
        "esql-output-batch-size" : {
          "displayName" : "Output Batch Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "esql-output-batch-size",
          "sensitive" : false
        },
        "esql-fetch-size" : {
          "displayName" : "Fetch Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "esql-fetch-size",
          "sensitive" : false
        },
        "dbf-normalize" : {
          "displayName" : "Normalize Table/Column Names",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "dbf-normalize",
          "sensitive" : false
        },
        "Content Output Strategy" : {
          "displayName" : "Content Output Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Content Output Strategy",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.ExecuteSQL",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "success" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "260cb945-8151-315d-935b-b459b6993414",
      "maxBackoffPeriod" : "10 mins",
      "name" : "LogMessage",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -736.0,
        "y" : 4168.0
      },
      "properties" : {
        "log-level" : "info"
      },
      "propertyDescriptors" : {
        "log-message" : {
          "displayName" : "Log message",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-message",
          "sensitive" : false
        },
        "log-level" : {
          "displayName" : "Log Level",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-level",
          "sensitive" : false
        },
        "log-prefix" : {
          "displayName" : "Log prefix",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-prefix",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.LogMessage",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-update-attribute-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "5136f87e-48fb-3f88-b60e-e3a5b1afa93c",
      "maxBackoffPeriod" : "10 mins",
      "name" : "CapNhatTrangThaiETLLaHoanThanh",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -240.0,
        "y" : 4392.0
      },
      "properties" : {
        "state.message" : "Hon thnh",
        "filename" : "${state.filename}",
        "Store State" : "Do not store state",
        "canonical-value-lookup-cache-size" : "100",
        "state.status" : "2",
        "state.isActive" : "false"
      },
      "propertyDescriptors" : {
        "state.message" : {
          "displayName" : "state.message",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.message",
          "sensitive" : false
        },
        "Delete Attributes Expression" : {
          "displayName" : "Delete Attributes Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Delete Attributes Expression",
          "sensitive" : false
        },
        "filename" : {
          "displayName" : "filename",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "filename",
          "sensitive" : false
        },
        "Store State" : {
          "displayName" : "Store State",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Store State",
          "sensitive" : false
        },
        "canonical-value-lookup-cache-size" : {
          "displayName" : "Cache Value Lookup Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "canonical-value-lookup-cache-size",
          "sensitive" : false
        },
        "state.status" : {
          "displayName" : "state.status",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.status",
          "sensitive" : false
        },
        "Stateful Variables Initial Value" : {
          "displayName" : "Stateful Variables Initial Value",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Stateful Variables Initial Value",
          "sensitive" : false
        },
        "state.isActive" : {
          "displayName" : "state.isActive",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.isActive",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "a4fb998c-7538-3cee-ac9a-234f9bf5fc6e",
      "maxBackoffPeriod" : "10 mins",
      "name" : "KhoiTao",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -232.0,
        "y" : -232.0
      },
      "properties" : {
        "character-set" : "UTF-8",
        "state.name" : "ETL_Balance",
        "File Size" : "100MB",
        "Path.Separator" : "#{Path.Separator}",
        "Batch Size" : "1",
        "Unique FlowFiles" : "false",
        "Data Format" : "Text"
      },
      "propertyDescriptors" : {
        "character-set" : {
          "displayName" : "Character Set",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "character-set",
          "sensitive" : false
        },
        "state.name" : {
          "displayName" : "state.name",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.name",
          "sensitive" : false
        },
        "File Size" : {
          "displayName" : "File Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "File Size",
          "sensitive" : false
        },
        "mime-type" : {
          "displayName" : "Mime Type",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "mime-type",
          "sensitive" : false
        },
        "generate-ff-custom-text" : {
          "displayName" : "Custom Text",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "generate-ff-custom-text",
          "sensitive" : false
        },
        "Path.Separator" : {
          "displayName" : "Path.Separator",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "Path.Separator",
          "sensitive" : false
        },
        "Batch Size" : {
          "displayName" : "Batch Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Batch Size",
          "sensitive" : false
        },
        "Unique FlowFiles" : {
          "displayName" : "Unique FlowFiles",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Unique FlowFiles",
          "sensitive" : false
        },
        "Data Format" : {
          "displayName" : "Data Format",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Data Format",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "60 min",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.GenerateFlowFile",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-update-attribute-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "dcdb240d-9e54-321c-b0db-d1930fe1c00b",
      "maxBackoffPeriod" : "10 mins",
      "name" : "CapNhatETLLaHoanThanh",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : 240.0,
        "y" : 1664.0
      },
      "properties" : {
        "state.message" : "Hon thnh - BC Empty",
        "filename" : "${state.filename}",
        "Store State" : "Do not store state",
        "canonical-value-lookup-cache-size" : "100",
        "state.status" : "2",
        "state.isActive" : "false"
      },
      "propertyDescriptors" : {
        "state.message" : {
          "displayName" : "state.message",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.message",
          "sensitive" : false
        },
        "Delete Attributes Expression" : {
          "displayName" : "Delete Attributes Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Delete Attributes Expression",
          "sensitive" : false
        },
        "filename" : {
          "displayName" : "filename",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "filename",
          "sensitive" : false
        },
        "Store State" : {
          "displayName" : "Store State",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Store State",
          "sensitive" : false
        },
        "canonical-value-lookup-cache-size" : {
          "displayName" : "Cache Value Lookup Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "canonical-value-lookup-cache-size",
          "sensitive" : false
        },
        "state.status" : {
          "displayName" : "state.status",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.status",
          "sensitive" : false
        },
        "Stateful Variables Initial Value" : {
          "displayName" : "Stateful Variables Initial Value",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Stateful Variables Initial Value",
          "sensitive" : false
        },
        "state.isActive" : {
          "displayName" : "state.isActive",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "state.isActive",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "success" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "03169748-cd9d-32b5-bce4-24e75d2e04f2",
      "maxBackoffPeriod" : "10 mins",
      "name" : "LogMessage",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -736.0,
        "y" : 480.0
      },
      "properties" : {
        "log-level" : "info"
      },
      "propertyDescriptors" : {
        "log-message" : {
          "displayName" : "Log message",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-message",
          "sensitive" : false
        },
        "log-level" : {
          "displayName" : "Log Level",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-level",
          "sensitive" : false
        },
        "log-prefix" : {
          "displayName" : "Log prefix",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-prefix",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.LogMessage",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "unmatched" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "1774681b-ca1d-3390-85c0-ee5c4e681d3d",
      "maxBackoffPeriod" : "10 mins",
      "name" : "KiemTraDanhSachBcTrong",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : 240.0,
        "y" : 1432.0
      },
      "properties" : {
        "Content Buffer Size" : "100 MB",
        "Match Requirement" : "content must match exactly",
        "isEmptyJsonArray " : "^\\[\\s*\\]$",
        "Character Set" : "UTF-8"
      },
      "propertyDescriptors" : {
        "Content Buffer Size" : {
          "displayName" : "Content Buffer Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Content Buffer Size",
          "sensitive" : false
        },
        "Match Requirement" : {
          "displayName" : "Match Requirement",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Match Requirement",
          "sensitive" : false
        },
        "isEmptyJsonArray " : {
          "displayName" : "isEmptyJsonArray ",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "isEmptyJsonArray ",
          "sensitive" : false
        },
        "Character Set" : {
          "displayName" : "Character Set",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Character Set",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.RouteOnContent",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-update-attribute-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "5da7a001-7348-3b30-91cb-941688015de1",
      "maxBackoffPeriod" : "10 mins",
      "name" : "CapNhatBcHienTaiLaDangXuLy",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -232.0,
        "y" : 2352.0
      },
      "properties" : {
        "stateBc.endTime" : "${state.endTime}",
        "Store State" : "Do not store state",
        "canonical-value-lookup-cache-size" : "100",
        "stateBc.sequenceNumber" : "${state.sequenceNumber}",
        "stateBc.isActive" : "true",
        "stateBc.message" : "ang x l",
        "stateBc.status" : "1"
      },
      "propertyDescriptors" : {
        "stateBc.endTime" : {
          "displayName" : "stateBc.endTime",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.endTime",
          "sensitive" : false
        },
        "Delete Attributes Expression" : {
          "displayName" : "Delete Attributes Expression",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Delete Attributes Expression",
          "sensitive" : false
        },
        "Store State" : {
          "displayName" : "Store State",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Store State",
          "sensitive" : false
        },
        "canonical-value-lookup-cache-size" : {
          "displayName" : "Cache Value Lookup Cache Size",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "canonical-value-lookup-cache-size",
          "sensitive" : false
        },
        "stateBc.sequenceNumber" : {
          "displayName" : "stateBc.sequenceNumber",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.sequenceNumber",
          "sensitive" : false
        },
        "stateBc.isActive" : {
          "displayName" : "stateBc.isActive",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.isActive",
          "sensitive" : false
        },
        "Stateful Variables Initial Value" : {
          "displayName" : "Stateful Variables Initial Value",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Stateful Variables Initial Value",
          "sensitive" : false
        },
        "stateBc.message" : {
          "displayName" : "stateBc.message",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.message",
          "sensitive" : false
        },
        "stateBc.status" : {
          "displayName" : "stateBc.status",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.status",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.attributes.UpdateAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "847ef9b6-d151-3fe8-b263-2c6c40a260ef",
      "maxBackoffPeriod" : "10 mins",
      "name" : "KiemTraETLDangXuLy",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -232.0,
        "y" : 264.0
      },
      "properties" : {
        "Routing Strategy" : "Route to Property name",
        "isProcessing" : "${state.isActive:equals('true')}"
      },
      "propertyDescriptors" : {
        "Routing Strategy" : {
          "displayName" : "Routing Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Routing Strategy",
          "sensitive" : false
        },
        "isProcessing" : {
          "displayName" : "isProcessing",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "isProcessing",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "success" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "c960b738-713f-38d6-9cb0-c356c4f3a1a4",
      "maxBackoffPeriod" : "10 mins",
      "name" : "LogMessage",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -720.0,
        "y" : 2136.0
      },
      "properties" : {
        "log-level" : "info"
      },
      "propertyDescriptors" : {
        "log-message" : {
          "displayName" : "Log message",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-message",
          "sensitive" : false
        },
        "log-level" : {
          "displayName" : "Log Level",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-level",
          "sensitive" : false
        },
        "log-prefix" : {
          "displayName" : "Log prefix",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "log-prefix",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ "success" ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.LogMessage",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "0cdf5897-5b6a-30ac-8e52-877fac24bd68",
      "maxBackoffPeriod" : "10 mins",
      "name" : "KiemTraBcDaETLChua",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -232.0,
        "y" : 2136.0
      },
      "properties" : {
        "Routing Strategy" : "Route to Property name",
        "HoanThanhETLRoi" : "${stateBc.sequenceNumber:gt(${state.sequenceNumber})}"
      },
      "propertyDescriptors" : {
        "Routing Strategy" : {
          "displayName" : "Routing Strategy",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Routing Strategy",
          "sensitive" : false
        },
        "HoanThanhETLRoi" : {
          "displayName" : "HoanThanhETLRoi",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "HoanThanhETLRoi",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 25,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.RouteOnAttribute",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "failure", "unmatched" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "112b2ee1-09dc-381c-ae20-e68e18f84138",
      "maxBackoffPeriod" : "10 mins",
      "name" : "ChuyenContentBcLenAttribute",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -232.0,
        "y" : 1664.0
      },
      "properties" : {
        "Destination" : "flowfile-attribute",
        "Max String Length" : "20 MB",
        "stateBc.name" : "$.BcName",
        "stateBc.dimId" : "$.Id",
        "Return Type" : "auto-detect",
        "stateBc.id" : "$.BcId",
        "Null Value Representation" : "empty string",
        "Path Not Found Behavior" : "ignore"
      },
      "propertyDescriptors" : {
        "Destination" : {
          "displayName" : "Destination",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Destination",
          "sensitive" : false
        },
        "Max String Length" : {
          "displayName" : "Max String Length",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Max String Length",
          "sensitive" : false
        },
        "stateBc.name" : {
          "displayName" : "stateBc.name",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.name",
          "sensitive" : false
        },
        "stateBc.dimId" : {
          "displayName" : "stateBc.dimId",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.dimId",
          "sensitive" : false
        },
        "Return Type" : {
          "displayName" : "Return Type",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Return Type",
          "sensitive" : false
        },
        "stateBc.id" : {
          "displayName" : "stateBc.id",
          "dynamic" : true,
          "identifiesControllerService" : false,
          "name" : "stateBc.id",
          "sensitive" : false
        },
        "Null Value Representation" : {
          "displayName" : "Null Value Representation",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Null Value Representation",
          "sensitive" : false
        },
        "Path Not Found Behavior" : {
          "displayName" : "Path Not Found Behavior",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Path Not Found Behavior",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.EvaluateJsonPath",
      "yieldDuration" : "1 sec"
    }, {
      "autoTerminatedRelationships" : [ "failure" ],
      "backoffMechanism" : "PENALIZE_FLOWFILE",
      "bulletinLevel" : "WARN",
      "bundle" : {
        "artifact" : "nifi-standard-nar",
        "group" : "org.apache.nifi",
        "version" : "2.4.0"
      },
      "comments" : "",
      "componentType" : "PROCESSOR",
      "concurrentlySchedulableTaskCount" : 1,
      "executionNode" : "ALL",
      "groupIdentifier" : "flow-contents-group",
      "identifier" : "ba8699c9-8e46-3393-996f-d6a353e45afa",
      "maxBackoffPeriod" : "10 mins",
      "name" : "Data to JSON",
      "penaltyDuration" : "30 sec",
      "position" : {
        "x" : -232.0,
        "y" : 1216.0
      },
      "properties" : {
        "Include Zero Record FlowFiles" : "true",
        "Record Writer" : "2d17ef4c-c0cc-3b2f-840a-19ea05a3f87a",
        "Record Reader" : "d1900214-a631-39c7-b7fb-00da2780645e"
      },
      "propertyDescriptors" : {
        "Include Zero Record FlowFiles" : {
          "displayName" : "Include Zero Record FlowFiles",
          "dynamic" : false,
          "identifiesControllerService" : false,
          "name" : "Include Zero Record FlowFiles",
          "sensitive" : false
        },
        "Record Writer" : {
          "displayName" : "Record Writer",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "Record Writer",
          "sensitive" : false
        },
        "Record Reader" : {
          "displayName" : "Record Reader",
          "dynamic" : false,
          "identifiesControllerService" : true,
          "name" : "Record Reader",
          "sensitive" : false
        }
      },
      "retriedRelationships" : [ ],
      "retryCount" : 10,
      "runDurationMillis" : 0,
      "scheduledState" : "ENABLED",
      "schedulingPeriod" : "0 sec",
      "schedulingStrategy" : "TIMER_DRIVEN",
      "style" : { },
      "type" : "org.apache.nifi.processors.standard.ConvertRecord",
      "yieldDuration" : "1 sec"
    } ],
    "remoteProcessGroups" : [ ],
    "scheduledState" : "ENABLED",
    "statelessFlowTimeout" : "1 min"
  },
  "flowEncodingVersion" : "1.0",
  "latest" : false,
  "parameterContexts" : {
    "ETL" : {
      "componentType" : "PARAMETER_CONTEXT",
      "inheritedParameterContexts" : [ ],
      "name" : "ETL",
      "parameters" : [ {
        "description" : "",
        "name" : "TempPath",
        "provided" : false,
        "sensitive" : false,
        "value" : ".\\template\\etl"
      }, {
        "description" : "",
        "name" : "PageSizeMax",
        "provided" : false,
        "sensitive" : false,
        "value" : "500"
      }, {
        "description" : "",
        "name" : "DbAccount",
        "provided" : false,
        "sensitive" : false,
        "value" : "sa"
      }, {
        "description" : "",
        "name" : "Path.Separator",
        "provided" : false,
        "sensitive" : false,
        "value" : "\\"
      }, {
        "description" : "",
        "name" : "DbDriverClassName",
        "provided" : false,
        "sensitive" : false,
        "value" : "com.microsoft.sqlserver.jdbc.SQLServerDriver"
      }, {
        "description" : "",
        "name" : "Enabled",
        "provided" : false,
        "sensitive" : false,
        "value" : "true"
      }, {
        "description" : "",
        "name" : "DbConnectString",
        "provided" : false,
        "sensitive" : false,
        "value" : "jdbc:sqlserver://127.0.0.1:1433;databaseName=TikTokDWH;TrustServerCertificate=true"
      }, {
        "description" : "",
        "name" : "DbDriverLocation",
        "provided" : false,
        "sensitive" : false,
        "value" : ".\\lib\\mssql-jdbc-12.10.1.jre11.jar"
      }, {
        "description" : "",
        "name" : "Directory",
        "provided" : false,
        "sensitive" : false,
        "value" : "${stateCurrent.Directory}"
      } ]
    },
    "TikTokETL" : {
      "componentType" : "PARAMETER_CONTEXT",
      "inheritedParameterContexts" : [ ],
      "name" : "TikTokETL",
      "parameters" : [ {
        "description" : "",
        "name" : "accept",
        "provided" : false,
        "sensitive" : false,
        "value" : "application/json;odata.metadata=minimal;odata.streaming=true"
      }, {
        "description" : "",
        "name" : "api.url",
        "provided" : false,
        "sensitive" : false,
        "value" : "https://app2.southeastasia.cloudapp.azure.com:44383/api/tiktok-video/get-list"
      }, {
        "description" : "",
        "name" : "Cookie",
        "provided" : false,
        "sensitive" : false,
        "value" : ".AspNetCore.Antiforgery=GIATRICOOKIE"
      }, {
        "description" : "",
        "name" : "X-Requested-With",
        "provided" : false,
        "sensitive" : false,
        "value" : "XMLHttpRequest"
      }, {
        "description" : "",
        "name" : "Log Level",
        "provided" : false,
        "sensitive" : false,
        "value" : "info"
      }, {
        "description" : "",
        "name" : "DbFacDimAccount",
        "provided" : false,
        "sensitive" : false,
        "value" : "sa"
      }, {
        "description" : "",
        "name" : "TempPath",
        "provided" : false,
        "sensitive" : false,
        "value" : ".\\tmp\\etl"
      }, {
        "description" : "",
        "name" : "DbDriverClassName",
        "provided" : false,
        "sensitive" : false,
        "value" : "com.microsoft.sqlserver.jdbc.SQLServerDriver"
      }, {
        "description" : "",
        "name" : "DbFactDimPassword",
        "provided" : false,
        "sensitive" : true
      }, {
        "description" : "",
        "name" : "HTTP Method",
        "provided" : false,
        "sensitive" : false,
        "value" : "POST"
      }, {
        "description" : "",
        "name" : "RequestVerificationToken",
        "provided" : false,
        "sensitive" : false,
        "value" : "CfDJ8KO0KjQZsxpOjzNZE7tYUzE6ND9vFRJaIzBoCSzgW535yiP6nE1BEbAmFlcjfNk2EH67bVcPBEWibuish2OMk-DsuFQB20jgBg12j6Q8zutg6CaS3qPDsoSZAP5w6JSAJVpivWol5TfeCBTBDn0gnao"
      }, {
        "description" : "",
        "name" : "api.content-type",
        "provided" : false,
        "sensitive" : false,
        "value" : "application/json;odata.metadata=minimal;odata.streaming=true"
      }, {
        "description" : "",
        "name" : "api.accept",
        "provided" : false,
        "sensitive" : false,
        "value" : "application/json;odata.metadata=minimal;odata.streaming=true"
      }, {
        "description" : "",
        "name" : "DbPassword",
        "provided" : false,
        "sensitive" : true
      }, {
        "description" : "",
        "name" : "DbAccount",
        "provided" : false,
        "sensitive" : false,
        "value" : "sa"
      }, {
        "description" : "",
        "name" : "DbFactDimConnectionString",
        "provided" : false,
        "sensitive" : false,
        "value" : "jdbc:sqlserver://127.0.0.1:1433;databaseName=TikTok;TrustServerCertificate=true"
      }, {
        "description" : "",
        "name" : "DbFactDimDriverClassName",
        "provided" : false,
        "sensitive" : false,
        "value" : "com.microsoft.sqlserver.jdbc.SQLServerDriver"
      }, {
        "description" : "",
        "name" : "api.XRequestedWith",
        "provided" : false,
        "sensitive" : false,
        "value" : "XMLHttpRequest"
      }, {
        "description" : "",
        "name" : "PageSizeMax",
        "provided" : false,
        "sensitive" : false,
        "value" : "500"
      }, {
        "description" : "",
        "name" : "api.token",
        "provided" : false,
        "sensitive" : false,
        "value" : "CfDJ8KO0KjQZsxpOjzNZE7tYUzE6ND9vFRJaIzBoCSzgW535yiP6nE1BEbAmFlcjfNk2EH67bVcPBEWibuish2OMk-DsuFQB20jgBg12j6Q8zutg6CaS3qPDsoSZAP5w6JSAJVpivWol5TfeCBTBDn0gnao"
      }, {
        "description" : "",
        "name" : "Path.Separator",
        "provided" : false,
        "sensitive" : false,
        "value" : "\\"
      }, {
        "description" : "",
        "name" : "DbConnectionString",
        "provided" : false,
        "sensitive" : false,
        "value" : "jdbc:sqlserver://127.0.0.1:1433;databaseName=TikTok;TrustServerCertificate=true"
      }, {
        "description" : "",
        "name" : "DbFactDimDriverLocation",
        "provided" : false,
        "sensitive" : false,
        "value" : ".\\lib\\mssql-jdbc-12.10.1.jre11.jar"
      }, {
        "description" : "",
        "name" : "DbDriverLocation",
        "provided" : false,
        "sensitive" : false,
        "value" : ".\\lib\\mssql-jdbc-12.10.1.jre11.jar"
      }, {
        "description" : "",
        "name" : "Directory",
        "provided" : false,
        "sensitive" : false,
        "value" : "${stateCurrent.Directory}"
      } ]
    }
  },
  "parameterProviders" : { },
  "snapshotMetadata" : {
    "author" : "4df8cad9-d248-48ab-a56c-7d80a4da5f7f",
    "flowIdentifier" : "FACTBALANCE",
    "timestamp" : 0
  }
}